/******************************************************************************
*  Filename:       rf_patch_mce_genook.c
*
*  Description: RF core patch for General OOK support in CC13x4 and CC26x4
*
*  Copyright (c) 2023, Texas Instruments Incorporated
*  All rights reserved.
*
*  Redistribution and use in source and binary forms, with or without
*  modification, are permitted provided that the following conditions are met:
*
*  1) Redistributions of source code must retain the above copyright notice,
*     this list of conditions and the following disclaimer.
*
*  2) Redistributions in binary form must reproduce the above copyright notice,
*     this list of conditions and the following disclaimer in the documentation
*     and/or other materials provided with the distribution.
*
*  3) Neither the name of the ORGANIZATION nor the names of its contributors may
*     be used to endorse or promote products derived from this software without
*     specific prior written permission.
*
*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
*  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
*  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
*  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
*  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
*  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
*  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
*  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
*  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
*  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
*  POSSIBILITY OF SUCH DAMAGE.
*
******************************************************************************/

#include <stdint.h>
#include "rf_patch_mce_genook.h"
#include <ti/devices/DeviceFamily.h>
#include DeviceFamily_constructPath(inc/hw_types.h)

#ifndef MCE_PATCH_TYPE
#define MCE_PATCH_TYPE static const uint32_t
#endif

#ifndef PATCH_FUN_SPEC
#define PATCH_FUN_SPEC
#endif

#ifndef RFC_MCERAM_BASE
#define RFC_MCERAM_BASE 0x21008000
#endif

#ifndef MCE_PATCH_MODE
#define MCE_PATCH_MODE 0
#endif

MCE_PATCH_TYPE patchGenookMce[472] = {
   0x603c0000,
   0x01952fcf,
   0x7fff0001,
   0x030c003f,
   0x070c680a,
   0x00000000,
   0x00000000,
   0x000f0001,
   0x00aaaaaa,
   0x808000fc,
   0x07ff07f8,
   0x0040ffc0,
   0x00170003,
   0x0000001f,
   0x04000000,
   0x0000000f,
   0x00020387,
   0x00434074,
   0x00018000,
   0x06f00020,
   0x091e0000,
   0x00540500,
   0x00000000,
   0x00505014,
   0x000f0000,
   0x007f7f30,
   0x00000000,
   0x00000000,
   0xaaaa0000,
   0x0000aaaa,
   0x72687223,
   0x73057303,
   0x73047203,
   0x72047306,
   0x72967396,
   0x8001c7c0,
   0x90010001,
   0x08019010,
   0x720d9001,
   0x720f720e,
   0xb0d07210,
   0xb1107100,
   0x721ba0d0,
   0x10208162,
   0x1e000670,
   0x1e104080,
   0x1e204081,
   0x39824069,
   0x163206f2,
   0x14211101,
   0x619a6c01,
   0x6332619a,
   0x3982634e,
   0x16323942,
   0x14211101,
   0x60f56c01,
   0x612760f5,
   0x60751220,
   0x72231210,
   0x73127311,
   0x81b17313,
   0x31213921,
   0x91b00010,
   0x6051b070,
   0xc1816074,
   0xc4e0c2b2,
   0x6f131820,
   0x16116e23,
   0x68851612,
   0x9cd07870,
   0x9ce07880,
   0x9cf07890,
   0x9a1078e0,
   0x94807930,
   0xc4f29490,
   0x1820c7a0,
   0x1203409d,
   0x16126e23,
   0x78a0689a,
   0x78b097e0,
   0x78c097f0,
   0x78d09800,
   0x60749810,
   0x96908190,
   0x39808170,
   0x10012a70,
   0x84a21611,
   0xc0f384b4,
   0xc200c0f5,
   0x40ca1c01,
   0x1c10c100,
   0x4cc240c0,
   0x18031013,
   0x1a131830,
   0x39121a10,
   0x60ca68bd,
   0x60ca13f3,
   0x101513f3,
   0x1850c100,
   0x1a101a15,
   0x68c83914,
   0x7100b0e8,
   0xa0e8b128,
   0xb002b230,
   0x8246b012,
   0x40d12216,
   0x3d468176,
   0x819506f6,
   0x06f08170,
   0x06111051,
   0x3d156573,
   0x817068da,
   0x44d422f0,
   0x4cd71a16,
   0x13f087e1,
   0x40ee1c03,
   0x1021c0f0,
   0x65730611,
   0x68e93d12,
   0x1041c0f0,
   0x65730611,
   0x68ef3d14,
   0x72237000,
   0x73127311,
   0xc00087e1,
   0xb11191f0,
   0xc050b0d1,
   0xc0109960,
   0x88109980,
   0x41061e00,
   0xade0bde4,
   0x87fe87ef,
   0xc008880d,
   0x8cf364a6,
   0x39533983,
   0x82100613,
   0x411d2210,
   0x083181d1,
   0x65731017,
   0x22c08cf0,
   0x1071411c,
   0x65730a11,
   0x1201610f,
   0xb2346573,
   0xb111c020,
   0xa0d16591,
   0xa0d3b111,
   0x72236074,
   0x73127311,
   0xc00087e1,
   0xb11191f0,
   0xc050b0d1,
   0xc0109960,
   0xb2309980,
   0x22168246,
   0xb0024134,
   0xc008b012,
   0x78fac030,
   0x061110a1,
   0x391a6573,
   0xc0f0693c,
   0x10a1790a,
   0x65730611,
   0x6943391a,
   0x791ac070,
   0x061110a1,
   0x391a6573,
   0xc090694a,
   0x10a1792a,
   0x65730611,
   0x6951391a,
   0x39838cf3,
   0x06133953,
   0x22108210,
   0xc011416a,
   0x65730831,
   0x82d281d1,
   0x06123972,
   0x65730821,
   0x0831c001,
   0x615a6573,
   0x6573c011,
   0x6573c001,
   0xa0d1b234,
   0xa0d3b111,
   0x08186074,
   0x2201418f,
   0x1e0e4182,
   0x10e9417c,
   0xbde06596,
   0xbde07100,
   0x92313111,
   0x618f3911,
   0x41871e0f,
   0x659610f9,
   0x71006188,
   0x1e0d9231,
   0x10d9418d,
   0xade06596,
   0x1018618f,
   0x7100c029,
   0x1a19b111,
   0x70004591,
   0x1a191000,
   0x70004596,
   0x9820c000,
   0x22c08cf0,
   0xb82b41a0,
   0x66a2676f,
   0x161d84ed,
   0x142d312d,
   0x318e8cee,
   0x397e311e,
   0x39598ce9,
   0x0409c7c0,
   0x72969989,
   0xa964b964,
   0x9962c662,
   0xb012b002,
   0xb3e9b3dc,
   0xb68cb685,
   0xa1b266bc,
   0xb820c00f,
   0x22f18cd1,
   0x8cf145c5,
   0x45c522f1,
   0x710061f8,
   0x220080b0,
   0x80904617,
   0x41ce2220,
   0x61c5665d,
   0x41d222b0,
   0x61c56661,
   0x223080b0,
   0x2a0f45d7,
   0xb13361e4,
   0x45c5220f,
   0x8cd1260f,
   0x41df22f1,
   0x8cf161f3,
   0x41c522f1,
   0x61c5b075,
   0x22508090,
   0xb11542f8,
   0x22108240,
   0x8cd141c5,
   0x41c522e1,
   0xb9649989,
   0xb116a964,
   0x998d61c5,
   0xa964b964,
   0x61c5b116,
   0x80b07100,
   0x46172200,
   0x46162230,
   0x22208090,
   0x665d4203,
   0x22b061f8,
   0x66614207,
   0x809061f8,
   0x42f82250,
   0x8240b115,
   0x41f82210,
   0x22e18cd1,
   0x998d41f8,
   0xa964b964,
   0x61f8b116,
   0xb130b1b2,
   0xb133a0f0,
   0xb074a0f3,
   0xa044b231,
   0xb127b073,
   0xc00fb821,
   0x398e8cfe,
   0x066e393e,
   0xb06db04d,
   0xc003b0e7,
   0x80907100,
   0x44512200,
   0x423222b0,
   0x622a6661,
   0x42362220,
   0x622a665d,
   0x1e13b127,
   0x1613423c,
   0x622ab822,
   0x8bb2ba8d,
   0x3d823182,
   0x4647221e,
   0x2272c000,
   0x0a10464e,
   0x2e0e624e,
   0x465b220e,
   0x1c2ac000,
   0xc0104a4e,
   0x4251222e,
   0x91c00a10,
   0xb823161f,
   0x1e008180,
   0x1a10425b,
   0x4e5b1cf0,
   0x102a6275,
   0xb112622a,
   0x978166b4,
   0xb11b7000,
   0x8ac2ba84,
   0x42721e4b,
   0x161c1426,
   0x392010b0,
   0x426d1c0c,
   0x39107000,
   0x10623806,
   0xc00cc006,
   0x66ad6686,
   0xb8247000,
   0xb116a0d6,
   0xb112a0d2,
   0xb11ba0db,
   0xb127a0e7,
   0x66826322,
   0x70006686,
   0xba84b11b,
   0x70008ac2,
   0x06308a10,
   0x42901e00,
   0x30011051,
   0x14211851,
   0x62913801,
   0x10151021,
   0x39228242,
   0x31211821,
   0x1c017960,
   0x10014e9b,
   0x7970629f,
   0x4a9f1c01,
   0xcff01001,
   0x70000401,
   0x79507947,
   0xc0011870,
   0x16176e71,
   0x79476aa6,
   0x16481078,
   0x6e817000,
   0x79501618,
   0x4eb31c80,
   0x70007948,
   0x6d716d71,
   0x79501617,
   0x4ebb1c70,
   0x70007947,
   0xb116b112,
   0xb130b111,
   0xb115b133,
   0x720db112,
   0x720f720e,
   0xb0d2b0db,
   0xb0f3b0f0,
   0xa469a468,
   0x22f28cd2,
   0xb0d642d2,
   0x62d5b963,
   0x22f08cf0,
   0xb44542ed,
   0x8cf3a444,
   0x39833183,
   0x31808450,
   0x31833980,
   0x94500030,
   0x31508440,
   0x8cf33950,
   0x06f33983,
   0x1834c1f4,
   0x31343184,
   0x94400040,
   0x22e2b089,
   0x8cea42f7,
   0x398a394a,
   0x998a312a,
   0xb0d6b0d5,
   0x7000b963,
   0xa0f0b23f,
   0xa0d2a0f3,
   0xb964998e,
   0xb116a964,
   0xb133b130,
   0x8240b112,
   0x43032200,
   0x8002b115,
   0xa006a004,
   0x7203a001,
   0x71007204,
   0xb116b964,
   0xa23fb0d5,
   0xb1157100,
   0x7820a0d5,
   0x90029030,
   0x90407830,
   0xb0729060,
   0x66bca23f,
   0xa964998a,
   0x61bcb116,
   0x81b0ba8c,
   0x39248ba4,
   0x00043184,
   0x739691b4,
   0x72687296,
   0x72027206,
   0x73057204,
   0x60747306,
   0xb118676f,
   0xb11bb0db,
   0xb258b005,
   0xb1127100,
   0x22e08cf0,
   0x82404340,
   0x43382210,
   0x9781667f,
   0x0a113971,
   0x47482201,
   0x634db005,
   0x22508000,
   0xb270434d,
   0x6338a005,
   0xb0db676f,
   0x120cb074,
   0x398e8a1e,
   0x435d1e0e,
   0x30e01210,
   0x71001a20,
   0x9781667f,
   0x71006b59,
   0x22e08cf0,
   0x82404364,
   0x43542210,
   0x3971667f,
   0x91c10a11,
   0x1e048184,
   0x161c4354,
   0x43221cc4,
   0x12006354,
   0xb11891e0,
   0xb016b006,
   0xb014b004,
   0xb012b002,
   0x78628440,
   0x81730420,
   0x2a733983,
   0xc1f294e3,
   0x31621832,
   0x31511021,
   0x00200012,
   0x78209440,
   0x90509030,
   0x90407830,
   0xc04b9060,
   0x39308360,
   0x1e000630,
   0x300b4394,
   0xa233a234,
   0xc0068360,
   0x2240c00c,
   0xc02c439e,
   0x63a2b234,
   0x43a22230,
   0xb233c01c,
   0xb23567a6,
   0x7000b072,
   0x95e184a1,
   0x95f184b1,
   0x960184c1,
   0x961184d1,
   0x00007000
};

PATCH_FUN_SPEC void rf_patch_mce_genook(void)
{
#ifdef __PATCH_NO_UNROLLING
   uint32_t i;
   for (i = 0; i < 472; i++) {
      HWREG(RFC_MCERAM_BASE + 4 * i) = patchGenookMce[i];
   }
#else
   const uint32_t *pS = patchGenookMce;
   volatile unsigned long *pD = &HWREG(RFC_MCERAM_BASE);
   uint32_t t1, t2, t3, t4, t5, t6, t7, t8;
   uint32_t nIterations = 59;

   do {
      t1 = *pS++;
      t2 = *pS++;
      t3 = *pS++;
      t4 = *pS++;
      t5 = *pS++;
      t6 = *pS++;
      t7 = *pS++;
      t8 = *pS++;
      *pD++ = t1;
      *pD++ = t2;
      *pD++ = t3;
      *pD++ = t4;
      *pD++ = t5;
      *pD++ = t6;
      *pD++ = t7;
      *pD++ = t8;
   } while (--nIterations);
#endif
}
