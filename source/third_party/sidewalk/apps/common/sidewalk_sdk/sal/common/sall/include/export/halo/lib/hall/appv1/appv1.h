/*
 * Copyright 2019-2022 Amazon.com, Inc. or its affiliates. All rights reserved.
 *
 * AMAZON PROPRIETARY/CONFIDENTIAL
 *
 * You may not use this file except in compliance with the terms and
 * conditions set forth in the accompanying LICENSE.TXT file.
 *
 * THESE MATERIALS ARE PROVIDED ON AN "AS IS" BASIS. AMAZON SPECIFICALLY
 * DISCLAIMS, WITH RESPECT TO THESE MATERIALS, ALL WARRANTIES, EXPRESS,
 * IMPLIED, OR STATUTORY, INCLUDING THE IMPLIED WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT.
 */

#ifndef LIB_HALL_INCLUDE_EXPORT_HALO_LIB_HALL_APPV1_APPV1_H_
#define LIB_HALL_INCLUDE_EXPORT_HALO_LIB_HALL_APPV1_APPV1_H_

#ifdef __cplusplus
extern "C" {
#endif

#define RNET_CMD_MIN_LEN \
    6 //!< 2B class + 2B CMD ID with OPC + 1B data header + 1B (payload length)
      //!< other data depends on data header (up to 8B extra)
      //!< and command payload (max len 255)

/**
 * This is enumeration of all commands taken from
 * @link https://doorbot.atlassian.net/wiki/spaces/RL/pages/464830456/Application+Layer+V1
 * and without OPC bits (OPC takes 2LSb)
 */

typedef enum {
    // Management commands
    HALO_HALL_CMD_ID_KA = 0x001,
    HALO_HALL_CMD_ID_KA_2 = 0x000,
    HALO_HALL_CMD_ID_GET_STATUS = 0x006,

    HALO_HALL_CMD_ID_P2P_CHNL = 0x100,
    HALO_HALL_CMD_ID_FW_VERSION = 0x101,
    HALO_HALL_CMD_ID_SERIAL_NUM = 0x102,
    HALO_HALL_CMD_ID_PAN_ID = 0x103,
    HALO_HALL_CMD_ID_P2P_BROADCAST_KEY = 0x104,
    HALO_HALL_CMD_ID_START_DFU = 0x105,
    HALO_HALL_CMD_ID_P2P_UNICAST_KEY = 0x106,
    HALO_HALL_CMD_ID_RESET_INFO = 0x107,
    HALO_HALL_CMD_ID_TIME = 0x108,
    HALO_HALL_CMD_ID_MULTICAST_RETRIES = 0x109,

    HALO_HALL_CMD_ID_DBG_DEV_ID = 0x180,
    HALO_HALL_CMD_ID_GROUP_NUM = 0x10A,
    HALO_HALL_CMD_ID_GO_TO_SIDEBAND = 0x10C,

    HALO_HALL_CMD_ID_KA_INTERVAL = 0x10E,

    HALO_HALL_CMD_ID_DEV_ID = 0x111,

    HALO_HALL_CMD_ID_FACTORY_RESET = 0x112,
    HALO_HALL_CMD_ID_RF_POWER = 0x113,
    HALO_HALL_CMD_ID_BRIDGE_CLOUD_AUTH_TOKEN = 0x114,
    HALO_HALL_CMD_ID_JOIN_NETWORK = 0x120,
    HALO_HALL_CMD_ID_PROTOCOL_VERSION = 0x121,
    HALO_HALL_CMD_ID_PAIRING_STATE = 0x122,
    HALO_HALL_CMD_ID_FIRMWARE_OTA_PARAMETERS = 0x123,
    HALO_HALL_CMD_ID_CAD_PARAMS = 0x124,
    HALO_HALL_CMD_ID_VENDOR_DFU_PKT = 0x125,
    HALO_HALL_CMD_ID_CLASS_VERSION = 0x140,
    HALO_HALL_CMD_ID_FAKE_EVENT = 0x215,
    HALO_HALL_CMD_ID_UPTIME = 0x216,
    HALO_HALL_CMD_ID_CHANNEL_SURVEY = 0x217,
    HALO_HALL_CMD_ID_TMP_PRTCL_EXP = 0x22E,

    // Management Diagnostics
    HALO_HALL_CMD_ID_STATUS_REPORT = 0x0FD,
    HALO_HALL_CMD_ID_DELAY_PING = 0x0FE,
    HALO_HALL_CMD_ID_TEST = 0x0FF,
    HALO_HALL_CMD_ID_START_LQ_TEST = 0x10F,
    HALO_HALL_CMD_ID_STOP_LQ_TEST = 0x110,
    HALO_HALL_CMD_ID_LQ_TEST_RESULTS = 0x128,

    /*** GATEWAY SPECIFIC *********
     * @see appv1/mgm_gateway
     */
    HALO_HALL_CMD_ID_WIFI_MAC = 0x205,
    HALO_HALL_CMD_ID_ETH_MAC = 0x206,
    HALO_HALL_CMD_ID_PROXY_RESP_TIME = 0x226,
    HALO_HALL_CMD_ID_MFG_PROXY_FLAG = 0x210, //!< Only for GW factory purpose command
    HALO_HALL_CMD_ID_RF_SECURITY_SETTINGS = 0x126,
    HALO_HALL_CMD_ID_GW_CONSENT_FLAG = 0x225, //!< alternative name in RingNet: SIDEWALK_NW_FLAG
    HALO_HALL_CMD_ID_NG_DISCOVERY = 0x02,
    HALO_HALL_CMD_ID_GW_ANNOUNCEMENT = 0x3,
    HALO_HALL_CMD_ID_DEV_STATUS_ANNOUNCEMENT = 0x22A,
    HALO_HALL_CMD_ID_DEDICATED_LINK_INIT = 0x22B,
    HALO_HALL_CMD_ID_DEDICATED_LINK_HAND_SHAKE_REQ = 0x22C,
    HALO_HALL_CMD_ID_GW_DISTRESS_DISCOVER = 0x22D,
    HALO_HALL_CMD_ID_HW_ID = 0x129,
    HALO_HALL_CMD_ID_FSK_WAN_AUTH_RESP = 0xD,
    HALO_HALL_CMD_ID_FSK_WAN_SCH = 0xE,
    HALO_HALL_CMD_ID_FSK_WAN_TERM = 0xF,

    /*** GATEWAY SPECIFIC - END ***/

    /**************Deprecated Halo 1.0 command Ids , Please do not reuse***********/
    HALO_HALL_CMD_ID_JOIN = 0x218,
    HALO_HALL_CMD_ID_JOIN_PARAMS = 0x219,
    /*****************************************************************************/
    HALO_HALL_CMD_ID_BRIDGE_KA_INTERVAL = 0x21A,

    HALO_HALL_CMD_ID_DEVICE_PROFILE = 0x21D,
    HALO_HALL_CMD_ID_MAX_BCN_MISS = 0x21E,
    HALO_HALL_CMD_ID_BCN_INTVL = 0x21F,
    HALO_HALL_CMD_ID_LDR_CHANNEL = 0x220,
    HALO_HALL_CMD_ID_DEFICIT_FLAG = 0x221,
    HALO_HALL_CMD_ID_PROBE_AUTH_FLAG = 0x222,
    HALO_HALL_CMD_ID_PROTOCOL_ON = 0x223,
    HALO_HALL_CMD_ID_PAN_SCAN_INTVL = 0x224,
    HALO_HALL_CMD_ID_CONFIG_PARAMS = 0x227,
    HALO_HALL_CMD_ID_HDR_SLOT_PARAM = 0x228,

    HALO_HALL_CMD_ID_CONFIGURATION_COMPLETE = 0x229,
    HALO_HALL_CMD_ID_JOIN_REQUEST = 0x22F,

    // Battery
    HALO_HALL_CMD_ID_VOLTAGE = 0x00,
    HALO_HALL_CMD_ID_LEVEL = 0x01,
    HALO_HALL_CMD_ID_LEVELS = 0x3C,
    HALO_HALL_CMD_ID_VOLTAGES = 0x3D,
    // HALO_HALL_CMD_ID_USAGE_REPORT = 0x02, //!< deprecated, moved to energy

    // Energy
    HALO_HALL_CMD_ID_SOURCE = 0x01,
    HALO_HALL_CMD_ID_USAGE_REPORT = 0x02,
    HALO_HALL_CMD_ID_MODE = 0x03,

    // Halo GATEWAY command class
    HALO_HALL_CMD_ID_RX_PKT = 0x00,
    HALO_HALL_CMD_ID_SEND_PKT = 0x01,
    HALO_HALL_CMD_ID_RX_DFU_PKT = 0x02,
    HALO_HALL_CMD_ID_SEND_DFU_PKT = 0x03,
    HALO_HALL_CMD_ID_SET_DFU_PARAMS = 0x04,
    HALO_HALL_CMD_ID_ZWAVE_TX_FLAG = 0x05,
    HALO_HALL_CMD_ID_ZWAVE_THRESHOLD = 0x06,
    HALO_HALL_CMD_ID_ZWAVE_PARAMS = 0x07,

    // Halo LOGGING class
    HALO_HALL_CMD_ID_SNIFFER_CFG = 0x00,
    HALO_HALL_CMD_ID_SNIFFER_RX_PKT = 0x02,
    HALO_HALL_CMD_ID_SNIFFER_TX_PKT = 0x03,

    HALO_HALL_CMD_ID_ENABLE_DEVICE_LOGS = 0x04,
    HALO_HALL_CMD_ID_DISABLE_DEVICE_LOGS = 0x05,

    HALO_HALL_CMD_ID_SET_MODULE_LOGGING = 0x06,
    HALO_HALL_CMD_ID_LOG_ERROR = 0x07,
    HALO_HALL_CMD_ID_LOG_ENTRIES = 0x08,
    HALO_HALL_CMD_ID_MISSED_PONG = 0x009,

    // SECURITY
    HALO_HALL_CMD_ID_SECURITY_WAN_SEC_PARAMS = 0x0,
    HALO_HALL_CMD_ID_SECURITY_APP_SEC_PARAMS = 0x1,
    HALO_HALL_CMD_ID_SECURITY_PROV_INIT_REQ = 0x4,
    HALO_HALL_CMD_ID_SECURITY_PROV_INIT_REQ_SIG = 0x5,
    HALO_HALL_CMD_ID_SECURITY_PROV_INIT_SIG = 0x6,
    HALO_HALL_CMD_ID_SECURITY_D2D_KEY = 0x7,
    HALO_HALL_CMD_ID_SECURITY_D2D_SEC_PARAMS = 0x8,
    HALO_HALL_CMD_ID_SECURITY_CHALLENGE_REQUEST = 0x9,
    HALO_HALL_CMD_ID_SECURITY_ENCRYPTION_CAPABILITIES = 0x10B,
    HALO_HALL_CMD_ID_SECURITY_CHECK_CERT_SERIAL = 0x10C,
    HALO_HALL_CMD_ID_SECURITY_HAND_SHAKE = 0x10D,
    HALO_HALL_CMD_ID_SECURITY_DEVICE_CERT_COUNT_NONCE = 0x115,
    HALO_HALL_CMD_ID_SECURITY_DEVICE_SERIAL_PUK = 0x116,
    HALO_HALL_CMD_ID_SECURITY_DEVICE_SIG = 0x117,
    HALO_HALL_CMD_ID_SECURITY_MODEL_SERIAL_PUK = 0x118,
    HALO_HALL_CMD_ID_SECURITY_MODEL_SIG = 0x119,
    HALO_HALL_CMD_ID_SECURITY_REMOTE_NONCE_ECDH_PUK_CERT_COUNT = 0x11A,
    HALO_HALL_CMD_ID_SECURITY_REMOTE_ECDH_SIG = 0x11B,
    HALO_HALL_CMD_ID_SECURITY_REMOTE_CERT_SERIAL_PUK = 0x11C,
    HALO_HALL_CMD_ID_SECURITY_REMOTE_SIG = 0x11D,
    HALO_HALL_CMD_ID_SECURITY_DEVICE_ECDH_PUK = 0x11E,
    HALO_HALL_CMD_ID_SECURITY_DEVICE_ECDH_SIG = 0x11F,
    HALO_HALL_CMD_ID_SECURITY_ERROR = 0x200,

    // HALO LINK METRICS class
    HALO_HALL_CMD_ID_P2P_METRICS = 0x01,
    HALO_HALL_CMD_ID_METRICS_NOTIFY_LATENCY = 0x02,
    HALO_HALL_CMD_ID_SCHED_METRICS = 0x04,
    HALO_HALL_CMD_ID_NOISE_FLOOR_METRICS = 0x05,
    HALO_HALL_CMD_ID_EP2P_METRICS = 0x08,
    HALO_HALL_CMD_ID_LDR_METRICS = 0x09,
    HALO_HALL_CMD_ID_EN_LDR_PHY_IMP1_METRICS = 0x0A,
    HALO_HALL_CMD_ID_GW_LDR_PHY_IMP_METRICS = 0x0B,
    HALO_HALL_CMD_ID_ALL_METRICS = 0x0C,

    // LOCATION
    HALO_HALL_CMD_ID_LM_CFG = 0x00,
    HALO_HALL_CMD_ID_LOCATION = 0x01,
    HALO_HALL_CMD_ID_LOC_ASSIST = 0x02,
    HALO_HALL_CMD_ID_CFG_LM = 0x03,
    HALO_HALL_CMD_ID_LOC_REC_CLEAR = 0x04,

    // GPS
    HALO_HALL_CMD_ID_GPS_STATUS = 0x00,
    HALO_HALL_CMD_ID_GPS_TEST_START = 0x02,
    HALO_HALL_CMD_ID_GPS_TEST_RESULT = 0x03,
    HALO_HALL_CMD_ID_GPS_METRICS = 0x04,

    // GEOFENCE
    HALO_HALL_CMD_ID_FENCE_CIRCULAR_CFG = 0x0,
    HALO_HALL_CMD_ID_FENCE_GET_STATE = 0x1,

    // LIGHT command class
    HALO_HALL_CMD_ID_LIGHT_TURN_ON = 0x0,
    HALO_HALL_CMD_ID_LIGHT_TURN_OFF = 0x1,
    HALO_HALL_CMD_ID_LIGHT_TIMEOUT = 0x2,
    HALO_HALL_CMD_ID_LIGHT_BRIGHTNESS_ON_MOTION = 0x3,
    HALO_HALL_CMD_ID_LIGHT_TEST_BRIGHTNESS = 0x7,

    // BUTTON command class
    HALO_HALL_CMD_ID_BUTTON_PRESS = 0x0,
    HALO_HALL_CMD_ID_BUTTON_TEST = 0x1,

    // Macros for different commands in ALERT command class
    HALO_HALL_CMD_ID_ALERT_MOTION_PIR = 0x0,
    HALO_HALL_CMD_ID_ALERT_MOTION_PIR_STOPPED = 0x1,
    HALO_HALL_CMD_ID_ALERT_LOW_BATTERY = 0x2,
    HALO_HALL_CMD_ID_ALERT_MOTION_IN_PROGRESS = 0x3,
    HALO_HALL_CMD_ID_ALERT_AMBIENT_LIGHT_CHANGE = 0x4,
    HALO_HALL_CMD_ID_ALERT_GEOFENCE = 0x5,
    HALO_HALL_CMD_ID_ALERT_DISTURBANCE = 0x7,
    HALO_HALL_CMD_ID_ALERT_MOTION_PROXIMITY = 0x8,
    HALO_HALL_CMD_ID_ALERT_LOUD_NOISE = 0x9,
    HALO_HALL_CMD_ID_ALERT_UNPLUGGED = 0xa,

    // Macros for different commands in MOTION_PIR command class
    HALO_HALL_CMD_ID_MOTION_PIR_ENABLE = 0x0,
    HALO_HALL_CMD_ID_MOTION_PIR_DISABLE = 0x1,
    HALO_HALL_CMD_ID_MOTION_PIR_SENSITIVITY = 0x2,

    // Macros for different commands in LIGHT_SENSOR command class
    HALO_HALL_CMD_ID_LIGHT_SENSOR_ENABLE = 0x00,
    HALO_HALL_CMD_ID_LIGHT_SENSOR_DISABLE = 0x01,
    HALO_HALL_CMD_ID_LIGHT_SENSOR_THRESHOLD = 0x02,

    // Macros for different commands in BEAMS_MODES command class
    HALO_HALL_CMD_ID_ON_D2D_MODE = 0x2,
    HALO_HALL_CMD_ID_OFF_D2D_MODE = 0x3,
    HALO_HALL_CMD_ID_ON_SNOOZE_MODE = 0x4,
    HALO_HALL_CMD_ID_OFF_SNOOZE_MODE = 0x5,

    // Macros for different commands in SOUND command class
    HALO_HALL_CMD_ID_SOUND_PLAY = 0x00,
    HALO_HALL_CMD_ID_SOUND_TEST = 0x01,
    HALO_HALL_CMD_ID_SOUND_ALARM = 0x02,

    // Motion Accelerator
    HALO_HALL_CMD_ID_ACCEL_SELF_TEST = 0x0,
    HALO_HALL_CMD_ID_ACCEL_TEST_RESULT = 0x1,
    HALO_HALL_CMD_ID_ACCEL_CFG = 0x02,

    // which class?
    HALO_HALL_CMD_ID_UNIT_ID_CHANGE = 0x0C,
    HALO_HALL_CMD_ID_ANNOUNCE_ID = 0x0D,
    // HALO_HALL_CMD_ID_GET_STATUS = 0x10, ?
    HALO_HALL_CMD_ID_FACTORY_RESET2 = 0x3F,

    // Alert
    HALO_HALL_CMD_ID_GEOFANCE_ALERT = 0x5,

    // Led
    HALO_HALL_CMD_ID_LED_TEST = 0x2,

    // Custom class commands
    HALO_HALL_CMD_ID_CUSTOM = 0x0,

    // Charging class commands
    HALO_HALL_CMD_ID_CHARGING_STATE = 0x0,

    // MICROPHONE
    HALO_HALL_CMD_ID_MICROPHONE = 0x0,

    // MPS
    HALO_HALL_CMD_ID_MPS = 0x0,

    // FETCH
    HALO_HALL_CMD_ID_FETCH_KA = 0x00,
    HALO_HALL_CMD_ID_FETCH_WIFI_CALIBRATION = 0x01,
    HALO_HALL_CMD_ID_FETCH_FW_VERSION = 0x02,
    HALO_HALL_CMD_ID_FETCH_START_DFU = 0x03,
    HALO_HALL_CMD_ID_FETCH_START_BLE_LOGS = 0x04,
    HALO_HALL_CMD_ID_FETCH_SMSN = 0x05,
    HALO_HALL_CMD_ID_FETCH_DSN = 0x06,
    HALO_HALL_CMD_ID_FETCH_RESET_REPORT = 0x07,

    // COVERAGE MAP
    HALO_HALL_CMD_ID_COVERAGE_MAP_CFG = 0x0,
    HALO_HALL_CMD_ID_COVERAGE_MAP_INFO = 0x1,

    // CAR BATTERY
    HALO_HALL_CMD_ID_CAR_BATTERY_CRANK_DATA = 0x00,

    // BRODY
    HALO_HALL_CMD_ID_BRODY_NOTIFY_STATUS = 0x00,
    HALO_HALL_CMD_ID_BRODY_SENSITIVITY_CFG = 0x01,

    // DEVICE
    HALO_HALL_CMD_ID_DEVICE_NOTIFY_RESET_REPORT = 0x00,

    //USER_AUTH
    HALO_HALL_CMD_ID_USER_AUTH_SYNC = 0x00,
    HALO_HALL_CMD_ID_USER_AUTH_RECOGNIZED_USER = 0x01,
    HALO_HALL_CMD_ID_USER_AUTH_UNIQUE_ID = 0x02,

    //SIDEBAND
    HALO_HALL_CMD_ID_SIDEBAND_CONTROL = 0x00,
    HALO_HALL_CMD_ID_SIDEBAND_OPEN = 0x01,
    HALO_HALL_CMD_ID_SIDEBAND_MAINTAIN = 0x02,
    HALO_HALL_CMD_ID_SIDEBAND_KEEP_ALIVE = 0x03,
    HALO_HALL_CMD_ID_SIDEBAND_LINK_STATUS = 0x05,
    HALO_HALL_CMD_ID_SIDEBAND_CLOSE = 0x06,

    // Network Diagnostic Class
    HALO_HALL_CMD_ID_START_NETWORK_TEST = 0x00,
    HALO_HALL_CMD_ID_STOP_NETWORK_TEST = 0x01,
    HALO_HALL_CMD_ID_NETWORK_TEST_RESULT = 0x02,
    HALO_HALL_CMD_ID_NETWORK_RX_EVENT = 0x03,
    HALO_HALL_CMD_ID_NETWORK_TX_EVENT = 0x04,
    HALO_HALL_CMD_ID_NETWORK_MISSED_PONG = 0x05,
} halo_all_cmd_id_v1;

// Macros for different command classes

typedef enum {
    RNET_CMD_CLASS_HALO_MGMT = 0x0,
    RNET_CMD_CLASS_ALERT = 0x1,
    RNET_CMD_CLASS_LIGHT = 0x2,
    RNET_CMD_CLASS_NETWORK_DIAG = 0x2,
    RNET_CMD_CLASS_MOTION_SENSOR_PIR = 0x3,
    RNET_CMD_CLASS_LIGHT_SENSOR = 0x4,
    RNET_CMD_CLASS_SECURITY = 0x5,
    RNET_CMD_CLASS_BATTERY = 0x6,
    RNET_CMD_CLASS_ENERGY = 0x7,
    RNET_CMD_CLASS_CUSTOM = 0x8,
    RNET_CMD_CLASS_FETCH = 0x9,
    RNET_CMD_CLASS_HALO_LOGGING = 0xA,
    RNET_CMD_CLASS_HALO_METRICS = 0xB,
    RNET_CMD_CLASS_LOCATION = 0xC,
    RNET_CMD_CLASS_GPS = 0xD,
    RNET_CMD_CLASS_GEOFENCE = 0xE,
    RNET_CMD_CLASS_CHARGING = 0xF,
    RNET_CMD_CLASS_BEAMS_MODES = 0x10,
    RNET_CMD_CLASS_BEAMS_SOUND = 0x11,
    RNET_CMD_CLASS_MOTION_ACCEL = 0x12,
    RNET_CMD_CLASS_LED = 0x13,
    RNET_CMD_CLASS_BUTTON = 0x14,
    RNET_CMD_CLASS_MPS = 0x15,
    RNET_CMD_CLASS_MICROPHONE = 0x16,
    RNET_CMD_CLASS_COVERAGE_MAP = 0x17,
    RNET_CMD_CLASS_CAR_BATTERY = 0x18,
    RNET_CMD_CLASS_BRODY = 0x19,
    RNET_CMD_CLASS_DEVICE = 0x1A,
    RNET_CMD_CLASS_USER_AUTH = 0x1B,
    RNET_CMD_CLASS_SIDEBAND = 0x5B,

    RNET_CMD_CLASS_HALO_GATEWAY = 0xFF,
} halo_all_cmd_class_v1;

// Sequence number is shared across all layers
typedef enum {
    HALO_HALL_SEQUENCE_1B_MAX = (1 << 6) - 1,
    HALO_HALL_SEQUENCE_2B_MAX = (1 << 14) - 1,
    HALO_HALL_SEQUENCE_INVALID = 0xffff
} halo_hall_sequence;

#ifdef __cplusplus
} // extern "C"
#endif

#endif /* LIB_HALL_INCLUDE_EXPORT_HALO_LIB_HALL_APPV1_APPV1_H_ */
