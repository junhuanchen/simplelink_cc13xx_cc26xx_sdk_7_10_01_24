<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flash Layout for On-Chip OAD &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
TI Wi-SUN FAN 1.0 Stack User&#39;s Guide
 2.10.00.00 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug oad-mcuboot flash-layout-on-chip-stack-library";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../wisun-guide/index.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
TI Wi-SUN FAN 1.0 Stack User's Guide

          </a>
              <div class="version">
                2.10.00.00
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/wisun-quick-start.html">Wi-SUN Stack Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/index-platform.html">SimpleLink Wireless MCU CC13xx and CC26xx Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/tirtos-index.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/freertos-index.html">FreeRTOS (RTOS Kernel) Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/wisun-index.html">TI Wi-SUN FAN Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/NWP_interface.html">TI Wi-SUN FAN NWP Interface Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/example-applications.html">Example Application Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/custom-hardware-cc13xx_cc26xx.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/memory-index.html">Memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/wisun-oad-index.html">MCUBoot Over-the-Air Download (OAD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/sysconfig-index.html">System Configuration (SysConfig)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/migration-guide.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wisun-guide/references.html#terms-and-acronyms">Terms and Acronyms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../wisun-guide/index.html">
SimpleLink™ CC13XX/CC26XX SDK
TI Wi-SUN FAN 1.0 Stack User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../wisun-guide/index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Flash Layout for On-Chip OAD</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="flash-layout-for-on-chip-oad">
<span id="sec-mcuboot-oad-flash-layout-on-chip-stack-library"></span><h1>Flash Layout for On-Chip OAD<a class="headerlink" href="#flash-layout-for-on-chip-oad" title="Permalink to this headline">¶</a></h1>
<p>This section will describe the method for placing images in internal
flash when using on-chip OAD.</p>
<div class="section" id="constraints-and-requirements-for-on-chip-oad-stack-library">
<h2>Constraints and Requirements for On-chip OAD (stack library)<a class="headerlink" href="#constraints-and-requirements-for-on-chip-oad-stack-library" title="Permalink to this headline">¶</a></h2>
<p>The following points must be considered for On-chip OAD applications:</p>
<blockquote>
<div><ul class="simple">
<li><p>The user application must be sufficiently small in order to fit into the
flash layout system described below</p></li>
<li><p>User app functionality is lost while performing OAD (Persistent app is
running)</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="internal-flash-memory-layout">
<span id="sect-mcuboot-on-chip-memory-layout-stack-library"></span><h2>Internal Flash Memory Layout<a class="headerlink" href="#internal-flash-memory-layout" title="Permalink to this headline">¶</a></h2>
<p>The internal flash of the device contains the active user application, the user
application’s stack, the persistent application, the persistent application’s
stack, and the secure bootloader. Each application’s role is defined below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As we have assumed the stack-library approach, the stack images
referenced below are a part of each application image (i.e. the user and
persistent apps have their own dedicated stack)</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 74%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Application Name</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p>MCUBoot bootloader</p></td>
<td><ul class="simple">
<li><p>Search for the proper image in FLASH</p></li>
<li><p>Ensure validity and security of image before running</p></li>
<li><p>Jump to the valid and newest image</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Persistent application</p></td>
<td><ul class="simple">
<li><p>Providing lightweight application that implements the OAD profile</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Stack (2)</p></td>
<td><ul class="simple">
<li><p>BLE protocol stack implementation</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>User application</p></td>
<td><ul class="simple">
<li><p>User application</p></li>
<li><p>Must implement OAD reset service</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<img alt="../_images/ditaa-ed6b437ffe94a2e852f39b552d4bda23728f3702.png" id="fig-mcuboot-on-chip-oad-target-memory-partition" src="../_images/ditaa-ed6b437ffe94a2e852f39b552d4bda23728f3702.png" />
<p>The user application pictured above is responsible for the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>Implementing the protocol stack definition of the OAD reset service</p></li>
<li><p>Implementing customer defined behavior</p></li>
</ul>
</div></blockquote>
<p>The persistent application pictured above is responsible for the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>Implementing the protocol stack definition of the OAD service</p></li>
<li><p>It is permanently resident on the device</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Based on different devices, the address of each component listed above might
vary. The address used in the persistent application linker file
should match the settings in the <code class="docutils literal notranslate"><span class="pre">flash_map_backend.h</span></code> file.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Flash addresses for various components</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define MCUBOOT_BASE    0x0000000</span>
<span class="cp">#define PERSISTENT_BASE 0x0006000</span>
<span class="cp">#define APP_BASE        0x0030000</span>
<span class="cp">#define NVS_BASE        (FLASH_SIZE - NVS_SIZE)</span>
<span class="cp">#define NVS_SIZE        0x4000</span>
<span class="cp">#define MCU_HDR_SIZE    0x100</span>
<span class="cp">#define MCUBOOT_SIZE    0x6000</span>
<span class="cp">#define MCU_OVERHEADS   (MCU_HDR_SIZE + MCU_TLV_SIZE)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>