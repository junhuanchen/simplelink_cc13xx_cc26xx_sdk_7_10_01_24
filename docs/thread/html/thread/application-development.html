<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Application Development &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
Thread User&#39;s Guide
 1.10.00.00 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example Applications" href="example-apps-cc13xx_cc26xx.html" />
    <link rel="prev" title="TI-OpenThread Overview" href="ti-openthread-overview.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug thread application-development";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../thread-guide/index-cc13xx_cc26xx.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
Thread User's Guide

          </a>
              <div class="version">
                1.10.00.00
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/quickstart-intro-cc13xx_cc26xx.html">Introduction to the SimpleLink CC13xx/CC26xx SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="ti-openthread-intro.html">TI-OpenThread Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/index-platform.html">SimpleLink Wireless MCU CC13xx and CC26xx Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/tirtos-index.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../thread-guide/software-development-index.html">Developing Thread Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ti-openthread-overview.html">TI-OpenThread Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Application Development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sec-tiop-ide-toolchains">IDEs and Toolchains</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-and-run-examples">Build and Run Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#openthread-api-mutex">OpenThread API Mutex</a></li>
<li class="toctree-l3"><a class="reference internal" href="#openthread-configuration">OpenThread Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#low-power-operation">Low-Power Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fcc-testing-functionality">FCC Testing Functionality</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#test-of-continuous-transmission">Test of Continuous Transmission</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-of-continuous-reception">Test of Continuous Reception</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-of-continuous-tone">Test of Continuous Tone</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="example-apps-cc13xx_cc26xx.html">Example Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="ncp-interface.html">NCP Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="product-certification.html">Thread Product Certification</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="thread-protocol.html">Thread Networking Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/custom-hardware-cc13xx_cc26xx.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/packet-sniffer-index.html">Packet Sniffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/border-router-index.html">Linux Border Router Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/oad-index.html">Over-the-Air Download (OAD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/sysconfig-index.html">System Configuration (SysConfig)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/memory-index.html">Memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/migration-index.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Terms and Definitions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../thread-guide/index-cc13xx_cc26xx.html">
SimpleLink™ CC13XX/CC26XX SDK
Thread User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../thread-guide/index-cc13xx_cc26xx.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../thread-guide/software-development-index.html">Developing Thread Applications</a> &raquo;</li>
      <li>Application Development</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="application-development">
<span id="sec-tiop-app-devel"></span><h1>Application Development<a class="headerlink" href="#application-development" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference external" href="http://www.ti.com/tool/simplelink-cc13xx-cc26xx-sdk">SimpleLink CC13xx/CC26xx SDK</a> for TI-OpenThread is intended to be developed with one of the
following development boards:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.ti.com/tool/LAUNCHXL-CC1352R1">CC1352R LaunchPad</a></p></li>
<li><p><a class="reference external" href="https://www.ti.com/tool/LAUNCHXL-CC1352P">CC1352P-2 LaunchPad</a></p></li>
<li><p><a class="reference external" href="https://www.ti.com/tool/LAUNCHXL-CC26x2R1">CC26x2R LaunchPad</a></p></li>
<li><p><a class="reference external" href="https://www.ti.com/tool/LP-CC2652R7">CC2652R7 LaunchPad</a></p></li>
</ul>
<p>The SDK provides the source code of the OpenThread stack, found in the
<code class="docutils literal notranslate"><span class="pre">source/third_party/openthread/</span></code> folder under the SDK installation
directory. The SDK does not provide any pre-compiled libraries for OpenThread.</p>
<div class="section" id="sec-tiop-ide-toolchains">
<span id="ides-and-toolchains"></span><h2>IDEs and Toolchains<a class="headerlink" href="#sec-tiop-ide-toolchains" title="Permalink to this headline">¶</a></h2>
<p>All TI-OpenThread examples can be built with the following IDEs and toolchains:</p>
<ul class="simple">
<li><p>Code Composer Studio, built with <a class="reference internal" href="glossary.html#term-TI-CLANG"><span class="xref std std-term">TI-CLANG</span></a></p></li>
<li><p>Code Composer Studio, built with <a class="reference internal" href="glossary.html#term-GCC"><span class="xref std std-term">GCC</span></a></p></li>
<li><p><a class="reference internal" href="glossary.html#term-IAR"><span class="xref std std-term">IAR Embedded Workbench</span></a></p></li>
</ul>
<p>When importing TI-OpenThread examples in <a class="reference external" href="http://www.ti.com/tool/ccstudio">Code Composer Studio</a> (CCS) there
are two variants for each example: one for the TI-CLANG Compiler with the
<code class="docutils literal notranslate"><span class="pre">ticlang</span></code> suffix, and one for the GCC toolchain with the <code class="docutils literal notranslate"><span class="pre">gcc</span></code> suffix.</p>
</div>
<div class="section" id="build-and-run-examples">
<span id="sec-tiop-building-examples"></span><h2>Build and Run Examples<a class="headerlink" href="#build-and-run-examples" title="Permalink to this headline">¶</a></h2>
<p>Building TI-OpenThread examples in <a class="reference internal" href="glossary.html#term-TI-CLANG"><span class="xref std std-term">TI-CLANG</span></a> is as simple as importing the
example into the IDE and start building. Either navigate in Resource Explorer
to the example in question and import as usual, or manually import the example
from the installed SDK.</p>
<p>When the example is imported, you will see multiple projects are imported in
addition to the example project. These are the OpenThread and mbed TLS
libraries which are compiled alongside with the example.</p>
<p>To start building, right click the example project in the Project Explorer
view and click Build Project. The first build will take some time compared to
subsequent builds, as the TI-RTOS7 Kernel, the OpenThread stack, and the mbed
TLS are compiled for the first time.</p>
<p>When the build finishes, start a debug session by clicking the Debug symbol or
<code class="docutils literal notranslate"><span class="pre">Run</span></code> → <code class="docutils literal notranslate"><span class="pre">Debug</span></code>. The device is programmed with the compiled example
application and the debug session halts at <code class="docutils literal notranslate"><span class="pre">main()</span></code>.</p>
</div>
<div class="section" id="openthread-api-mutex">
<span id="sec-tiop-api-mutex"></span><h2>OpenThread API Mutex<a class="headerlink" href="#openthread-api-mutex" title="Permalink to this headline">¶</a></h2>
<p>As described in <a class="reference internal" href="ti-openthread-overview.html#sec-tiop-app-arch"><span class="std std-ref">Application Architecture</span></a>, an API mutex is employed by
TI-OpenThread when accessing the OpenThread API. This was to ensure coherent
access to the OpenThread APIs by both the user application tasks and the
OpenThread stack task.</p>
<p>The API mutex is available in the <code class="docutils literal notranslate"><span class="pre">OtRtosApi</span></code> module, found under the
<code class="docutils literal notranslate"><span class="pre">otsupport/</span></code> folder in the example project. The <code class="docutils literal notranslate"><span class="pre">OtRtosApi</span></code> module is
initialized by the OpenThread stack task.</p>
<p>The underlying implementation of the API mutex uses <code class="docutils literal notranslate"><span class="pre">pthread_mutex_t</span></code>. For
more information, see <a class="reference external" href="../../../tiposix/Users_Guide.html">TI-POSIX User’s Guide</a>.</p>
<p>Usage of the <code class="docutils literal notranslate"><span class="pre">OtRtosApi</span></code> module is straightforward: any task that wants to
access the OpenThread API must first lock the mutex, access one or more
OpenThread APIs, and finally unlock the mutex.</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-number">Listing 18. </span><span class="caption-text">OpenThread API mutex usage.</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;otsupport/otrtosapi.h&gt;</span><span class="cp"></span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4</span><span class="p">{</span><span class="w"></span>
<span class="linenos">5</span><span class="w">    </span><span class="n">OtRtosApi_lock</span><span class="p">();</span><span class="w"></span>
<span class="linenos">6</span><span class="w">    </span><span class="cm">/* Access one or more OpenThread APIs */</span><span class="w"></span>
<span class="linenos">7</span><span class="w">    </span><span class="n">OtRtosApi_unlock</span><span class="p">();</span><span class="w"></span>
<span class="linenos">8</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be aware that if a task fails to unlock the API mutex after locking it,
any other tasks trying to access the API mutex will result in a deadlock.
In other words, tasks trying to lock the API mutex will never return.</p>
</div>
</div>
<div class="section" id="openthread-configuration">
<span id="sec-tiop-config"></span><h2>OpenThread Configuration<a class="headerlink" href="#openthread-configuration" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Application-level configuration with SysConfig is supported for
TI-OpenThread. See Section <a class="reference internal" href="../sysconfig/thread-config.html#sec-sysconfig-tiop"><span class="std std-ref">TI-OpenThread SysConfig</span></a> for more information.</p>
</div>
<p>The OpenThread stack comes pre-configured with TI-OpenThread, with default
settings provided for the following device configurations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="thread-protocol.html#sec-thread-protocol-device-roles"><span class="std std-ref">MTD</span></a> – configuration files located in library <code class="docutils literal notranslate"><span class="pre">libopenthread_mtd_&lt;platform&gt;</span></code></p></li>
<li><p><a class="reference internal" href="thread-protocol.html#sec-thread-protocol-device-roles"><span class="std std-ref">FTD</span></a> – configuration files located in library <code class="docutils literal notranslate"><span class="pre">libopenthread_ftd_&lt;platform&gt;</span></code></p></li>
<li><p><a class="reference internal" href="thread-protocol.html#sec-thread-protocol-device-roles"><span class="std std-ref">NCP</span></a> – configuration files located in library <code class="docutils literal notranslate"><span class="pre">libopenthread_ncp_&lt;platform&gt;</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">&lt;platform&gt;</span></code> denotes in this context the device family and the toolchain. E.g.
a MTD for <a class="reference external" href="https://www.ti.com/tool/LAUNCHXL-CC26x2R1">CC26x2R LaunchPad</a> on CCS would have the name
<code class="docutils literal notranslate"><span class="pre">libopenthread_mtd_cc13x2_26x2_ticlang</span></code>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Be aware that these device configuration libraries are shared among
projects with the same device configuration. Therefore, a change in
the OpenThread configuration in one of the libraries will affect all other
projects with the same device configuration.</p>
<p>TI recommends to keep separate CCS workspaces for multiple configurations
of the OpenThread stack.</p>
</div>
<p>OpenThread is configured by a set of various compile-time configuration
constants in the form of preprocessor macro defines. These macro defines can
be overridden or changed for different functionality and behavior.
Configuration consists of a core configuration and a device configuration. The
core configuration is used by the OpenThread stack, while the device
configuration is used by the project and the TI-OpenThread platform.</p>
<p>The device configuration is used to enable and disable functionalities of the
OpenThread stack, such as <a class="reference internal" href="glossary.html#term-CoAP"><span class="xref std std-term">CoAP</span></a>, <a class="reference internal" href="glossary.html#term-DHCPv6"><span class="xref std std-term">DHCPv6</span></a>, and more. For an
exhaustive list, consult the device configuration file. Enable or disable each
functionality by directly modifying the device configuration file.</p>
<p>Available configuration options are detailed at the following locations in the
imported device configuration library:</p>
<ul class="simple">
<li><p><strong>Core configuration</strong> – found under <code class="docutils literal notranslate"><span class="pre">src/core/openthread-core-default-config.h</span></code></p></li>
<li><p><strong>Device configuration</strong> – found under <code class="docutils literal notranslate"><span class="pre">config/openthread-config-&lt;platform&gt;.h</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">&lt;platform&gt;</span></code> denotes in this context the device family, toolchain and device
configuration. E.g. the configuration file for a MTD for CC2652 on CCS is
<code class="docutils literal notranslate"><span class="pre">config/openthread-config-cc13x2_26x2-ccs-mtd.h</span></code>.</p>
</div>
<div class="section" id="low-power-operation">
<span id="sec-tiop-low-power"></span><h2>Low-Power Operation<a class="headerlink" href="#low-power-operation" title="Permalink to this headline">¶</a></h2>
<p>Thread provides support for low-power devices by defining a device type called
Sleepy End Device (<a class="reference internal" href="thread-protocol.html#sec-thread-protocol-device-roles"><span class="std std-ref">SED</span></a>). A SED is a <a class="reference internal" href="thread-protocol.html#sec-thread-protocol-device-roles"><span class="std std-ref">MTD</span></a> which has the ability to disable
the transceiver when idle, which allows for battery-constrained devices to
operate in a Thread network.</p>
<p>By default in OpenThread, a MTD is configured as a <a class="reference internal" href="thread-protocol.html#sec-thread-protocol-device-roles"><span class="std std-ref">MED</span></a>. In order to
configure a MTD to be a SED the <em>rx-on-when-idle</em> value in the Thread device
mode must be unset. Additionally, the data poll period can be configured, but
is not required.</p>
<p>The Thread device mode is configured in OpenThread as follows:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-number">Listing 19. </span><span class="caption-text">Sleepy End Device configuration in OpenThread.</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;openthread/error.h&gt;</span><span class="cp"></span>
<span class="linenos"> 2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;openthread/instance.h&gt;</span><span class="cp"></span>
<span class="linenos"> 3</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;openthread/link.h&gt;</span><span class="cp"></span>
<span class="linenos"> 4</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;openthread/thread.h&gt;</span><span class="cp"></span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="kt">void</span><span class="w"> </span><span class="nf">configureSleepyEndDevice</span><span class="p">(</span><span class="n">otInstance</span><span class="w"> </span><span class="o">*</span><span class="n">aInstance</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">aPollPeriod</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 7</span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 8</span><span class="w">    </span><span class="n">otLinkModeConfig</span><span class="w"> </span><span class="n">linkMode</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 9</span><span class="w">    </span><span class="n">otError</span><span class="w"> </span><span class="n">error</span><span class="p">;</span><span class="w"></span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="w">    </span><span class="cm">/* Set Thread device mode for SED */</span><span class="w"></span>
<span class="linenos">12</span><span class="w">    </span><span class="n">linkMode</span><span class="p">.</span><span class="n">mRxOnWhenIdle</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Must be set to 0 for SED */</span><span class="w"></span>
<span class="linenos">13</span><span class="w">    </span><span class="n">linkMode</span><span class="p">.</span><span class="n">mSecureDataRequests</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Must be set to 1 */</span><span class="w"></span>
<span class="linenos">14</span><span class="w">    </span><span class="n">linkMode</span><span class="p">.</span><span class="n">mDeviceType</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Must be set to 0 for MTD */</span><span class="w"></span>
<span class="linenos">15</span><span class="w">    </span><span class="n">linkMode</span><span class="p">.</span><span class="n">mNetworkData</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Can be either 0 or 1 */</span><span class="w"></span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="w">    </span><span class="cm">/* Update Thread device mode and data poll period.</span>
<span class="linenos">18</span><span class="cm">     * Any appropriate error checking should be done.</span>
<span class="linenos">19</span><span class="cm">     */</span><span class="w"></span>
<span class="linenos">20</span><span class="w">    </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">otThreadSetLinkMode</span><span class="p">(</span><span class="n">aInstance</span><span class="p">,</span><span class="w"> </span><span class="n">linkMode</span><span class="p">);</span><span class="w"></span>
<span class="linenos">21</span><span class="w">    </span><span class="n">otLinkSetPollPeriod</span><span class="p">(</span><span class="n">aInstance</span><span class="p">,</span><span class="w"> </span><span class="n">aPollPeriod</span><span class="p">);</span><span class="w"></span>
<span class="linenos">22</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="fcc-testing-functionality">
<span id="sec-fcc-testing-functionality"></span><h2>FCC Testing Functionality<a class="headerlink" href="#fcc-testing-functionality" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="glossary.html#term-FCC"><span class="xref std std-term">FCC</span></a> and other similar RF regulatory bodies often require certain
certifications to be fulfilled before a product is brought to market, even
though the Thread protocol makes no such requirements. Therefore, it is
desirable to have FCC testing functionality available in a Thread example
project.</p>
<p>The <em>diag</em> (diagnostic) module in OpenThread provides a set of commands to
manipulate the radio from within the OpenThread environment. The <em>diag</em> module
is accesible from the OpenThread CLI application.</p>
<p>Mainly two FCC testing functionalities are supported: <a class="reference internal" href="glossary.html#term-PER"><span class="xref std std-term">PER</span></a> test
functionality with <a class="reference external" href="http://www.ti.com/tool/smartrftm-studio">SmartRF Studio</a> compatibility, and test of continuous
tone. The result of a PER test is calculated in the same fashion as SmartRF
Studio, shown in equation <a class="reference internal" href="#equation-smartrf-studio-per">(1)</a>.</p>
<div class="math" id="equation-smartrf-studio-per">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-smartrf-studio-per" title="Permalink to this equation">¶</a></span><img src="../_images/math/ae657e3f5b3ad2115d0b66b75da8d1c923c652aa.svg" alt="\text{Error Count} &amp;= \text{CRC Error Count} + \text{Lost Packet Count}

\text{Packet Error Rate}[\%] &amp;= \frac{\text{Error Count}}{\text{Packet Count} + \text{Error Count}} \times 100"/></p>
</div><div class="section" id="test-of-continuous-transmission">
<span id="subsec-fcc-continuous-transmission"></span><h3>Test of Continuous Transmission<a class="headerlink" href="#test-of-continuous-transmission" title="Permalink to this headline">¶</a></h3>
<p>The API for starting and stopping a continuous transmission is on the
following format:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">diag</span><span class="w"> </span><span class="n">transmit</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">&lt;</span><span class="n">packet</span><span class="w"> </span><span class="n">size</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">interframe</span><span class="w"> </span><span class="n">space</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">transmit</span><span class="w"> </span><span class="n">count</span><span class="o">&gt;</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">transmit</span><span class="w"> </span><span class="n">stop</span><span class="w"></span>
</pre></div>
</div>
<p><em>Packet size</em> specifies the payload of the packet in bytes, the <em>interframe
space</em> specifies time beween each packet in milliseconds, and <em>transmit count</em>
specifies the number of packets to send.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to receive and observe the transmitted packets, you can use an
IEEE 802.15.4-capable LaunchPad with <a class="reference external" href="http://www.ti.com/tool/smartrftm-studio">SmartRF Studio</a>, configuring the
device to the same channel in Packet RX mode expecting infinite packets.
This is optional.</p>
</div>
<p>To start a test of continuous transmission with your Thread device, do the
following:</p>
<ol class="arabic">
<li><p>Build and flash the <em>cli_ftd</em> example application.</p></li>
<li><p>Input the following commands in the UART CLI.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">diag</span><span class="w"> </span><span class="n">start</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">transmit</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="mi">500</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>(Optional) Observe the packets in <a class="reference external" href="http://www.ti.com/tool/smartrftm-studio">SmartRF Studio</a>.</p></li>
<li><p>Stop the transmission with the commands in the UART CLI.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">diag</span><span class="w"> </span><span class="n">transmit</span><span class="w"> </span><span class="n">stop</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">stop</span><span class="w"></span>
</pre></div>
</div>
</li>
</ol>
<p>After stopping the transmission, a test report is displayed with statistics
over how many packets were transmitted.</p>
<p>For channels near the band edge (such as channel 25 and 26), it may be necessary
to lower the maximum output power to pass FCC certification tests. As this is
dependent on the hardware design, refer to the following code to set the
appropriate power limit for your design.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Array of back-off values necessary for passing FCC testing.</span>
<span class="cm"> */</span><span class="w"></span>
<span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span> <span class="nc">tx_power_max</span><span class="w"> </span><span class="n">cTxMaxPower</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">channel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">26</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">maxPower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="cm">/* back-off for 25 deg C, 3.3V */</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">channel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">maxPower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">19</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="cm">/* back-off for 25 deg C, 3.3V */</span><span class="w"></span>
<span class="p">};</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="test-of-continuous-reception">
<span id="subsec-fcc-continuous-reception"></span><h3>Test of Continuous Reception<a class="headerlink" href="#test-of-continuous-reception" title="Permalink to this headline">¶</a></h3>
<p>The API for starting and stopping a continuous transmission is one the
following format:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">diag</span><span class="w"> </span><span class="n">receive</span><span class="w"> </span><span class="n">start</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">receive</span><span class="w"> </span><span class="n">stop</span><span class="w"></span>
</pre></div>
</div>
<p>No additional parameters are required. Stopping the continuous reception will
present a <a class="reference internal" href="glossary.html#term-PER"><span class="xref std std-term">PER</span></a> report of packets received.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is required to have a device sending out a continuous transmission on
the same channel, while the continuous reception test is running to have
any meaningful results. Either setup <a class="reference external" href="http://www.ti.com/tool/smartrftm-studio">SmartRF Studio</a> with an IEEE
802.15.4-capable LaunchPad in Packet TX mode on the same channel sending
infinite packets, or see <a class="reference internal" href="#subsec-fcc-continuous-transmission"><span class="std std-ref">Test of Continuous Transmission</span></a>.</p>
</div>
<p>To start a test of continuous reception with your Thread device, do the
following:</p>
<ol class="arabic">
<li><p>Build and flash the <em>cli_ftd</em> example application.</p></li>
<li><p>Input the following cmmands in the UART CLI.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">diag</span><span class="w"> </span><span class="n">start</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">receive</span><span class="w"> </span><span class="n">start</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>Start packet transmissions from your other device.</p></li>
<li><p>When satisfied, stop packet transmissions.</p></li>
<li><p>Stop the transmission with the commands in the UART CLI, observing the report.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">diag</span><span class="w"> </span><span class="n">receive</span><span class="w"> </span><span class="n">stop</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">stop</span><span class="w"></span>
</pre></div>
</div>
</li>
</ol>
<p>After stopping the reception, a test report is displayed with statistics over
received packets, including <a class="reference internal" href="glossary.html#term-PER"><span class="xref std std-term">PER</span></a>.</p>
</div>
<div class="section" id="test-of-continuous-tone">
<span id="subsec-fcc-continuous-ton"></span><h3>Test of Continuous Tone<a class="headerlink" href="#test-of-continuous-tone" title="Permalink to this headline">¶</a></h3>
<p>The API for starting and stopping a continuous tone is one the following
format:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">diag</span><span class="w"> </span><span class="n">tone</span><span class="w"> </span><span class="n">start</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">tone</span><span class="w"> </span><span class="n">stop</span><span class="w"></span>
</pre></div>
</div>
<p>No additional parameters are required. To observe the continuous tone, setup a
Spectrum Analyzer near the DUT; or, setup <a class="reference external" href="http://www.ti.com/tool/smartrftm-studio">SmartRF Studio</a> in Continuous RX
mode on the same channel.</p>
<p>To start a test of continuous tone with your Thread device, do the following:</p>
<ol class="arabic">
<li><p>Build and flash the <em>cli_ftd</em> example application.</p></li>
<li><p>Input the following cmmands in the UART CLI.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">diag</span><span class="w"> </span><span class="n">start</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="mi">12</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">tone</span><span class="w"> </span><span class="n">start</span><span class="w"></span>
</pre></div>
</div>
</li>
<li><p>Observe the transmission over the air with the Spectrum Analizer or <a class="reference external" href="http://www.ti.com/tool/smartrftm-studio">SmartRF Studio</a>.</p></li>
<li><p>Stop the transmission with the commands in the UART CLI, observing the report.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">diag</span><span class="w"> </span><span class="n">tone</span><span class="w"> </span><span class="n">stop</span><span class="w"></span>
<span class="n">diag</span><span class="w"> </span><span class="n">stop</span><span class="w"></span>
</pre></div>
</div>
</li>
</ol>
<p>No test report is displayed after stopping the tone.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ti-openthread-overview.html" class="btn btn-neutral float-left" title="TI-OpenThread Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="example-apps-cc13xx_cc26xx.html" class="btn btn-neutral float-right" title="Example Applications" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>