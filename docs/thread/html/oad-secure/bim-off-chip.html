<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BIM for Off-Chip OAD &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
Thread User&#39;s Guide
 1.10.00.00 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="OAD Image Header" href="image-header.html" />
    <link rel="prev" title="Boot Image Manager (BIM)" href="bim.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug oad-secure bim-off-chip";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../thread-guide/index-cc13xx_cc26xx.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
Thread User's Guide

          </a>
              <div class="version">
                1.10.00.00
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/quickstart-intro-cc13xx_cc26xx.html">Introduction to the SimpleLink CC13xx/CC26xx SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/ti-openthread-intro.html">TI-OpenThread Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/index-platform.html">SimpleLink Wireless MCU CC13xx and CC26xx Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/tirtos-index.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/software-development-index.html">Developing Thread Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/thread-protocol.html">Thread Networking Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/custom-hardware-cc13xx_cc26xx.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/packet-sniffer-index.html">Packet Sniffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/border-router-index.html">Linux Border Router Quick Start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../thread-guide/oad-index.html">Over-the-Air Download (OAD)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="oad-types.html">OAD Storage &amp; Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="bim.html">Boot Image Manager (BIM)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">BIM for Off-Chip OAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="image-header.html">OAD Image Header</a></li>
<li class="toctree-l2"><a class="reference internal" href="ext-flash-image-header.html">OAD External Flash Image Header</a></li>
<li class="toctree-l2"><a class="reference internal" href="flash-layout-off-chip.html">Flash Layout for Off-Chip OAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">OAD Image Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thread-oad/native-oad.html">TI-OpenThread Native OAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thread-oad/non-native-oad.html">Non-native OAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="../thread-oad/create-tiop-oad-image.html">Create a TI-OpenThread OAD Image</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/sysconfig-index.html">System Configuration (SysConfig)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/memory-index.html">Memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread-guide/migration-index.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thread/glossary.html">Terms and Definitions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../thread-guide/index-cc13xx_cc26xx.html">
SimpleLink™ CC13XX/CC26XX SDK
Thread User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../thread-guide/index-cc13xx_cc26xx.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../thread-guide/oad-index.html">Over-the-Air Download (OAD)</a> &raquo;</li>
      <li>BIM for Off-Chip OAD</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="bim-for-off-chip-oad">
<span id="sec-oad-bim-off-chip"></span><h1>BIM for Off-Chip OAD<a class="headerlink" href="#bim-for-off-chip-oad" title="Permalink to this headline">¶</a></h1>
<p>This section describes the behavior of the <a class="reference internal" href="../thread/glossary.html#term-BIM"><span class="xref std std-term">BIM</span></a> for off-chip OAD. This
approach requires an external flash to be connected to the device. As with
on-chip OAD, it is BIM’s responsibility to locate which image should be run.</p>
<p>At steady state, the normal case is that a valid image exists in internal flash
and no image in the external flash has been marked as needing to be copied. In
this case, BIM will validate that the image on internal flash and execute it
by loading the stack pointer and jumping to the image’s reset vector location.
BIM determines the location of the reset vector and stack pointer of the image
through the OAD image header attached to it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The execution flow below is assuming security is on. If using an unsecured
BIM configuration, the process is the same with the exception that there
is no check for security.</p>
</div>
<p>The following flowchart describes the process by which the BIM selects an
image.</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../_images/bim_sequence_diagram_offchip.png"><img alt="../_images/bim_sequence_diagram_offchip.png" src="../_images/bim_sequence_diagram_offchip.png" style="width: 893.0px; height: 917.0px;" /></a>
<p class="caption"><span class="caption-number">Figure 64. </span><span class="caption-text">Functional Overview of Off-chip BIM</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>The image above is illustrated in words below. In order to determine which
image is best to run, BIM takes the following measures:</p>
<ol class="arabic">
<li><p>At startup, BIM looks for a valid image header in external flash by reading
the first 8 bytes to find the valid External Flash Image Identification
value.</p></li>
<li><p>After a valid header is found, it reads the entire header from ext flash
and verifies the compatibility of BIM and image header versions. Then it
checks if the ‘Image copy status’ is set to be copied to the on-chip
flash(0xFE) and has a valid CRC (CRC status=0xFE).</p>
<blockquote>
<div><ul class="simple">
<li><p>If a compatible header is found, secure versions of the BIM will check
the signature of the image using ECDSA verification algorithm.</p></li>
<li><p>If the CRC flag is not valid (CRC status != 0xFE) then it is rejected.</p></li>
<li><p>On finding the invalid CRC it moves on to read the next image’s header.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>If a valid image is found, BIM copies the image to on-chip flash, as per
the image copy procedure.</p>
<blockquote>
<div><ul class="simple">
<li><p>After the copy, the CRC is calculated and signature is validated again
on the internal flash to ensure the copy succeeded.</p></li>
<li><p>If the copy failed the status byte is updated and the BIM will continue
searching external flash.</p></li>
<li><p>If the copy succeeded, then the BIM will verify the image again and if
successful jump directly to the application image, and the search
process ends.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>If BIM reaches the end of the image header region in external flash without
finding a valid image, then it will try to find an on-chip image and
execute it.</p></li>
<li><p>If BIM fails to find a valid image internal flash, it will attempt to
revert the factory image if there is one present.</p></li>
<li><p>BIM will put the device to low power mode if it fails to find a valid
application image.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An image is considered bad/invalid if it’s calculated CRC32 does not match
the image’s CRC bytes embedded in the image header.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bim.html" class="btn btn-neutral float-left" title="Boot Image Manager (BIM)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="image-header.html" class="btn btn-neutral float-right" title="OAD Image Header" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>