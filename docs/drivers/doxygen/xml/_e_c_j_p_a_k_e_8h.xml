<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.12">
  <compounddef id="_e_c_j_p_a_k_e_8h" kind="file" language="C++">
    <compoundname>ECJPAKE.h</compoundname>
    <includes local="no">stdbool.h</includes>
    <includes local="no">stddef.h</includes>
    <includes local="no">stdint.h</includes>
    <includes refid="_crypto_key_8h" local="no">ti/drivers/cryptoutils/cryptokey/CryptoKey.h</includes>
    <includes refid="_e_c_c_params_8h" local="no">ti/drivers/cryptoutils/ecc/ECCParams.h</includes>
    <includedby refid="_e_c_j_p_a_k_e_c_c26_x2_8h" local="no">ECJPAKECC26X2.h</includedby>
    <incdepgraph>
      <node id="846">
        <label>stdbool.h</label>
      </node>
      <node id="848">
        <label>stdint.h</label>
      </node>
      <node id="849">
        <label>ti/drivers/cryptoutils/cryptokey/CryptoKey.h</label>
        <link refid="_crypto_key_8h"/>
        <childnode refid="848" relation="include">
        </childnode>
        <childnode refid="846" relation="include">
        </childnode>
      </node>
      <node id="847">
        <label>stddef.h</label>
      </node>
      <node id="850">
        <label>ti/drivers/cryptoutils/ecc/ECCParams.h</label>
        <link refid="_e_c_c_params_8h"/>
        <childnode refid="848" relation="include">
        </childnode>
        <childnode refid="847" relation="include">
        </childnode>
        <childnode refid="846" relation="include">
        </childnode>
        <childnode refid="849" relation="include">
        </childnode>
        <childnode refid="851" relation="include">
        </childnode>
      </node>
      <node id="845">
        <label>ECJPAKE.h</label>
        <link refid="_e_c_j_p_a_k_e_8h"/>
        <childnode refid="846" relation="include">
        </childnode>
        <childnode refid="847" relation="include">
        </childnode>
        <childnode refid="848" relation="include">
        </childnode>
        <childnode refid="849" relation="include">
        </childnode>
        <childnode refid="850" relation="include">
        </childnode>
      </node>
      <node id="851">
        <label>ti/devices/DeviceFamily.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="852">
        <label>ECJPAKE.h</label>
        <link refid="_e_c_j_p_a_k_e_8h"/>
        <childnode refid="853" relation="include">
        </childnode>
      </node>
      <node id="853">
        <label>ECJPAKECC26X2.h</label>
        <link refid="_e_c_j_p_a_k_e_c_c26_x2_8h"/>
      </node>
    </invincdepgraph>
    <innerclass refid="struct_e_c_j_p_a_k_e___config" prot="public">ECJPAKE_Config</innerclass>
    <innerclass refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys" prot="public">ECJPAKE_OperationRoundOneGenerateKeys</innerclass>
    <innerclass refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p" prot="public">ECJPAKE_OperationGenerateZKP</innerclass>
    <innerclass refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p" prot="public">ECJPAKE_OperationVerifyZKP</innerclass>
    <innerclass refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys" prot="public">ECJPAKE_OperationRoundTwoGenerateKeys</innerclass>
    <innerclass refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret" prot="public">ECJPAKE_OperationComputeSharedSecret</innerclass>
    <innerclass refid="union_e_c_j_p_a_k_e___operation" prot="public">ECJPAKE_Operation</innerclass>
    <innerclass refid="struct_e_c_j_p_a_k_e___params" prot="public">ECJPAKE_Params</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1a312c0c75c7b47e0d5e8493ca4cb98683" prot="public" static="no">
        <name>ECJPAKE_STATUS_RESERVED</name>
        <initializer>(-32)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Common ECJPAKE status code reservation offset. ECJPAKE driver implementations should offset status codes with ECJPAKE_STATUS_RESERVED growing negatively.</para><para>Example implementation specific status codes: <programlisting><codeline><highlight class="normal">#define<sp/>ECJPAKEXYZ_STATUS_ERROR0<sp/><sp/><sp/><sp/>ECJPAKE_STATUS_RESERVED<sp/>-<sp/>0</highlight></codeline>
<codeline><highlight class="normal">#define<sp/>ECJPAKEXYZ_STATUS_ERROR1<sp/><sp/><sp/><sp/>ECJPAKE_STATUS_RESERVED<sp/>-<sp/>1</highlight></codeline>
<codeline><highlight class="normal">#define<sp/>ECJPAKEXYZ_STATUS_ERROR2<sp/><sp/><sp/><sp/>ECJPAKE_STATUS_RESERVED<sp/>-<sp/>2</highlight></codeline>
</programlisting> </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="678" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="678" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1a1e2fe3a0d3efd4d6505552b732402a35" prot="public" static="no">
        <name>ECJPAKE_STATUS_SUCCESS</name>
        <initializer>(0)</initializer>
        <briefdescription>
<para>Successful status code. </para>        </briefdescription>
        <detaileddescription>
<para>Functions return ECJPAKE_STATUS_SUCCESS if the function was executed successfully. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="686" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="686" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1a3173a5ec592e345c4dc58e9fbbde2825" prot="public" static="no">
        <name>ECJPAKE_STATUS_ERROR</name>
        <initializer>(-1)</initializer>
        <briefdescription>
<para>Generic error status code. </para>        </briefdescription>
        <detaileddescription>
<para>Functions return ECJPAKE_STATUS_ERROR if the function was not executed successfully. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="694" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="694" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1a668d9bd2a4926c046f40ee6698892362" prot="public" static="no">
        <name>ECJPAKE_STATUS_RESOURCE_UNAVAILABLE</name>
        <initializer>(-2)</initializer>
        <briefdescription>
<para>An error status code returned if the hardware or software resource is currently unavailable. </para>        </briefdescription>
        <detaileddescription>
<para>ECJPAKE driver implementations may have hardware or software limitations on how many clients can simultaneously perform operations. This status code is returned if the mutual exclusion mechanism signals that an operation cannot currently be performed. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="704" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="704" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1adc3a17b99ca7816137c60f780b51ef63" prot="public" static="no">
        <name>ECJPAKE_STATUS_INVALID_PUBLIC_KEY</name>
        <initializer>(-3)</initializer>
        <briefdescription>
<para>The public key of the other party is not valid. </para>        </briefdescription>
        <detaileddescription>
<para>The public key received from the other party is not valid. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="711" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="711" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1a11dcd54552f0512755ba72f17ae5da46" prot="public" static="no">
        <name>ECJPAKE_STATUS_PUBLIC_KEY_NOT_ON_CURVE</name>
        <initializer>(-4)</initializer>
        <briefdescription>
<para>The public key of the other party does not lie upon the curve. </para>        </briefdescription>
        <detaileddescription>
<para>The public key received from the other party does not lie upon the agreed upon curve. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="719" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="719" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1a79517ed3fbf41907b1d9e495f7bfef5c" prot="public" static="no">
        <name>ECJPAKE_STATUS_PUBLIC_KEY_LARGER_THAN_PRIME</name>
        <initializer>(-5)</initializer>
        <briefdescription>
<para>A coordinate of the public key of the other party is too large. </para>        </briefdescription>
        <detaileddescription>
<para>A coordinate of the public key received from the other party is larger than the prime of the curve. This implies that the point was not correctly generated on that curve. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="728" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="728" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1a74586f857af1aaffbe358721b81f1b0f" prot="public" static="no">
        <name>ECJPAKE_STATUS_POINT_AT_INFINITY</name>
        <initializer>(-6)</initializer>
        <briefdescription>
<para>The result of the operation is the point at infinity. </para>        </briefdescription>
        <detaileddescription>
<para>The operation yielded the point at infinity on this curve. This point is not permitted for further use in ECC operations. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="736" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="736" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1a4ca6b37156ce3f0bd1c26b5ecd4d4a23" prot="public" static="no">
        <name>ECJPAKE_STATUS_INVALID_PRIVATE_KEY</name>
        <initializer>(-7)</initializer>
        <briefdescription>
<para>The private key passed into the the call is invalid. </para>        </briefdescription>
        <detaileddescription>
<para>Private keys must be integers in the interval [1, n - 1], where n is the order of the curve. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="744" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="744" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1a45e8ebd0af128c2b81c249022baa6667" prot="public" static="no">
        <name>ECJPAKE_STATUS_INVALID_PRIVATE_V</name>
        <initializer>(-8)</initializer>
        <briefdescription>
<para>The private v passed into the the call is invalid. </para>        </briefdescription>
        <detaileddescription>
<para>Private v must be integers in the interval [1, n - 1], where n is the order of the curve. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="752" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="752" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_e_c_j_p_a_k_e_8h_1a583347838bba8d270e653517317aaa39" prot="public" static="no">
        <name>ECJPAKE_STATUS_CANCELED</name>
        <initializer>(-9)</initializer>
        <briefdescription>
<para>The ongoing operation was canceled. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="757" column="9" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="757" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="enum">
      <memberdef kind="enum" id="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634c" prot="public" static="no">
        <name>ECJPAKE_ReturnBehavior</name>
        <enumvalue id="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634ca5a4164de2fa7a74f8e9a8f21a6f40069" prot="public">
          <name>ECJPAKE_RETURN_BEHAVIOR_CALLBACK</name>
          <initializer>= 1</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will return immediately while the ECJPAKE operation goes on in the background. The registered callback function is called after the operation completes. The context the callback function is called (task, HWI, SWI) is implementation-dependent. </para>          </detaileddescription>
        </enumvalue>
        <enumvalue id="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634ca124c6b724f8fc636176973cbc470d63f" prot="public">
          <name>ECJPAKE_RETURN_BEHAVIOR_BLOCKING</name>
          <initializer>= 2</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will block while ECJPAKE operation goes on in the background. ECJPAKE operation results are available after the function returns. </para>          </detaileddescription>
        </enumvalue>
        <enumvalue id="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634ca5ec172da7685ba35f8337c7f5dc5d5a6" prot="public">
          <name>ECJPAKE_RETURN_BEHAVIOR_POLLING</name>
          <initializer>= 4</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will continuously poll a flag while ECJPAKE operation goes on in the background. ECJPAKE operation results are available after the function returns. </para>          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>The way in which ECJPAKE function calls return after performing an encryption + authentication or decryption + verification operation. </para>        </briefdescription>
        <detaileddescription>
<para>Not all ECJPAKE operations exhibit the specified return behavor. Functions that do not require significant computation and cannot offload that computation to a background thread behave like regular functions. Which functions exhibit the specfied return behavior is implementation dependent. Specifically, a software-backed implementation run on the same CPU as the application will emulate the return behavior while not actually offloading the computation to the background thread.</para><para>ECJPAKE functions exhibiting the specified return behavior have restrictions on the context from which they may be called.</para><para><table rows="4" cols="4"><row>
<entry thead="yes"><para></para></entry><entry thead="yes"><para>Task </para></entry><entry thead="yes"><para>Hwi </para></entry><entry thead="yes"><para>Swi  </para></entry></row>
<row>
<entry thead="no"><para>ECJPAKE_RETURN_BEHAVIOR_CALLBACK </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry></row>
<row>
<entry thead="no"><para>ECJPAKE_RETURN_BEHAVIOR_BLOCKING </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para></para></entry><entry thead="no"><para></para></entry></row>
<row>
<entry thead="no"><para>ECJPAKE_RETURN_BEHAVIOR_POLLING </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry></row>
</table>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="806" column="1" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="805" bodyend="821"/>
      </memberdef>
      <memberdef kind="enum" id="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26" prot="public" static="no">
        <name>ECJPAKE_OperationType</name>
        <enumvalue id="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26a127cd39a054561f63b428ddfafed821a" prot="public">
          <name>ECJPAKE_OPERATION_TYPE_ROUND_ONE_GENERATE_KEYS</name>
          <initializer>= 1</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26ad08ce6c1fa4c35487af7a3f5faeea4b3" prot="public">
          <name>ECJPAKE_OPERATION_TYPE_GENERATE_ZKP</name>
          <initializer>= 2</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26aae45452ee70a3aa970183c9f5c8ca6ff" prot="public">
          <name>ECJPAKE_OPERATION_TYPE_VERIFY_ZKP</name>
          <initializer>= 3</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26acccd1127e96dd121dc8dbe4a600b2903" prot="public">
          <name>ECJPAKE_OPERATION_TYPE_ROUND_TWO_GENERATE_KEYS</name>
          <initializer>= 4</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26aa121074a25507188f1d89a816cfaf7ed" prot="public">
          <name>ECJPAKE_OPERATION_TYPE_COMPUTE_SHARED_SECRET</name>
          <initializer>= 5</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Enum for the operation types supported by the driver. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1062" column="1" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="1061" bodyend="1068"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="typedef">
      <memberdef kind="typedef" id="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" prot="public" static="no">
        <type><ref refid="struct_e_c_j_p_a_k_e___config" kindref="compound">ECJPAKE_Config</ref> *</type>
        <definition>typedef ECJPAKE_Config* ECJPAKE_Handle</definition>
        <argsstring></argsstring>
        <name>ECJPAKE_Handle</name>
        <briefdescription>
<para>A handle that is returned from an <ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref> call. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="782" column="1" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="782" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="_e_c_j_p_a_k_e_8h_1a743785709e9ca990077a97befed10232" prot="public" static="no">
        <type>void(*</type>
        <definition>typedef void(* ECJPAKE_CallbackFxn) (ECJPAKE_Handle handle, int_fast16_t returnStatus, ECJPAKE_Operation operation, ECJPAKE_OperationType operationType)</definition>
        <argsstring>)(ECJPAKE_Handle handle, int_fast16_t returnStatus, ECJPAKE_Operation operation, ECJPAKE_OperationType operationType)</argsstring>
        <name>ECJPAKE_CallbackFxn</name>
        <briefdescription>
<para>The definition of a callback function used by the ECJPAKE driver when used in <ref refid="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634ca5a4164de2fa7a74f8e9a8f21a6f40069" kindref="member">ECJPAKE_RETURN_BEHAVIOR_CALLBACK</ref>. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>handle</parametername>
</parameternamelist>
<parameterdescription>
<para>Handle of the client that started the ECJPAKE operation.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>returnStatus</parametername>
</parameternamelist>
<parameterdescription>
<para>The result of the ECJPAKE operation. May contain an error code if the result is the point at infinity for example.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A union of pointers to operation structs. Only one type of pointer is valid per call to the callback function. Which type is currently valid is determined by /c operationType. The union allows easier access to the struct&apos;s fields without the need to typecase the result.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>operationType</parametername>
</parameternamelist>
<parameterdescription>
<para>This parameter determined which operation the callback refers to and which type to access through /c operation. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1088" column="1" bodyfile="source/ti/drivers/ECJPAKE.h" bodystart="1088" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a700d51c05aed0c04a37615136583c96b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECJPAKE_init</definition>
        <argsstring>(void)</argsstring>
        <name>ECJPAKE_init</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>This function initializes the ECJPAKE module. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para>The ECJPAKE_config structure must exist and be persistent before this function can be called. This function must also be called before any other ECJPAKE driver APIs. This function call does not modify any peripheral registers. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1121" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1ad4905b7bbdda7a6d84d68a33825d71fc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECJPAKE_OperationRoundOneGenerateKeys_init</definition>
        <argsstring>(ECJPAKE_OperationRoundOneGenerateKeys *operation)</argsstring>
        <name>ECJPAKE_OperationRoundOneGenerateKeys_init</name>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys" kindref="compound">ECJPAKE_OperationRoundOneGenerateKeys</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys" kindref="compound">ECJPAKE_OperationRoundOneGenerateKeys</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to <ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys" kindref="compound">ECJPAKE_OperationRoundOneGenerateKeys</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1131" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a309530be8bedab920f30a9e31e01f052" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECJPAKE_OperationGenerateZKP_init</definition>
        <argsstring>(ECJPAKE_OperationGenerateZKP *operation)</argsstring>
        <name>ECJPAKE_OperationGenerateZKP_init</name>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p" kindref="compound">ECJPAKE_OperationGenerateZKP</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p" kindref="compound">ECJPAKE_OperationGenerateZKP</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to <ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p" kindref="compound">ECJPAKE_OperationGenerateZKP</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1141" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1adecdfdaae05bd0dc70f3b2766014c0e4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECJPAKE_OperationVerifyZKP_init</definition>
        <argsstring>(ECJPAKE_OperationVerifyZKP *operation)</argsstring>
        <name>ECJPAKE_OperationVerifyZKP_init</name>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p" kindref="compound">ECJPAKE_OperationVerifyZKP</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p" kindref="compound">ECJPAKE_OperationVerifyZKP</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to <ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p" kindref="compound">ECJPAKE_OperationVerifyZKP</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1151" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a779e5c3610e226d58917c1fdf6294f4c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECJPAKE_OperationRoundTwoGenerateKeys_init</definition>
        <argsstring>(ECJPAKE_OperationRoundTwoGenerateKeys *operation)</argsstring>
        <name>ECJPAKE_OperationRoundTwoGenerateKeys_init</name>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys" kindref="compound">ECJPAKE_OperationRoundTwoGenerateKeys</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys" kindref="compound">ECJPAKE_OperationRoundTwoGenerateKeys</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to <ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys" kindref="compound">ECJPAKE_OperationRoundTwoGenerateKeys</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1161" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a0c65ce541534493bd352248f7bc7314f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECJPAKE_OperationComputeSharedSecret_init</definition>
        <argsstring>(ECJPAKE_OperationComputeSharedSecret *operation)</argsstring>
        <name>ECJPAKE_OperationComputeSharedSecret_init</name>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret" kindref="compound">ECJPAKE_OperationComputeSharedSecret</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret" kindref="compound">ECJPAKE_OperationComputeSharedSecret</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to <ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret" kindref="compound">ECJPAKE_OperationComputeSharedSecret</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1171" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a3fd8ad0728bebfd64e14537b2dbfedf1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECJPAKE_close</definition>
        <argsstring>(ECJPAKE_Handle handle)</argsstring>
        <name>ECJPAKE_close</name>
        <param>
          <type><ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <briefdescription>
<para>Function to close an ECJPAKE peripheral specified by the ECJPAKE handle. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para><ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref> has to be called first.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>handle</parametername>
</parameternamelist>
<parameterdescription>
<para>An ECJPAKE handle returned from <ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref></para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1182" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref></type>
        <definition>ECJPAKE_Handle ECJPAKE_open</definition>
        <argsstring>(uint_least8_t index, ECJPAKE_Params *params)</argsstring>
        <name>ECJPAKE_open</name>
        <param>
          <type>uint_least8_t</type>
          <declname>index</declname>
        </param>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>This function opens a given ECJPAKE peripheral. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para>ECJPAKE controller has been initialized using <ref refid="_e_c_j_p_a_k_e_8h_1a700d51c05aed0c04a37615136583c96b" kindref="member">ECJPAKE_init()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>index</parametername>
</parameternamelist>
<parameterdescription>
<para>Logical peripheral number for the ECJPAKE indexed into the ECJPAKE_config table</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>params</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to an parameter block, if NULL it will use default values.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>An ECJPAKE_Handle on success or a NULL on an error or if it has been opened already.</para></simplesect>
<simplesect kind="see"><para><ref refid="_e_c_j_p_a_k_e_8h_1a700d51c05aed0c04a37615136583c96b" kindref="member">ECJPAKE_init()</ref> </para></simplesect>
<simplesect kind="see"><para><ref refid="_e_c_j_p_a_k_e_8h_1a3fd8ad0728bebfd64e14537b2dbfedf1" kindref="member">ECJPAKE_close()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1201" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1accb0f74e2250c5cdb6bbd2d71d790323" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void ECJPAKE_Params_init</definition>
        <argsstring>(ECJPAKE_Params *params)</argsstring>
        <name>ECJPAKE_Params_init</name>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>Function to initialize the <ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>params</parametername>
</parameternamelist>
<parameterdescription>
<para>An pointer to <ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are: returnBehavior = ECJPAKE_RETURN_BEHAVIOR_BLOCKING callbackFxn = NULL timeout = SemaphoreP_WAIT_FOREVER custom = NULL </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1215" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a12cd2e0e5f6828d904fbb76bd6c5c2d9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t ECJPAKE_roundOneGenerateKeys</definition>
        <argsstring>(ECJPAKE_Handle handle, ECJPAKE_OperationRoundOneGenerateKeys *operation)</argsstring>
        <name>ECJPAKE_roundOneGenerateKeys</name>
        <param>
          <type><ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys" kindref="compound">ECJPAKE_OperationRoundOneGenerateKeys</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Generates all public and private keying material for the first round of the EC-JPAKE scheme. </para>        </briefdescription>
        <detaileddescription>
<para>This function generates all public and private keying material required for the first round of the EC-JPAKE scheme.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>An ECJPAKE handle returned from <ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the requisite parameters to execute the function.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="pre"><para>Call <ref refid="_e_c_j_p_a_k_e_8h_1ad4905b7bbdda7a6d84d68a33825d71fc" kindref="member">ECJPAKE_OperationRoundOneGenerateKeys_init()</ref> on /c operation.</para></simplesect>
<simplesect kind="post"><para>Generate the two sets of hashes and ZKPs for the two public/private key pairs.</para></simplesect>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a1e2fe3a0d3efd4d6505552b732402a35" kindref="member">ECJPAKE_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a3173a5ec592e345c4dc58e9fbbde2825" kindref="member">ECJPAKE_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a668d9bd2a4926c046f40ee6698892362" kindref="member">ECJPAKE_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a583347838bba8d270e653517317aaa39" kindref="member">ECJPAKE_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a74586f857af1aaffbe358721b81f1b0f" kindref="member">ECJPAKE_STATUS_POINT_AT_INFINITY</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The computed public key is the point at infinity. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a4ca6b37156ce3f0bd1c26b5ecd4d4a23" kindref="member">ECJPAKE_STATUS_INVALID_PRIVATE_KEY</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The private key passed into the the call is invalid. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a45e8ebd0af128c2b81c249022baa6667" kindref="member">ECJPAKE_STATUS_INVALID_PRIVATE_V</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The private v passed into the the call is invalid. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1242" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a422529b4456d9e53682985002fd87376" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t ECJPAKE_generateZKP</definition>
        <argsstring>(ECJPAKE_Handle handle, ECJPAKE_OperationGenerateZKP *operation)</argsstring>
        <name>ECJPAKE_generateZKP</name>
        <param>
          <type><ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p" kindref="compound">ECJPAKE_OperationGenerateZKP</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Generates the <computeroutput>r</computeroutput> component of a Schnorr Zero-Knowledge Proof (ZKP) signature. </para>        </briefdescription>
        <detaileddescription>
<para>This function generates the <computeroutput>r</computeroutput> component of a ZKP using the hash and private keys. The hash must be computed prior. This function does not compute the hash for the application. There is no strictly defined bit-level implementation guideline for generating the hash in the EC-JPAKE scheme. Hence, interoperability could not be guaranteed between different EC-JPAKE implementations. Usually, the hash will be a concatenation of the public V, public key, generator point, and user ID. There may be other components such as length fields mixed in.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>An ECJPAKE handle returned from <ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the requisite parameters to execute the function.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="pre"><para>If in round one, <ref refid="_e_c_j_p_a_k_e_8h_1a12cd2e0e5f6828d904fbb76bd6c5c2d9" kindref="member">ECJPAKE_roundOneGenerateKeys()</ref> must be called prior. Else, <ref refid="_e_c_j_p_a_k_e_8h_1a6b0de26fef61a785906120acb0277074" kindref="member">ECJPAKE_roundTwoGenerateKeys()</ref> must be called prior. The hash must also have been computed prior to calling this function. Call <ref refid="_e_c_j_p_a_k_e_8h_1a309530be8bedab920f30a9e31e01f052" kindref="member">ECJPAKE_OperationGenerateZKP_init()</ref> on /c operation.</para></simplesect>
<simplesect kind="post"><para>Send all ZKP signatures (<computeroutput>r</computeroutput>, public V, user ID) together with the public keys to the other party.</para></simplesect>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a1e2fe3a0d3efd4d6505552b732402a35" kindref="member">ECJPAKE_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a3173a5ec592e345c4dc58e9fbbde2825" kindref="member">ECJPAKE_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a668d9bd2a4926c046f40ee6698892362" kindref="member">ECJPAKE_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a583347838bba8d270e653517317aaa39" kindref="member">ECJPAKE_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1276" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1af47d98b1e451cca11b450f425f94ddb0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t ECJPAKE_verifyZKP</definition>
        <argsstring>(ECJPAKE_Handle handle, ECJPAKE_OperationVerifyZKP *operation)</argsstring>
        <name>ECJPAKE_verifyZKP</name>
        <param>
          <type><ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p" kindref="compound">ECJPAKE_OperationVerifyZKP</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Verifies a Schnorr Zero-Knowledge Proof (ZKP) signature. </para>        </briefdescription>
        <detaileddescription>
<para>This function computes if a received Schnorr ZKP correctly verifies a received public key.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>An ECJPAKE handle returned from <ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the requisite parameters to execute the function.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="pre"><para>Receive the relevant ZKP signature parameters. Compute the hash. If in the second round, compute the generator first by calling <ref refid="_e_c_j_p_a_k_e_8h_1a6b0de26fef61a785906120acb0277074" kindref="member">ECJPAKE_roundTwoGenerateKeys()</ref>. Call <ref refid="_e_c_j_p_a_k_e_8h_1adecdfdaae05bd0dc70f3b2766014c0e4" kindref="member">ECJPAKE_OperationVerifyZKP_init()</ref> on /c operation.</para></simplesect>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a1e2fe3a0d3efd4d6505552b732402a35" kindref="member">ECJPAKE_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a3173a5ec592e345c4dc58e9fbbde2825" kindref="member">ECJPAKE_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. Signature did not verify correctly. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a668d9bd2a4926c046f40ee6698892362" kindref="member">ECJPAKE_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a583347838bba8d270e653517317aaa39" kindref="member">ECJPAKE_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a11dcd54552f0512755ba72f17ae5da46" kindref="member">ECJPAKE_STATUS_PUBLIC_KEY_NOT_ON_CURVE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The public key of the other party does not lie upon the curve. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a79517ed3fbf41907b1d9e495f7bfef5c" kindref="member">ECJPAKE_STATUS_PUBLIC_KEY_LARGER_THAN_PRIME</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>A coordinate of the public key of the other party is too large. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1304" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a6b0de26fef61a785906120acb0277074" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t ECJPAKE_roundTwoGenerateKeys</definition>
        <argsstring>(ECJPAKE_Handle handle, ECJPAKE_OperationRoundTwoGenerateKeys *operation)</argsstring>
        <name>ECJPAKE_roundTwoGenerateKeys</name>
        <param>
          <type><ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys" kindref="compound">ECJPAKE_OperationRoundTwoGenerateKeys</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Generates all public and private keying material for the first round of the EC-JPAKE scheme. </para>        </briefdescription>
        <detaileddescription>
<para>This function generates all public and private keying material required for the first round of the EC-JPAKE scheme.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>An ECJPAKE handle returned from <ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the requisite parameters to execute the function.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="pre"><para>Call <ref refid="_e_c_j_p_a_k_e_8h_1a779e5c3610e226d58917c1fdf6294f4c" kindref="member">ECJPAKE_OperationRoundTwoGenerateKeys_init()</ref> on /c operation.</para></simplesect>
<simplesect kind="post"><para>Generate the hash and ZKP signature for the second round public/private key.</para></simplesect>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a1e2fe3a0d3efd4d6505552b732402a35" kindref="member">ECJPAKE_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a3173a5ec592e345c4dc58e9fbbde2825" kindref="member">ECJPAKE_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a668d9bd2a4926c046f40ee6698892362" kindref="member">ECJPAKE_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a583347838bba8d270e653517317aaa39" kindref="member">ECJPAKE_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a4ca6b37156ce3f0bd1c26b5ecd4d4a23" kindref="member">ECJPAKE_STATUS_INVALID_PRIVATE_KEY</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The private key passed into the the call is invalid. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a45e8ebd0af128c2b81c249022baa6667" kindref="member">ECJPAKE_STATUS_INVALID_PRIVATE_V</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The private v passed into the the call is invalid. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1329" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a6d46725aff59ef45fffff16ec1f5ae5b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t ECJPAKE_computeSharedSecret</definition>
        <argsstring>(ECJPAKE_Handle handle, ECJPAKE_OperationComputeSharedSecret *operation)</argsstring>
        <name>ECJPAKE_computeSharedSecret</name>
        <param>
          <type><ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret" kindref="compound">ECJPAKE_OperationComputeSharedSecret</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Computes the shared secret. </para>        </briefdescription>
        <detaileddescription>
<para>This function computes the shared secret between both parties. The shared secret is a point on the elliptic curve and is used to further derive the symmetric session key via a key derivation function.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>An ECJPAKE handle returned from <ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the requisite parameters to execute the function.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="pre"><para>Call <ref refid="_e_c_j_p_a_k_e_8h_1a0c65ce541534493bd352248f7bc7314f" kindref="member">ECJPAKE_OperationComputeSharedSecret_init()</ref> on /c operation.</para></simplesect>
<simplesect kind="post"><para>The shared secret must be processed by a key derivation function to compute the symmetric session key. It is recommended that the two parties prove to each other that they are in posession of the symmetric session key. While this should be implied by the successful verification of the three ZKPs in the scheme, it is nonetheless good practice.</para></simplesect>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a1e2fe3a0d3efd4d6505552b732402a35" kindref="member">ECJPAKE_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a3173a5ec592e345c4dc58e9fbbde2825" kindref="member">ECJPAKE_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a668d9bd2a4926c046f40ee6698892362" kindref="member">ECJPAKE_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a583347838bba8d270e653517317aaa39" kindref="member">ECJPAKE_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1356" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a220578478388eb6de285a3ced904b4c9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t ECJPAKE_cancelOperation</definition>
        <argsstring>(ECJPAKE_Handle handle)</argsstring>
        <name>ECJPAKE_cancelOperation</name>
        <param>
          <type><ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <briefdescription>
<para>Cancels an ongoing ECJPAKE operation. </para>        </briefdescription>
        <detaileddescription>
<para>Asynchronously cancels an ECJPAKE operation. Only available when using ECJPAKE_RETURN_BEHAVIOR_CALLBACK or ECJPAKE_RETURN_BEHAVIOR_BLOCKING. The operation will terminate as though an error occured. The return status code of the operation will be ECJPAKE_STATUS_CANCELED.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>handle</parametername>
</parameternamelist>
<parameterdescription>
<para>Handle of the operation to cancel</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a1e2fe3a0d3efd4d6505552b732402a35" kindref="member">ECJPAKE_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_e_c_j_p_a_k_e_8h_1a3173a5ec592e345c4dc58e9fbbde2825" kindref="member">ECJPAKE_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was not canceled. There may be no operation to cancel. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1371" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_e_c_j_p_a_k_e_8h_1a6fb85a2fd62f3d860ee85110d47ecf30" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref></type>
        <definition>ECJPAKE_Handle ECJPAKE_construct</definition>
        <argsstring>(ECJPAKE_Config *config, const ECJPAKE_Params *params)</argsstring>
        <name>ECJPAKE_construct</name>
        <param>
          <type><ref refid="struct_e_c_j_p_a_k_e___config" kindref="compound">ECJPAKE_Config</ref> *</type>
          <declname>config</declname>
        </param>
        <param>
          <type>const <ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>Constructs a new ECJPAKE object. </para>        </briefdescription>
        <detaileddescription>
<para>Unlike <ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref>, <ref refid="_e_c_j_p_a_k_e_8h_1a6fb85a2fd62f3d860ee85110d47ecf30" kindref="member">ECJPAKE_construct()</ref> does not require the hwAttrs and object to be allocated in a <ref refid="struct_e_c_j_p_a_k_e___config" kindref="compound">ECJPAKE_Config</ref> array that is indexed into. Instead, the <ref refid="struct_e_c_j_p_a_k_e___config" kindref="compound">ECJPAKE_Config</ref>, hwAttrs, and object can be allocated at any location. This allows for relatively simple run-time allocation of temporary driver instances on the stack or the heap. The drawback is that this makes it more difficult to write device-agnostic code. If you use an ifdef with DeviceFamily, you can choose the correct object and hwAttrs to allocate. That compilation unit will be tied to the device it was compiled for at this point. To change devices, recompilation of the application with a different DeviceFamily setting is necessary.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>config</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="struct_e_c_j_p_a_k_e___config" kindref="compound">ECJPAKE_Config</ref> describing the location of the object and hwAttrs.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>params</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref> to configure the driver instance.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Returns a <ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref> on success or NULL on failure.</para></simplesect>
<simplesect kind="pre"><para>The object struct <computeroutput>config</computeroutput> points to must be zeroed out prior to calling this function. Otherwise, unexpected behavior may ensue. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/ECJPAKE.h" line="1396" column="1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>TI Driver for Elliptic Curve Password Authenticated Key Exchange by Juggling. </para>    </briefdescription>
    <detaileddescription>
<para><hruler/>
</para><para><anchor id="_e_c_j_p_a_k_e_8h_1ti_drivers_ECJPAKE_Overview"/><heading level="1">Overview</heading>
</para><para>Elliptic Curve Password Authenticated Key Exchange by Juggling (EC-JPAKE) is a key agreement scheme that establishes a secure channel over an insecure network. It only requires sharing a password offline and does not require public key infrastructure or trusted third parties such as certificate authorities.</para><para>At the end of the EC-JPAKE scheme, both parties derive a shared secret from which a session key is derived.</para><para>The scheme is symmetric. Both parties perform the exact same operations to end up with the shared secret.</para><para><heading level="1">Steps involved</heading>
</para><para>Since the scheme is symmetric, the steps involved will be illustrated using Alice and Bob as relevant parties.</para><para><orderedlist>
<listitem><para>Alice and Bob decide on some pre-shared secret, the password, and negotiate this through some offline means such as during commissioning.</para></listitem><listitem><para>Alice generates private keys x1, x2, v1, and v2 uniformly at random from [1, n - 1], where n is the order of the curve.</para></listitem><listitem><para>Alice generates public keys X1 = x1 * G, X2 = x2 * G, V1 = v1 * G, and V2 = v2 * G.</para></listitem><listitem><para>Alice generates Zero-Knowledge Proofs (ZKPs) for (X1, x1) and (X2, x2). The required hash is computed by concatenating G, V, the public key the ZKP authenticates, and the UserID of the authenticator and hashing the new bitstring. The exact order and formatting of all parameters and any extra information such as length words must be agreed upon by both parties to yield the same result.</para></listitem><listitem><para>Alice sends X1, X2, V1, V2, r1, r2, and her UserID to Bob.</para></listitem><listitem><para>Bob generates private keys x3, x4, v3, and v4 uniformly at random from [1, n - 1], where n is the order of the curve.</para></listitem><listitem><para>Bob generates public keys X3 = x3 * G, X4 = x4 * G, V3 = v3 * G, and V4 = v4 * G.</para></listitem><listitem><para>Bob generates Zero-Knowledge Proofs (ZKPs) for (X3, x3) and (X4, x4).</para></listitem><listitem><para>Bob sends X3, X4, V3, V4, r3, r4, and his UserID to Bob.</para></listitem><listitem><para>Alice and Bob verify the other parties ZKPs and break off the scheme if they do not check out.</para></listitem><listitem><para>Alice computes the new generator point G2 = (X1 + X3 + X4).</para></listitem><listitem><para>Alice computes the combined private key x5 = x2 * s, where s is the pre-shared secret.</para></listitem><listitem><para>Alice computes the combined public key X5 = x5 * G2.</para></listitem><listitem><para>Alice computes a ZKP for (X5, x5) using G2 as the generator point of the ZKP.</para></listitem><listitem><para>Alice sends X5, V5, r5, and her UserID to Bob.</para></listitem><listitem><para>Bob computes the new generator point G3 = (X3 + X1 + X2).</para></listitem><listitem><para>Bob computes the combined private key x6 = x4 * s, where s is the pre-shared secret.</para></listitem><listitem><para>Bob computes the combined public key X6 = x6 * G3.</para></listitem><listitem><para>Bob computes a ZKP for (X6, x6) using G3 as the generator point of the ZKP.</para></listitem><listitem><para>Bob sends X6, V6, r6, and his UserID to Alice.</para></listitem><listitem><para>Alice and Bob verify the other parties ZKPs and break off the scheme if they do not check out. This involves computing the other parties generator point.</para></listitem><listitem><para>Alice computes shared secret K = (X6 - (X4 * x5)) * x2.</para></listitem><listitem><para>Bob computes shared secret K = (X5 - (X2 * x6)) * x4.</para></listitem><listitem><para>Alice and Bob each run K through a mutually agreed upon key derivation function to compute the symmetric session key.</para></listitem></orderedlist>
</para><para><anchor id="_e_c_j_p_a_k_e_8h_1ti_drivers_ECJPAKE_Usage"/><heading level="1">Usage</heading>
</para><para><heading level="2">Before starting an ECJPAKE operation</heading>
</para><para>Before starting an ECJPAKE operation, the application must do the following:<orderedlist>
<listitem><para>Call <ref refid="_e_c_j_p_a_k_e_8h_1a700d51c05aed0c04a37615136583c96b" kindref="member">ECJPAKE_init()</ref> to initialize the driver</para></listitem><listitem><para>Call <ref refid="_e_c_j_p_a_k_e_8h_1accb0f74e2250c5cdb6bbd2d71d790323" kindref="member">ECJPAKE_Params_init()</ref> to initialize the <ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref> to default values.</para></listitem><listitem><para>Modify the <ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref> as desired</para></listitem><listitem><para>Call <ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open()</ref> to open an instance of the driver</para></listitem></orderedlist>
</para><para><heading level="2">Round one</heading>
</para><para><orderedlist>
<listitem><para>Initialize the following private key CryptoKeys. Seed them with keying material uniformly drawn from [1, n - 1]<itemizedlist>
<listitem><para>myPrivateKey1</para></listitem><listitem><para>myPrivateKey2</para></listitem><listitem><para>myPrivateV1</para></listitem><listitem><para>myPrivateV2</para></listitem></itemizedlist>
</para></listitem><listitem><para>Initialize the following blank public key CryptoKeys:<itemizedlist>
<listitem><para>myPublicKey1</para></listitem><listitem><para>myPublicKey2</para></listitem><listitem><para>myPublicV1</para></listitem><listitem><para>myPublicV2</para></listitem><listitem><para>theirPublicKey1</para></listitem><listitem><para>theirPublicKey2</para></listitem><listitem><para>theirPublicV1</para></listitem><listitem><para>theirPublicV2</para></listitem></itemizedlist>
</para></listitem><listitem><para>Call <ref refid="_e_c_j_p_a_k_e_8h_1a12cd2e0e5f6828d904fbb76bd6c5c2d9" kindref="member">ECJPAKE_roundOneGenerateKeys()</ref> to generate all round one keys as needed.</para></listitem><listitem><para>Generate the hashes for the ZKPs using previously agreed upon formatting. Use the default generator point of the curve in the first round.</para></listitem><listitem><para>Generate your two ZKPs by calling <ref refid="_e_c_j_p_a_k_e_8h_1a422529b4456d9e53682985002fd87376" kindref="member">ECJPAKE_generateZKP()</ref> once per ZKP.</para></listitem><listitem><para>Exchange public keys, UserIDs, and ZKP signatures. Write the received keying material into the relevant buffers or load them into key stores as specified by the CryptoKeys initialised earlier.</para></listitem><listitem><para>Verify the other party&apos;s ZKPs after computing their ZKP hash by calling <ref refid="_e_c_j_p_a_k_e_8h_1af47d98b1e451cca11b450f425f94ddb0" kindref="member">ECJPAKE_verifyZKP()</ref> once per ZKP.</para></listitem><listitem><para>You can now let all V keys, myPrivateKey1, and all ZKP signatures go out of scope and re-use their memory.</para></listitem></orderedlist>
</para><para><heading level="2">Round two</heading>
</para><para><orderedlist>
<listitem><para>Initialize the following private key CryptoKeys. Seed myPrivateV with keying material uniformly drawn from [1, n - 1]. Initialise the preSharedSecret with the common keying material previously shared between you and the other party.<itemizedlist>
<listitem><para>preSharedSecret</para></listitem><listitem><para>myCombinedPrivateKey</para></listitem></itemizedlist>
</para></listitem><listitem><para>Initialize the following blank public key CryptoKeys:<itemizedlist>
<listitem><para>theirNewGenerator</para></listitem><listitem><para>myNewGenerator</para></listitem><listitem><para>myCombinedPublicKey</para></listitem><listitem><para>myPublicV</para></listitem></itemizedlist>
</para></listitem><listitem><para>Call <ref refid="_e_c_j_p_a_k_e_8h_1a6b0de26fef61a785906120acb0277074" kindref="member">ECJPAKE_roundTwoGenerateKeys()</ref> to generate the remaining round two keys.</para></listitem><listitem><para>Generate the hash for your ZKP use myNewGenerator as your generator point.</para></listitem><listitem><para>Exchange public keys, UserIDs, and ZKP signatures. Write the received keying material into the relevant buffers or load them into key stores as specified by the CryptoKeys initialised earlier.</para></listitem><listitem><para>Verify the other party&apos;s ZKP after computing their ZKP hash b calling <ref refid="_e_c_j_p_a_k_e_8h_1af47d98b1e451cca11b450f425f94ddb0" kindref="member">ECJPAKE_verifyZKP()</ref>. Use theirNewGenerator as the generator point for this ZKP.</para></listitem><listitem><para>You can now let all keys and keying material but myCombinedPrivateKey, theirCombinedPublicKey, theirPublicKey2, and myPrivateKey2 go out of scope.</para></listitem></orderedlist>
</para><para><heading level="2">Computing the shared secret</heading>
</para><para><orderedlist>
<listitem><para>Initialize the following blank public key <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>:<itemizedlist>
<listitem><para>sharedSecret</para></listitem></itemizedlist>
</para></listitem><listitem><para>Call <ref refid="_e_c_j_p_a_k_e_8h_1a6d46725aff59ef45fffff16ec1f5ae5b" kindref="member">ECJPAKE_computeSharedSecret()</ref>.</para></listitem><listitem><para>Run sharedSecret through a key derivation function to compute the shared symmetric session key.</para></listitem></orderedlist>
</para><para><heading level="2">Key Formatting</heading>
</para><para>The ECJPAKE API expects the private and public keys to be formatted in octet string format. The details of octet string formatting can be found in SEC 1: Elliptic Curve Cryptography.</para><para>Private keys and V&apos;s are formatted as big-endian integers of the same length as the curve length.</para><para>Public keys, public V&apos;s, generator points, and shared secrets are points on an elliptic curve. These points can be expressed in several ways. This API uses points expressed in uncompressed affine coordinates by default. The octet string format requires a formatting byte in the first byte of the public key. When using uncompressed affine coordinates, this is the value 0x04. The point itself is stored as a concatenated array of X followed by Y. X and Y are big-endian. Some implementations do not require or yield the Y coordinate for ECJPAKE on certain curves. It is recommended that the full keying material buffer of twice the curve param length is used to facilitate code-reuse. Implementations that do not use the Y coordinate will zero-out the Y-coordinate whenever they write a point to the <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>.</para><para>This API accepts and returns the keying material of public keys according to the following table:</para><para><table rows="4" cols="3"><row>
<entry thead="yes"><para>Curve Type </para></entry><entry thead="yes"><para>Keying Material Array </para></entry><entry thead="yes"><para>Array Length  </para></entry></row>
<row>
<entry thead="no"><para>Short Weierstrass </para></entry><entry thead="no"><para>[0x04, X, Y] </para></entry><entry thead="no"><para>1 + 2 * Curve Param Length </para></entry></row>
<row>
<entry thead="no"><para>Montgomery </para></entry><entry thead="no"><para>[0x04, X, Y] </para></entry><entry thead="no"><para>1 + 2 * Curve Param Length </para></entry></row>
<row>
<entry thead="no"><para>Edwards </para></entry><entry thead="no"><para>[0x04, X, Y] </para></entry><entry thead="no"><para>1 + 2 * Curve Param Length </para></entry></row>
</table>
The r component of the ZKP signature, hash, and preSharedSecret also all use the octet string format. They are interpreted as big-endian integers.</para><para><anchor id="_e_c_j_p_a_k_e_8h_1ti_drivers_ECJPAKE_Synopsis"/><heading level="2">Synopsis</heading>
</para><para><anchor id="_e_c_j_p_a_k_e_8h_1ti_drivers_ECJPAKE_Synopsis_Code"/><programlisting><codeline><highlight class="normal">//<sp/>Import<sp/>ECJPAKE<sp/>Driver<sp/>definitions</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/ECJPAKE.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECJPAKE_init();</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Since<sp/>we<sp/>are<sp/>using<sp/>default<sp/>ECJPAKE_Params,<sp/>we<sp/>just<sp/>pass<sp/>in<sp/>NULL<sp/>for<sp/>that<sp/>parameter.</highlight></codeline>
<codeline><highlight class="normal">ecjpakeHandle<sp/>=<sp/>ECJPAKE_open(0,<sp/>NULL);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECJPAKE_Handle<sp/>handle<sp/>=<sp/>ECJPAKE_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationRoundOneGenerateKeys<sp/><sp/><sp/>operationRoundOneGenerateKeys;</highlight></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationRoundTwoGenerateKeys<sp/><sp/><sp/>operationRoundTwoGenerateKeys;</highlight></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationGenerateZKP<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationGenerateZKP;</highlight></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationVerifyZKP<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationVerifyZKP;</highlight></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationComputeSharedSecret<sp/><sp/><sp/><sp/>operationComputeSharedSecret;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Generate<sp/>my<sp/>round<sp/>one<sp/>keys</highlight></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationRoundOneGenerateKeys_init(&amp;operationRoundOneGenerateKeys);</highlight></codeline>
<codeline><highlight class="normal">operationRoundOneGenerateKeys.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationRoundOneGenerateKeys.myPrivateKey1<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal">operationRoundOneGenerateKeys.myPrivateKey2<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal">operationRoundOneGenerateKeys.myPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal">operationRoundOneGenerateKeys.myPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal">operationRoundOneGenerateKeys.myPrivateV1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV1;</highlight></codeline>
<codeline><highlight class="normal">operationRoundOneGenerateKeys.myPrivateV2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV2;</highlight></codeline>
<codeline><highlight class="normal">operationRoundOneGenerateKeys.myPublicV1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV1;</highlight></codeline>
<codeline><highlight class="normal">operationRoundOneGenerateKeys.myPublicV2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV2;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">result<sp/>=<sp/>ECJPAKE_roundOneGenerateKeys(handle,<sp/>&amp;operationRoundOneGenerateKeys);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Generate<sp/>hashes<sp/>here</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>generate<sp/>my<sp/>round<sp/>one<sp/>ZKPs</highlight></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV1;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash1;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR1;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV2;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash2;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR2;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Do<sp/>ZKP<sp/>and<sp/>key<sp/>transmission<sp/>here</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Verify<sp/>their<sp/>round<sp/>one<sp/>ZKPs</highlight></codeline>
<codeline><highlight class="normal">//<sp/>Generate<sp/>their<sp/>hashes<sp/>here</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>NULL;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV1;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash1;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR1;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,<sp/>&amp;operationVerifyZKP);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>NULL;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV2;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash2;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR2;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,&amp;operationVerifyZKP);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Round<sp/>two<sp/>starts<sp/>now</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Generate<sp/>my<sp/>round<sp/>two<sp/>keys</highlight></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationRoundTwoGenerateKeys_init(&amp;operationRoundTwoGenerateKeys);</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.myPrivateKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.myPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.myPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.theirPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.theirPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.preSharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;preSharedSecretCryptoKey;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.theirNewGenerator<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirGeneratorKey;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.myNewGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myGeneratorKey;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.myCombinedPrivateKey<sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.myCombinedPublicKey<sp/><sp/><sp/>=<sp/>&amp;myCombinedPublicKey;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV3;</highlight></codeline>
<codeline><highlight class="normal">operationRoundTwoGenerateKeys.myPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV3;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">result<sp/>=<sp/>ECJPAKE_roundTwoGenerateKeys(handle,<sp/>&amp;operationRoundTwoGenerateKeys);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Generate<sp/>my<sp/>round<sp/><sp/>two<sp/>ZKP</highlight></codeline>
<codeline><highlight class="normal">//<sp/>Generate<sp/>the<sp/>round<sp/>two<sp/>hash<sp/>here</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV3;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash3;</highlight></codeline>
<codeline><highlight class="normal">operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR3;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Exchange<sp/>keys<sp/>and<sp/>ZKPs<sp/>again</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Verify<sp/>their<sp/>second<sp/>round<sp/>ZKP</highlight></codeline>
<codeline><highlight class="normal">//<sp/>Generate<sp/>their<sp/>round<sp/>two<sp/>hash<sp/>here</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirGeneratorKey;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirCombinedPublicKey;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV3;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash3;</highlight></codeline>
<codeline><highlight class="normal">operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR3;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,<sp/>&amp;operationVerifyZKP);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Generate<sp/>shared<sp/>secret</highlight></codeline>
<codeline><highlight class="normal">ECJPAKE_OperationComputeSharedSecret_init(&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.myCombinedPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.theirCombinedPublicKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirCombinedPublicKey;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.theirPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.myPrivateKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal">operationComputeSharedSecret.sharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;sharedSecretCryptoKey;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">result<sp/>=<sp/><sp/>ECJPAKE_computeSharedSecret(handle,<sp/>&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Close<sp/>the<sp/>driver</highlight></codeline>
<codeline><highlight class="normal">ECJPAKE_close(handle);</highlight></codeline>
</programlisting></para><para><anchor id="_e_c_j_p_a_k_e_8h_1ti_drivers_ECJPAKE_Examples"/><heading level="1">Examples</heading>
</para><para><heading level="2">Basic ECJPAKE exchange</heading>
</para><para><programlisting><codeline><highlight class="normal"><sp/><sp/>#define<sp/>NISTP256_CURVE_LENGTH_BYTES<sp/>32</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>#define<sp/>OCTET_STRING_OFFSET<sp/>1</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>#define<sp/>NISTP256_PRIVATE_KEY_LENGTH_BYTES<sp/>NISTP256_CURVE_LENGTH_BYTES</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>#define<sp/>NISTP256_PUBLIC_KEY_LENGTH_BYTES<sp/>(NISTP256_CURVE_LENGTH_BYTES<sp/>*<sp/>2<sp/>+<sp/>OCTET_STRING_OFFSET)</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>My<sp/>fixed<sp/>keying<sp/>material</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myPrivateKeyMaterial1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myPrivateKeyMaterial2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myPrivateVMaterial1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myPrivateVMaterial2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myPrivateVMaterial3[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myHash1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myHash2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myHash3[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>My<sp/>derived<sp/>keying<sp/>material</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myR1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myR2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myR3[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myPublicKeyMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myPublicKeyMaterial2[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myPublicVMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myPublicVMaterial2[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myPublicVMaterial3[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myCombinedPublicKeyMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myCombinedPrivateKeyMaterial1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>myGenerator[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Their<sp/>fixed<sp/>keying<sp/>material</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirHash1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirHash2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirHash3[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Their<sp/>derived<sp/>keying<sp/>material</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirR1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirR2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirR3[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirPublicKeyMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirPublicKeyMaterial2[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirPublicVMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirPublicVMaterial2[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirPublicVMaterial3[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirCombinedPublicKeyMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>theirGenerator[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/><sp/>Shared<sp/>secrets</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>preSharedSecretKeyingMaterial[NISTP256_PRIVATE_KEY_LENGTH_BYTES]<sp/>=<sp/>&quot;This<sp/>is<sp/>our<sp/>password&quot;;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>uint8_t<sp/>sharedSecretKeyingMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Pre-Shared<sp/>Secret<sp/>Key</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>preSharedSecretCryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Final<sp/>shared<sp/>secret<sp/>keys</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>sharedSecretCryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>My&apos;s<sp/>keys</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myPrivateCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myPrivateCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myPrivateCryptoV1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myPrivateCryptoV2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myPrivateCryptoV3;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myCombinedPrivateKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myPublicCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myPublicCryptoV1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myPublicCryptoV2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myPublicCryptoV3;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myCombinedPublicKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>myGeneratorKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Their&apos;s<sp/>Keys</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>theirPublicCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>theirPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>theirPublicCryptoV1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>theirPublicCryptoV2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>theirPublicCryptoV3;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>theirCombinedPublicKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKey<sp/>theirGeneratorKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>NISTP256<sp/>generator</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initKey(NULL,<sp/>ECCParams_NISTP256.generatorX,<sp/>sizeof(ECCParams_NISTP256.length<sp/>*<sp/>2));</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Pre-shared<sp/>secret</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;preSharedSecretCryptoKey,<sp/>preSharedSecretKeyingMaterial,</highlight></codeline>
<codeline><highlight class="normal">sizeof(preSharedSecretKeyingMaterial));</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Final<sp/>shared<sp/>secret<sp/>key</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;sharedSecretCryptoKey,<sp/>sharedSecretKeyingMaterial1,<sp/>sizeof(sharedSecretKeyingMaterial1));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;sharedSecretCryptoKey2,<sp/>sharedSecretKeyingMaterial2,</highlight></codeline>
<codeline><highlight class="normal">sizeof(sharedSecretKeyingMaterial2));</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>My<sp/>keys</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>This<sp/>example<sp/>assumes<sp/>that<sp/>the<sp/>private<sp/>keying<sp/>material<sp/>buffers<sp/>already</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>contains<sp/>random<sp/>bytes.<sp/>Otherwise,<sp/>we<sp/>need<sp/>to<sp/>use<sp/>a<sp/>TRNG<sp/>or<sp/>DRBG<sp/>to<sp/>fill</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>them<sp/>after<sp/>initialising<sp/>the<sp/>CryptoKeys.</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateCryptoKey1,<sp/>myPrivateKeyMaterial1,<sp/>sizeof(myPrivateKeyMaterial1));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateCryptoKey2,<sp/>myPrivateKeyMaterial2,<sp/>sizeof(myPrivateKeyMaterial2));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateCryptoV1,<sp/>myPrivateVMaterial1,<sp/>sizeof(myPrivateVMaterial1));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateCryptoV2,<sp/>myPrivateVMaterial2,<sp/>sizeof(myPrivateVMaterial2));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateCryptoV3,<sp/>myPrivateVMaterial3,<sp/>sizeof(myPrivateVMaterial3));</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicCryptoKey1,<sp/>myPublicKeyMaterial1,<sp/>sizeof(myPublicKeyMaterial1));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicCryptoKey2,<sp/>myPublicKeyMaterial2,<sp/>sizeof(myPublicKeyMaterial2));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicCryptoV1,<sp/>myPublicVMaterial1,<sp/>sizeof(myPublicVMaterial1));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicCryptoV2,<sp/>myPublicVMaterial2,<sp/>sizeof(myPublicVMaterial2));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicCryptoV3,<sp/>myPublicVMaterial3,<sp/>sizeof(myPublicVMaterial3));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;myCombinedPrivateKey,<sp/>myCombinedPrivateKeyMaterial1,</highlight></codeline>
<codeline><highlight class="normal">sizeof(myCombinedPrivateKeyMaterial1));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;myCombinedPublicKey,<sp/>myCombinedPublicKeyMaterial1,</highlight></codeline>
<codeline><highlight class="normal">sizeof(myCombinedPublicKeyMaterial1));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;myGeneratorKey,<sp/>myGenerator,<sp/>sizeof(myGenerator));</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Their<sp/>keys</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirPublicCryptoKey1,<sp/>theirPublicKeyMaterial1,<sp/>sizeof(theirPublicKeyMaterial1));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirPublicCryptoKey2,<sp/>theirPublicKeyMaterial2,<sp/>sizeof(theirPublicKeyMaterial2));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirPublicCryptoV1,<sp/>theirPublicVMaterial1,<sp/>sizeof(theirPublicVMaterial1));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirPublicCryptoV2,<sp/>theirPublicVMaterial2,<sp/>sizeof(theirPublicVMaterial2));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirPublicCryptoV3,<sp/>theirPublicVMaterial3,<sp/>sizeof(theirPublicVMaterial3));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirCombinedPublicKey,<sp/>theirCombinedPublicKeyMaterial1,</highlight></codeline>
<codeline><highlight class="normal">sizeof(theirCombinedPublicKeyMaterial1));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirGeneratorKey,<sp/>theirGenerator,<sp/>sizeof(theirGenerator));</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Initial<sp/>driver<sp/>setup</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_Params<sp/>params;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_Params_init(&amp;params);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_Handle<sp/>handle<sp/>=<sp/>ECJPAKE_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationRoundOneGenerateKeys<sp/><sp/><sp/>operationRoundOneGenerateKeys;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationRoundTwoGenerateKeys<sp/><sp/><sp/>operationRoundTwoGenerateKeys;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationGenerateZKP<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationGenerateZKP;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationVerifyZKP<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationVerifyZKP;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationComputeSharedSecret<sp/><sp/><sp/><sp/>operationComputeSharedSecret;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Generate<sp/>my<sp/>round<sp/>one<sp/>keys</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationRoundOneGenerateKeys_init(&amp;operationRoundOneGenerateKeys);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundOneGenerateKeys.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundOneGenerateKeys.myPrivateKey1<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundOneGenerateKeys.myPrivateKey2<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundOneGenerateKeys.myPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundOneGenerateKeys.myPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundOneGenerateKeys.myPrivateV1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundOneGenerateKeys.myPrivateV2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundOneGenerateKeys.myPublicV1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundOneGenerateKeys.myPublicV2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV2;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>int_fast16_t<sp/>result<sp/>=<sp/>ECJPAKE_roundOneGenerateKeys(handle,<sp/>&amp;operationRoundOneGenerateKeys);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Generate<sp/>hashes<sp/>here</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>generate<sp/>my<sp/>round<sp/>one<sp/>ZKPs</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR1;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR2;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Do<sp/>ZKP<sp/>and<sp/>key<sp/>transmission<sp/>here</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Verify<sp/>their<sp/>round<sp/>one<sp/>ZKPs</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Generate<sp/>their<sp/>hashes<sp/>here</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>NULL;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR1;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,<sp/>&amp;operationVerifyZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>NULL;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR2;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,&amp;operationVerifyZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Round<sp/>two<sp/>starts<sp/>now</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Generate<sp/>my<sp/>round<sp/>two<sp/>keys</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationRoundTwoGenerateKeys_init(&amp;operationRoundTwoGenerateKeys);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.myPrivateKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.myPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.myPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.theirPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.theirPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.preSharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;preSharedSecretCryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.theirNewGenerator<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirGeneratorKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.myNewGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myGeneratorKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.myCombinedPrivateKey<sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.myCombinedPublicKey<sp/><sp/><sp/>=<sp/>&amp;myCombinedPublicKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV3;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationRoundTwoGenerateKeys.myPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV3;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>result<sp/>=<sp/>ECJPAKE_roundTwoGenerateKeys(handle,<sp/>&amp;operationRoundTwoGenerateKeys);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Generate<sp/>my<sp/>round<sp/><sp/>two<sp/>ZKP</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Generate<sp/>the<sp/>round<sp/>two<sp/>hash<sp/>here</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV3;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash3;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR3;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Exchange<sp/>keys<sp/>and<sp/>ZKPs<sp/>again</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Verify<sp/>their<sp/>second<sp/>round<sp/>ZKP</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Generate<sp/>their<sp/>round<sp/>two<sp/>hash<sp/>here</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirGeneratorKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirCombinedPublicKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV3;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash3;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR3;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,<sp/>&amp;operationVerifyZKP);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Generate<sp/>shared<sp/>secret</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>ECJPAKE_OperationComputeSharedSecret_init(&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationComputeSharedSecret.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationComputeSharedSecret.myCombinedPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationComputeSharedSecret.theirCombinedPublicKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirCombinedPublicKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationComputeSharedSecret.theirPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationComputeSharedSecret.myPrivateKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>operationComputeSharedSecret.sharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;sharedSecretCryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>result<sp/>=<sp/><sp/>ECJPAKE_computeSharedSecret(handle,<sp/>&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>Run<sp/>sharedSecretCryptoKey<sp/>through<sp/>a<sp/>key<sp/>derivation<sp/>function<sp/>and</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>//<sp/>confirm<sp/>to<sp/>the<sp/>other<sp/>party<sp/>that<sp/>we<sp/>have<sp/>derived<sp/>the<sp/>same<sp/>key</highlight></codeline>
</programlisting> </para>    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2017-2020,<sp/>Texas<sp/>Instruments<sp/>Incorporated</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>All<sp/>rights<sp/>reserved.</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the<sp/>distribution.</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Neither<sp/>the<sp/>name<sp/>of<sp/>Texas<sp/>Instruments<sp/>Incorporated<sp/>nor<sp/>the<sp/>names<sp/>of</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>its<sp/>contributors<sp/>may<sp/>be<sp/>used<sp/>to<sp/>endorse<sp/>or<sp/>promote<sp/>products<sp/>derived</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>from<sp/>this<sp/>software<sp/>without<sp/>specific<sp/>prior<sp/>written<sp/>permission.</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>THE<sp/>COPYRIGHT<sp/>HOLDERS<sp/>AND<sp/>CONTRIBUTORS<sp/>&quot;AS<sp/>IS&quot;</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>AND<sp/>ANY<sp/>EXPRESS<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>COPYRIGHT<sp/>OWNER<sp/>OR</highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/>CONTRIBUTORS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,<sp/>SPECIAL,</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/>DATA,<sp/>OR<sp/>PROFITS;</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/>THEORY<sp/>OF<sp/>LIABILITY,</highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/>OF<sp/>THIS<sp/>SOFTWARE,</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="comment">/*!****************************************************************************</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*<sp/>@file<sp/>ECJPAKE.h</highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*<sp/>@brief<sp/><sp/><sp/>TI<sp/>Driver<sp/>for<sp/>Elliptic<sp/>Curve<sp/>Password<sp/>Authenticated<sp/>Key<sp/>Exchange</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>by<sp/>Juggling.</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*<sp/>@anchor<sp/>ti_drivers_ECJPAKE_Overview</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/>*<sp/>#<sp/>Overview<sp/>#</highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/>*<sp/>Elliptic<sp/>Curve<sp/>Password<sp/>Authenticated<sp/>Key<sp/>Exchange<sp/>by<sp/>Juggling<sp/>(EC-JPAKE)</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/>*<sp/>is<sp/>a<sp/>key<sp/>agreement<sp/>scheme<sp/>that<sp/>establishes<sp/>a<sp/>secure<sp/>channel<sp/>over<sp/>an<sp/>insecure</highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/>*<sp/>network.<sp/>It<sp/>only<sp/>requires<sp/>sharing<sp/>a<sp/>password<sp/>offline<sp/>and<sp/>does<sp/>not<sp/>require</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/>*<sp/>public<sp/>key<sp/>infrastructure<sp/>or<sp/>trusted<sp/>third<sp/>parties<sp/>such<sp/>as<sp/>certificate</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/>*<sp/>authorities.</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/>*<sp/>At<sp/>the<sp/>end<sp/>of<sp/>the<sp/>EC-JPAKE<sp/>scheme,<sp/>both<sp/>parties<sp/>derive<sp/>a<sp/>shared<sp/>secret</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/>*<sp/>from<sp/>which<sp/>a<sp/>session<sp/>key<sp/>is<sp/>derived.</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/>*<sp/>The<sp/>scheme<sp/>is<sp/>symmetric.<sp/>Both<sp/>parties<sp/>perform<sp/>the<sp/>exact<sp/>same<sp/>operations</highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/>*<sp/>to<sp/>end<sp/>up<sp/>with<sp/>the<sp/>shared<sp/>secret.</highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="52"><highlight class="comment"><sp/>*<sp/>#<sp/>Steps<sp/>involved<sp/>#</highlight></codeline>
<codeline lineno="53"><highlight class="comment"><sp/>*<sp/>Since<sp/>the<sp/>scheme<sp/>is<sp/>symmetric,<sp/>the<sp/>steps<sp/>involved<sp/>will<sp/>be<sp/>illustrated</highlight></codeline>
<codeline lineno="54"><highlight class="comment"><sp/>*<sp/>using<sp/>Alice<sp/>and<sp/>Bob<sp/>as<sp/>relevant<sp/>parties.</highlight></codeline>
<codeline lineno="55"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="56"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>and<sp/>Bob<sp/>decide<sp/>on<sp/>some<sp/>pre-shared<sp/>secret,<sp/>the<sp/>password,<sp/>and</highlight></codeline>
<codeline lineno="57"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>negotiate<sp/>this<sp/>through<sp/>some<sp/>offline<sp/>means<sp/>such<sp/>as<sp/>during<sp/>commissioning.</highlight></codeline>
<codeline lineno="58"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="59"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>generates<sp/>private<sp/>keys<sp/>x1,<sp/>x2,<sp/>v1,<sp/>and<sp/>v2<sp/>uniformly<sp/>at<sp/>random<sp/>from<sp/>[1,<sp/>n<sp/>-<sp/>1],</highlight></codeline>
<codeline lineno="60"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>where<sp/>n<sp/>is<sp/>the<sp/>order<sp/>of<sp/>the<sp/>curve.</highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>generates<sp/>public<sp/>keys<sp/>X1<sp/>=<sp/>x1<sp/>*<sp/>G,<sp/>X2<sp/>=<sp/>x2<sp/>*<sp/>G,<sp/>V1<sp/>=<sp/>v1<sp/>*<sp/>G,<sp/>and<sp/>V2<sp/>=<sp/>v2<sp/>*<sp/>G.</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>generates<sp/>Zero-Knowledge<sp/>Proofs<sp/>(ZKPs)<sp/>for<sp/>(X1,<sp/>x1)<sp/>and<sp/>(X2,<sp/>x2).</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>The<sp/>required<sp/>hash<sp/>is<sp/>computed<sp/>by<sp/>concatenating<sp/>G,<sp/>V,<sp/>the<sp/>public<sp/>key</highlight></codeline>
<codeline lineno="64"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>the<sp/>ZKP<sp/>authenticates,<sp/>and<sp/>the<sp/>UserID<sp/>of<sp/>the<sp/>authenticator<sp/>and<sp/>hashing</highlight></codeline>
<codeline lineno="65"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>the<sp/>new<sp/>bitstring.<sp/>The<sp/>exact<sp/>order<sp/>and<sp/>formatting<sp/>of<sp/>all<sp/>parameters<sp/>and</highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>any<sp/>extra<sp/>information<sp/>such<sp/>as<sp/>length<sp/>words<sp/>must<sp/>be<sp/>agreed<sp/>upon<sp/>by<sp/>both</highlight></codeline>
<codeline lineno="67"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>parties<sp/>to<sp/>yield<sp/>the<sp/>same<sp/>result.</highlight></codeline>
<codeline lineno="68"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>sends<sp/>X1,<sp/>X2,<sp/>V1,<sp/>V2,<sp/>r1,<sp/>r2,<sp/>and<sp/>her<sp/>UserID<sp/>to<sp/>Bob.</highlight></codeline>
<codeline lineno="69"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="70"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Bob<sp/>generates<sp/>private<sp/>keys<sp/>x3,<sp/>x4,<sp/>v3,<sp/>and<sp/>v4<sp/>uniformly<sp/>at<sp/>random<sp/>from<sp/>[1,<sp/>n<sp/>-<sp/>1],</highlight></codeline>
<codeline lineno="71"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>where<sp/>n<sp/>is<sp/>the<sp/>order<sp/>of<sp/>the<sp/>curve.</highlight></codeline>
<codeline lineno="72"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Bob<sp/>generates<sp/>public<sp/>keys<sp/>X3<sp/>=<sp/>x3<sp/>*<sp/>G,<sp/>X4<sp/>=<sp/>x4<sp/>*<sp/>G,<sp/>V3<sp/>=<sp/>v3<sp/>*<sp/>G,<sp/>and<sp/>V4<sp/>=<sp/>v4<sp/>*<sp/>G.</highlight></codeline>
<codeline lineno="73"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Bob<sp/>generates<sp/>Zero-Knowledge<sp/>Proofs<sp/>(ZKPs)<sp/>for<sp/>(X3,<sp/>x3)<sp/>and<sp/>(X4,<sp/>x4).</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Bob<sp/>sends<sp/>X3,<sp/>X4,<sp/>V3,<sp/>V4,<sp/>r3,<sp/>r4,<sp/>and<sp/>his<sp/>UserID<sp/>to<sp/>Bob.</highlight></codeline>
<codeline lineno="75"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="76"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>and<sp/>Bob<sp/>verify<sp/>the<sp/>other<sp/>parties<sp/>ZKPs<sp/>and<sp/>break<sp/>off<sp/>the<sp/>scheme<sp/>if<sp/>they</highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>do<sp/>not<sp/>check<sp/>out.</highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>computes<sp/>the<sp/>new<sp/>generator<sp/>point<sp/>G2<sp/>=<sp/>(X1<sp/>+<sp/>X3<sp/>+<sp/>X4).</highlight></codeline>
<codeline lineno="80"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>computes<sp/>the<sp/>combined<sp/>private<sp/>key<sp/>x5<sp/>=<sp/>x2<sp/>*<sp/>s,<sp/>where<sp/>s<sp/>is<sp/>the<sp/>pre-shared</highlight></codeline>
<codeline lineno="81"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>secret.</highlight></codeline>
<codeline lineno="82"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>computes<sp/>the<sp/>combined<sp/>public<sp/>key<sp/>X5<sp/>=<sp/>x5<sp/>*<sp/>G2.</highlight></codeline>
<codeline lineno="83"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>computes<sp/>a<sp/>ZKP<sp/>for<sp/>(X5,<sp/>x5)<sp/>using<sp/>G2<sp/>as<sp/>the<sp/>generator<sp/>point<sp/>of<sp/>the<sp/>ZKP.</highlight></codeline>
<codeline lineno="84"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>sends<sp/>X5,<sp/>V5,<sp/>r5,<sp/>and<sp/>her<sp/>UserID<sp/>to<sp/>Bob.</highlight></codeline>
<codeline lineno="85"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="86"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Bob<sp/>computes<sp/>the<sp/>new<sp/>generator<sp/>point<sp/>G3<sp/>=<sp/>(X3<sp/>+<sp/>X1<sp/>+<sp/>X2).</highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Bob<sp/>computes<sp/>the<sp/>combined<sp/>private<sp/>key<sp/>x6<sp/>=<sp/>x4<sp/>*<sp/>s,<sp/>where<sp/>s<sp/>is<sp/>the<sp/>pre-shared</highlight></codeline>
<codeline lineno="88"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>secret.</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Bob<sp/>computes<sp/>the<sp/>combined<sp/>public<sp/>key<sp/>X6<sp/>=<sp/>x6<sp/>*<sp/>G3.</highlight></codeline>
<codeline lineno="90"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Bob<sp/>computes<sp/>a<sp/>ZKP<sp/>for<sp/>(X6,<sp/>x6)<sp/>using<sp/>G3<sp/>as<sp/>the<sp/>generator<sp/>point<sp/>of<sp/>the<sp/>ZKP.</highlight></codeline>
<codeline lineno="91"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Bob<sp/>sends<sp/>X6,<sp/>V6,<sp/>r6,<sp/>and<sp/>his<sp/>UserID<sp/>to<sp/>Alice.</highlight></codeline>
<codeline lineno="92"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="93"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>and<sp/>Bob<sp/>verify<sp/>the<sp/>other<sp/>parties<sp/>ZKPs<sp/>and<sp/>break<sp/>off<sp/>the<sp/>scheme<sp/>if<sp/>they</highlight></codeline>
<codeline lineno="94"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>do<sp/>not<sp/>check<sp/>out.<sp/>This<sp/>involves<sp/>computing<sp/>the<sp/>other<sp/>parties<sp/>generator<sp/>point.</highlight></codeline>
<codeline lineno="95"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="96"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>computes<sp/>shared<sp/>secret<sp/>K<sp/>=<sp/>(X6<sp/>-<sp/>(X4<sp/>*<sp/>x5))<sp/>*<sp/>x2.</highlight></codeline>
<codeline lineno="97"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="98"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Bob<sp/>computes<sp/>shared<sp/>secret<sp/>K<sp/>=<sp/>(X5<sp/>-<sp/>(X2<sp/>*<sp/>x6))<sp/>*<sp/>x4.</highlight></codeline>
<codeline lineno="99"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="100"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Alice<sp/>and<sp/>Bob<sp/>each<sp/>run<sp/>K<sp/>through<sp/>a<sp/>mutually<sp/>agreed<sp/>upon<sp/>key<sp/>derivation</highlight></codeline>
<codeline lineno="101"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>function<sp/>to<sp/>compute<sp/>the<sp/>symmetric<sp/>session<sp/>key.</highlight></codeline>
<codeline lineno="102"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="103"><highlight class="comment"><sp/>*<sp/>@anchor<sp/>ti_drivers_ECJPAKE_Usage</highlight></codeline>
<codeline lineno="104"><highlight class="comment"><sp/>*<sp/>#<sp/>Usage<sp/>#</highlight></codeline>
<codeline lineno="105"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="106"><highlight class="comment"><sp/>*<sp/>##<sp/>Before<sp/>starting<sp/>an<sp/>ECJPAKE<sp/>operation<sp/>#</highlight></codeline>
<codeline lineno="107"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="108"><highlight class="comment"><sp/>*<sp/>Before<sp/>starting<sp/>an<sp/>ECJPAKE<sp/>operation,<sp/>the<sp/>application<sp/>must<sp/>do<sp/>the<sp/>following:</highlight></codeline>
<codeline lineno="109"><highlight class="comment"><sp/>*<sp/>-#<sp/>Call<sp/>ECJPAKE_init()<sp/>to<sp/>initialize<sp/>the<sp/>driver</highlight></codeline>
<codeline lineno="110"><highlight class="comment"><sp/>*<sp/>-#<sp/>Call<sp/>ECJPAKE_Params_init()<sp/>to<sp/>initialize<sp/>the<sp/>ECJPAKE_Params<sp/>to<sp/>default<sp/>values.</highlight></codeline>
<codeline lineno="111"><highlight class="comment"><sp/>*<sp/>-#<sp/>Modify<sp/>the<sp/>ECJPAKE_Params<sp/>as<sp/>desired</highlight></codeline>
<codeline lineno="112"><highlight class="comment"><sp/>*<sp/>-#<sp/>Call<sp/>ECJPAKE_open()<sp/>to<sp/>open<sp/>an<sp/>instance<sp/>of<sp/>the<sp/>driver</highlight></codeline>
<codeline lineno="113"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="114"><highlight class="comment"><sp/>*<sp/>##<sp/>Round<sp/>one<sp/>#</highlight></codeline>
<codeline lineno="115"><highlight class="comment"><sp/>*<sp/>-#<sp/>Initialize<sp/>the<sp/>following<sp/>private<sp/>key<sp/>CryptoKeys.</highlight></codeline>
<codeline lineno="116"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>Seed<sp/>them<sp/>with<sp/>keying<sp/>material<sp/>uniformly<sp/>drawn<sp/>from<sp/>[1,<sp/>n<sp/>-<sp/>1]</highlight></codeline>
<codeline lineno="117"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myPrivateKey1</highlight></codeline>
<codeline lineno="118"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myPrivateKey2</highlight></codeline>
<codeline lineno="119"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myPrivateV1</highlight></codeline>
<codeline lineno="120"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myPrivateV2</highlight></codeline>
<codeline lineno="121"><highlight class="comment"><sp/>*<sp/>-#<sp/>Initialize<sp/>the<sp/>following<sp/>blank<sp/>public<sp/>key<sp/>CryptoKeys:</highlight></codeline>
<codeline lineno="122"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myPublicKey1</highlight></codeline>
<codeline lineno="123"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myPublicKey2</highlight></codeline>
<codeline lineno="124"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myPublicV1</highlight></codeline>
<codeline lineno="125"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myPublicV2</highlight></codeline>
<codeline lineno="126"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>theirPublicKey1</highlight></codeline>
<codeline lineno="127"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>theirPublicKey2</highlight></codeline>
<codeline lineno="128"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>theirPublicV1</highlight></codeline>
<codeline lineno="129"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>theirPublicV2</highlight></codeline>
<codeline lineno="130"><highlight class="comment"><sp/>*<sp/>-#<sp/>Call<sp/>ECJPAKE_roundOneGenerateKeys()<sp/>to<sp/>generate<sp/>all<sp/>round<sp/>one<sp/>keys<sp/>as<sp/>needed.</highlight></codeline>
<codeline lineno="131"><highlight class="comment"><sp/>*<sp/>-#<sp/>Generate<sp/>the<sp/>hashes<sp/>for<sp/>the<sp/>ZKPs<sp/>using<sp/>previously<sp/>agreed<sp/>upon<sp/>formatting.</highlight></codeline>
<codeline lineno="132"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>Use<sp/>the<sp/>default<sp/>generator<sp/>point<sp/>of<sp/>the<sp/>curve<sp/>in<sp/>the<sp/>first<sp/>round.</highlight></codeline>
<codeline lineno="133"><highlight class="comment"><sp/>*<sp/>-#<sp/>Generate<sp/>your<sp/>two<sp/>ZKPs<sp/>by<sp/>calling<sp/>ECJPAKE_generateZKP()<sp/>once<sp/>per<sp/>ZKP.</highlight></codeline>
<codeline lineno="134"><highlight class="comment"><sp/>*<sp/>-#<sp/>Exchange<sp/>public<sp/>keys,<sp/>UserIDs,<sp/>and<sp/>ZKP<sp/>signatures.<sp/>Write<sp/>the<sp/>received<sp/>keying</highlight></codeline>
<codeline lineno="135"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>material<sp/>into<sp/>the<sp/>relevant<sp/>buffers<sp/>or<sp/>load<sp/>them<sp/>into<sp/>key<sp/>stores<sp/>as<sp/>specified</highlight></codeline>
<codeline lineno="136"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>by<sp/>the<sp/>CryptoKeys<sp/>initialised<sp/>earlier.</highlight></codeline>
<codeline lineno="137"><highlight class="comment"><sp/>*<sp/>-#<sp/>Verify<sp/>the<sp/>other<sp/>party&apos;s<sp/>ZKPs<sp/>after<sp/>computing<sp/>their<sp/>ZKP<sp/>hash<sp/>by<sp/>calling</highlight></codeline>
<codeline lineno="138"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>ECJPAKE_verifyZKP()<sp/>once<sp/>per<sp/>ZKP.</highlight></codeline>
<codeline lineno="139"><highlight class="comment"><sp/>*<sp/>-#<sp/>You<sp/>can<sp/>now<sp/>let<sp/>all<sp/>V<sp/>keys,<sp/>myPrivateKey1,<sp/>and<sp/>all<sp/>ZKP<sp/>signatures<sp/>go<sp/>out<sp/>of<sp/>scope</highlight></codeline>
<codeline lineno="140"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>and<sp/>re-use<sp/>their<sp/>memory.</highlight></codeline>
<codeline lineno="141"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="142"><highlight class="comment"><sp/>*<sp/>##<sp/>Round<sp/>two<sp/>#</highlight></codeline>
<codeline lineno="143"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Initialize<sp/>the<sp/>following<sp/>private<sp/>key<sp/>CryptoKeys.</highlight></codeline>
<codeline lineno="144"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>Seed<sp/>myPrivateV<sp/>with<sp/>keying<sp/>material<sp/>uniformly<sp/>drawn<sp/>from<sp/>[1,<sp/>n<sp/>-<sp/>1].</highlight></codeline>
<codeline lineno="145"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>Initialise<sp/>the<sp/>preSharedSecret<sp/>with<sp/>the<sp/>common<sp/>keying<sp/>material<sp/>previously</highlight></codeline>
<codeline lineno="146"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>shared<sp/>between<sp/>you<sp/>and<sp/>the<sp/>other<sp/>party.</highlight></codeline>
<codeline lineno="147"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>preSharedSecret</highlight></codeline>
<codeline lineno="148"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myCombinedPrivateKey</highlight></codeline>
<codeline lineno="149"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Initialize<sp/>the<sp/>following<sp/>blank<sp/>public<sp/>key<sp/>CryptoKeys:</highlight></codeline>
<codeline lineno="150"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>theirNewGenerator</highlight></codeline>
<codeline lineno="151"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myNewGenerator</highlight></codeline>
<codeline lineno="152"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myCombinedPublicKey</highlight></codeline>
<codeline lineno="153"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>myPublicV</highlight></codeline>
<codeline lineno="154"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Call<sp/>ECJPAKE_roundTwoGenerateKeys()<sp/>to<sp/>generate<sp/>the<sp/>remaining<sp/>round<sp/>two<sp/>keys.</highlight></codeline>
<codeline lineno="155"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Generate<sp/>the<sp/>hash<sp/>for<sp/>your<sp/>ZKP<sp/>use<sp/>myNewGenerator<sp/>as<sp/>your<sp/>generator<sp/>point.</highlight></codeline>
<codeline lineno="156"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Exchange<sp/>public<sp/>keys,<sp/>UserIDs,<sp/>and<sp/>ZKP<sp/>signatures.<sp/>Write<sp/>the<sp/>received<sp/>keying</highlight></codeline>
<codeline lineno="157"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>material<sp/>into<sp/>the<sp/>relevant<sp/>buffers<sp/>or<sp/>load<sp/>them<sp/>into<sp/>key<sp/>stores<sp/>as<sp/>specified</highlight></codeline>
<codeline lineno="158"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>by<sp/>the<sp/>CryptoKeys<sp/>initialised<sp/>earlier.</highlight></codeline>
<codeline lineno="159"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>Verify<sp/>the<sp/>other<sp/>party&apos;s<sp/>ZKP<sp/>after<sp/>computing<sp/>their<sp/>ZKP<sp/>hash<sp/>b<sp/>calling</highlight></codeline>
<codeline lineno="160"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>ECJPAKE_verifyZKP().<sp/>Use<sp/>theirNewGenerator<sp/>as<sp/>the<sp/>generator<sp/>point<sp/>for<sp/>this</highlight></codeline>
<codeline lineno="161"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>ZKP.</highlight></codeline>
<codeline lineno="162"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/>You<sp/>can<sp/>now<sp/>let<sp/>all<sp/>keys<sp/>and<sp/>keying<sp/>material<sp/>but<sp/>myCombinedPrivateKey,</highlight></codeline>
<codeline lineno="163"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>theirCombinedPublicKey,<sp/>theirPublicKey2,<sp/>and<sp/>myPrivateKey2<sp/>go<sp/>out<sp/>of<sp/>scope.</highlight></codeline>
<codeline lineno="164"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="165"><highlight class="comment"><sp/>*<sp/>##<sp/>Computing<sp/>the<sp/>shared<sp/>secret<sp/>#</highlight></codeline>
<codeline lineno="166"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/><sp/>Initialize<sp/>the<sp/>following<sp/>blank<sp/>public<sp/>key<sp/>CryptoKey:</highlight></codeline>
<codeline lineno="167"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>sharedSecret</highlight></codeline>
<codeline lineno="168"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/><sp/>Call<sp/>ECJPAKE_computeSharedSecret().</highlight></codeline>
<codeline lineno="169"><highlight class="comment"><sp/>*<sp/><sp/>-#<sp/><sp/>Run<sp/>sharedSecret<sp/>through<sp/>a<sp/>key<sp/>derivation<sp/>function<sp/>to<sp/>compute<sp/>the<sp/>shared</highlight></codeline>
<codeline lineno="170"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>symmetric<sp/>session<sp/>key.</highlight></codeline>
<codeline lineno="171"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="172"><highlight class="comment"><sp/>*<sp/>##<sp/>Key<sp/>Formatting</highlight></codeline>
<codeline lineno="173"><highlight class="comment"><sp/>*<sp/>The<sp/>ECJPAKE<sp/>API<sp/>expects<sp/>the<sp/>private<sp/>and<sp/>public<sp/>keys<sp/>to<sp/>be<sp/>formatted<sp/>in<sp/>octet</highlight></codeline>
<codeline lineno="174"><highlight class="comment"><sp/>*<sp/>string<sp/>format.<sp/>The<sp/>details<sp/>of<sp/>octet<sp/>string<sp/>formatting<sp/>can<sp/>be<sp/>found<sp/>in</highlight></codeline>
<codeline lineno="175"><highlight class="comment"><sp/>*<sp/>SEC<sp/>1:<sp/>Elliptic<sp/>Curve<sp/>Cryptography.</highlight></codeline>
<codeline lineno="176"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="177"><highlight class="comment"><sp/>*<sp/>Private<sp/>keys<sp/>and<sp/>V&apos;s<sp/>are<sp/>formatted<sp/>as<sp/>big-endian<sp/>integers<sp/>of<sp/>the<sp/>same<sp/>length</highlight></codeline>
<codeline lineno="178"><highlight class="comment"><sp/>*<sp/>as<sp/>the<sp/>curve<sp/>length.</highlight></codeline>
<codeline lineno="179"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="180"><highlight class="comment"><sp/>*<sp/>Public<sp/>keys,<sp/>public<sp/>V&apos;s,<sp/>generator<sp/>points,<sp/>and<sp/>shared<sp/>secrets<sp/>are<sp/>points<sp/>on</highlight></codeline>
<codeline lineno="181"><highlight class="comment"><sp/>*<sp/>an<sp/>elliptic<sp/>curve.<sp/>These<sp/>points<sp/>can<sp/>be<sp/>expressed<sp/>in<sp/>several<sp/>ways.</highlight></codeline>
<codeline lineno="182"><highlight class="comment"><sp/>*<sp/>This<sp/>API<sp/>uses<sp/>points<sp/>expressed<sp/>in<sp/>uncompressed<sp/>affine<sp/>coordinates<sp/>by<sp/>default.</highlight></codeline>
<codeline lineno="183"><highlight class="comment"><sp/>*<sp/>The<sp/>octet<sp/>string<sp/>format<sp/>requires<sp/>a<sp/>formatting<sp/>byte<sp/>in<sp/>the<sp/>first<sp/>byte<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="184"><highlight class="comment"><sp/>*<sp/>public<sp/>key.<sp/>When<sp/>using<sp/>uncompressed<sp/>affine<sp/>coordinates,<sp/>this<sp/>is<sp/>the<sp/>value</highlight></codeline>
<codeline lineno="185"><highlight class="comment"><sp/>*<sp/>0x04.</highlight></codeline>
<codeline lineno="186"><highlight class="comment"><sp/>*<sp/>The<sp/>point<sp/>itself<sp/>is<sp/>stored<sp/>as<sp/>a<sp/>concatenated<sp/>array<sp/>of<sp/>X<sp/>followed<sp/>by<sp/>Y.</highlight></codeline>
<codeline lineno="187"><highlight class="comment"><sp/>*<sp/>X<sp/>and<sp/>Y<sp/>are<sp/>big-endian.<sp/>Some<sp/>implementations<sp/>do<sp/>not<sp/>require<sp/>or<sp/>yield</highlight></codeline>
<codeline lineno="188"><highlight class="comment"><sp/>*<sp/>the<sp/>Y<sp/>coordinate<sp/>for<sp/>ECJPAKE<sp/>on<sp/>certain<sp/>curves.<sp/>It<sp/>is<sp/>recommended<sp/>that<sp/>the<sp/>full</highlight></codeline>
<codeline lineno="189"><highlight class="comment"><sp/>*<sp/>keying<sp/>material<sp/>buffer<sp/>of<sp/>twice<sp/>the<sp/>curve<sp/>param<sp/>length<sp/>is<sp/>used<sp/>to<sp/>facilitate</highlight></codeline>
<codeline lineno="190"><highlight class="comment"><sp/>*<sp/>code-reuse.<sp/>Implementations<sp/>that<sp/>do<sp/>not<sp/>use<sp/>the<sp/>Y<sp/>coordinate<sp/>will<sp/>zero-out</highlight></codeline>
<codeline lineno="191"><highlight class="comment"><sp/>*<sp/>the<sp/>Y-coordinate<sp/>whenever<sp/>they<sp/>write<sp/>a<sp/>point<sp/>to<sp/>the<sp/>CryptoKey.</highlight></codeline>
<codeline lineno="192"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="193"><highlight class="comment"><sp/>*<sp/>This<sp/>API<sp/>accepts<sp/>and<sp/>returns<sp/>the<sp/>keying<sp/>material<sp/>of<sp/>public<sp/>keys<sp/>according</highlight></codeline>
<codeline lineno="194"><highlight class="comment"><sp/>*<sp/>to<sp/>the<sp/>following<sp/>table:</highlight></codeline>
<codeline lineno="195"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="196"><highlight class="comment"><sp/>*<sp/>|<sp/>Curve<sp/>Type<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>Keying<sp/>Material<sp/>Array<sp/>|<sp/>Array<sp/>Length<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline lineno="197"><highlight class="comment"><sp/>*<sp/>|--------------------|-----------------------|----------------------------|</highlight></codeline>
<codeline lineno="198"><highlight class="comment"><sp/>*<sp/>|<sp/>Short<sp/>Weierstrass<sp/><sp/>|<sp/>[0x04,<sp/>X,<sp/>Y]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>1<sp/>+<sp/>2<sp/>*<sp/>Curve<sp/>Param<sp/>Length<sp/>|</highlight></codeline>
<codeline lineno="199"><highlight class="comment"><sp/>*<sp/>|<sp/>Montgomery<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>[0x04,<sp/>X,<sp/>Y]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>1<sp/>+<sp/>2<sp/>*<sp/>Curve<sp/>Param<sp/>Length<sp/>|</highlight></codeline>
<codeline lineno="200"><highlight class="comment"><sp/>*<sp/>|<sp/>Edwards<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>[0x04,<sp/>X,<sp/>Y]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>|<sp/>1<sp/>+<sp/>2<sp/>*<sp/>Curve<sp/>Param<sp/>Length<sp/>|</highlight></codeline>
<codeline lineno="201"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="202"><highlight class="comment"><sp/>*<sp/>The<sp/>r<sp/>component<sp/>of<sp/>the<sp/>ZKP<sp/>signature,<sp/>hash,<sp/>and<sp/>preSharedSecret<sp/>also<sp/>all</highlight></codeline>
<codeline lineno="203"><highlight class="comment"><sp/>*<sp/>use<sp/>the<sp/>octet<sp/>string<sp/>format.<sp/>They<sp/>are<sp/>interpreted<sp/>as<sp/>big-endian<sp/>integers.</highlight></codeline>
<codeline lineno="204"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="205"><highlight class="comment"><sp/>*<sp/>@anchor<sp/>ti_drivers_ECJPAKE_Synopsis</highlight></codeline>
<codeline lineno="206"><highlight class="comment"><sp/>*<sp/>##<sp/>Synopsis</highlight></codeline>
<codeline lineno="207"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="208"><highlight class="comment"><sp/>*<sp/>@anchor<sp/>ti_drivers_ECJPAKE_Synopsis_Code</highlight></codeline>
<codeline lineno="209"><highlight class="comment"><sp/>*<sp/>@code</highlight></codeline>
<codeline lineno="210"><highlight class="comment"><sp/>*<sp/>//<sp/>Import<sp/>ECJPAKE<sp/>Driver<sp/>definitions</highlight></codeline>
<codeline lineno="211"><highlight class="comment"><sp/>*<sp/>#include<sp/>&lt;ti/drivers/ECJPAKE.h&gt;</highlight></codeline>
<codeline lineno="212"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="213"><highlight class="comment"><sp/>*<sp/>ECJPAKE_init();</highlight></codeline>
<codeline lineno="214"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="215"><highlight class="comment"><sp/>*<sp/>//<sp/>Since<sp/>we<sp/>are<sp/>using<sp/>default<sp/>ECJPAKE_Params,<sp/>we<sp/>just<sp/>pass<sp/>in<sp/>NULL<sp/>for<sp/>that<sp/>parameter.</highlight></codeline>
<codeline lineno="216"><highlight class="comment"><sp/>*<sp/>ecjpakeHandle<sp/>=<sp/>ECJPAKE_open(0,<sp/>NULL);</highlight></codeline>
<codeline lineno="217"><highlight class="comment"></highlight></codeline>
<codeline lineno="218"><highlight class="comment"><sp/>*<sp/>ECJPAKE_Handle<sp/>handle<sp/>=<sp/>ECJPAKE_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline lineno="219"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="220"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationRoundOneGenerateKeys<sp/><sp/><sp/>operationRoundOneGenerateKeys;</highlight></codeline>
<codeline lineno="221"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationRoundTwoGenerateKeys<sp/><sp/><sp/>operationRoundTwoGenerateKeys;</highlight></codeline>
<codeline lineno="222"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationGenerateZKP<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationGenerateZKP;</highlight></codeline>
<codeline lineno="223"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationVerifyZKP<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationVerifyZKP;</highlight></codeline>
<codeline lineno="224"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationComputeSharedSecret<sp/><sp/><sp/><sp/>operationComputeSharedSecret;</highlight></codeline>
<codeline lineno="225"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="226"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>my<sp/>round<sp/>one<sp/>keys</highlight></codeline>
<codeline lineno="227"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationRoundOneGenerateKeys_init(&amp;operationRoundOneGenerateKeys);</highlight></codeline>
<codeline lineno="228"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="229"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPrivateKey1<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey1;</highlight></codeline>
<codeline lineno="230"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPrivateKey2<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline lineno="231"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey1;</highlight></codeline>
<codeline lineno="232"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey2;</highlight></codeline>
<codeline lineno="233"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPrivateV1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV1;</highlight></codeline>
<codeline lineno="234"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPrivateV2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV2;</highlight></codeline>
<codeline lineno="235"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPublicV1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV1;</highlight></codeline>
<codeline lineno="236"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPublicV2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV2;</highlight></codeline>
<codeline lineno="237"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="238"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_roundOneGenerateKeys(handle,<sp/>&amp;operationRoundOneGenerateKeys);</highlight></codeline>
<codeline lineno="239"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="240"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>hashes<sp/>here</highlight></codeline>
<codeline lineno="241"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="242"><highlight class="comment"><sp/>*<sp/>//<sp/>generate<sp/>my<sp/>round<sp/>one<sp/>ZKPs</highlight></codeline>
<codeline lineno="243"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="244"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="245"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey1;</highlight></codeline>
<codeline lineno="246"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV1;</highlight></codeline>
<codeline lineno="247"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash1;</highlight></codeline>
<codeline lineno="248"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR1;</highlight></codeline>
<codeline lineno="249"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="250"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="251"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="252"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="253"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="254"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline lineno="255"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV2;</highlight></codeline>
<codeline lineno="256"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash2;</highlight></codeline>
<codeline lineno="257"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR2;</highlight></codeline>
<codeline lineno="258"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="259"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="260"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="261"><highlight class="comment"><sp/>*<sp/>//<sp/>Do<sp/>ZKP<sp/>and<sp/>key<sp/>transmission<sp/>here</highlight></codeline>
<codeline lineno="262"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="263"><highlight class="comment"><sp/>*<sp/>//<sp/>Verify<sp/>their<sp/>round<sp/>one<sp/>ZKPs</highlight></codeline>
<codeline lineno="264"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>their<sp/>hashes<sp/>here</highlight></codeline>
<codeline lineno="265"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="266"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="267"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="268"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="269"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey1;</highlight></codeline>
<codeline lineno="270"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV1;</highlight></codeline>
<codeline lineno="271"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash1;</highlight></codeline>
<codeline lineno="272"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR1;</highlight></codeline>
<codeline lineno="273"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="274"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,<sp/>&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="275"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="276"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="277"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="278"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="279"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline lineno="280"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV2;</highlight></codeline>
<codeline lineno="281"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash2;</highlight></codeline>
<codeline lineno="282"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR2;</highlight></codeline>
<codeline lineno="283"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="284"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="285"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="286"><highlight class="comment"><sp/>*<sp/>//<sp/>Round<sp/>two<sp/>starts<sp/>now</highlight></codeline>
<codeline lineno="287"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="288"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>my<sp/>round<sp/>two<sp/>keys</highlight></codeline>
<codeline lineno="289"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationRoundTwoGenerateKeys_init(&amp;operationRoundTwoGenerateKeys);</highlight></codeline>
<codeline lineno="290"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="291"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myPrivateKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline lineno="292"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey1;</highlight></codeline>
<codeline lineno="293"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey2;</highlight></codeline>
<codeline lineno="294"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.theirPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey1;</highlight></codeline>
<codeline lineno="295"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.theirPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline lineno="296"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.preSharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;preSharedSecretCryptoKey;</highlight></codeline>
<codeline lineno="297"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.theirNewGenerator<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirGeneratorKey;</highlight></codeline>
<codeline lineno="298"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myNewGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myGeneratorKey;</highlight></codeline>
<codeline lineno="299"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myCombinedPrivateKey<sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline lineno="300"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myCombinedPublicKey<sp/><sp/><sp/>=<sp/>&amp;myCombinedPublicKey;</highlight></codeline>
<codeline lineno="301"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV3;</highlight></codeline>
<codeline lineno="302"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV3;</highlight></codeline>
<codeline lineno="303"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="304"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_roundTwoGenerateKeys(handle,<sp/>&amp;operationRoundTwoGenerateKeys);</highlight></codeline>
<codeline lineno="305"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="306"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>my<sp/>round<sp/><sp/>two<sp/>ZKP</highlight></codeline>
<codeline lineno="307"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>the<sp/>round<sp/>two<sp/>hash<sp/>here</highlight></codeline>
<codeline lineno="308"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="309"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="310"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="311"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline lineno="312"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV3;</highlight></codeline>
<codeline lineno="313"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash3;</highlight></codeline>
<codeline lineno="314"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR3;</highlight></codeline>
<codeline lineno="315"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="316"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="317"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="318"><highlight class="comment"><sp/>*<sp/>//<sp/>Exchange<sp/>keys<sp/>and<sp/>ZKPs<sp/>again</highlight></codeline>
<codeline lineno="319"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="320"><highlight class="comment"><sp/>*<sp/>//<sp/>Verify<sp/>their<sp/>second<sp/>round<sp/>ZKP</highlight></codeline>
<codeline lineno="321"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>their<sp/>round<sp/>two<sp/>hash<sp/>here</highlight></codeline>
<codeline lineno="322"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="323"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="324"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="325"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirGeneratorKey;</highlight></codeline>
<codeline lineno="326"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirCombinedPublicKey;</highlight></codeline>
<codeline lineno="327"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV3;</highlight></codeline>
<codeline lineno="328"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash3;</highlight></codeline>
<codeline lineno="329"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR3;</highlight></codeline>
<codeline lineno="330"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="331"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,<sp/>&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="332"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="333"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>shared<sp/>secret</highlight></codeline>
<codeline lineno="334"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationComputeSharedSecret_init(&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline lineno="335"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="336"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.myCombinedPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline lineno="337"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.theirCombinedPublicKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirCombinedPublicKey;</highlight></codeline>
<codeline lineno="338"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.theirPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline lineno="339"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.myPrivateKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline lineno="340"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.sharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;sharedSecretCryptoKey;</highlight></codeline>
<codeline lineno="341"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="342"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/><sp/>ECJPAKE_computeSharedSecret(handle,<sp/>&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline lineno="343"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="344"><highlight class="comment"><sp/>*<sp/>//<sp/>Close<sp/>the<sp/>driver</highlight></codeline>
<codeline lineno="345"><highlight class="comment"><sp/>*<sp/>ECJPAKE_close(handle);</highlight></codeline>
<codeline lineno="346"><highlight class="comment"><sp/>*<sp/>@endcode</highlight></codeline>
<codeline lineno="347"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="348"><highlight class="comment"><sp/>*<sp/>@anchor<sp/>ti_drivers_ECJPAKE_Examples</highlight></codeline>
<codeline lineno="349"><highlight class="comment"><sp/>*<sp/>#<sp/>Examples<sp/>#</highlight></codeline>
<codeline lineno="350"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="351"><highlight class="comment"><sp/>*<sp/>##<sp/>Basic<sp/>ECJPAKE<sp/>exchange<sp/>#</highlight></codeline>
<codeline lineno="352"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="353"><highlight class="comment"><sp/>*<sp/>@code</highlight></codeline>
<codeline lineno="354"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="355"><highlight class="comment"><sp/>*<sp/>#define<sp/>NISTP256_CURVE_LENGTH_BYTES<sp/>32</highlight></codeline>
<codeline lineno="356"><highlight class="comment"><sp/>*<sp/>#define<sp/>OCTET_STRING_OFFSET<sp/>1</highlight></codeline>
<codeline lineno="357"><highlight class="comment"><sp/>*<sp/>#define<sp/>NISTP256_PRIVATE_KEY_LENGTH_BYTES<sp/>NISTP256_CURVE_LENGTH_BYTES</highlight></codeline>
<codeline lineno="358"><highlight class="comment"><sp/>*<sp/>#define<sp/>NISTP256_PUBLIC_KEY_LENGTH_BYTES<sp/>(NISTP256_CURVE_LENGTH_BYTES<sp/>*<sp/>2<sp/>+<sp/>OCTET_STRING_OFFSET)</highlight></codeline>
<codeline lineno="359"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="360"><highlight class="comment"><sp/>*<sp/>//<sp/>My<sp/>fixed<sp/>keying<sp/>material</highlight></codeline>
<codeline lineno="361"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPrivateKeyMaterial1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="362"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPrivateKeyMaterial2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="363"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPrivateVMaterial1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="364"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPrivateVMaterial2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="365"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPrivateVMaterial3[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="366"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myHash1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="367"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myHash2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="368"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myHash3[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="369"><highlight class="comment"><sp/>*<sp/>//<sp/>My<sp/>derived<sp/>keying<sp/>material</highlight></codeline>
<codeline lineno="370"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myR1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="371"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myR2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="372"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myR3[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="373"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPublicKeyMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="374"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPublicKeyMaterial2[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="375"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPublicVMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="376"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPublicVMaterial2[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="377"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myPublicVMaterial3[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="378"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myCombinedPublicKeyMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="379"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myCombinedPrivateKeyMaterial1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="380"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>myGenerator[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="381"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="382"><highlight class="comment"><sp/>*<sp/>//<sp/>Their<sp/>fixed<sp/>keying<sp/>material</highlight></codeline>
<codeline lineno="383"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirHash1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="384"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirHash2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="385"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirHash3[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="386"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="387"><highlight class="comment"><sp/>*<sp/>//<sp/>Their<sp/>derived<sp/>keying<sp/>material</highlight></codeline>
<codeline lineno="388"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirR1[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="389"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirR2[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="390"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirR3[NISTP256_PRIVATE_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="391"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirPublicKeyMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="392"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirPublicKeyMaterial2[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="393"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirPublicVMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="394"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirPublicVMaterial2[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="395"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirPublicVMaterial3[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="396"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirCombinedPublicKeyMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="397"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>theirGenerator[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="398"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="399"><highlight class="comment"><sp/>*<sp/>//<sp/><sp/>Shared<sp/>secrets</highlight></codeline>
<codeline lineno="400"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>preSharedSecretKeyingMaterial[NISTP256_PRIVATE_KEY_LENGTH_BYTES]<sp/>=<sp/>&quot;This<sp/>is<sp/>our<sp/>password&quot;;</highlight></codeline>
<codeline lineno="401"><highlight class="comment"><sp/>*<sp/>uint8_t<sp/>sharedSecretKeyingMaterial1[NISTP256_PUBLIC_KEY_LENGTH_BYTES];</highlight></codeline>
<codeline lineno="402"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="403"><highlight class="comment"><sp/>*<sp/>//<sp/>Pre-Shared<sp/>Secret<sp/>Key</highlight></codeline>
<codeline lineno="404"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>preSharedSecretCryptoKey;</highlight></codeline>
<codeline lineno="405"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="406"><highlight class="comment"><sp/>*<sp/>//<sp/>Final<sp/>shared<sp/>secret<sp/>keys</highlight></codeline>
<codeline lineno="407"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>sharedSecretCryptoKey;</highlight></codeline>
<codeline lineno="408"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="409"><highlight class="comment"><sp/>*<sp/>//<sp/>My&apos;s<sp/>keys</highlight></codeline>
<codeline lineno="410"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPrivateCryptoKey1;</highlight></codeline>
<codeline lineno="411"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPrivateCryptoKey2;</highlight></codeline>
<codeline lineno="412"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPrivateCryptoV1;</highlight></codeline>
<codeline lineno="413"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPrivateCryptoV2;</highlight></codeline>
<codeline lineno="414"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPrivateCryptoV3;</highlight></codeline>
<codeline lineno="415"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myCombinedPrivateKey;</highlight></codeline>
<codeline lineno="416"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="417"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPublicCryptoKey1;</highlight></codeline>
<codeline lineno="418"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPublicCryptoKey2;</highlight></codeline>
<codeline lineno="419"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPublicCryptoV1;</highlight></codeline>
<codeline lineno="420"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPublicCryptoV2;</highlight></codeline>
<codeline lineno="421"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myPublicCryptoV3;</highlight></codeline>
<codeline lineno="422"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myCombinedPublicKey;</highlight></codeline>
<codeline lineno="423"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>myGeneratorKey;</highlight></codeline>
<codeline lineno="424"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="425"><highlight class="comment"><sp/>*<sp/>//<sp/>Their&apos;s<sp/>Keys</highlight></codeline>
<codeline lineno="426"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>theirPublicCryptoKey1;</highlight></codeline>
<codeline lineno="427"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>theirPublicCryptoKey2;</highlight></codeline>
<codeline lineno="428"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>theirPublicCryptoV1;</highlight></codeline>
<codeline lineno="429"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>theirPublicCryptoV2;</highlight></codeline>
<codeline lineno="430"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>theirPublicCryptoV3;</highlight></codeline>
<codeline lineno="431"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>theirCombinedPublicKey;</highlight></codeline>
<codeline lineno="432"><highlight class="comment"><sp/>*<sp/>CryptoKey<sp/>theirGeneratorKey;</highlight></codeline>
<codeline lineno="433"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="434"><highlight class="comment"><sp/>*<sp/>//<sp/>NISTP256<sp/>generator</highlight></codeline>
<codeline lineno="435"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(NULL,<sp/>ECCParams_NISTP256.generatorX,<sp/>sizeof(ECCParams_NISTP256.length<sp/>*<sp/>2));</highlight></codeline>
<codeline lineno="436"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="437"><highlight class="comment"><sp/>*<sp/>//<sp/>Pre-shared<sp/>secret</highlight></codeline>
<codeline lineno="438"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;preSharedSecretCryptoKey,<sp/>preSharedSecretKeyingMaterial,</highlight></codeline>
<codeline lineno="439"><highlight class="comment"><sp/>sizeof(preSharedSecretKeyingMaterial));</highlight></codeline>
<codeline lineno="440"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="441"><highlight class="comment"><sp/>*<sp/>//<sp/>Final<sp/>shared<sp/>secret<sp/>key</highlight></codeline>
<codeline lineno="442"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;sharedSecretCryptoKey,<sp/>sharedSecretKeyingMaterial1,<sp/>sizeof(sharedSecretKeyingMaterial1));</highlight></codeline>
<codeline lineno="443"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;sharedSecretCryptoKey2,<sp/>sharedSecretKeyingMaterial2,</highlight></codeline>
<codeline lineno="444"><highlight class="comment"><sp/>sizeof(sharedSecretKeyingMaterial2));</highlight></codeline>
<codeline lineno="445"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="446"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="447"><highlight class="comment"><sp/>*<sp/>//<sp/>My<sp/>keys</highlight></codeline>
<codeline lineno="448"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="449"><highlight class="comment"><sp/>*<sp/>//<sp/>This<sp/>example<sp/>assumes<sp/>that<sp/>the<sp/>private<sp/>keying<sp/>material<sp/>buffers<sp/>already</highlight></codeline>
<codeline lineno="450"><highlight class="comment"><sp/>*<sp/>//<sp/>contains<sp/>random<sp/>bytes.<sp/>Otherwise,<sp/>we<sp/>need<sp/>to<sp/>use<sp/>a<sp/>TRNG<sp/>or<sp/>DRBG<sp/>to<sp/>fill</highlight></codeline>
<codeline lineno="451"><highlight class="comment"><sp/>*<sp/>//<sp/>them<sp/>after<sp/>initialising<sp/>the<sp/>CryptoKeys.</highlight></codeline>
<codeline lineno="452"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateCryptoKey1,<sp/>myPrivateKeyMaterial1,<sp/>sizeof(myPrivateKeyMaterial1));</highlight></codeline>
<codeline lineno="453"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateCryptoKey2,<sp/>myPrivateKeyMaterial2,<sp/>sizeof(myPrivateKeyMaterial2));</highlight></codeline>
<codeline lineno="454"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateCryptoV1,<sp/>myPrivateVMaterial1,<sp/>sizeof(myPrivateVMaterial1));</highlight></codeline>
<codeline lineno="455"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateCryptoV2,<sp/>myPrivateVMaterial2,<sp/>sizeof(myPrivateVMaterial2));</highlight></codeline>
<codeline lineno="456"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initKey(&amp;myPrivateCryptoV3,<sp/>myPrivateVMaterial3,<sp/>sizeof(myPrivateVMaterial3));</highlight></codeline>
<codeline lineno="457"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="458"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicCryptoKey1,<sp/>myPublicKeyMaterial1,<sp/>sizeof(myPublicKeyMaterial1));</highlight></codeline>
<codeline lineno="459"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicCryptoKey2,<sp/>myPublicKeyMaterial2,<sp/>sizeof(myPublicKeyMaterial2));</highlight></codeline>
<codeline lineno="460"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicCryptoV1,<sp/>myPublicVMaterial1,<sp/>sizeof(myPublicVMaterial1));</highlight></codeline>
<codeline lineno="461"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicCryptoV2,<sp/>myPublicVMaterial2,<sp/>sizeof(myPublicVMaterial2));</highlight></codeline>
<codeline lineno="462"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;myPublicCryptoV3,<sp/>myPublicVMaterial3,<sp/>sizeof(myPublicVMaterial3));</highlight></codeline>
<codeline lineno="463"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;myCombinedPrivateKey,<sp/>myCombinedPrivateKeyMaterial1,</highlight></codeline>
<codeline lineno="464"><highlight class="comment"><sp/>sizeof(myCombinedPrivateKeyMaterial1));</highlight></codeline>
<codeline lineno="465"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;myCombinedPublicKey,<sp/>myCombinedPublicKeyMaterial1,</highlight></codeline>
<codeline lineno="466"><highlight class="comment"><sp/>sizeof(myCombinedPublicKeyMaterial1));</highlight></codeline>
<codeline lineno="467"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;myGeneratorKey,<sp/>myGenerator,<sp/>sizeof(myGenerator));</highlight></codeline>
<codeline lineno="468"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="469"><highlight class="comment"><sp/>*<sp/>//<sp/>Their<sp/>keys</highlight></codeline>
<codeline lineno="470"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirPublicCryptoKey1,<sp/>theirPublicKeyMaterial1,<sp/>sizeof(theirPublicKeyMaterial1));</highlight></codeline>
<codeline lineno="471"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirPublicCryptoKey2,<sp/>theirPublicKeyMaterial2,<sp/>sizeof(theirPublicKeyMaterial2));</highlight></codeline>
<codeline lineno="472"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirPublicCryptoV1,<sp/>theirPublicVMaterial1,<sp/>sizeof(theirPublicVMaterial1));</highlight></codeline>
<codeline lineno="473"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirPublicCryptoV2,<sp/>theirPublicVMaterial2,<sp/>sizeof(theirPublicVMaterial2));</highlight></codeline>
<codeline lineno="474"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirPublicCryptoV3,<sp/>theirPublicVMaterial3,<sp/>sizeof(theirPublicVMaterial3));</highlight></codeline>
<codeline lineno="475"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirCombinedPublicKey,<sp/>theirCombinedPublicKeyMaterial1,</highlight></codeline>
<codeline lineno="476"><highlight class="comment"><sp/>sizeof(theirCombinedPublicKeyMaterial1));</highlight></codeline>
<codeline lineno="477"><highlight class="comment"><sp/>*<sp/>CryptoKeyPlaintext_initBlankKey(&amp;theirGeneratorKey,<sp/>theirGenerator,<sp/>sizeof(theirGenerator));</highlight></codeline>
<codeline lineno="478"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="479"><highlight class="comment"><sp/>*<sp/>//<sp/>Initial<sp/>driver<sp/>setup</highlight></codeline>
<codeline lineno="480"><highlight class="comment"><sp/>*<sp/>ECJPAKE_Params<sp/>params;</highlight></codeline>
<codeline lineno="481"><highlight class="comment"><sp/>*<sp/>ECJPAKE_Params_init(&amp;params);</highlight></codeline>
<codeline lineno="482"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="483"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="484"><highlight class="comment"><sp/>*<sp/>ECJPAKE_Handle<sp/>handle<sp/>=<sp/>ECJPAKE_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline lineno="485"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="486"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationRoundOneGenerateKeys<sp/><sp/><sp/>operationRoundOneGenerateKeys;</highlight></codeline>
<codeline lineno="487"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationRoundTwoGenerateKeys<sp/><sp/><sp/>operationRoundTwoGenerateKeys;</highlight></codeline>
<codeline lineno="488"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationGenerateZKP<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationGenerateZKP;</highlight></codeline>
<codeline lineno="489"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationVerifyZKP<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationVerifyZKP;</highlight></codeline>
<codeline lineno="490"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationComputeSharedSecret<sp/><sp/><sp/><sp/>operationComputeSharedSecret;</highlight></codeline>
<codeline lineno="491"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="492"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>my<sp/>round<sp/>one<sp/>keys</highlight></codeline>
<codeline lineno="493"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationRoundOneGenerateKeys_init(&amp;operationRoundOneGenerateKeys);</highlight></codeline>
<codeline lineno="494"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="495"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPrivateKey1<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey1;</highlight></codeline>
<codeline lineno="496"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPrivateKey2<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline lineno="497"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey1;</highlight></codeline>
<codeline lineno="498"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey2;</highlight></codeline>
<codeline lineno="499"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPrivateV1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV1;</highlight></codeline>
<codeline lineno="500"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPrivateV2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV2;</highlight></codeline>
<codeline lineno="501"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPublicV1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV1;</highlight></codeline>
<codeline lineno="502"><highlight class="comment"><sp/>*<sp/>operationRoundOneGenerateKeys.myPublicV2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV2;</highlight></codeline>
<codeline lineno="503"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="504"><highlight class="comment"><sp/>*<sp/>int_fast16_t<sp/>result<sp/>=<sp/>ECJPAKE_roundOneGenerateKeys(handle,<sp/>&amp;operationRoundOneGenerateKeys);</highlight></codeline>
<codeline lineno="505"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="506"><highlight class="comment"><sp/>*<sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="507"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline lineno="508"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="509"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="510"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>hashes<sp/>here</highlight></codeline>
<codeline lineno="511"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="512"><highlight class="comment"><sp/>*<sp/>//<sp/>generate<sp/>my<sp/>round<sp/>one<sp/>ZKPs</highlight></codeline>
<codeline lineno="513"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="514"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="515"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey1;</highlight></codeline>
<codeline lineno="516"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV1;</highlight></codeline>
<codeline lineno="517"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash1;</highlight></codeline>
<codeline lineno="518"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR1;</highlight></codeline>
<codeline lineno="519"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="520"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="521"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="522"><highlight class="comment"><sp/>*<sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="523"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline lineno="524"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="525"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="526"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="527"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="528"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline lineno="529"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV2;</highlight></codeline>
<codeline lineno="530"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash2;</highlight></codeline>
<codeline lineno="531"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR2;</highlight></codeline>
<codeline lineno="532"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="533"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="534"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="535"><highlight class="comment"><sp/>*<sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="536"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline lineno="537"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="538"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="539"><highlight class="comment"><sp/>*<sp/>//<sp/>Do<sp/>ZKP<sp/>and<sp/>key<sp/>transmission<sp/>here</highlight></codeline>
<codeline lineno="540"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="541"><highlight class="comment"><sp/>*<sp/>//<sp/>Verify<sp/>their<sp/>round<sp/>one<sp/>ZKPs</highlight></codeline>
<codeline lineno="542"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>their<sp/>hashes<sp/>here</highlight></codeline>
<codeline lineno="543"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="544"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="545"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="546"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="547"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey1;</highlight></codeline>
<codeline lineno="548"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV1;</highlight></codeline>
<codeline lineno="549"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash1;</highlight></codeline>
<codeline lineno="550"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR1;</highlight></codeline>
<codeline lineno="551"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="552"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,<sp/>&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="553"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="554"><highlight class="comment"><sp/>*<sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="555"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline lineno="556"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="557"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="558"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="559"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="560"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="561"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline lineno="562"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV2;</highlight></codeline>
<codeline lineno="563"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash2;</highlight></codeline>
<codeline lineno="564"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR2;</highlight></codeline>
<codeline lineno="565"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="566"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="567"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="568"><highlight class="comment"><sp/>*<sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="569"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline lineno="570"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="571"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="572"><highlight class="comment"><sp/>*<sp/>//<sp/>Round<sp/>two<sp/>starts<sp/>now</highlight></codeline>
<codeline lineno="573"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="574"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>my<sp/>round<sp/>two<sp/>keys</highlight></codeline>
<codeline lineno="575"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationRoundTwoGenerateKeys_init(&amp;operationRoundTwoGenerateKeys);</highlight></codeline>
<codeline lineno="576"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="577"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myPrivateKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline lineno="578"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey1;</highlight></codeline>
<codeline lineno="579"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoKey2;</highlight></codeline>
<codeline lineno="580"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.theirPublicKey1<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey1;</highlight></codeline>
<codeline lineno="581"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.theirPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline lineno="582"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.preSharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;preSharedSecretCryptoKey;</highlight></codeline>
<codeline lineno="583"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.theirNewGenerator<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirGeneratorKey;</highlight></codeline>
<codeline lineno="584"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myNewGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myGeneratorKey;</highlight></codeline>
<codeline lineno="585"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myCombinedPrivateKey<sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline lineno="586"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myCombinedPublicKey<sp/><sp/><sp/>=<sp/>&amp;myCombinedPublicKey;</highlight></codeline>
<codeline lineno="587"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV3;</highlight></codeline>
<codeline lineno="588"><highlight class="comment"><sp/>*<sp/>operationRoundTwoGenerateKeys.myPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPublicCryptoV3;</highlight></codeline>
<codeline lineno="589"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="590"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_roundTwoGenerateKeys(handle,<sp/>&amp;operationRoundTwoGenerateKeys);</highlight></codeline>
<codeline lineno="591"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="592"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>my<sp/>round<sp/><sp/>two<sp/>ZKP</highlight></codeline>
<codeline lineno="593"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>the<sp/>round<sp/>two<sp/>hash<sp/>here</highlight></codeline>
<codeline lineno="594"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="595"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationGenerateZKP_init(&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="596"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="597"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline lineno="598"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.myPrivateV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoV3;</highlight></codeline>
<codeline lineno="599"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myHash3;</highlight></codeline>
<codeline lineno="600"><highlight class="comment"><sp/>*<sp/>operationGenerateZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>myR3;</highlight></codeline>
<codeline lineno="601"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="602"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_generateZKP(handle,<sp/>&amp;operationGenerateZKP);</highlight></codeline>
<codeline lineno="603"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="604"><highlight class="comment"><sp/>*<sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="605"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline lineno="606"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="607"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="608"><highlight class="comment"><sp/>*<sp/>//<sp/>Exchange<sp/>keys<sp/>and<sp/>ZKPs<sp/>again</highlight></codeline>
<codeline lineno="609"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="610"><highlight class="comment"><sp/>*<sp/>//<sp/>Verify<sp/>their<sp/>second<sp/>round<sp/>ZKP</highlight></codeline>
<codeline lineno="611"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>their<sp/>round<sp/>two<sp/>hash<sp/>here</highlight></codeline>
<codeline lineno="612"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="613"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationVerifyZKP_init(&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="614"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="615"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirGenerator<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirGeneratorKey;</highlight></codeline>
<codeline lineno="616"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirCombinedPublicKey;</highlight></codeline>
<codeline lineno="617"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.theirPublicV<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoV3;</highlight></codeline>
<codeline lineno="618"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.hash<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirHash3;</highlight></codeline>
<codeline lineno="619"><highlight class="comment"><sp/>*<sp/>operationVerifyZKP.r<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>theirR3;</highlight></codeline>
<codeline lineno="620"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="621"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/>ECJPAKE_verifyZKP(handle,<sp/>&amp;operationVerifyZKP);</highlight></codeline>
<codeline lineno="622"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="623"><highlight class="comment"><sp/>*<sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="624"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline lineno="625"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="626"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="627"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="628"><highlight class="comment"><sp/>*<sp/>//<sp/>Generate<sp/>shared<sp/>secret</highlight></codeline>
<codeline lineno="629"><highlight class="comment"><sp/>*<sp/>ECJPAKE_OperationComputeSharedSecret_init(&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline lineno="630"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.curve<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;ECCParams_NISTP256;</highlight></codeline>
<codeline lineno="631"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.myCombinedPrivateKey<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myCombinedPrivateKey;</highlight></codeline>
<codeline lineno="632"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.theirCombinedPublicKey<sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirCombinedPublicKey;</highlight></codeline>
<codeline lineno="633"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.theirPublicKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;theirPublicCryptoKey2;</highlight></codeline>
<codeline lineno="634"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.myPrivateKey2<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;myPrivateCryptoKey2;</highlight></codeline>
<codeline lineno="635"><highlight class="comment"><sp/>*<sp/>operationComputeSharedSecret.sharedSecret<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;sharedSecretCryptoKey;</highlight></codeline>
<codeline lineno="636"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="637"><highlight class="comment"><sp/>*<sp/>result<sp/>=<sp/><sp/>ECJPAKE_computeSharedSecret(handle,<sp/>&amp;operationComputeSharedSecret);</highlight></codeline>
<codeline lineno="638"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="639"><highlight class="comment"><sp/>*<sp/>if<sp/>(result<sp/>!=<sp/>ECJPAKE_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="640"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/>while(1);</highlight></codeline>
<codeline lineno="641"><highlight class="comment"><sp/>*<sp/>}</highlight></codeline>
<codeline lineno="642"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="643"><highlight class="comment"><sp/>*<sp/>//<sp/>Run<sp/>sharedSecretCryptoKey<sp/>through<sp/>a<sp/>key<sp/>derivation<sp/>function<sp/>and</highlight></codeline>
<codeline lineno="644"><highlight class="comment"><sp/>*<sp/>//<sp/>confirm<sp/>to<sp/>the<sp/>other<sp/>party<sp/>that<sp/>we<sp/>have<sp/>derived<sp/>the<sp/>same<sp/>key</highlight></codeline>
<codeline lineno="645"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="646"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="647"><highlight class="comment"><sp/>*<sp/>@endcode</highlight></codeline>
<codeline lineno="648"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="649"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="650"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"></highlight></codeline>
<codeline lineno="652"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>ti_drivers_ECJPAKE__include</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ti_drivers_ECJPAKE__include</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="654"><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdbool.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="658"><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="_crypto_key_8h" kindref="compound">ti/drivers/cryptoutils/cryptokey/CryptoKey.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="_e_c_c_params_8h" kindref="compound">ti/drivers/cryptoutils/ecc/ECCParams.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="661"><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="663"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="664"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"></highlight></codeline>
<codeline lineno="678" refid="_e_c_j_p_a_k_e_8h_1a312c0c75c7b47e0d5e8493ca4cb98683" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_RESERVED<sp/>(-32)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"></highlight></codeline>
<codeline lineno="686" refid="_e_c_j_p_a_k_e_8h_1a1e2fe3a0d3efd4d6505552b732402a35" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_SUCCESS<sp/>(0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"></highlight></codeline>
<codeline lineno="694" refid="_e_c_j_p_a_k_e_8h_1a3173a5ec592e345c4dc58e9fbbde2825" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_ERROR<sp/>(-1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"></highlight></codeline>
<codeline lineno="704" refid="_e_c_j_p_a_k_e_8h_1a668d9bd2a4926c046f40ee6698892362" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_RESOURCE_UNAVAILABLE<sp/>(-2)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="705"><highlight class="normal"></highlight></codeline>
<codeline lineno="711" refid="_e_c_j_p_a_k_e_8h_1adc3a17b99ca7816137c60f780b51ef63" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_INVALID_PUBLIC_KEY<sp/>(-3)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"></highlight></codeline>
<codeline lineno="719" refid="_e_c_j_p_a_k_e_8h_1a11dcd54552f0512755ba72f17ae5da46" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_PUBLIC_KEY_NOT_ON_CURVE<sp/>(-4)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"></highlight></codeline>
<codeline lineno="728" refid="_e_c_j_p_a_k_e_8h_1a79517ed3fbf41907b1d9e495f7bfef5c" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_PUBLIC_KEY_LARGER_THAN_PRIME<sp/>(-5)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="729"><highlight class="normal"></highlight></codeline>
<codeline lineno="736" refid="_e_c_j_p_a_k_e_8h_1a74586f857af1aaffbe358721b81f1b0f" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_POINT_AT_INFINITY<sp/>(-6)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="737"><highlight class="normal"></highlight></codeline>
<codeline lineno="744" refid="_e_c_j_p_a_k_e_8h_1a4ca6b37156ce3f0bd1c26b5ecd4d4a23" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_INVALID_PRIVATE_KEY<sp/>(-7)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="745"><highlight class="normal"></highlight></codeline>
<codeline lineno="752" refid="_e_c_j_p_a_k_e_8h_1a45e8ebd0af128c2b81c249022baa6667" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_INVALID_PRIVATE_V<sp/>(-8)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="753"><highlight class="normal"></highlight></codeline>
<codeline lineno="757" refid="_e_c_j_p_a_k_e_8h_1a583347838bba8d270e653517317aaa39" refkind="member"><highlight class="preprocessor">#define<sp/>ECJPAKE_STATUS_CANCELED<sp/>(-9)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="758"><highlight class="normal"></highlight></codeline>
<codeline lineno="770" refid="struct_e_c_j_p_a_k_e___config" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal">{</highlight></codeline>
<codeline lineno="773" refid="struct_e_c_j_p_a_k_e___config_1a84312ac49d17c054ab3c4f0a077fa927" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="struct_e_c_j_p_a_k_e___config_1a84312ac49d17c054ab3c4f0a077fa927" kindref="member">object</ref>;</highlight></codeline>
<codeline lineno="774"><highlight class="normal"></highlight></codeline>
<codeline lineno="776" refid="struct_e_c_j_p_a_k_e___config_1a89a8b0efb52d7ec041a7a050bc0af09a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>*<ref refid="struct_e_c_j_p_a_k_e___config_1a89a8b0efb52d7ec041a7a050bc0af09a" kindref="member">hwAttrs</ref>;</highlight></codeline>
<codeline lineno="777"><highlight class="normal">}<sp/><ref refid="struct_e_c_j_p_a_k_e___config" kindref="compound">ECJPAKE_Config</ref>;</highlight></codeline>
<codeline lineno="778"><highlight class="normal"></highlight></codeline>
<codeline lineno="782" refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/><ref refid="struct_e_c_j_p_a_k_e___config" kindref="compound">ECJPAKE_Config</ref><sp/>*<ref refid="_e_c_j_p_a_k_e_8h_1a07fa2d7e815b145614a69ce6646c7f4c" kindref="member">ECJPAKE_Handle</ref>;</highlight></codeline>
<codeline lineno="783"><highlight class="normal"></highlight></codeline>
<codeline lineno="805" refid="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634c" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="806"><highlight class="normal">{</highlight></codeline>
<codeline lineno="807" refid="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634ca5a4164de2fa7a74f8e9a8f21a6f40069" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634ca5a4164de2fa7a74f8e9a8f21a6f40069" kindref="member">ECJPAKE_RETURN_BEHAVIOR_CALLBACK</ref><sp/>=<sp/>1,<sp/></highlight></codeline>
<codeline lineno="813" refid="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634ca124c6b724f8fc636176973cbc470d63f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634ca124c6b724f8fc636176973cbc470d63f" kindref="member">ECJPAKE_RETURN_BEHAVIOR_BLOCKING</ref><sp/>=<sp/>2,<sp/></highlight></codeline>
<codeline lineno="817" refid="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634ca5ec172da7685ba35f8337c7f5dc5d5a6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634ca5ec172da7685ba35f8337c7f5dc5d5a6" kindref="member">ECJPAKE_RETURN_BEHAVIOR_POLLING</ref><sp/><sp/>=<sp/>4,<sp/></highlight></codeline>
<codeline lineno="821"><highlight class="normal">}<sp/><ref refid="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634c" kindref="member">ECJPAKE_ReturnBehavior</ref>;</highlight></codeline>
<codeline lineno="822"><highlight class="normal"></highlight></codeline>
<codeline lineno="826" refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="827"><highlight class="normal">{</highlight></codeline>
<codeline lineno="828" refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1ab114792910e0ea158a8ac395510ccc53" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_e_c_c_params___curve_params" kindref="compound">ECCParams_CurveParams</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1ab114792910e0ea158a8ac395510ccc53" kindref="member">curve</ref>;<sp/></highlight></codeline>
<codeline lineno="831" refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a4daf3b33de1e9d3de08869918f9d215e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a4daf3b33de1e9d3de08869918f9d215e" kindref="member">myPrivateKey1</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="835" refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a864d14da964cd8a7a14ca0055700e58c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a864d14da964cd8a7a14ca0055700e58c" kindref="member">myPrivateKey2</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="839" refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a02b1264ab2a9d23a7ae54cdaf39494c3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a02b1264ab2a9d23a7ae54cdaf39494c3" kindref="member">myPublicKey1</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="844" refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a8aa339a06a25586addbcb5d408c9ed49" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a8aa339a06a25586addbcb5d408c9ed49" kindref="member">myPublicKey2</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="849" refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a998769ead4ed78a9fc7ebd1986a11753" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a998769ead4ed78a9fc7ebd1986a11753" kindref="member">myPrivateV1</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="856" refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a19b4f5da483abcf28c03cf6baae924ff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a19b4f5da483abcf28c03cf6baae924ff" kindref="member">myPrivateV2</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="863" refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a4be523ebfc383f0c41e61f4fc3ea149b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a4be523ebfc383f0c41e61f4fc3ea149b" kindref="member">myPublicV1</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="872" refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a8c021725d9774a0f6153ee30b424485c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys_1a8c021725d9774a0f6153ee30b424485c" kindref="member">myPublicV2</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="881"><highlight class="normal">}<sp/><ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys" kindref="compound">ECJPAKE_OperationRoundOneGenerateKeys</ref>;</highlight></codeline>
<codeline lineno="882"><highlight class="normal"></highlight></codeline>
<codeline lineno="886" refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal">{</highlight></codeline>
<codeline lineno="888" refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p_1a06f03779f77101eeda49eacb69c90c87" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_e_c_c_params___curve_params" kindref="compound">ECCParams_CurveParams</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p_1a06f03779f77101eeda49eacb69c90c87" kindref="member">curve</ref>;<sp/></highlight></codeline>
<codeline lineno="891" refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p_1a4b8a05ead0bb6f6d60861928a57bffab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p_1a4b8a05ead0bb6f6d60861928a57bffab" kindref="member">myPrivateKey</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="895" refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p_1af55456bdd3c1f6e9fb48f75d1ddbcd46" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p_1af55456bdd3c1f6e9fb48f75d1ddbcd46" kindref="member">myPrivateV</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="900" refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p_1a7cafdde04fe2951a5f2402f39b35971b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p_1a7cafdde04fe2951a5f2402f39b35971b" kindref="member">hash</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="904" refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p_1a4fec606197ccec4e21c87eb3ea3fcd9e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p_1a4fec606197ccec4e21c87eb3ea3fcd9e" kindref="member">r</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="907"><highlight class="normal">}<sp/><ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p" kindref="compound">ECJPAKE_OperationGenerateZKP</ref>;</highlight></codeline>
<codeline lineno="908"><highlight class="normal"></highlight></codeline>
<codeline lineno="912" refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="913"><highlight class="normal">{</highlight></codeline>
<codeline lineno="914" refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1aa9fd0c3220148eb260da304767b845e7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_e_c_c_params___curve_params" kindref="compound">ECCParams_CurveParams</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1aa9fd0c3220148eb260da304767b845e7" kindref="member">curve</ref>;<sp/></highlight></codeline>
<codeline lineno="917" refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1acf6d864f4e02a34195700a538f3ec3c4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1acf6d864f4e02a34195700a538f3ec3c4" kindref="member">theirGenerator</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="926" refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1a22bf5b561832f7be21e7c766573f906a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1a22bf5b561832f7be21e7c766573f906a" kindref="member">theirPublicKey</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="930" refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1a4be0a99f30ddb02784ae088d8b36d497" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1a4be0a99f30ddb02784ae088d8b36d497" kindref="member">theirPublicV</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="933" refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1ad524369b4c52fbff25abef2b7dc5f2b2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1ad524369b4c52fbff25abef2b7dc5f2b2" kindref="member">hash</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="936" refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1acd55d6b35c8713a96fe853cf813df8ac" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p_1acd55d6b35c8713a96fe853cf813df8ac" kindref="member">r</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="939"><highlight class="normal">}<sp/><ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p" kindref="compound">ECJPAKE_OperationVerifyZKP</ref>;</highlight></codeline>
<codeline lineno="940"><highlight class="normal"></highlight></codeline>
<codeline lineno="944" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="945"><highlight class="normal">{</highlight></codeline>
<codeline lineno="946" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a70378dcb290f2d4032d667bb37975ab8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_e_c_c_params___curve_params" kindref="compound">ECCParams_CurveParams</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a70378dcb290f2d4032d667bb37975ab8" kindref="member">curve</ref>;<sp/></highlight></codeline>
<codeline lineno="949" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a9e7e5b0765e81c7b8021242dae006231" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a9e7e5b0765e81c7b8021242dae006231" kindref="member">myPrivateKey2</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="953" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a2a9a1eff4321e488d979b01b69a4c5ca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a2a9a1eff4321e488d979b01b69a4c5ca" kindref="member">myPublicKey1</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="956" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1ad67d4498895c39c520fc89af43411cbd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1ad67d4498895c39c520fc89af43411cbd" kindref="member">myPublicKey2</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="959" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1aa56b66dd17b7788d4a092c08c0fc526d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1aa56b66dd17b7788d4a092c08c0fc526d" kindref="member">theirPublicKey1</ref>;<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="962" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a7b26f89a9ff6c4991231cacfa2834fb5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a7b26f89a9ff6c4991231cacfa2834fb5" kindref="member">theirPublicKey2</ref>;<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="965" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1af056028d0089252d89d1413e9950e39c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1af056028d0089252d89d1413e9950e39c" kindref="member">preSharedSecret</ref>;<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="974" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a79021d246ce8e6603f987502e1c306d1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a79021d246ce8e6603f987502e1c306d1" kindref="member">theirNewGenerator</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="981" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1aad7c70af8f88da28262eae66c2606196" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1aad7c70af8f88da28262eae66c2606196" kindref="member">myNewGenerator</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="988" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1ae3b22eb15838cffb4469dae238bd103f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1ae3b22eb15838cffb4469dae238bd103f" kindref="member">myCombinedPrivateKey</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="993" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a5be4dc8d025e3f195b9ca9467d891e2f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a5be4dc8d025e3f195b9ca9467d891e2f" kindref="member">myCombinedPublicKey</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="996" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1aeb7a4d170ee355be0201d4b246a73a88" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1aeb7a4d170ee355be0201d4b246a73a88" kindref="member">myPrivateV</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1003" refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a8d31da90d614deb245c6ef35ab9ea795" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys_1a8d31da90d614deb245c6ef35ab9ea795" kindref="member">myPublicV</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1012"><highlight class="normal">}<sp/><ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys" kindref="compound">ECJPAKE_OperationRoundTwoGenerateKeys</ref>;</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"></highlight></codeline>
<codeline lineno="1017" refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1018"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1019" refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a37d1500a311757555ae775f40c7fc8ab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_e_c_c_params___curve_params" kindref="compound">ECCParams_CurveParams</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a37d1500a311757555ae775f40c7fc8ab" kindref="member">curve</ref>;<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1022" refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a9141620809db06c0839bcaa504e35962" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a9141620809db06c0839bcaa504e35962" kindref="member">myCombinedPrivateKey</ref>;<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1026" refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a2e18c8f059736f66f4c768201ed475a8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a2e18c8f059736f66f4c768201ed475a8" kindref="member">theirCombinedPublicKey</ref>;<sp/></highlight></codeline>
<codeline lineno="1029" refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a789ee04ff7193f20aa330b5ad12a61b9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a789ee04ff7193f20aa330b5ad12a61b9" kindref="member">theirPublicKey2</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1034" refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a700f29dfb260521cbeae1d86c06bce00" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a700f29dfb260521cbeae1d86c06bce00" kindref="member">myPrivateKey2</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1038" refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a8486981c6cc2ba1b949322f7178a3dc4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret_1a8486981c6cc2ba1b949322f7178a3dc4" kindref="member">sharedSecret</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1041"><highlight class="normal">}<sp/><ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret" kindref="compound">ECJPAKE_OperationComputeSharedSecret</ref>;</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"></highlight></codeline>
<codeline lineno="1046" refid="union_e_c_j_p_a_k_e___operation" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">union</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1047"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1048" refid="union_e_c_j_p_a_k_e___operation_1a6c46e845743811aae2037f8dd6876316" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys" kindref="compound">ECJPAKE_OperationRoundOneGenerateKeys</ref><sp/>*<ref refid="union_e_c_j_p_a_k_e___operation_1a6c46e845743811aae2037f8dd6876316" kindref="member">generateRoundOneKeys</ref>;<sp/></highlight></codeline>
<codeline lineno="1050" refid="union_e_c_j_p_a_k_e___operation_1ac8503245dc8cf2a5987e2a73ee6550e6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p" kindref="compound">ECJPAKE_OperationGenerateZKP</ref><sp/>*<ref refid="union_e_c_j_p_a_k_e___operation_1ac8503245dc8cf2a5987e2a73ee6550e6" kindref="member">generateZKP</ref>;<sp/></highlight></codeline>
<codeline lineno="1051" refid="union_e_c_j_p_a_k_e___operation_1a728e6fd48622866c96a0cca65d9086c2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p" kindref="compound">ECJPAKE_OperationVerifyZKP</ref><sp/>*<ref refid="union_e_c_j_p_a_k_e___operation_1a728e6fd48622866c96a0cca65d9086c2" kindref="member">verifyZKP</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1052" refid="union_e_c_j_p_a_k_e___operation_1ab867fa191e0c11a5efdc81804427cede" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys" kindref="compound">ECJPAKE_OperationRoundTwoGenerateKeys</ref><sp/>*<ref refid="union_e_c_j_p_a_k_e___operation_1ab867fa191e0c11a5efdc81804427cede" kindref="member">generateRoundTwoKeys</ref>;<sp/></highlight></codeline>
<codeline lineno="1054" refid="union_e_c_j_p_a_k_e___operation_1ad3a8ee59d8b6ee74a1016c9e44a49c6a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret" kindref="compound">ECJPAKE_OperationComputeSharedSecret</ref><sp/>*<ref refid="union_e_c_j_p_a_k_e___operation_1ad3a8ee59d8b6ee74a1016c9e44a49c6a" kindref="member">computeSharedSecret</ref>;<sp/></highlight></codeline>
<codeline lineno="1056"><highlight class="normal">}<sp/><ref refid="union_e_c_j_p_a_k_e___operation" kindref="compound">ECJPAKE_Operation</ref>;</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"></highlight></codeline>
<codeline lineno="1061" refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1062"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1063" refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26a127cd39a054561f63b428ddfafed821a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26a127cd39a054561f63b428ddfafed821a" kindref="member">ECJPAKE_OPERATION_TYPE_ROUND_ONE_GENERATE_KEYS</ref><sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="1064" refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26ad08ce6c1fa4c35487af7a3f5faeea4b3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26ad08ce6c1fa4c35487af7a3f5faeea4b3" kindref="member">ECJPAKE_OPERATION_TYPE_GENERATE_ZKP</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>2,</highlight></codeline>
<codeline lineno="1065" refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26aae45452ee70a3aa970183c9f5c8ca6ff" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26aae45452ee70a3aa970183c9f5c8ca6ff" kindref="member">ECJPAKE_OPERATION_TYPE_VERIFY_ZKP</ref><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>3,</highlight></codeline>
<codeline lineno="1066" refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26acccd1127e96dd121dc8dbe4a600b2903" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26acccd1127e96dd121dc8dbe4a600b2903" kindref="member">ECJPAKE_OPERATION_TYPE_ROUND_TWO_GENERATE_KEYS</ref><sp/>=<sp/>4,</highlight></codeline>
<codeline lineno="1067" refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26aa121074a25507188f1d89a816cfaf7ed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26aa121074a25507188f1d89a816cfaf7ed" kindref="member">ECJPAKE_OPERATION_TYPE_COMPUTE_SHARED_SECRET</ref><sp/><sp/><sp/>=<sp/>5,</highlight></codeline>
<codeline lineno="1068"><highlight class="normal">}<sp/><ref refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26" kindref="member">ECJPAKE_OperationType</ref>;</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"></highlight></codeline>
<codeline lineno="1088" refid="_e_c_j_p_a_k_e_8h_1a743785709e9ca990077a97befed10232" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/>void<sp/>(*<ref refid="_e_c_j_p_a_k_e_8h_1a743785709e9ca990077a97befed10232" kindref="member">ECJPAKE_CallbackFxn</ref>)(ECJPAKE_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnStatus,</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="union_e_c_j_p_a_k_e___operation" kindref="compound">ECJPAKE_Operation</ref><sp/>operation,</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a7cc04050ce660dd03540b7bf8e53fb26" kindref="member">ECJPAKE_OperationType</ref><sp/>operationType);</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"></highlight></codeline>
<codeline lineno="1101" refid="struct_e_c_j_p_a_k_e___params" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1102"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1103" refid="struct_e_c_j_p_a_k_e___params_1aeb38bfee3ec1ec719187b92cf7809f62" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a9955de2a9c7b9260b512ca14bf7a634c" kindref="member">ECJPAKE_ReturnBehavior</ref><sp/><ref refid="struct_e_c_j_p_a_k_e___params_1aeb38bfee3ec1ec719187b92cf7809f62" kindref="member">returnBehavior</ref>;<sp/></highlight></codeline>
<codeline lineno="1104" refid="struct_e_c_j_p_a_k_e___params_1a37c26c9517afb1b31656f0b1bd75c0a6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a743785709e9ca990077a97befed10232" kindref="member">ECJPAKE_CallbackFxn</ref><sp/><ref refid="struct_e_c_j_p_a_k_e___params_1a37c26c9517afb1b31656f0b1bd75c0a6" kindref="member">callbackFxn</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1105" refid="struct_e_c_j_p_a_k_e___params_1a3d57c640ac73a11756b4e81e2c47f43d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/><ref refid="struct_e_c_j_p_a_k_e___params_1a3d57c640ac73a11756b4e81e2c47f43d" kindref="member">timeout</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1108" refid="struct_e_c_j_p_a_k_e___params_1a6423049919fbd7864c3726ec7e5417ce" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="struct_e_c_j_p_a_k_e___params_1a6423049919fbd7864c3726ec7e5417ce" kindref="member">custom</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1111"><highlight class="normal">}<sp/><ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref>;</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"></highlight></codeline>
<codeline lineno="1121"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a700d51c05aed0c04a37615136583c96b" kindref="member">ECJPAKE_init</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"></highlight></codeline>
<codeline lineno="1131"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_j_p_a_k_e_8h_1ad4905b7bbdda7a6d84d68a33825d71fc" kindref="member">ECJPAKE_OperationRoundOneGenerateKeys_init</ref>(<ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys" kindref="compound">ECJPAKE_OperationRoundOneGenerateKeys</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"></highlight></codeline>
<codeline lineno="1141"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a309530be8bedab920f30a9e31e01f052" kindref="member">ECJPAKE_OperationGenerateZKP_init</ref>(<ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p" kindref="compound">ECJPAKE_OperationGenerateZKP</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"></highlight></codeline>
<codeline lineno="1151"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_j_p_a_k_e_8h_1adecdfdaae05bd0dc70f3b2766014c0e4" kindref="member">ECJPAKE_OperationVerifyZKP_init</ref>(<ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p" kindref="compound">ECJPAKE_OperationVerifyZKP</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"></highlight></codeline>
<codeline lineno="1161"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a779e5c3610e226d58917c1fdf6294f4c" kindref="member">ECJPAKE_OperationRoundTwoGenerateKeys_init</ref>(<ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys" kindref="compound">ECJPAKE_OperationRoundTwoGenerateKeys</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"></highlight></codeline>
<codeline lineno="1171"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a0c65ce541534493bd352248f7bc7314f" kindref="member">ECJPAKE_OperationComputeSharedSecret_init</ref>(<ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret" kindref="compound">ECJPAKE_OperationComputeSharedSecret</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"></highlight></codeline>
<codeline lineno="1182"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_j_p_a_k_e_8h_1a3fd8ad0728bebfd64e14537b2dbfedf1" kindref="member">ECJPAKE_close</ref>(ECJPAKE_Handle<sp/>handle);</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"></highlight></codeline>
<codeline lineno="1201"><highlight class="normal">ECJPAKE_Handle<sp/><ref refid="_e_c_j_p_a_k_e_8h_1aee777d6c12846f95c21a7ccce3b5daef" kindref="member">ECJPAKE_open</ref>(uint_least8_t<sp/>index,<sp/><ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref><sp/>*<ref refid="_driver___init_8h_1af93f10d4f7393a01dff58c92f91d8cbc" kindref="member">params</ref>);</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"></highlight></codeline>
<codeline lineno="1215"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_e_c_j_p_a_k_e_8h_1accb0f74e2250c5cdb6bbd2d71d790323" kindref="member">ECJPAKE_Params_init</ref>(<ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref><sp/>*<ref refid="_driver___init_8h_1af93f10d4f7393a01dff58c92f91d8cbc" kindref="member">params</ref>);</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"></highlight></codeline>
<codeline lineno="1242"><highlight class="normal">int_fast16_t<sp/><ref refid="_e_c_j_p_a_k_e_8h_1a12cd2e0e5f6828d904fbb76bd6c5c2d9" kindref="member">ECJPAKE_roundOneGenerateKeys</ref>(ECJPAKE_Handle<sp/>handle,<sp/><ref refid="struct_e_c_j_p_a_k_e___operation_round_one_generate_keys" kindref="compound">ECJPAKE_OperationRoundOneGenerateKeys</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"></highlight></codeline>
<codeline lineno="1276"><highlight class="normal">int_fast16_t<sp/><ref refid="_e_c_j_p_a_k_e_8h_1a422529b4456d9e53682985002fd87376" kindref="member">ECJPAKE_generateZKP</ref>(ECJPAKE_Handle<sp/>handle,<sp/><ref refid="struct_e_c_j_p_a_k_e___operation_generate_z_k_p" kindref="compound">ECJPAKE_OperationGenerateZKP</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1277"><highlight class="normal"></highlight></codeline>
<codeline lineno="1304"><highlight class="normal">int_fast16_t<sp/><ref refid="_e_c_j_p_a_k_e_8h_1af47d98b1e451cca11b450f425f94ddb0" kindref="member">ECJPAKE_verifyZKP</ref>(ECJPAKE_Handle<sp/>handle,<sp/><ref refid="struct_e_c_j_p_a_k_e___operation_verify_z_k_p" kindref="compound">ECJPAKE_OperationVerifyZKP</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"></highlight></codeline>
<codeline lineno="1329"><highlight class="normal">int_fast16_t<sp/><ref refid="_e_c_j_p_a_k_e_8h_1a6b0de26fef61a785906120acb0277074" kindref="member">ECJPAKE_roundTwoGenerateKeys</ref>(ECJPAKE_Handle<sp/>handle,<sp/><ref refid="struct_e_c_j_p_a_k_e___operation_round_two_generate_keys" kindref="compound">ECJPAKE_OperationRoundTwoGenerateKeys</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"></highlight></codeline>
<codeline lineno="1356"><highlight class="normal">int_fast16_t<sp/><ref refid="_e_c_j_p_a_k_e_8h_1a6d46725aff59ef45fffff16ec1f5ae5b" kindref="member">ECJPAKE_computeSharedSecret</ref>(ECJPAKE_Handle<sp/>handle,<sp/><ref refid="struct_e_c_j_p_a_k_e___operation_compute_shared_secret" kindref="compound">ECJPAKE_OperationComputeSharedSecret</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"></highlight></codeline>
<codeline lineno="1371"><highlight class="normal">int_fast16_t<sp/><ref refid="_e_c_j_p_a_k_e_8h_1a220578478388eb6de285a3ced904b4c9" kindref="member">ECJPAKE_cancelOperation</ref>(ECJPAKE_Handle<sp/>handle);</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"></highlight></codeline>
<codeline lineno="1396"><highlight class="normal">ECJPAKE_Handle<sp/><ref refid="_e_c_j_p_a_k_e_8h_1a6fb85a2fd62f3d860ee85110d47ecf30" kindref="member">ECJPAKE_construct</ref>(<ref refid="struct_e_c_j_p_a_k_e___config" kindref="compound">ECJPAKE_Config</ref><sp/>*config,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_e_c_j_p_a_k_e___params" kindref="compound">ECJPAKE_Params</ref><sp/>*<ref refid="_driver___init_8h_1af93f10d4f7393a01dff58c92f91d8cbc" kindref="member">params</ref>);</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"></highlight></codeline>
<codeline lineno="1398"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1399"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1401"><highlight class="normal"></highlight></codeline>
<codeline lineno="1402"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>ti_drivers_ECJPAKE__include<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="source/ti/drivers/ECJPAKE.h"/>
  </compounddef>
</doxygen>
