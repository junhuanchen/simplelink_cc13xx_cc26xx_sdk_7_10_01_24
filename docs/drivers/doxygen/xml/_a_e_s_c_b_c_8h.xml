<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.12">
  <compounddef id="_a_e_s_c_b_c_8h" kind="file" language="C++">
    <compoundname>AESCBC.h</compoundname>
    <includes local="no">stdbool.h</includes>
    <includes local="no">stddef.h</includes>
    <includes local="no">stdint.h</includes>
    <includes refid="_a_e_s_common_8h" local="no">ti/drivers/AESCommon.h</includes>
    <includes refid="_crypto_key_8h" local="no">ti/drivers/cryptoutils/cryptokey/CryptoKey.h</includes>
    <includedby refid="_a_e_s_c_b_c_c_c26_x4__ns_8h" local="no">AESCBCCC26X4_ns.h</includedby>
    <includedby refid="_a_e_s_c_b_c_c_c26_x4__s_8h" local="no">AESCBCCC26X4_s.h</includedby>
    <includedby refid="_a_e_s_c_b_c_c_c26_x_x_8h" local="no">AESCBCCC26XX.h</includedby>
    <incdepgraph>
      <node id="79">
        <label>stdbool.h</label>
      </node>
      <node id="82">
        <label>ti/drivers/AESCommon.h</label>
        <link refid="_a_e_s_common_8h"/>
        <childnode refid="79" relation="include">
        </childnode>
        <childnode refid="80" relation="include">
        </childnode>
        <childnode refid="81" relation="include">
        </childnode>
      </node>
      <node id="81">
        <label>stdint.h</label>
      </node>
      <node id="83">
        <label>ti/drivers/cryptoutils/cryptokey/CryptoKey.h</label>
        <link refid="_crypto_key_8h"/>
        <childnode refid="81" relation="include">
        </childnode>
        <childnode refid="79" relation="include">
        </childnode>
      </node>
      <node id="80">
        <label>stddef.h</label>
      </node>
      <node id="78">
        <label>AESCBC.h</label>
        <link refid="_a_e_s_c_b_c_8h"/>
        <childnode refid="79" relation="include">
        </childnode>
        <childnode refid="80" relation="include">
        </childnode>
        <childnode refid="81" relation="include">
        </childnode>
        <childnode refid="82" relation="include">
        </childnode>
        <childnode refid="83" relation="include">
        </childnode>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="87">
        <label>AESCBCCC26XX.h</label>
        <link refid="_a_e_s_c_b_c_c_c26_x_x_8h"/>
      </node>
      <node id="85">
        <label>AESCBCCC26X4_ns.h</label>
        <link refid="_a_e_s_c_b_c_c_c26_x4__ns_8h"/>
      </node>
      <node id="84">
        <label>AESCBC.h</label>
        <link refid="_a_e_s_c_b_c_8h"/>
        <childnode refid="85" relation="include">
        </childnode>
        <childnode refid="86" relation="include">
        </childnode>
        <childnode refid="87" relation="include">
        </childnode>
      </node>
      <node id="86">
        <label>AESCBCCC26X4_s.h</label>
        <link refid="_a_e_s_c_b_c_c_c26_x4__s_8h"/>
      </node>
    </invincdepgraph>
    <innerclass refid="struct_a_e_s_c_b_c___one_step_operation" prot="public">AESCBC_OneStepOperation</innerclass>
    <innerclass refid="struct_a_e_s_c_b_c___segmented_operation" prot="public">AESCBC_SegmentedOperation</innerclass>
    <innerclass refid="union_a_e_s_c_b_c___operation_union" prot="public">AESCBC_OperationUnion</innerclass>
    <innerclass refid="struct_a_e_s_c_b_c___params" prot="public">AESCBC_Params</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="_a_e_s_c_b_c_8h_1a3cd55c1962740cbb6e3217d49ddb8cc6" prot="public" static="no">
        <name>AESCBC_STATUS_RESERVED</name>
        <initializer><ref refid="_a_e_s_common_8h_1a4896831b1a3a4ead39a3c58eb13a05f5" kindref="member">AES_STATUS_RESERVED</ref></initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Common AESCBC status code reservation offset. AESCBC driver implementations should offset status codes with <ref refid="_a_e_s_c_b_c_8h_1a3cd55c1962740cbb6e3217d49ddb8cc6" kindref="member">AESCBC_STATUS_RESERVED</ref> growing negatively.</para><para>Example implementation specific status codes: <programlisting><codeline><highlight class="normal">#define<sp/>AESCBCXYZ_STATUS_ERROR0<sp/><sp/><sp/><sp/>AESCBC_STATUS_RESERVED<sp/>-<sp/>0</highlight></codeline>
<codeline><highlight class="normal">#define<sp/>AESCBCXYZ_STATUS_ERROR1<sp/><sp/><sp/><sp/>AESCBC_STATUS_RESERVED<sp/>-<sp/>1</highlight></codeline>
<codeline><highlight class="normal">#define<sp/>AESCBCXYZ_STATUS_ERROR2<sp/><sp/><sp/><sp/>AESCBC_STATUS_RESERVED<sp/>-<sp/>2</highlight></codeline>
</programlisting> </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="596" column="9" bodyfile="source/ti/drivers/AESCBC.h" bodystart="596" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" prot="public" static="no">
        <name>AESCBC_STATUS_SUCCESS</name>
        <initializer><ref refid="_a_e_s_common_8h_1a40238be3b30c09acbb966b8cf64d8db6" kindref="member">AES_STATUS_SUCCESS</ref></initializer>
        <briefdescription>
<para>Successful status code. </para>        </briefdescription>
        <detaileddescription>
<para>Functions return <ref refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" kindref="member">AESCBC_STATUS_SUCCESS</ref> if the function was executed successfully. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="604" column="9" bodyfile="source/ti/drivers/AESCBC.h" bodystart="604" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" prot="public" static="no">
        <name>AESCBC_STATUS_ERROR</name>
        <initializer><ref refid="_a_e_s_common_8h_1ac6963a06e1923ad116a23c0e1a17dba8" kindref="member">AES_STATUS_ERROR</ref></initializer>
        <briefdescription>
<para>Generic error status code. </para>        </briefdescription>
        <detaileddescription>
<para>Functions return <ref refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" kindref="member">AESCBC_STATUS_ERROR</ref> if the function was not executed successfully and no more pertinent error code could be returned. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="612" column="9" bodyfile="source/ti/drivers/AESCBC.h" bodystart="612" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_b_c_8h_1ad92a5502a5a56aaf28b7d930be275271" prot="public" static="no">
        <name>AESCBC_STATUS_RESOURCE_UNAVAILABLE</name>
        <initializer><ref refid="_a_e_s_common_8h_1a4720c275153144c20096dc2d85f93889" kindref="member">AES_STATUS_RESOURCE_UNAVAILABLE</ref></initializer>
        <briefdescription>
<para>An error status code returned if the hardware or software resource is currently unavailable. </para>        </briefdescription>
        <detaileddescription>
<para>AESCBC driver implementations may have hardware or software limitations on how many clients can simultaneously perform operations. This status code is returned if the mutual exclusion mechanism signals that an operation cannot currently be performed. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="622" column="9" bodyfile="source/ti/drivers/AESCBC.h" bodystart="622" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_b_c_8h_1aa3ff5d2f23cdceb6652dbe490c6ec93f" prot="public" static="no">
        <name>AESCBC_STATUS_CANCELED</name>
        <initializer><ref refid="_a_e_s_common_8h_1aa8d5ff0dd5cde60089ac5d84cfb4a702" kindref="member">AES_STATUS_CANCELED</ref></initializer>
        <briefdescription>
<para>The ongoing operation was canceled. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="627" column="9" bodyfile="source/ti/drivers/AESCBC.h" bodystart="627" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_b_c_8h_1a75fee21f079588cba1b516720b553f1a" prot="public" static="no">
        <name>AESCBC_STATUS_FEATURE_NOT_SUPPORTED</name>
        <initializer><ref refid="_a_e_s_common_8h_1a671e5331015411e6db491d8eee23732c" kindref="member">AES_STATUS_FEATURE_NOT_SUPPORTED</ref></initializer>
        <briefdescription>
<para>The operation requested is not supported for now. </para>        </briefdescription>
        <detaileddescription>
<para>This code is returned by <ref refid="_a_e_s_c_b_c_8h_1af8e25f2268d83629d9799a165bc7683c" kindref="member">AESCBC_generateIV()</ref>, and internal generation of IVs isn&apos;t supported for now. Eventually, this function will make the TRNG generate the IV. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="636" column="9" bodyfile="source/ti/drivers/AESCBC.h" bodystart="636" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_b_c_8h_1adad2a122e8b54e8c2e0d1563ac1095a7" prot="public" static="no">
        <name>AESCBC_STATUS_KEYSTORE_INVALID_ID</name>
        <initializer><ref refid="_a_e_s_common_8h_1aeaab212abda07968840db525e114d1ae" kindref="member">AES_STATUS_KEYSTORE_INVALID_ID</ref></initializer>
        <briefdescription>
<para>The operation tried to load a key from the keystore using an invalid key ID. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="641" column="9" bodyfile="source/ti/drivers/AESCBC.h" bodystart="641" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_b_c_8h_1a65047ed053730a6dee6332cd98fc377c" prot="public" static="no">
        <name>AESCBC_STATUS_KEYSTORE_GENERIC_ERROR</name>
        <initializer><ref refid="_a_e_s_common_8h_1a89e9ed71ffb10f4f6d5b52b8afbd4389" kindref="member">AES_STATUS_KEYSTORE_GENERIC_ERROR</ref></initializer>
        <briefdescription>
<para>The key store module returned a generic error. See key store documentation for additional details. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="647" column="9" bodyfile="source/ti/drivers/AESCBC.h" bodystart="647" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_b_c_8h_1adf65612b9131789ae5db3e3151473bbc" prot="public" static="no">
        <name>AESCBC_STATUS_UNALIGNED_IO_NOT_SUPPORTED</name>
        <initializer><ref refid="_a_e_s_common_8h_1ab367c0137dd8d9bda4107b1545bfdb12" kindref="member">AES_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></initializer>
        <briefdescription>
<para>The operation does not support non-word-aligned input and/or output. </para>        </briefdescription>
        <detaileddescription>
<para>AESCBC driver implementations may have restrictions on the alignment of input/output data due to performance limitations of the hardware. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="655" column="9" bodyfile="source/ti/drivers/AESCBC.h" bodystart="655" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="enum">
      <memberdef kind="enum" id="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5" prot="public" static="no">
        <name>AESCBC_ReturnBehavior</name>
        <enumvalue id="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5acedc995468fd1ad451c6aa24f56d456d" prot="public">
          <name>AESCBC_RETURN_BEHAVIOR_CALLBACK</name>
          <initializer>= AES_RETURN_BEHAVIOR_CALLBACK</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will return immediately while the CBC operation goes on in the background. The registered callback function is called after the operation completes. The context the callback function is called (task, HWI, SWI) is implementation-dependent. </para>          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5ad4cf399115e78f5253b12f88605d212e" prot="public">
          <name>AESCBC_RETURN_BEHAVIOR_BLOCKING</name>
          <initializer>= AES_RETURN_BEHAVIOR_BLOCKING</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will block while the CBC operation goes on in the background. CBC operation results are available after the function returns. </para>          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5aeccf5cad47aac1edcef820125f7c361d" prot="public">
          <name>AESCBC_RETURN_BEHAVIOR_POLLING</name>
          <initializer>= AES_RETURN_BEHAVIOR_POLLING</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will continuously poll a flag while CBC operation goes on in the background. CBC operation results are available after the function returns. </para>          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>The way in which CBC function calls return after performing an encryption or decryption operation. </para>        </briefdescription>
        <detaileddescription>
<para>Not all CBC operations exhibit the specified return behavior. Functions that do not require significant computation and cannot offload that computation to a background thread behave like regular functions. Which functions exhibit the specified return behavior is not implementation dependent. Specifically, a software-backed implementation run on the same CPU as the application will emulate the return behavior while not actually offloading the computation to the background thread.</para><para>AESCBC functions exhibiting the specified return behavior have restrictions on the context from which they may be called.</para><para><table rows="4" cols="4"><row>
<entry thead="yes"><para></para></entry><entry thead="yes"><para>Task </para></entry><entry thead="yes"><para>Hwi </para></entry><entry thead="yes"><para>Swi  </para></entry></row>
<row>
<entry thead="no"><para>AESCBC_RETURN_BEHAVIOR_CALLBACK </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry></row>
<row>
<entry thead="no"><para>AESCBC_RETURN_BEHAVIOR_BLOCKING </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para></para></entry><entry thead="no"><para></para></entry></row>
<row>
<entry thead="no"><para>AESCBC_RETURN_BEHAVIOR_POLLING </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry></row>
</table>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="697" column="1" bodyfile="source/ti/drivers/AESCBC.h" bodystart="696" bodyend="715"/>
      </memberdef>
      <memberdef kind="enum" id="_a_e_s_c_b_c_8h_1a3d0b3dbc7f859b9d0c6acf102adb4d39" prot="public" static="no">
        <name>AESCBC_Mode</name>
        <enumvalue id="_a_e_s_c_b_c_8h_1a3d0b3dbc7f859b9d0c6acf102adb4d39a6937032fe648623f9b9a5f7b4dcce26a" prot="public">
          <name>AESCBC_MODE_ENCRYPT</name>
          <initializer>= 1</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_b_c_8h_1a3d0b3dbc7f859b9d0c6acf102adb4d39afacbd481470a984c92878b82c17a825c" prot="public">
          <name>AESCBC_MODE_DECRYPT</name>
          <initializer>= 2</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Enum for the direction of the CBC operation. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="721" column="1" bodyfile="source/ti/drivers/AESCBC.h" bodystart="720" bodyend="724"/>
      </memberdef>
      <memberdef kind="enum" id="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959" prot="public" static="no">
        <name>AESCBC_OperationType</name>
        <enumvalue id="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959ae9f86ebbb5b543515e8cf4b63d533924" prot="public">
          <name>AESCBC_OPERATION_TYPE_ENCRYPT</name>
          <initializer>= 1</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a9c63c1a604a8ef68797d84bed9cf20a5" prot="public">
          <name>AESCBC_OPERATION_TYPE_DECRYPT</name>
          <initializer>= 2</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a28e1fd2ea29d9c7cdd2534686f50ec5b" prot="public">
          <name>AESCBC_OP_TYPE_ONESTEP_ENCRYPT</name>
          <initializer>= 1</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959ad06b3a66a8906cbcdb2f21cb6ea57e89" prot="public">
          <name>AESCBC_OP_TYPE_ONESTEP_DECRYPT</name>
          <initializer>= 2</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a4d9d7bab075783ce371f817a1b4c0a37" prot="public">
          <name>AESCBC_OP_TYPE_ENCRYPT_SEGMENTED</name>
          <initializer>= 3</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959aa8e0e67a9f80b534073fc07030415085" prot="public">
          <name>AESCBC_OP_TYPE_DECRYPT_SEGMENTED</name>
          <initializer>= 4</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a15314c3bc0356e0a1cea870ffc2f5075" prot="public">
          <name>AESCBC_OP_TYPE_FINALIZE_ENCRYPT_SEGMENTED</name>
          <initializer>= 5</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a9fcc96b5e73a699498f3627085aa02cf" prot="public">
          <name>AESCBC_OP_TYPE_FINALIZE_DECRYPT_SEGMENTED</name>
          <initializer>= 6</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Enum for the operation types supported by the driver. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="816" column="1" bodyfile="source/ti/drivers/AESCBC.h" bodystart="815" bodyend="826"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="typedef">
      <memberdef kind="typedef" id="_a_e_s_c_b_c_8h_1af5f0c2913e25511cc73288b1db71d6e7" prot="public" static="no">
        <type><ref refid="struct_a_e_s_common___config" kindref="compound">AESCommon_Config</ref></type>
        <definition>typedef AESCommon_Config AESCBC_Config</definition>
        <argsstring></argsstring>
        <name>AESCBC_Config</name>
        <briefdescription>
<para>AESCBC Global configuration. </para>        </briefdescription>
        <detaileddescription>
<para>The <ref refid="_a_e_s_c_b_c_8h_1af5f0c2913e25511cc73288b1db71d6e7" kindref="member">AESCBC_Config</ref> structure contains a set of pointers used to characterize the AESCBC driver implementation.</para><para>This structure needs to be defined before calling <ref refid="_a_e_s_c_b_c_8h_1a72ae710de057086ca1d4e96f1a92a9a1" kindref="member">AESCBC_init()</ref> and it must not be changed thereafter.</para><para><simplesect kind="see"><para><ref refid="_a_e_s_c_b_c_8h_1a72ae710de057086ca1d4e96f1a92a9a1" kindref="member">AESCBC_init()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="668" column="1" bodyfile="source/ti/drivers/AESCBC.h" bodystart="668" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" prot="public" static="no">
        <type><ref refid="_a_e_s_c_b_c_8h_1af5f0c2913e25511cc73288b1db71d6e7" kindref="member">AESCBC_Config</ref> *</type>
        <definition>typedef AESCBC_Config* AESCBC_Handle</definition>
        <argsstring></argsstring>
        <name>AESCBC_Handle</name>
        <briefdescription>
<para>A handle that is returned from an <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> call. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="673" column="1" bodyfile="source/ti/drivers/AESCBC.h" bodystart="673" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="_a_e_s_c_b_c_8h_1a4f412502b110e7046c203e23722aaa89" prot="public" static="no">
        <type><ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref></type>
        <definition>typedef AESCBC_OneStepOperation AESCBC_Operation</definition>
        <argsstring></argsstring>
        <name>AESCBC_Operation</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><xrefsect id="deprecated_1_deprecated000002"><xreftitle>Deprecated</xreftitle><xrefdescription><para>Define a typedef for deprecated operation AESCBC_Operation. Existing code should be refactored to use <ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref>. This reference may be removed at some point in the future</para></xrefdescription></xrefsect></para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="800" column="1" bodyfile="source/ti/drivers/AESCBC.h" bodystart="800" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="_a_e_s_c_b_c_8h_1aa2bc486e0f51737928f21514715a537c" prot="public" static="no">
        <type>union <ref refid="union_a_e_s_c_b_c___operation_union" kindref="compound">AESCBC_OperationUnion</ref></type>
        <definition>typedef union AESCBC_OperationUnion  AESCBC_OperationUnion</definition>
        <argsstring></argsstring>
        <name>AESCBC_OperationUnion</name>
        <briefdescription>
<para>Union containing a reference to a one step or segmented operation. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="810" column="1"/>
      </memberdef>
      <memberdef kind="typedef" id="_a_e_s_c_b_c_8h_1ad3c538c1ce2d9aa37bd538a90f278b45" prot="public" static="no">
        <type>void(*</type>
        <definition>typedef void(* AESCBC_CallbackFxn) (AESCBC_Handle handle, int_fast16_t returnValue, AESCBC_OperationUnion *operation, AESCBC_OperationType operationType)</definition>
        <argsstring>)(AESCBC_Handle handle, int_fast16_t returnValue, AESCBC_OperationUnion *operation, AESCBC_OperationType operationType)</argsstring>
        <name>AESCBC_CallbackFxn</name>
        <briefdescription>
<para>The definition of a callback function used by the AESCBC driver when used in <ref refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5acedc995468fd1ad451c6aa24f56d456d" kindref="member">AESCBC_RETURN_BEHAVIOR_CALLBACK</ref>. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>handle</parametername>
</parameternamelist>
<parameterdescription>
<para>Handle of the client that started the CBC operation.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>returnValue</parametername>
</parameternamelist>
<parameterdescription>
<para>The result of the CBC operation. May contain an error code. Informs the application of why the callback function was called.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>operation</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to an operation union.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>operationType</parametername>
</parameternamelist>
<parameterdescription>
<para>This parameter determines which operation the callback refers to. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="843" column="1" bodyfile="source/ti/drivers/AESCBC.h" bodystart="843" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="_a_e_s_c_b_c_8h_1a65d438667291f32d79714a3b24b7e9bb" prot="public" static="no" mutable="no">
        <type>const <ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref></type>
        <definition>const AESCBC_Params AESCBC_defaultParams</definition>
        <argsstring></argsstring>
        <name>AESCBC_defaultParams</name>
        <briefdescription>
<para>Default <ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref> structure. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="see"><para><ref refid="_a_e_s_c_b_c_8h_1a3c0ff1f31e58390f960f927f12756a98" kindref="member">AESCBC_Params_init()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="873" column="1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a72ae710de057086ca1d4e96f1a92a9a1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCBC_init</definition>
        <argsstring>(void)</argsstring>
        <name>AESCBC_init</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>This function initializes the CBC module. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para>The AESCBC_config structure must exist and be persistent before this function can be called. This function must also be called before any other CBC driver APIs. This function call does not modify any peripheral registers. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="883" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a3c0ff1f31e58390f960f927f12756a98" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCBC_Params_init</definition>
        <argsstring>(AESCBC_Params *params)</argsstring>
        <name>AESCBC_Params_init</name>
        <param>
          <type><ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>Function to initialize the <ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>params</parametername>
</parameternamelist>
<parameterdescription>
<para>An pointer to <ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are: returnBehavior = AESCBC_RETURN_BEHAVIOR_BLOCKING callbackFxn = NULL timeout = SemaphoreP_WAIT_FOREVER custom = NULL </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="897" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
        <definition>AESCBC_Handle AESCBC_open</definition>
        <argsstring>(uint_least8_t index, const AESCBC_Params *params)</argsstring>
        <name>AESCBC_open</name>
        <param>
          <type>uint_least8_t</type>
          <declname>index</declname>
        </param>
        <param>
          <type>const <ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>This function opens a given CBC peripheral. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para>CBC controller has been initialized using <ref refid="_a_e_s_c_b_c_8h_1a72ae710de057086ca1d4e96f1a92a9a1" kindref="member">AESCBC_init()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">index</parametername>
</parameternamelist>
<parameterdescription>
<para>Logical peripheral number for the CBC indexed into the AESCBC_config table</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">params</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to an parameter block, if NULL it will use default values.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>An <ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref> on success or a NULL on an error or if it has been opened already.</para></simplesect>
<simplesect kind="see"><para><ref refid="_a_e_s_c_b_c_8h_1a72ae710de057086ca1d4e96f1a92a9a1" kindref="member">AESCBC_init()</ref> </para></simplesect>
<simplesect kind="see"><para><ref refid="_a_e_s_c_b_c_8h_1a3189993c935516a40c09110092e6ef19" kindref="member">AESCBC_close()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="916" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a3189993c935516a40c09110092e6ef19" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCBC_close</definition>
        <argsstring>(AESCBC_Handle handle)</argsstring>
        <name>AESCBC_close</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <briefdescription>
<para>Function to close a CBC peripheral specified by the CBC handle. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para><ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CBC handle</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="927" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a0864488e0826602937308930ab60e200" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCBC_Operation_init</definition>
        <argsstring>(AESCBC_Operation *operationStruct)</argsstring>
        <name>AESCBC_Operation_init</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4f412502b110e7046c203e23722aaa89" kindref="member">AESCBC_Operation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="_a_e_s_c_b_c_8h_1a4f412502b110e7046c203e23722aaa89" kindref="member">AESCBC_Operation</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><xrefsect id="deprecated_1_deprecated000003"><xreftitle>Deprecated</xreftitle><xrefdescription><para>This function should be replaced by calls to operation-specific init functions.</para></xrefdescription></xrefsect></para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to an <ref refid="_a_e_s_c_b_c_8h_1a4f412502b110e7046c203e23722aaa89" kindref="member">AESCBC_Operation</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="940" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a6715fbb822cc1ef0b60869588f60f7e2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCBC_OneStepOperation_init</definition>
        <argsstring>(AESCBC_OneStepOperation *operationStruct)</argsstring>
        <name>AESCBC_OneStepOperation_init</name>
        <param>
          <type><ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to an <ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="950" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a6b97cc99a27c2c2f20defb663d6eca26" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCBC_SegmentedOperation_init</definition>
        <argsstring>(AESCBC_SegmentedOperation *operationStruct)</argsstring>
        <name>AESCBC_SegmentedOperation_init</name>
        <param>
          <type><ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to an <ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="960" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1af3cf6e72eacee43c28450dad9dc3f046" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCBC_oneStepEncrypt</definition>
        <argsstring>(AESCBC_Handle handle, AESCBC_OneStepOperation *operationStruct)</argsstring>
        <name>AESCBC_oneStepEncrypt</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to perform an AESCBC encryption operation in one call. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="note"><para>None of the buffers provided as arguments may be altered by the application during an ongoing operation. Doing so can yield corrupted ciphertext.</para></simplesect>
<simplesect kind="pre"><para><ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref>, and <ref refid="_a_e_s_c_b_c_8h_1a6715fbb822cc1ef0b60869588f60f7e2" kindref="member">AESCBC_OneStepOperation_init()</ref> must be called first.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CBC handle returned from <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the parameters required to perform the operation.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" kindref="member">AESCBC_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" kindref="member">AESCBC_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1ad92a5502a5a56aaf28b7d930be275271" kindref="member">AESCBC_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1adf65612b9131789ae5db3e3151473bbc" kindref="member">AESCBC_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The input and/or output buffer were not word-aligned.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="_a_e_s_c_b_c_8h_1a3e603f77710ad26615805f9bb27672d3" kindref="member">AESCBC_oneStepDecrypt()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="982" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a3e603f77710ad26615805f9bb27672d3" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCBC_oneStepDecrypt</definition>
        <argsstring>(AESCBC_Handle handle, AESCBC_OneStepOperation *operationStruct)</argsstring>
        <name>AESCBC_oneStepDecrypt</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to perform an AESCBC decryption operation in one call. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="note"><para>None of the buffers provided as arguments may be altered by the application during an ongoing operation. Doing so can yield corrupted plaintext.</para></simplesect>
<simplesect kind="pre"><para><ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref>, and <ref refid="_a_e_s_c_b_c_8h_1a6715fbb822cc1ef0b60869588f60f7e2" kindref="member">AESCBC_OneStepOperation_init()</ref> must be called first.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CBC handle returned from <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the parameters required to perform the operation.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" kindref="member">AESCBC_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" kindref="member">AESCBC_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1ad92a5502a5a56aaf28b7d930be275271" kindref="member">AESCBC_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1adf65612b9131789ae5db3e3151473bbc" kindref="member">AESCBC_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The input and/or output buffer were not word-aligned.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="_a_e_s_c_b_c_8h_1af3cf6e72eacee43c28450dad9dc3f046" kindref="member">AESCBC_oneStepEncrypt()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="1004" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a5e3356cffdfd0671cdefb1aa11a97bca" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCBC_setupEncrypt</definition>
        <argsstring>(AESCBC_Handle handle, const CryptoKey *key)</argsstring>
        <name>AESCBC_setupEncrypt</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type>const <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> *</type>
          <declname>key</declname>
        </param>
        <briefdescription>
<para>Function to prepare a segmented AESCBC encryption operation. </para>        </briefdescription>
        <detaileddescription>
<para>This function sets up a segmented AESCBC encryption operation.</para><para><simplesect kind="pre"><para><ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CBC handle returned from <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">key</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to a previously initialized <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" kindref="member">AESCBC_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" kindref="member">AESCBC_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_b_c_8h_1a1a32ec040a89052bf3f6e08ddb5657e2" kindref="member">AESCBC_setIV()</ref> or <ref refid="_a_e_s_c_b_c_8h_1af8e25f2268d83629d9799a165bc7683c" kindref="member">AESCBC_generateIV()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="1023" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a144ccb3985ceeee03b370d68dd1ea4b2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCBC_setupDecrypt</definition>
        <argsstring>(AESCBC_Handle handle, const CryptoKey *key)</argsstring>
        <name>AESCBC_setupDecrypt</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type>const <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> *</type>
          <declname>key</declname>
        </param>
        <briefdescription>
<para>Function to prepare a segmented AESCBC decryption operation. </para>        </briefdescription>
        <detaileddescription>
<para>This function sets up a segmented AESCBC decryption operation.</para><para><simplesect kind="pre"><para><ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CBC handle returned from <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">key</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to a previously initialized <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" kindref="member">AESCBC_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" kindref="member">AESCBC_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_b_c_8h_1a1a32ec040a89052bf3f6e08ddb5657e2" kindref="member">AESCBC_setIV()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="1042" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a1a32ec040a89052bf3f6e08ddb5657e2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCBC_setIV</definition>
        <argsstring>(AESCBC_Handle handle, const uint8_t *iv, size_t ivLength)</argsstring>
        <name>AESCBC_setIV</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type>const uint8_t *</type>
          <declname>iv</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>ivLength</declname>
        </param>
        <briefdescription>
<para>Function to set an initialization vector for an AES CBC segmented operation. </para>        </briefdescription>
        <detaileddescription>
<para>This function sets up a segmented AESCBC encryption or decryption operation.</para><para><simplesect kind="pre"><para><ref refid="_a_e_s_c_b_c_8h_1a5e3356cffdfd0671cdefb1aa11a97bca" kindref="member">AESCBC_setupEncrypt()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a144ccb3985ceeee03b370d68dd1ea4b2" kindref="member">AESCBC_setupDecrypt()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CBC handle returned from <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">iv</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the buffer containing the initialization vector</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">ivLength</parametername>
</parameternamelist>
<parameterdescription>
<para>The length of the initialization vector. The length of the IV buffer must be 16 bytes.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" kindref="member">AESCBC_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" kindref="member">AESCBC_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_b_c_8h_1ab3f6ed48e40f396b1f99f071d74652c8" kindref="member">AESCBC_addData()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="1065" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1af8e25f2268d83629d9799a165bc7683c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCBC_generateIV</definition>
        <argsstring>(AESCBC_Handle handle, uint8_t *iv, size_t ivSize, size_t *ivLength)</argsstring>
        <name>AESCBC_generateIV</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>iv</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>ivSize</declname>
        </param>
        <param>
          <type>size_t *</type>
          <declname>ivLength</declname>
        </param>
        <briefdescription>
<para>Function to generate an initialization vector for an AES CBC segmented encryption operation. </para>        </briefdescription>
        <detaileddescription>
<para>This function sets up a segmented AESCBC encryption operation.</para><para><simplesect kind="pre"><para><ref refid="_a_e_s_c_b_c_8h_1a5e3356cffdfd0671cdefb1aa11a97bca" kindref="member">AESCBC_setupEncrypt()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CBC handle returned from <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">iv</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to a buffer to write the generated initialization vector to</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">ivSize</parametername>
</parameternamelist>
<parameterdescription>
<para>Size of the buffer pointed to by iv. This buffer must be 16 bytes long for AES CBC mode.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">ivLength</parametername>
</parameternamelist>
<parameterdescription>
<para>The length of the initialization vector actually written if the operation was successful.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" kindref="member">AESCBC_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" kindref="member">AESCBC_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a75fee21f079588cba1b516720b553f1a" kindref="member">AESCBC_STATUS_FEATURE_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation is not supported in this device.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_b_c_8h_1ab3f6ed48e40f396b1f99f071d74652c8" kindref="member">AESCBC_addData()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="1093" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1ab3f6ed48e40f396b1f99f071d74652c8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCBC_addData</definition>
        <argsstring>(AESCBC_Handle handle, AESCBC_SegmentedOperation *operation)</argsstring>
        <name>AESCBC_addData</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Encrypts or decrypts a segment of data defined by the <ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref> struct. </para>        </briefdescription>
        <detaileddescription>
<para><ref refid="_a_e_s_c_b_c_8h_1ab3f6ed48e40f396b1f99f071d74652c8" kindref="member">AESCBC_addData()</ref> may be called an arbitrary number times before finishing the operation with <ref refid="_a_e_s_c_b_c_8h_1a2e0e343511ed0d1ca298b22a09fc36a6" kindref="member">AESCBC_finalize()</ref>.</para><para>This function returns according to the return behavior set when opening the driver.</para><para><simplesect kind="pre"><para><ref refid="_a_e_s_c_b_c_8h_1a5e3356cffdfd0671cdefb1aa11a97bca" kindref="member">AESCBC_setupEncrypt()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a144ccb3985ceeee03b370d68dd1ea4b2" kindref="member">AESCBC_setupDecrypt()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CBC handle returned from <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to a segmented CBC operation structure</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" kindref="member">AESCBC_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" kindref="member">AESCBC_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1ad92a5502a5a56aaf28b7d930be275271" kindref="member">AESCBC_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1adf65612b9131789ae5db3e3151473bbc" kindref="member">AESCBC_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The input and/or output buffer were not word-aligned.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_b_c_8h_1ab3f6ed48e40f396b1f99f071d74652c8" kindref="member">AESCBC_addData()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a2e0e343511ed0d1ca298b22a09fc36a6" kindref="member">AESCBC_finalize()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="1118" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a2e0e343511ed0d1ca298b22a09fc36a6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCBC_finalize</definition>
        <argsstring>(AESCBC_Handle handle, AESCBC_SegmentedOperation *operation)</argsstring>
        <name>AESCBC_finalize</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Finalize the AES operation. If new data needs to be added, <computeroutput>inputLength</computeroutput> will be used to govern how many bytes will be written. New data must be a multiple of a block length, 16 bytes, or 0 if no new data needs to be added. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para><ref refid="_a_e_s_c_b_c_8h_1ab3f6ed48e40f396b1f99f071d74652c8" kindref="member">AESCBC_addData()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CBC handle returned from <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to a segmented CBC operation structure</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" kindref="member">AESCBC_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>In <ref refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5ad4cf399115e78f5253b12f88605d212e" kindref="member">AESCBC_RETURN_BEHAVIOR_BLOCKING</ref> and <ref refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5aeccf5cad47aac1edcef820125f7c361d" kindref="member">AESCBC_RETURN_BEHAVIOR_POLLING</ref>, this means the CBC was generated successfully. In <ref refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5acedc995468fd1ad451c6aa24f56d456d" kindref="member">AESCBC_RETURN_BEHAVIOR_CALLBACK</ref>, this means the operation started successfully. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" kindref="member">AESCBC_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1ad92a5502a5a56aaf28b7d930be275271" kindref="member">AESCBC_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1adf65612b9131789ae5db3e3151473bbc" kindref="member">AESCBC_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The input and/or output buffer were not word-aligned. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="1142" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a807f254a97d04e2b8e2c73d026d3c81a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCBC_cancelOperation</definition>
        <argsstring>(AESCBC_Handle handle)</argsstring>
        <name>AESCBC_cancelOperation</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <briefdescription>
<para>Cancels an ongoing AESCBC operation. </para>        </briefdescription>
        <detaileddescription>
<para>Asynchronously cancels an AESCBC operation. Only available when using AESCBC_RETURN_BEHAVIOR_CALLBACK. The operation will terminate as though an error occurred. The return status code of the operation will be AESCBC_STATUS_CANCELED.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>Handle of the operation to cancel</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" kindref="member">AESCBC_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled or the operation had already completed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" kindref="member">AESCBC_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The IV buffer was not properly cleared. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="1157" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref></type>
        <definition>AESCBC_Handle AESCBC_construct</definition>
        <argsstring>(AESCBC_Config *config, const AESCBC_Params *params)</argsstring>
        <name>AESCBC_construct</name>
        <param>
          <type><ref refid="_a_e_s_c_b_c_8h_1af5f0c2913e25511cc73288b1db71d6e7" kindref="member">AESCBC_Config</ref> *</type>
          <declname>config</declname>
        </param>
        <param>
          <type>const <ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>Constructs a new AESCBC object. </para>        </briefdescription>
        <detaileddescription>
<para>Unlike <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref>, <ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct()</ref> does not require the hwAttrs and object to be allocated in a <ref refid="_a_e_s_c_b_c_8h_1af5f0c2913e25511cc73288b1db71d6e7" kindref="member">AESCBC_Config</ref> array that is indexed into. Instead, the <ref refid="_a_e_s_c_b_c_8h_1af5f0c2913e25511cc73288b1db71d6e7" kindref="member">AESCBC_Config</ref>, hwAttrs, and object can be allocated at any location. This allows for relatively simple run-time allocation of temporary driver instances on the stack or the heap. The drawback is that this makes it more difficult to write device-agnostic code. If you use an ifdef with DeviceFamily, you can choose the correct object and hwAttrs to allocate. That compilation unit will be tied to the device it was compiled for at this point. To change devices, recompilation of the application with a different DeviceFamily setting is necessary.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">config</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="_a_e_s_c_b_c_8h_1af5f0c2913e25511cc73288b1db71d6e7" kindref="member">AESCBC_Config</ref> describing the location of the object and hwAttrs.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">params</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref> to configure the driver instance.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Returns a <ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref> on success or NULL on failure.</para></simplesect>
<simplesect kind="pre"><para>The object struct <computeroutput>config</computeroutput> points to must be zeroed out prior to calling this function. Otherwise, unexpected behavior may ensue. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCBC.h" line="1182" column="1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>AESCBC driver header. </para>    </briefdescription>
    <detaileddescription>
<para><hruler/>
</para><para><anchor id="_a_e_s_c_b_c_8h_1ti_drivers_AESCBC_Overview"/><heading level="1">Overview</heading>
</para><para>The Cipher Block Chaining (CBC) mode of operation is a generic block cipher mode of operation. It can be used with any block cipher including AES.</para><para>CBC mode encrypts messages of any practical length that have a length evenly divisible by the block size. Unlike ECB, it guarantees confidentiality of the entire message when the message is larger than one block.</para><para><heading level="2">Operation</heading>
</para><para>In CBC encryption, the initialization vector (IV) is XOR&apos;d with a block of plaintext and then encrypted. The output ciphertext block is then XOR&apos;d with the next plaintext block and the result is encrypted. This process is repeated until the final block of plaintext has been encrypted.</para><para>To decrypt the message, decrypt the first block of ciphertext and XOR the result with the IV. The result is the first plaintext block. For subsequent ciphertext blocks, decrypt each block and XOR the previous block of the encrypted message into the result.</para><para><heading level="2">Padding</heading>
</para><para>CBC operates on entire blocks of ciphertext and plaintext at a time. This means that message lengths must be a multiple of the block cipher block size. AES has a block size of 16 bytes no matter the key size. Since messages do not necessarily always have a length that is a multiple of 16 bytes, it may be necessary to pad the message to a 16-byte boundary. Padding requires the sender and receiver to implicitly agree on the padding convention. Improperly designed or implemented padding schemes may leak information to an attacker through a padding oracle attack for example.</para><para><heading level="2">Initialization Vectors</heading>
</para><para>The IV is generated by the party performing the encryption operation. Within the scope of any encryption key, the IV value must be unique. The IV does not need to be kept secret and is usually transmitted together with the ciphertext to the decrypting party. In CBC mode, the IVs must not be predictable. Two recommended ways to generate IVs is to either:</para><para><itemizedlist>
<listitem><para>Apply the block cipher (AESCBC), using the same key used with CBC, to a nonce. This nonce must be unique for each key-message pair. A counter will usually suffice. If the same symmetric key is used by both parties to encrypt messages, they should agree to use a nonce scheme that avoids generating the same nonce and thus IV twice. Incrementing the counter by two and making one party use even numbers and the other odd numbers is a common method to avoid such collisions.</para></listitem><listitem><para>Use a TRNG (True Random Number Generator) or PRNG (Pseudo-Random Number Generator) to generate a random number for use as IV.</para></listitem></itemizedlist>
</para><para><heading level="2">Drawbacks</heading>
</para><para>CBC mode has several drawbacks. Unless interfacing with legacy devices, it is recommended to use an AEAD (Authenticated Encryption with Associated Data) mode such as CCM or GCM. Below is a non-exhaustive list of reasons to use a different block cipher mode of operation.</para><para><itemizedlist>
<listitem><para>CBC mode does not offer authentication or integrity guarantees. In practice, this means that attackers can intercept the encrypted message and manipulate the ciphertext before sending the message on to the receiver. While this does not break confidentiality and reveal the plaintext, it has enabled several attacks in the past. This is especially problematic given that changing the ciphertext of a block will only corrupt the block itself and the subsequent block of resultant plaintext. This property may be used to manipulate only certain parts of the message.</para></listitem><listitem><para>CBC mode requires message lengths to be evenly divisible by the block size. This necessitates a padding scheme. Improperly implemented padding schemes may lead to vulnerabilities that can be exploited by attackers. It often makes more sense to use a dedicated stream cipher such as CTR (Counter) that does not have this restriction. CCM and GCM both use CTR for encryption.</para></listitem></itemizedlist>
</para><para><anchor id="_a_e_s_c_b_c_8h_1ti_drivers_AESCBC_Usage"/><heading level="1">Usage</heading>
</para><para><heading level="2">Before starting a CBC operation</heading>
</para><para>Before starting a CBC operation, the application must do the following:<itemizedlist>
<listitem><para>Call <ref refid="_a_e_s_c_b_c_8h_1a72ae710de057086ca1d4e96f1a92a9a1" kindref="member">AESCBC_init()</ref> to initialize the driver</para></listitem><listitem><para>Call <ref refid="_a_e_s_c_b_c_8h_1a3c0ff1f31e58390f960f927f12756a98" kindref="member">AESCBC_Params_init()</ref> to initialize the <ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref> to default values.</para></listitem><listitem><para>Modify the <ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref> as desired</para></listitem><listitem><para>Call <ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open()</ref> to open an instance of the driver</para></listitem><listitem><para>Initialize a <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>. These opaque data structures are representations of keying material and its storage. Depending on how the keying material is stored (RAM or flash, key store), the <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> must be initialized differently. The AESCBC API can handle all types of <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>. However, not all device-specific implementations support all types of <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>. Devices without a key store will not support CryptoKeys with keying material stored in a key store for example. All devices support plaintext CryptoKeys.</para></listitem><listitem><para>Initialize the appropriate AESCBC operation struct using the relevant operation init functions and set all fields. For example, one-step (one-shot or single call) operations should initialize AESCBC_Operation or <ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref> using <ref refid="_a_e_s_c_b_c_8h_1a0864488e0826602937308930ab60e200" kindref="member">AESCBC_Operation_init()</ref> or <ref refid="_a_e_s_c_b_c_8h_1a6715fbb822cc1ef0b60869588f60f7e2" kindref="member">AESCBC_OneStepOperation_init()</ref>. For multi-step (segmented or multiple call) operations, <ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref> must be initialized and set.</para></listitem></itemizedlist>
</para><para><heading level="2">Starting a CBC operation</heading>
</para><para>The <ref refid="_a_e_s_c_b_c_8h_1af3cf6e72eacee43c28450dad9dc3f046" kindref="member">AESCBC_oneStepEncrypt</ref> and <ref refid="_a_e_s_c_b_c_8h_1a3e603f77710ad26615805f9bb27672d3" kindref="member">AESCBC_oneStepDecrypt</ref> functions perform a CBC operation in a single call. They will always be the most highly optimized routines with the least overhead and the fastest runtime. However, they require all plaintext or ciphertext to be available to the function at the start of the call. All devices support single call operations.</para><para><heading level="2">After the CBC operation completes</heading>
</para><para>After the CBC operation completes, the application should either start another operation or close the driver by calling <ref refid="_a_e_s_c_b_c_8h_1a3189993c935516a40c09110092e6ef19" kindref="member">AESCBC_close()</ref>.</para><para><anchor id="_a_e_s_c_b_c_8h_1ti_drivers_AESCBC_Synopsis"/><heading level="2">Synopsis</heading>
</para><para><anchor id="_a_e_s_c_b_c_8h_1ti_drivers_AESCBC_Synopsis_Code"/><programlisting><codeline><highlight class="normal">//<sp/>Import<sp/>AESCBC<sp/>Driver<sp/>definitions</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Define<sp/>name<sp/>for<sp/>AESCBC<sp/>channel<sp/>index</highlight></codeline>
<codeline><highlight class="normal">#define<sp/>AESCBC_INSTANCE<sp/>0</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_init();</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">handle<sp/>=<sp/>AESCBC_open(AESCBC_INSTANCE,<sp/>NULL);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Initialize<sp/>symmetric<sp/>key</highlight></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Set<sp/>up<sp/>AESCBC_Operation</highlight></codeline>
<codeline><highlight class="normal">AESCBC_OneStepOperation<sp/>operation;</highlight></codeline>
<codeline><highlight class="normal">AESCBC_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline><highlight class="normal">operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline><highlight class="normal">operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal">operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal">operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext);</highlight></codeline>
<codeline><highlight class="normal">operation.iv<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>iv;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCBC_oneStepEncrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_close(handle);</highlight></codeline>
</programlisting></para><para><anchor id="_a_e_s_c_b_c_8h_1ti_drivers_AESCBC_Examples"/><heading level="2">Examples</heading>
</para><para>### Single call CBC encryption with plaintext <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> in blocking return mode # <programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_Handle<sp/>handle;</highlight></codeline>
<codeline><highlight class="normal">CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline><highlight class="normal">int_fast16_t<sp/>encryptionResult;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>For<sp/>example<sp/>purposes<sp/>only.<sp/>Generate<sp/>IVs<sp/>in<sp/>a<sp/>non-static<sp/>way<sp/>in<sp/>practice.</highlight></codeline>
<codeline><highlight class="normal">//<sp/>Test<sp/>vector<sp/>0<sp/>from<sp/>NIST<sp/>CAPV<sp/>set<sp/>CBCMMT128</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>iv[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0x2f,<sp/>0xe2,<sp/>0xb3,<sp/>0x33,<sp/>0xce,<sp/>0xda,<sp/>0x8f,<sp/>0x98,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xf4,<sp/>0xa9,<sp/>0x9b,<sp/>0x40,<sp/>0xd2,<sp/>0xcd,<sp/>0x34,<sp/>0xa8};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>plaintext[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0x45,<sp/>0xcf,<sp/>0x12,<sp/>0x96,<sp/>0x4f,<sp/>0xc8,<sp/>0x24,<sp/>0xab,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x76,<sp/>0x61,<sp/>0x6a,<sp/>0xe2,<sp/>0xf4,<sp/>0xbf,<sp/>0x08,<sp/>0x22};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ciphertext[sizeof(plaintext)];</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>keyingMaterial[16]<sp/>=<sp/><sp/><sp/><sp/>{0x1f,<sp/>0x8e,<sp/>0x49,<sp/>0x73,<sp/>0x95,<sp/>0x3f,<sp/>0x3f,<sp/>0xb0,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xbd,<sp/>0x6b,<sp/>0x16,<sp/>0x66,<sp/>0x2e,<sp/>0x9a,<sp/>0x3c,<sp/>0x17};</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>ciphertext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>encryption<sp/>operation:</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x0f,<sp/>0x61,<sp/>0xc4,<sp/>0xd4,<sp/>0x4c,<sp/>0x51,<sp/>0x47,<sp/>0xc0</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x3c,<sp/>0x19,<sp/>0x5a,<sp/>0xd7,<sp/>0xe2,<sp/>0xcc,<sp/>0x12,<sp/>0xb2</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal">handle<sp/>=<sp/>AESCBC_open(0,<sp/>NULL);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_OneStepOperation<sp/>operation;</highlight></codeline>
<codeline><highlight class="normal">AESCBC_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline><highlight class="normal">operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal">operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal">operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext);</highlight></codeline>
<codeline><highlight class="normal">operation.iv<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>iv;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCBC_oneStepEncrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_close(handle);</highlight></codeline>
</programlisting></para><para><heading level="3">Single call CBC decryption with plaintext <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> in callback return mode</heading>
</para><para><simplesect kind="note"><para>The following code example presented uses a 256-bit key. However, CC13x1/CC26x1 and CC23x0 only support a maximum key size of 128-bits, so reduction of keyingMaterial would be required.</para></simplesect>
<programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Test<sp/>vector<sp/>0<sp/>from<sp/>NIST<sp/>CAPV<sp/>set<sp/>CBCMMT256</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">uint8_t<sp/>iv[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0xdd,<sp/>0xbb,<sp/>0xb0,<sp/>0x17,<sp/>0x3f,<sp/>0x1e,<sp/>0x2d,<sp/>0xeb,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x23,<sp/>0x94,<sp/>0xa6,<sp/>0x2a,<sp/>0xa2,<sp/>0xa0,<sp/>0x24,<sp/>0x0e};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ciphertext[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0xd5,<sp/>0x1d,<sp/>0x19,<sp/>0xde,<sp/>0xd5,<sp/>0xca,<sp/>0x4a,<sp/>0xe1,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x4b,<sp/>0x2b,<sp/>0x20,<sp/>0xb0,<sp/>0x27,<sp/>0xff,<sp/>0xb0,<sp/>0x20};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>keyingMaterial[32]<sp/>=<sp/><sp/><sp/><sp/>{0x43,<sp/>0xe9,<sp/>0x53,<sp/>0xb2,<sp/>0xae,<sp/>0xa0,<sp/>0x8a,<sp/>0x3a,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xd5,<sp/>0x2d,<sp/>0x18,<sp/>0x2f,<sp/>0x58,<sp/>0xc7,<sp/>0x2b,<sp/>0x9c,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x60,<sp/>0xfb,<sp/>0xe4,<sp/>0xa9,<sp/>0xca,<sp/>0x46,<sp/>0xa3,<sp/>0xcb,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x89,<sp/>0xe3,<sp/>0x86,<sp/>0x38,<sp/>0x45,<sp/>0xe2,<sp/>0x2c,<sp/>0x9e};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>plaintext[sizeof(ciphertext)];</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>plaintext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>decryption<sp/>operation:</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x07,<sp/>0x27,<sp/>0x0d,<sp/>0x0e,<sp/>0x63,<sp/>0xaa,<sp/>0x36,<sp/>0xda</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0xed,<sp/>0x8c,<sp/>0x6a,<sp/>0xde,<sp/>0x13,<sp/>0xac,<sp/>0x1a,<sp/>0xf1</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal">void<sp/>cbcCallback(AESCBC_Handle<sp/>handle,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OperationUnion<sp/>*operation,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OperationType<sp/>operationType)<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(returnValue<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(operationType<sp/>==<sp/>AESCBC_OPERATION_TYPE_DECRYPT<sp/>||</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCBC_OPERATION_TYPE_ENCRYPT)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>something<sp/>with<sp/>operation-&gt;oneStepOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/>else<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>something<sp/>with<sp/>operation-&gt;segmentedOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_OneStepOperation<sp/>operation;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">void<sp/>cbcStartFunction(void)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCBC_Handle<sp/>handle;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCBC_Params<sp/>params;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>int_fast16_t<sp/>decryptionResult;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCBC_Params_init(&amp;params);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>params.returnBehavior<sp/>=<sp/>AESCBC_RETURN_BEHAVIOR_CALLBACK;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>params.callbackFxn<sp/>=<sp/>cbcCallback;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>handle<sp/>=<sp/>AESCBC_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCBC_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(ciphertext);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.iv<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>iv;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCBC_oneStepDecrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>do<sp/>other<sp/>things<sp/>while<sp/>CBC<sp/>operation<sp/>completes<sp/>in<sp/>the<sp/>background</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para><para>### Multi-step CBC encryption with plaintext <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> in blocking return mode # <programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">#define<sp/>AES_BLOCK_SIZE<sp/><sp/><sp/><sp/><sp/><sp/>16<sp/>//<sp/>bytes</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_Handle<sp/>handle;</highlight></codeline>
<codeline><highlight class="normal">CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline><highlight class="normal">int_fast16_t<sp/>encryptionResult;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>For<sp/>example<sp/>purposes<sp/>only.<sp/>Generate<sp/>IVs<sp/>in<sp/>a<sp/>non-static<sp/>way<sp/>in<sp/>practice.</highlight></codeline>
<codeline><highlight class="normal">//<sp/>Test<sp/>vector<sp/>0<sp/>from<sp/>NIST<sp/>CAPV<sp/>set<sp/>CBCMMT128</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>iv[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0x2f,<sp/>0xe2,<sp/>0xb3,<sp/>0x33,<sp/>0xce,<sp/>0xda,<sp/>0x8f,<sp/>0x98,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xf4,<sp/>0xa9,<sp/>0x9b,<sp/>0x40,<sp/>0xd2,<sp/>0xcd,<sp/>0x34,<sp/>0xa8};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>plaintext[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0x45,<sp/>0xcf,<sp/>0x12,<sp/>0x96,<sp/>0x4f,<sp/>0xc8,<sp/>0x24,<sp/>0xab,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x76,<sp/>0x61,<sp/>0x6a,<sp/>0xe2,<sp/>0xf4,<sp/>0xbf,<sp/>0x08,<sp/>0x22};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ciphertext[sizeof(plaintext)];</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>keyingMaterial[16]<sp/>=<sp/><sp/><sp/><sp/>{0x1f,<sp/>0x8e,<sp/>0x49,<sp/>0x73,<sp/>0x95,<sp/>0x3f,<sp/>0x3f,<sp/>0xb0,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xbd,<sp/>0x6b,<sp/>0x16,<sp/>0x66,<sp/>0x2e,<sp/>0x9a,<sp/>0x3c,<sp/>0x17};</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>ciphertext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>encryption<sp/>operation:</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x0f,<sp/>0x61,<sp/>0xc4,<sp/>0xd4,<sp/>0x4c,<sp/>0x51,<sp/>0x47,<sp/>0xc0</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x3c,<sp/>0x19,<sp/>0x5a,<sp/>0xd7,<sp/>0xe2,<sp/>0xcc,<sp/>0x12,<sp/>0xb2</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal">handle<sp/>=<sp/>AESCBC_open(0,<sp/>NULL);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_SegmentedOperation<sp/>operation;</highlight></codeline>
<codeline><highlight class="normal">AESCBC_SegmentedOperation_init(&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal">operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal">operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCBC_setupEncrypt(handle,<sp/>&amp;cryptoKey);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCBC_setIV(handle,<sp/>iv,<sp/>AES_BLOCK_SIZE);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCBC_addData(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">operation.inputLength<sp/>=<sp/>0;</highlight></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCBC_finalize(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_close(handle);</highlight></codeline>
</programlisting></para><para><heading level="3">Multi-step CBC decryption with plaintext <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> in callback return mode</heading>
</para><para><simplesect kind="note"><para>The following code example presented uses a 256-bit key. However, CC13x1/CC26x1 and CC23x0 only support a maximum key size of 128-bits, so reduction of keyingMaterial would be required.</para></simplesect>
<programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">#define<sp/>AES_BLOCK_SIZE<sp/><sp/><sp/><sp/><sp/><sp/>16<sp/>//<sp/>bytes</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Test<sp/>vector<sp/>0<sp/>from<sp/>NIST<sp/>CAPV<sp/>set<sp/>CBCMMT256</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">uint8_t<sp/>iv[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0xdd,<sp/>0xbb,<sp/>0xb0,<sp/>0x17,<sp/>0x3f,<sp/>0x1e,<sp/>0x2d,<sp/>0xeb,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x23,<sp/>0x94,<sp/>0xa6,<sp/>0x2a,<sp/>0xa2,<sp/>0xa0,<sp/>0x24,<sp/>0x0e};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ciphertext[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0xd5,<sp/>0x1d,<sp/>0x19,<sp/>0xde,<sp/>0xd5,<sp/>0xca,<sp/>0x4a,<sp/>0xe1,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x4b,<sp/>0x2b,<sp/>0x20,<sp/>0xb0,<sp/>0x27,<sp/>0xff,<sp/>0xb0,<sp/>0x20};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>keyingMaterial[32]<sp/>=<sp/><sp/><sp/><sp/>{0x43,<sp/>0xe9,<sp/>0x53,<sp/>0xb2,<sp/>0xae,<sp/>0xa0,<sp/>0x8a,<sp/>0x3a,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xd5,<sp/>0x2d,<sp/>0x18,<sp/>0x2f,<sp/>0x58,<sp/>0xc7,<sp/>0x2b,<sp/>0x9c,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x60,<sp/>0xfb,<sp/>0xe4,<sp/>0xa9,<sp/>0xca,<sp/>0x46,<sp/>0xa3,<sp/>0xcb,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x89,<sp/>0xe3,<sp/>0x86,<sp/>0x38,<sp/>0x45,<sp/>0xe2,<sp/>0x2c,<sp/>0x9e};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>plaintext[sizeof(ciphertext)];</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>plaintext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>decryption<sp/>operation:</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x07,<sp/>0x27,<sp/>0x0d,<sp/>0x0e,<sp/>0x63,<sp/>0xaa,<sp/>0x36,<sp/>0xda</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0xed,<sp/>0x8c,<sp/>0x6a,<sp/>0xde,<sp/>0x13,<sp/>0xac,<sp/>0x1a,<sp/>0xf1</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal">void<sp/>cbcCallback(AESCBC_Handle<sp/>handle,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OperationUnion<sp/>*operation,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OperationType<sp/>operationType)<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(returnValue<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(operationType<sp/>==<sp/>AESCBC_OPERATION_TYPE_DECRYPT<sp/>||</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCBC_OPERATION_TYPE_ENCRYPT)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>something<sp/>with<sp/>operation-&gt;oneStepOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/>else<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>something<sp/>with<sp/>operation-&gt;segmentedOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_SegmentedOperation<sp/>operation;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">void<sp/>cbcStartFunction(void)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCBC_Handle<sp/>handle;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCBC_Params<sp/>params;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>int_fast16_t<sp/>decryptionResult;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCBC_Params_init(&amp;params);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>params.returnBehavior<sp/>=<sp/>AESCBC_RETURN_BEHAVIOR_CALLBACK;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>params.callbackFxn<sp/>=<sp/>cbcCallback;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>handle<sp/>=<sp/>AESCBC_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCBC_SegmentedOperation_init(&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(ciphertext);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCBC_setupDecrypt(handle,<sp/>&amp;cryptoKey);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCBC_setIV(handle,<sp/>iv,<sp/>AES_BLOCK_SIZE);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCBC_addData(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>do<sp/>other<sp/>things<sp/>while<sp/>CBC<sp/>operation<sp/>completes<sp/>in<sp/>the<sp/>background</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.inputLength<sp/>=<sp/>0;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCBC_finalize(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para><para><heading level="3">Multi-step CBC encryption with plaintext <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> and non-empty finalize in blocking return mode</heading>
</para><para><programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">#define<sp/>AES_BLOCK_SIZE<sp/><sp/><sp/><sp/><sp/><sp/>16<sp/>//<sp/>bytes</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_Handle<sp/>handle;</highlight></codeline>
<codeline><highlight class="normal">CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline><highlight class="normal">int_fast16_t<sp/>encryptionResult;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>For<sp/>example<sp/>purposes<sp/>only.<sp/>Generate<sp/>IVs<sp/>in<sp/>a<sp/>non-static<sp/>way<sp/>in<sp/>practice.</highlight></codeline>
<codeline><highlight class="normal">//<sp/>Test<sp/>vector<sp/>1<sp/>from<sp/>NIST<sp/>CAPV<sp/>set<sp/>CBCMMT128</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>iv[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0xaa,<sp/>0xd1,<sp/>0x58,<sp/>0x3c,<sp/>0xd9,<sp/>0x13,<sp/>0x65,<sp/>0xe3,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xbb,<sp/>0x2f,<sp/>0x0c,<sp/>0x34,<sp/>0x30,<sp/>0xd0,<sp/>0x65,<sp/>0xbb};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>plaintext[32]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0x06,<sp/>0x8b,<sp/>0x25,<sp/>0xc7,<sp/>0xbf,<sp/>0xb1,<sp/>0xf8,<sp/>0xbd,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xd4,<sp/>0xcf,<sp/>0xc9,<sp/>0x08,<sp/>0xf6,<sp/>0x9d,<sp/>0xff,<sp/>0xc5,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xdd,<sp/>0xc7,<sp/>0x26,<sp/>0xa1,<sp/>0x97,<sp/>0xf0,<sp/>0xe5,<sp/>0xf7,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x20,<sp/>0xf7,<sp/>0x30,<sp/>0x39,<sp/>0x32,<sp/>0x79,<sp/>0xbe,<sp/>0x91};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ciphertext[sizeof(plaintext)];</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>keyingMaterial[16]<sp/>=<sp/><sp/><sp/><sp/>{0x07,<sp/>0x00,<sp/>0xd6,<sp/>0x03,<sp/>0xa1,<sp/>0xc5,<sp/>0x14,<sp/>0xe4,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x6b,<sp/>0x61,<sp/>0x91,<sp/>0xba,<sp/>0x43,<sp/>0x0a,<sp/>0x3a,<sp/>0x0c};</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>ciphertext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>encryption<sp/>operation:</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0xc4,<sp/>0xdc,<sp/>0x61,<sp/>0xd9,<sp/>0x72,<sp/>0x59,<sp/>0x67,<sp/>0xa3</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x02,<sp/>0x01,<sp/>0x04,<sp/>0xa9,<sp/>0x73,<sp/>0x8f,<sp/>0x23,<sp/>0x86</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x85,<sp/>0x27,<sp/>0xce,<sp/>0x83,<sp/>0x9a,<sp/>0xab,<sp/>0x17,<sp/>0x52</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0xfd,<sp/>0x8b,<sp/>0xdb,<sp/>0x95,<sp/>0xa8,<sp/>0x2c,<sp/>0x4d,<sp/>0x00</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal">handle<sp/>=<sp/>AESCBC_open(0,<sp/>NULL);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_SegmentedOperation<sp/>operation;</highlight></codeline>
<codeline><highlight class="normal">AESCBC_SegmentedOperation_init(&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal">operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal">//<sp/>One<sp/>should<sp/>pass<sp/>in<sp/>data<sp/>that<sp/>is<sp/>a<sp/>block-sized<sp/>multiple<sp/>length<sp/>(16<sp/>bytes)</highlight></codeline>
<codeline><highlight class="normal">operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCBC_setupEncrypt(handle,<sp/>&amp;cryptoKey);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCBC_setIV(handle,<sp/>iv,<sp/>AES_BLOCK_SIZE);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCBC_addData(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline><highlight class="normal">operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>You<sp/>can<sp/>also<sp/>finalize<sp/>with<sp/>more<sp/>data<sp/>(non-zero<sp/>inputLength)</highlight></codeline>
<codeline><highlight class="normal">operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext)<sp/>-<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCBC_finalize(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCBC_close(handle);</highlight></codeline>
</programlisting> </para>    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2018-2022,<sp/>Texas<sp/>Instruments<sp/>Incorporated</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>All<sp/>rights<sp/>reserved.</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the<sp/>distribution.</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Neither<sp/>the<sp/>name<sp/>of<sp/>Texas<sp/>Instruments<sp/>Incorporated<sp/>nor<sp/>the<sp/>names<sp/>of</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>its<sp/>contributors<sp/>may<sp/>be<sp/>used<sp/>to<sp/>endorse<sp/>or<sp/>promote<sp/>products<sp/>derived</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>from<sp/>this<sp/>software<sp/>without<sp/>specific<sp/>prior<sp/>written<sp/>permission.</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>THE<sp/>COPYRIGHT<sp/>HOLDERS<sp/>AND<sp/>CONTRIBUTORS<sp/>&quot;AS<sp/>IS&quot;</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>AND<sp/>ANY<sp/>EXPRESS<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>COPYRIGHT<sp/>OWNER<sp/>OR</highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/>CONTRIBUTORS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,<sp/>SPECIAL,</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/>DATA,<sp/>OR<sp/>PROFITS;</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/>THEORY<sp/>OF<sp/>LIABILITY,</highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/>OF<sp/>THIS<sp/>SOFTWARE,</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="comment">/*!***************************************************************************</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*<sp/><sp/>@file<sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC.h</highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*<sp/><sp/>@brief<sp/><sp/><sp/><sp/><sp/><sp/>AESCBC<sp/>driver<sp/>header</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/>*<sp/><sp/>@anchor<sp/>ti_drivers_AESCBC_Overview</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*<sp/><sp/>#<sp/>Overview<sp/>#</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>Cipher<sp/>Block<sp/>Chaining<sp/>(CBC)<sp/>mode<sp/>of<sp/>operation<sp/>is<sp/>a<sp/>generic</highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/>*<sp/><sp/>block<sp/>cipher<sp/>mode<sp/>of<sp/>operation.<sp/>It<sp/>can<sp/>be<sp/>used<sp/>with<sp/>any<sp/>block<sp/>cipher</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/>*<sp/><sp/>including<sp/>AES.</highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/>*<sp/><sp/>CBC<sp/>mode<sp/>encrypts<sp/>messages<sp/>of<sp/>any<sp/>practical<sp/>length<sp/>that<sp/>have<sp/>a<sp/>length</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/>*<sp/><sp/>evenly<sp/>divisible<sp/>by<sp/>the<sp/>block<sp/>size.<sp/>Unlike<sp/>ECB,<sp/>it<sp/>guarantees</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/>*<sp/><sp/>confidentiality<sp/>of<sp/>the<sp/>entire<sp/>message<sp/>when<sp/>the<sp/>message<sp/>is<sp/>larger<sp/>than</highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/>*<sp/><sp/>one<sp/>block.</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Operation<sp/>#</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/>*<sp/><sp/>In<sp/>CBC<sp/>encryption,<sp/>the<sp/>initialization<sp/>vector<sp/>(IV)<sp/>is<sp/>XOR&apos;d<sp/>with<sp/>a<sp/>block<sp/>of</highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/>*<sp/><sp/>plaintext<sp/>and<sp/>then<sp/>encrypted.<sp/>The<sp/>output<sp/>ciphertext<sp/>block<sp/>is<sp/>then<sp/>XOR&apos;d<sp/>with</highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/>*<sp/><sp/>the<sp/>next<sp/>plaintext<sp/>block<sp/>and<sp/>the<sp/>result<sp/>is<sp/>encrypted.<sp/>This<sp/>process<sp/>is<sp/>repeated</highlight></codeline>
<codeline lineno="52"><highlight class="comment"><sp/>*<sp/><sp/>until<sp/>the<sp/>final<sp/>block<sp/>of<sp/>plaintext<sp/>has<sp/>been<sp/>encrypted.</highlight></codeline>
<codeline lineno="53"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="54"><highlight class="comment"><sp/>*<sp/><sp/>To<sp/>decrypt<sp/>the<sp/>message,<sp/>decrypt<sp/>the<sp/>first<sp/>block<sp/>of<sp/>ciphertext<sp/>and<sp/>XOR<sp/>the<sp/>result</highlight></codeline>
<codeline lineno="55"><highlight class="comment"><sp/>*<sp/><sp/>with<sp/>the<sp/>IV.<sp/>The<sp/>result<sp/>is<sp/>the<sp/>first<sp/>plaintext<sp/>block.<sp/>For<sp/>subsequent<sp/>ciphertext</highlight></codeline>
<codeline lineno="56"><highlight class="comment"><sp/>*<sp/><sp/>blocks,<sp/>decrypt<sp/>each<sp/>block<sp/>and<sp/>XOR<sp/>the<sp/>previous<sp/>block<sp/>of<sp/>the<sp/>encrypted<sp/>message</highlight></codeline>
<codeline lineno="57"><highlight class="comment"><sp/>*<sp/><sp/>into<sp/>the<sp/>result.</highlight></codeline>
<codeline lineno="58"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="59"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Padding<sp/>#</highlight></codeline>
<codeline lineno="60"><highlight class="comment"><sp/>*<sp/><sp/>CBC<sp/>operates<sp/>on<sp/>entire<sp/>blocks<sp/>of<sp/>ciphertext<sp/>and<sp/>plaintext<sp/>at<sp/>a<sp/>time.<sp/>This</highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/>*<sp/><sp/>means<sp/>that<sp/>message<sp/>lengths<sp/>must<sp/>be<sp/>a<sp/>multiple<sp/>of<sp/>the<sp/>block<sp/>cipher<sp/>block<sp/>size.</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/>*<sp/><sp/>AES<sp/>has<sp/>a<sp/>block<sp/>size<sp/>of<sp/>16<sp/>bytes<sp/>no<sp/>matter<sp/>the<sp/>key<sp/>size.<sp/>Since<sp/>messages<sp/>do</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/>*<sp/><sp/>not<sp/>necessarily<sp/>always<sp/>have<sp/>a<sp/>length<sp/>that<sp/>is<sp/>a<sp/>multiple<sp/>of<sp/>16<sp/>bytes,<sp/>it<sp/>may</highlight></codeline>
<codeline lineno="64"><highlight class="comment"><sp/>*<sp/><sp/>be<sp/>necessary<sp/>to<sp/>pad<sp/>the<sp/>message<sp/>to<sp/>a<sp/>16-byte<sp/>boundary.<sp/>Padding<sp/>requires</highlight></codeline>
<codeline lineno="65"><highlight class="comment"><sp/>*<sp/><sp/>the<sp/>sender<sp/>and<sp/>receiver<sp/>to<sp/>implicitly<sp/>agree<sp/>on<sp/>the<sp/>padding<sp/>convention.</highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/>*<sp/><sp/>Improperly<sp/>designed<sp/>or<sp/>implemented<sp/>padding<sp/>schemes<sp/>may<sp/>leak<sp/>information</highlight></codeline>
<codeline lineno="67"><highlight class="comment"><sp/>*<sp/><sp/>to<sp/>an<sp/>attacker<sp/>through<sp/>a<sp/>padding<sp/>oracle<sp/>attack<sp/>for<sp/>example.</highlight></codeline>
<codeline lineno="68"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="69"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Initialization<sp/>Vectors<sp/>#</highlight></codeline>
<codeline lineno="70"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>IV<sp/>is<sp/>generated<sp/>by<sp/>the<sp/>party<sp/>performing<sp/>the<sp/>encryption<sp/>operation.</highlight></codeline>
<codeline lineno="71"><highlight class="comment"><sp/>*<sp/><sp/>Within<sp/>the<sp/>scope<sp/>of<sp/>any<sp/>encryption<sp/>key,<sp/>the<sp/>IV<sp/>value<sp/>must<sp/>be<sp/>unique.</highlight></codeline>
<codeline lineno="72"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>IV<sp/>does<sp/>not<sp/>need<sp/>to<sp/>be<sp/>kept<sp/>secret<sp/>and<sp/>is<sp/>usually<sp/>transmitted<sp/>together</highlight></codeline>
<codeline lineno="73"><highlight class="comment"><sp/>*<sp/><sp/>with<sp/>the<sp/>ciphertext<sp/>to<sp/>the<sp/>decrypting<sp/>party.</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/>*<sp/><sp/>In<sp/>CBC<sp/>mode,<sp/>the<sp/>IVs<sp/>must<sp/>not<sp/>be<sp/>predictable.<sp/>Two<sp/>recommended<sp/>ways<sp/>to</highlight></codeline>
<codeline lineno="75"><highlight class="comment"><sp/>*<sp/><sp/>generate<sp/>IVs<sp/>is<sp/>to<sp/>either:</highlight></codeline>
<codeline lineno="76"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/>*<sp/><sp/>-<sp/>Apply<sp/>the<sp/>block<sp/>cipher<sp/>(AESCBC),<sp/>using<sp/>the<sp/>same<sp/>key<sp/>used<sp/>with<sp/>CBC,</highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>to<sp/>a<sp/>nonce.<sp/>This<sp/>nonce<sp/>must<sp/>be<sp/>unique<sp/>for<sp/>each<sp/>key-message<sp/>pair.</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>A<sp/>counter<sp/>will<sp/>usually<sp/>suffice.<sp/>If<sp/>the<sp/>same<sp/>symmetric<sp/>key<sp/>is<sp/>used</highlight></codeline>
<codeline lineno="80"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>by<sp/>both<sp/>parties<sp/>to<sp/>encrypt<sp/>messages,<sp/>they<sp/>should<sp/>agree<sp/>to<sp/>use<sp/>a</highlight></codeline>
<codeline lineno="81"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>nonce<sp/>scheme<sp/>that<sp/>avoids<sp/>generating<sp/>the<sp/>same<sp/>nonce<sp/>and<sp/>thus<sp/>IV<sp/>twice.</highlight></codeline>
<codeline lineno="82"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>Incrementing<sp/>the<sp/>counter<sp/>by<sp/>two<sp/>and<sp/>making<sp/>one<sp/>party<sp/>use<sp/>even<sp/>numbers</highlight></codeline>
<codeline lineno="83"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>and<sp/>the<sp/>other<sp/>odd<sp/>numbers<sp/>is<sp/>a<sp/>common<sp/>method<sp/>to<sp/>avoid<sp/>such<sp/>collisions.</highlight></codeline>
<codeline lineno="84"><highlight class="comment"><sp/>*<sp/><sp/>-<sp/>Use<sp/>a<sp/>TRNG<sp/>(True<sp/>Random<sp/>Number<sp/>Generator)<sp/>or<sp/>PRNG</highlight></codeline>
<codeline lineno="85"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>(Pseudo-Random<sp/>Number<sp/>Generator)<sp/>to<sp/>generate<sp/>a<sp/>random<sp/>number<sp/>for<sp/>use</highlight></codeline>
<codeline lineno="86"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>as<sp/>IV.</highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="88"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Drawbacks<sp/>#</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/>*<sp/><sp/>CBC<sp/>mode<sp/>has<sp/>several<sp/>drawbacks.<sp/>Unless<sp/>interfacing<sp/>with<sp/>legacy<sp/>devices,</highlight></codeline>
<codeline lineno="90"><highlight class="comment"><sp/>*<sp/><sp/>it<sp/>is<sp/>recommended<sp/>to<sp/>use<sp/>an<sp/>AEAD<sp/>(Authenticated<sp/>Encryption<sp/>with<sp/>Associated<sp/>Data)</highlight></codeline>
<codeline lineno="91"><highlight class="comment"><sp/>*<sp/><sp/>mode<sp/>such<sp/>as<sp/>CCM<sp/>or<sp/>GCM.<sp/>Below<sp/>is<sp/>a<sp/>non-exhaustive<sp/>list<sp/>of<sp/>reasons<sp/>to<sp/>use</highlight></codeline>
<codeline lineno="92"><highlight class="comment"><sp/>*<sp/><sp/>a<sp/>different<sp/>block<sp/>cipher<sp/>mode<sp/>of<sp/>operation.</highlight></codeline>
<codeline lineno="93"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="94"><highlight class="comment"><sp/>*<sp/><sp/>-<sp/>CBC<sp/>mode<sp/>does<sp/>not<sp/>offer<sp/>authentication<sp/>or<sp/>integrity<sp/>guarantees.<sp/>In<sp/>practice,</highlight></codeline>
<codeline lineno="95"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>this<sp/>means<sp/>that<sp/>attackers<sp/>can<sp/>intercept<sp/>the<sp/>encrypted<sp/>message<sp/>and<sp/>manipulate</highlight></codeline>
<codeline lineno="96"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>the<sp/>ciphertext<sp/>before<sp/>sending<sp/>the<sp/>message<sp/>on<sp/>to<sp/>the<sp/>receiver.<sp/>While<sp/>this</highlight></codeline>
<codeline lineno="97"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>does<sp/>not<sp/>break<sp/>confidentiality<sp/>and<sp/>reveal<sp/>the<sp/>plaintext,<sp/>it<sp/>has<sp/>enabled<sp/>several</highlight></codeline>
<codeline lineno="98"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>attacks<sp/>in<sp/>the<sp/>past.<sp/>This<sp/>is<sp/>especially<sp/>problematic<sp/>given<sp/>that<sp/>changing<sp/>the</highlight></codeline>
<codeline lineno="99"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>ciphertext<sp/>of<sp/>a<sp/>block<sp/>will<sp/>only<sp/>corrupt<sp/>the<sp/>block<sp/>itself<sp/>and<sp/>the<sp/>subsequent</highlight></codeline>
<codeline lineno="100"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>block<sp/>of<sp/>resultant<sp/>plaintext.<sp/>This<sp/>property<sp/>may<sp/>be<sp/>used<sp/>to<sp/>manipulate<sp/>only</highlight></codeline>
<codeline lineno="101"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>certain<sp/>parts<sp/>of<sp/>the<sp/>message.</highlight></codeline>
<codeline lineno="102"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="103"><highlight class="comment"><sp/>*<sp/><sp/>-<sp/>CBC<sp/>mode<sp/>requires<sp/>message<sp/>lengths<sp/>to<sp/>be<sp/>evenly<sp/>divisible<sp/>by<sp/>the<sp/>block<sp/>size.</highlight></codeline>
<codeline lineno="104"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>This<sp/>necessitates<sp/>a<sp/>padding<sp/>scheme.<sp/>Improperly<sp/>implemented<sp/>padding<sp/>schemes</highlight></codeline>
<codeline lineno="105"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>may<sp/>lead<sp/>to<sp/>vulnerabilities<sp/>that<sp/>can<sp/>be<sp/>exploited<sp/>by<sp/>attackers.<sp/>It<sp/>often</highlight></codeline>
<codeline lineno="106"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>makes<sp/>more<sp/>sense<sp/>to<sp/>use<sp/>a<sp/>dedicated<sp/>stream<sp/>cipher<sp/>such<sp/>as<sp/>CTR<sp/>(Counter)<sp/>that</highlight></codeline>
<codeline lineno="107"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>does<sp/>not<sp/>have<sp/>this<sp/>restriction.<sp/>CCM<sp/>and<sp/>GCM<sp/>both<sp/>use<sp/>CTR<sp/>for<sp/>encryption.</highlight></codeline>
<codeline lineno="108"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="109"><highlight class="comment"><sp/>*<sp/><sp/>@anchor<sp/>ti_drivers_AESCBC_Usage</highlight></codeline>
<codeline lineno="110"><highlight class="comment"><sp/>*<sp/><sp/>#<sp/>Usage<sp/>#</highlight></codeline>
<codeline lineno="111"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Before<sp/>starting<sp/>a<sp/>CBC<sp/>operation<sp/>#</highlight></codeline>
<codeline lineno="112"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="113"><highlight class="comment"><sp/>*<sp/><sp/>Before<sp/>starting<sp/>a<sp/>CBC<sp/>operation,<sp/>the<sp/>application<sp/>must<sp/>do<sp/>the<sp/>following:</highlight></codeline>
<codeline lineno="114"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>#AESCBC_init()<sp/>to<sp/>initialize<sp/>the<sp/>driver</highlight></codeline>
<codeline lineno="115"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>#AESCBC_Params_init()<sp/>to<sp/>initialize<sp/>the<sp/>#AESCBC_Params<sp/>to<sp/>default<sp/>values.</highlight></codeline>
<codeline lineno="116"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Modify<sp/>the<sp/>#AESCBC_Params<sp/>as<sp/>desired</highlight></codeline>
<codeline lineno="117"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>#AESCBC_open()<sp/>to<sp/>open<sp/>an<sp/>instance<sp/>of<sp/>the<sp/>driver</highlight></codeline>
<codeline lineno="118"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Initialize<sp/>a<sp/>CryptoKey.<sp/>These<sp/>opaque<sp/>data<sp/>structures<sp/>are<sp/>representations</highlight></codeline>
<codeline lineno="119"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>keying<sp/>material<sp/>and<sp/>its<sp/>storage.<sp/>Depending<sp/>on<sp/>how<sp/>the<sp/>keying<sp/>material</highlight></codeline>
<codeline lineno="120"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>stored<sp/>(RAM<sp/>or<sp/>flash,<sp/>key<sp/>store),<sp/>the<sp/>CryptoKey<sp/>must<sp/>be</highlight></codeline>
<codeline lineno="121"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>initialized<sp/>differently.<sp/>The<sp/>AESCBC<sp/>API<sp/>can<sp/>handle<sp/>all<sp/>types<sp/>of<sp/>CryptoKey.</highlight></codeline>
<codeline lineno="122"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>However,<sp/>not<sp/>all<sp/>device-specific<sp/>implementations<sp/>support<sp/>all<sp/>types<sp/>of<sp/>CryptoKey.</highlight></codeline>
<codeline lineno="123"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Devices<sp/>without<sp/>a<sp/>key<sp/>store<sp/>will<sp/>not<sp/>support<sp/>CryptoKeys<sp/>with<sp/>keying<sp/>material</highlight></codeline>
<codeline lineno="124"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stored<sp/>in<sp/>a<sp/>key<sp/>store<sp/>for<sp/>example.</highlight></codeline>
<codeline lineno="125"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>All<sp/>devices<sp/>support<sp/>plaintext<sp/>CryptoKeys.</highlight></codeline>
<codeline lineno="126"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Initialize<sp/>the<sp/>appropriate<sp/>AESCBC<sp/>operation<sp/>struct<sp/>using<sp/>the<sp/>relevant</highlight></codeline>
<codeline lineno="127"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operation<sp/>init<sp/>functions<sp/>and<sp/>set<sp/>all<sp/>fields.<sp/>For<sp/>example,<sp/>one-step<sp/>(one-shot</highlight></codeline>
<codeline lineno="128"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>or<sp/>single<sp/>call)<sp/>operations<sp/>should<sp/>initialize<sp/>AESCBC_Operation<sp/>or</highlight></codeline>
<codeline lineno="129"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OneStepOperation<sp/>using<sp/>AESCBC_Operation_init()<sp/>or</highlight></codeline>
<codeline lineno="130"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OneStepOperation_init().<sp/>For<sp/>multi-step<sp/>(segmented<sp/>or<sp/>multiple<sp/>call)</highlight></codeline>
<codeline lineno="131"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operations,<sp/>AESCBC_SegmentedOperation<sp/>must<sp/>be<sp/>initialized<sp/>and<sp/>set.</highlight></codeline>
<codeline lineno="132"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="133"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Starting<sp/>a<sp/>CBC<sp/>operation<sp/>#</highlight></codeline>
<codeline lineno="134"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="135"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>#AESCBC_oneStepEncrypt<sp/>and<sp/>#AESCBC_oneStepDecrypt<sp/>functions<sp/>perform<sp/>a<sp/>CBC<sp/>operation</highlight></codeline>
<codeline lineno="136"><highlight class="comment"><sp/>*<sp/><sp/>in<sp/>a<sp/>single<sp/>call.<sp/>They<sp/>will<sp/>always<sp/>be<sp/>the<sp/>most<sp/>highly<sp/>optimized<sp/>routines<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="137"><highlight class="comment"><sp/>*<sp/><sp/>least<sp/>overhead<sp/>and<sp/>the<sp/>fastest<sp/>runtime.<sp/>However,<sp/>they<sp/>require<sp/>all<sp/>plaintext</highlight></codeline>
<codeline lineno="138"><highlight class="comment"><sp/>*<sp/><sp/>or<sp/>ciphertext<sp/>to<sp/>be<sp/>available<sp/>to<sp/>the<sp/>function<sp/>at<sp/>the<sp/>start<sp/>of<sp/>the<sp/>call.</highlight></codeline>
<codeline lineno="139"><highlight class="comment"><sp/>*<sp/><sp/>All<sp/>devices<sp/>support<sp/>single<sp/>call<sp/>operations.</highlight></codeline>
<codeline lineno="140"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="141"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>After<sp/>the<sp/>CBC<sp/>operation<sp/>completes<sp/>#</highlight></codeline>
<codeline lineno="142"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="143"><highlight class="comment"><sp/>*<sp/><sp/>After<sp/>the<sp/>CBC<sp/>operation<sp/>completes,<sp/>the<sp/>application<sp/>should<sp/>either<sp/>start</highlight></codeline>
<codeline lineno="144"><highlight class="comment"><sp/>*<sp/><sp/>another<sp/>operation<sp/>or<sp/>close<sp/>the<sp/>driver<sp/>by<sp/>calling<sp/>#AESCBC_close().</highlight></codeline>
<codeline lineno="145"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="146"><highlight class="comment"><sp/>*<sp/><sp/>@anchor<sp/>ti_drivers_AESCBC_Synopsis</highlight></codeline>
<codeline lineno="147"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Synopsis</highlight></codeline>
<codeline lineno="148"><highlight class="comment"><sp/>*<sp/><sp/>@anchor<sp/>ti_drivers_AESCBC_Synopsis_Code</highlight></codeline>
<codeline lineno="149"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="150"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Import<sp/>AESCBC<sp/>Driver<sp/>definitions</highlight></codeline>
<codeline lineno="151"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline lineno="152"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="153"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Define<sp/>name<sp/>for<sp/>AESCBC<sp/>channel<sp/>index</highlight></codeline>
<codeline lineno="154"><highlight class="comment"><sp/>*<sp/><sp/>#define<sp/>AESCBC_INSTANCE<sp/>0</highlight></codeline>
<codeline lineno="155"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="156"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_init();</highlight></codeline>
<codeline lineno="157"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="158"><highlight class="comment"><sp/>*<sp/><sp/>handle<sp/>=<sp/>AESCBC_open(AESCBC_INSTANCE,<sp/>NULL);</highlight></codeline>
<codeline lineno="159"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="160"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Initialize<sp/>symmetric<sp/>key</highlight></codeline>
<codeline lineno="161"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="162"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="163"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Set<sp/>up<sp/>AESCBC_Operation</highlight></codeline>
<codeline lineno="164"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_OneStepOperation<sp/>operation;</highlight></codeline>
<codeline lineno="165"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline lineno="166"><highlight class="comment"><sp/>*<sp/><sp/>operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline lineno="167"><highlight class="comment"><sp/>*<sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="168"><highlight class="comment"><sp/>*<sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="169"><highlight class="comment"><sp/>*<sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext);</highlight></codeline>
<codeline lineno="170"><highlight class="comment"><sp/>*<sp/><sp/>operation.iv<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>iv;</highlight></codeline>
<codeline lineno="171"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="172"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCBC_oneStepEncrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="173"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="174"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_close(handle);</highlight></codeline>
<codeline lineno="175"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="176"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="177"><highlight class="comment"><sp/>*<sp/><sp/>@anchor<sp/>ti_drivers_AESCBC_Examples</highlight></codeline>
<codeline lineno="178"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Examples</highlight></codeline>
<codeline lineno="179"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="180"><highlight class="comment"><sp/>*<sp/><sp/>###<sp/>Single<sp/>call<sp/>CBC<sp/>encryption<sp/>with<sp/>plaintext<sp/>CryptoKey<sp/>in<sp/>blocking<sp/>return<sp/>mode<sp/>#</highlight></codeline>
<codeline lineno="181"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="182"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="183"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline lineno="184"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="185"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="186"><highlight class="comment"><sp/>*<sp/><sp/>...</highlight></codeline>
<codeline lineno="187"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="188"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_Handle<sp/>handle;</highlight></codeline>
<codeline lineno="189"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline lineno="190"><highlight class="comment"><sp/>*<sp/><sp/>int_fast16_t<sp/>encryptionResult;</highlight></codeline>
<codeline lineno="191"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="192"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>For<sp/>example<sp/>purposes<sp/>only.<sp/>Generate<sp/>IVs<sp/>in<sp/>a<sp/>non-static<sp/>way<sp/>in<sp/>practice.</highlight></codeline>
<codeline lineno="193"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Test<sp/>vector<sp/>0<sp/>from<sp/>NIST<sp/>CAPV<sp/>set<sp/>CBCMMT128</highlight></codeline>
<codeline lineno="194"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>iv[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0x2f,<sp/>0xe2,<sp/>0xb3,<sp/>0x33,<sp/>0xce,<sp/>0xda,<sp/>0x8f,<sp/>0x98,</highlight></codeline>
<codeline lineno="195"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xf4,<sp/>0xa9,<sp/>0x9b,<sp/>0x40,<sp/>0xd2,<sp/>0xcd,<sp/>0x34,<sp/>0xa8};</highlight></codeline>
<codeline lineno="196"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>plaintext[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0x45,<sp/>0xcf,<sp/>0x12,<sp/>0x96,<sp/>0x4f,<sp/>0xc8,<sp/>0x24,<sp/>0xab,</highlight></codeline>
<codeline lineno="197"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x76,<sp/>0x61,<sp/>0x6a,<sp/>0xe2,<sp/>0xf4,<sp/>0xbf,<sp/>0x08,<sp/>0x22};</highlight></codeline>
<codeline lineno="198"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>ciphertext[sizeof(plaintext)];</highlight></codeline>
<codeline lineno="199"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>keyingMaterial[16]<sp/>=<sp/><sp/><sp/><sp/>{0x1f,<sp/>0x8e,<sp/>0x49,<sp/>0x73,<sp/>0x95,<sp/>0x3f,<sp/>0x3f,<sp/>0xb0,</highlight></codeline>
<codeline lineno="200"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xbd,<sp/>0x6b,<sp/>0x16,<sp/>0x66,<sp/>0x2e,<sp/>0x9a,<sp/>0x3c,<sp/>0x17};</highlight></codeline>
<codeline lineno="201"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="202"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>ciphertext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>encryption<sp/>operation:</highlight></codeline>
<codeline lineno="203"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x0f,<sp/>0x61,<sp/>0xc4,<sp/>0xd4,<sp/>0x4c,<sp/>0x51,<sp/>0x47,<sp/>0xc0</highlight></codeline>
<codeline lineno="204"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x3c,<sp/>0x19,<sp/>0x5a,<sp/>0xd7,<sp/>0xe2,<sp/>0xcc,<sp/>0x12,<sp/>0xb2</highlight></codeline>
<codeline lineno="205"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="206"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="207"><highlight class="comment"><sp/>*<sp/><sp/>handle<sp/>=<sp/>AESCBC_open(0,<sp/>NULL);</highlight></codeline>
<codeline lineno="208"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="209"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="210"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="211"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="212"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="213"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="214"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="215"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_OneStepOperation<sp/>operation;</highlight></codeline>
<codeline lineno="216"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline lineno="217"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="218"><highlight class="comment"><sp/>*<sp/><sp/>operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline lineno="219"><highlight class="comment"><sp/>*<sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="220"><highlight class="comment"><sp/>*<sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="221"><highlight class="comment"><sp/>*<sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext);</highlight></codeline>
<codeline lineno="222"><highlight class="comment"><sp/>*<sp/><sp/>operation.iv<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>iv;</highlight></codeline>
<codeline lineno="223"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="224"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCBC_oneStepEncrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="225"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="226"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="227"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="228"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="229"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="230"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_close(handle);</highlight></codeline>
<codeline lineno="231"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="232"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="233"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="234"><highlight class="comment"><sp/>*<sp/><sp/>###<sp/>Single<sp/>call<sp/>CBC<sp/>decryption<sp/>with<sp/>plaintext<sp/>CryptoKey<sp/>in<sp/>callback<sp/>return<sp/>mode<sp/>#</highlight></codeline>
<codeline lineno="235"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="236"><highlight class="comment"><sp/>*<sp/><sp/>@note<sp/>The<sp/>following<sp/>code<sp/>example<sp/>presented<sp/>uses<sp/>a<sp/>256-bit<sp/>key.<sp/>However,</highlight></codeline>
<codeline lineno="237"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CC13x1/CC26x1<sp/>and<sp/>CC23x0<sp/>only<sp/>support<sp/>a<sp/>maximum<sp/>key<sp/>size<sp/>of<sp/>128-bits,</highlight></codeline>
<codeline lineno="238"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>so<sp/>reduction<sp/>of<sp/>keyingMaterial<sp/>would<sp/>be<sp/>required.</highlight></codeline>
<codeline lineno="239"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="240"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="241"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="242"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline lineno="243"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="244"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="245"><highlight class="comment"><sp/>*<sp/><sp/>...</highlight></codeline>
<codeline lineno="246"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="247"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Test<sp/>vector<sp/>0<sp/>from<sp/>NIST<sp/>CAPV<sp/>set<sp/>CBCMMT256</highlight></codeline>
<codeline lineno="248"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="249"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>iv[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0xdd,<sp/>0xbb,<sp/>0xb0,<sp/>0x17,<sp/>0x3f,<sp/>0x1e,<sp/>0x2d,<sp/>0xeb,</highlight></codeline>
<codeline lineno="250"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x23,<sp/>0x94,<sp/>0xa6,<sp/>0x2a,<sp/>0xa2,<sp/>0xa0,<sp/>0x24,<sp/>0x0e};</highlight></codeline>
<codeline lineno="251"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>ciphertext[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0xd5,<sp/>0x1d,<sp/>0x19,<sp/>0xde,<sp/>0xd5,<sp/>0xca,<sp/>0x4a,<sp/>0xe1,</highlight></codeline>
<codeline lineno="252"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x4b,<sp/>0x2b,<sp/>0x20,<sp/>0xb0,<sp/>0x27,<sp/>0xff,<sp/>0xb0,<sp/>0x20};</highlight></codeline>
<codeline lineno="253"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>keyingMaterial[32]<sp/>=<sp/><sp/><sp/><sp/>{0x43,<sp/>0xe9,<sp/>0x53,<sp/>0xb2,<sp/>0xae,<sp/>0xa0,<sp/>0x8a,<sp/>0x3a,</highlight></codeline>
<codeline lineno="254"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xd5,<sp/>0x2d,<sp/>0x18,<sp/>0x2f,<sp/>0x58,<sp/>0xc7,<sp/>0x2b,<sp/>0x9c,</highlight></codeline>
<codeline lineno="255"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x60,<sp/>0xfb,<sp/>0xe4,<sp/>0xa9,<sp/>0xca,<sp/>0x46,<sp/>0xa3,<sp/>0xcb,</highlight></codeline>
<codeline lineno="256"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x89,<sp/>0xe3,<sp/>0x86,<sp/>0x38,<sp/>0x45,<sp/>0xe2,<sp/>0x2c,<sp/>0x9e};</highlight></codeline>
<codeline lineno="257"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>plaintext[sizeof(ciphertext)];</highlight></codeline>
<codeline lineno="258"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="259"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>plaintext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>decryption<sp/>operation:</highlight></codeline>
<codeline lineno="260"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x07,<sp/>0x27,<sp/>0x0d,<sp/>0x0e,<sp/>0x63,<sp/>0xaa,<sp/>0x36,<sp/>0xda</highlight></codeline>
<codeline lineno="261"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0xed,<sp/>0x8c,<sp/>0x6a,<sp/>0xde,<sp/>0x13,<sp/>0xac,<sp/>0x1a,<sp/>0xf1</highlight></codeline>
<codeline lineno="262"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="263"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="264"><highlight class="comment"><sp/>*<sp/><sp/>void<sp/>cbcCallback(AESCBC_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="265"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline lineno="266"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OperationUnion<sp/>*operation,</highlight></codeline>
<codeline lineno="267"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OperationType<sp/>operationType)<sp/>{</highlight></codeline>
<codeline lineno="268"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="269"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(returnValue<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="271"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="272"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="273"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(operationType<sp/>==<sp/>AESCBC_OPERATION_TYPE_DECRYPT<sp/>||</highlight></codeline>
<codeline lineno="274"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCBC_OPERATION_TYPE_ENCRYPT)<sp/>{</highlight></codeline>
<codeline lineno="275"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>something<sp/>with<sp/>operation-&gt;oneStepOperation</highlight></codeline>
<codeline lineno="276"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>else<sp/>{</highlight></codeline>
<codeline lineno="277"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>something<sp/>with<sp/>operation-&gt;segmentedOperation</highlight></codeline>
<codeline lineno="278"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="279"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="280"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="281"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_OneStepOperation<sp/>operation;</highlight></codeline>
<codeline lineno="282"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="283"><highlight class="comment"><sp/>*<sp/><sp/>void<sp/>cbcStartFunction(void)<sp/>{</highlight></codeline>
<codeline lineno="284"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_Handle<sp/>handle;</highlight></codeline>
<codeline lineno="285"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_Params<sp/>params;</highlight></codeline>
<codeline lineno="286"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline lineno="287"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>decryptionResult;</highlight></codeline>
<codeline lineno="288"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="289"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_Params_init(&amp;params);</highlight></codeline>
<codeline lineno="290"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>params.returnBehavior<sp/>=<sp/>AESCBC_RETURN_BEHAVIOR_CALLBACK;</highlight></codeline>
<codeline lineno="291"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>params.callbackFxn<sp/>=<sp/>cbcCallback;</highlight></codeline>
<codeline lineno="292"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="293"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>handle<sp/>=<sp/>AESCBC_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline lineno="294"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="295"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="296"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="297"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="298"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="299"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="300"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="301"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline lineno="302"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="303"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline lineno="304"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="305"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="306"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(ciphertext);</highlight></codeline>
<codeline lineno="307"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.iv<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>iv;</highlight></codeline>
<codeline lineno="308"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="309"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCBC_oneStepDecrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="310"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="311"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="312"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="313"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="314"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="315"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>other<sp/>things<sp/>while<sp/>CBC<sp/>operation<sp/>completes<sp/>in<sp/>the<sp/>background</highlight></codeline>
<codeline lineno="316"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="317"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="318"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="319"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="320"><highlight class="comment"><sp/>*<sp/><sp/>###<sp/>Multi-step<sp/>CBC<sp/>encryption<sp/>with<sp/>plaintext<sp/>CryptoKey<sp/>in<sp/>blocking<sp/>return<sp/>mode<sp/>#</highlight></codeline>
<codeline lineno="321"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="322"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="323"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline lineno="324"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="325"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="326"><highlight class="comment"><sp/>*<sp/><sp/>...</highlight></codeline>
<codeline lineno="327"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="328"><highlight class="comment"><sp/>*<sp/><sp/>#define<sp/>AES_BLOCK_SIZE<sp/><sp/><sp/><sp/><sp/><sp/>16<sp/>//<sp/>bytes</highlight></codeline>
<codeline lineno="329"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="330"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_Handle<sp/>handle;</highlight></codeline>
<codeline lineno="331"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline lineno="332"><highlight class="comment"><sp/>*<sp/><sp/>int_fast16_t<sp/>encryptionResult;</highlight></codeline>
<codeline lineno="333"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="334"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>For<sp/>example<sp/>purposes<sp/>only.<sp/>Generate<sp/>IVs<sp/>in<sp/>a<sp/>non-static<sp/>way<sp/>in<sp/>practice.</highlight></codeline>
<codeline lineno="335"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Test<sp/>vector<sp/>0<sp/>from<sp/>NIST<sp/>CAPV<sp/>set<sp/>CBCMMT128</highlight></codeline>
<codeline lineno="336"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>iv[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0x2f,<sp/>0xe2,<sp/>0xb3,<sp/>0x33,<sp/>0xce,<sp/>0xda,<sp/>0x8f,<sp/>0x98,</highlight></codeline>
<codeline lineno="337"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xf4,<sp/>0xa9,<sp/>0x9b,<sp/>0x40,<sp/>0xd2,<sp/>0xcd,<sp/>0x34,<sp/>0xa8};</highlight></codeline>
<codeline lineno="338"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>plaintext[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0x45,<sp/>0xcf,<sp/>0x12,<sp/>0x96,<sp/>0x4f,<sp/>0xc8,<sp/>0x24,<sp/>0xab,</highlight></codeline>
<codeline lineno="339"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x76,<sp/>0x61,<sp/>0x6a,<sp/>0xe2,<sp/>0xf4,<sp/>0xbf,<sp/>0x08,<sp/>0x22};</highlight></codeline>
<codeline lineno="340"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>ciphertext[sizeof(plaintext)];</highlight></codeline>
<codeline lineno="341"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>keyingMaterial[16]<sp/>=<sp/><sp/><sp/><sp/>{0x1f,<sp/>0x8e,<sp/>0x49,<sp/>0x73,<sp/>0x95,<sp/>0x3f,<sp/>0x3f,<sp/>0xb0,</highlight></codeline>
<codeline lineno="342"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xbd,<sp/>0x6b,<sp/>0x16,<sp/>0x66,<sp/>0x2e,<sp/>0x9a,<sp/>0x3c,<sp/>0x17};</highlight></codeline>
<codeline lineno="343"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="344"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>ciphertext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>encryption<sp/>operation:</highlight></codeline>
<codeline lineno="345"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x0f,<sp/>0x61,<sp/>0xc4,<sp/>0xd4,<sp/>0x4c,<sp/>0x51,<sp/>0x47,<sp/>0xc0</highlight></codeline>
<codeline lineno="346"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x3c,<sp/>0x19,<sp/>0x5a,<sp/>0xd7,<sp/>0xe2,<sp/>0xcc,<sp/>0x12,<sp/>0xb2</highlight></codeline>
<codeline lineno="347"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="348"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="349"><highlight class="comment"><sp/>*<sp/><sp/>handle<sp/>=<sp/>AESCBC_open(0,<sp/>NULL);</highlight></codeline>
<codeline lineno="350"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="351"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="352"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="353"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="354"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="355"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="356"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="357"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_SegmentedOperation<sp/>operation;</highlight></codeline>
<codeline lineno="358"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_SegmentedOperation_init(&amp;operation);</highlight></codeline>
<codeline lineno="359"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="360"><highlight class="comment"><sp/>*<sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="361"><highlight class="comment"><sp/>*<sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="362"><highlight class="comment"><sp/>*<sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext);</highlight></codeline>
<codeline lineno="363"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="364"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCBC_setupEncrypt(handle,<sp/>&amp;cryptoKey);</highlight></codeline>
<codeline lineno="365"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="366"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="367"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="368"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="369"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCBC_setIV(handle,<sp/>iv,<sp/>AES_BLOCK_SIZE);</highlight></codeline>
<codeline lineno="370"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="371"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="372"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="373"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="374"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCBC_addData(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="375"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="376"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="377"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="378"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="379"><highlight class="comment"><sp/>*<sp/><sp/>operation.inputLength<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="380"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCBC_finalize(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="381"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="382"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="383"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="384"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="385"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_close(handle);</highlight></codeline>
<codeline lineno="386"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="387"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="388"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="389"><highlight class="comment"><sp/>*<sp/><sp/>###<sp/>Multi-step<sp/>CBC<sp/>decryption<sp/>with<sp/>plaintext<sp/>CryptoKey<sp/>in<sp/>callback<sp/>return<sp/>mode<sp/>#</highlight></codeline>
<codeline lineno="390"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="391"><highlight class="comment"><sp/>*<sp/><sp/>@note<sp/>The<sp/>following<sp/>code<sp/>example<sp/>presented<sp/>uses<sp/>a<sp/>256-bit<sp/>key.<sp/>However,</highlight></codeline>
<codeline lineno="392"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CC13x1/CC26x1<sp/>and<sp/>CC23x0<sp/>only<sp/>support<sp/>a<sp/>maximum<sp/>key<sp/>size<sp/>of<sp/>128-bits,</highlight></codeline>
<codeline lineno="393"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>so<sp/>reduction<sp/>of<sp/>keyingMaterial<sp/>would<sp/>be<sp/>required.</highlight></codeline>
<codeline lineno="394"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="395"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="396"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="397"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline lineno="398"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="399"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="400"><highlight class="comment"><sp/>*<sp/><sp/>...</highlight></codeline>
<codeline lineno="401"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="402"><highlight class="comment"><sp/>*<sp/><sp/>#define<sp/>AES_BLOCK_SIZE<sp/><sp/><sp/><sp/><sp/><sp/>16<sp/>//<sp/>bytes</highlight></codeline>
<codeline lineno="403"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="404"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Test<sp/>vector<sp/>0<sp/>from<sp/>NIST<sp/>CAPV<sp/>set<sp/>CBCMMT256</highlight></codeline>
<codeline lineno="405"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="406"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>iv[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0xdd,<sp/>0xbb,<sp/>0xb0,<sp/>0x17,<sp/>0x3f,<sp/>0x1e,<sp/>0x2d,<sp/>0xeb,</highlight></codeline>
<codeline lineno="407"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x23,<sp/>0x94,<sp/>0xa6,<sp/>0x2a,<sp/>0xa2,<sp/>0xa0,<sp/>0x24,<sp/>0x0e};</highlight></codeline>
<codeline lineno="408"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>ciphertext[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0xd5,<sp/>0x1d,<sp/>0x19,<sp/>0xde,<sp/>0xd5,<sp/>0xca,<sp/>0x4a,<sp/>0xe1,</highlight></codeline>
<codeline lineno="409"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x4b,<sp/>0x2b,<sp/>0x20,<sp/>0xb0,<sp/>0x27,<sp/>0xff,<sp/>0xb0,<sp/>0x20};</highlight></codeline>
<codeline lineno="410"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>keyingMaterial[32]<sp/>=<sp/><sp/><sp/><sp/>{0x43,<sp/>0xe9,<sp/>0x53,<sp/>0xb2,<sp/>0xae,<sp/>0xa0,<sp/>0x8a,<sp/>0x3a,</highlight></codeline>
<codeline lineno="411"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xd5,<sp/>0x2d,<sp/>0x18,<sp/>0x2f,<sp/>0x58,<sp/>0xc7,<sp/>0x2b,<sp/>0x9c,</highlight></codeline>
<codeline lineno="412"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x60,<sp/>0xfb,<sp/>0xe4,<sp/>0xa9,<sp/>0xca,<sp/>0x46,<sp/>0xa3,<sp/>0xcb,</highlight></codeline>
<codeline lineno="413"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x89,<sp/>0xe3,<sp/>0x86,<sp/>0x38,<sp/>0x45,<sp/>0xe2,<sp/>0x2c,<sp/>0x9e};</highlight></codeline>
<codeline lineno="414"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>plaintext[sizeof(ciphertext)];</highlight></codeline>
<codeline lineno="415"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="416"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>plaintext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>decryption<sp/>operation:</highlight></codeline>
<codeline lineno="417"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x07,<sp/>0x27,<sp/>0x0d,<sp/>0x0e,<sp/>0x63,<sp/>0xaa,<sp/>0x36,<sp/>0xda</highlight></codeline>
<codeline lineno="418"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0xed,<sp/>0x8c,<sp/>0x6a,<sp/>0xde,<sp/>0x13,<sp/>0xac,<sp/>0x1a,<sp/>0xf1</highlight></codeline>
<codeline lineno="419"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="420"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="421"><highlight class="comment"><sp/>*<sp/><sp/>void<sp/>cbcCallback(AESCBC_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="422"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline lineno="423"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OperationUnion<sp/>*operation,</highlight></codeline>
<codeline lineno="424"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_OperationType<sp/>operationType)<sp/>{</highlight></codeline>
<codeline lineno="425"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="426"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(returnValue<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="427"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="428"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="429"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="430"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(operationType<sp/>==<sp/>AESCBC_OPERATION_TYPE_DECRYPT<sp/>||</highlight></codeline>
<codeline lineno="431"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCBC_OPERATION_TYPE_ENCRYPT)<sp/>{</highlight></codeline>
<codeline lineno="432"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>something<sp/>with<sp/>operation-&gt;oneStepOperation</highlight></codeline>
<codeline lineno="433"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}<sp/>else<sp/>{</highlight></codeline>
<codeline lineno="434"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>something<sp/>with<sp/>operation-&gt;segmentedOperation</highlight></codeline>
<codeline lineno="435"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="436"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="437"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="438"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_SegmentedOperation<sp/>operation;</highlight></codeline>
<codeline lineno="439"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="440"><highlight class="comment"><sp/>*<sp/><sp/>void<sp/>cbcStartFunction(void)<sp/>{</highlight></codeline>
<codeline lineno="441"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_Handle<sp/>handle;</highlight></codeline>
<codeline lineno="442"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_Params<sp/>params;</highlight></codeline>
<codeline lineno="443"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline lineno="444"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>decryptionResult;</highlight></codeline>
<codeline lineno="445"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="446"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_Params_init(&amp;params);</highlight></codeline>
<codeline lineno="447"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>params.returnBehavior<sp/>=<sp/>AESCBC_RETURN_BEHAVIOR_CALLBACK;</highlight></codeline>
<codeline lineno="448"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>params.callbackFxn<sp/>=<sp/>cbcCallback;</highlight></codeline>
<codeline lineno="449"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="450"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>handle<sp/>=<sp/>AESCBC_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline lineno="451"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="452"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="453"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="454"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="455"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="456"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="457"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="458"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCBC_SegmentedOperation_init(&amp;operation);</highlight></codeline>
<codeline lineno="459"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="460"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="461"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="462"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(ciphertext);</highlight></codeline>
<codeline lineno="463"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="464"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCBC_setupDecrypt(handle,<sp/>&amp;cryptoKey);</highlight></codeline>
<codeline lineno="465"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="466"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="467"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="468"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="469"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCBC_setIV(handle,<sp/>iv,<sp/>AES_BLOCK_SIZE);</highlight></codeline>
<codeline lineno="470"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="471"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="472"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="473"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="474"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCBC_addData(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="475"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="476"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="477"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="479"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>other<sp/>things<sp/>while<sp/>CBC<sp/>operation<sp/>completes<sp/>in<sp/>the<sp/>background</highlight></codeline>
<codeline lineno="480"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="481"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.inputLength<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="482"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCBC_finalize(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="483"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="484"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="485"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="487"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="488"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="489"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="490"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="491"><highlight class="comment"><sp/>*<sp/><sp/>###<sp/>Multi-step<sp/>CBC<sp/>encryption<sp/>with<sp/>plaintext<sp/>CryptoKey<sp/>and<sp/>non-empty<sp/>finalize<sp/>in<sp/>blocking<sp/>return<sp/>mode<sp/>#</highlight></codeline>
<codeline lineno="492"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="493"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="494"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCBC.h&gt;</highlight></codeline>
<codeline lineno="495"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="496"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="497"><highlight class="comment"><sp/>*<sp/><sp/>...</highlight></codeline>
<codeline lineno="498"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="499"><highlight class="comment"><sp/>*<sp/><sp/>#define<sp/>AES_BLOCK_SIZE<sp/><sp/><sp/><sp/><sp/><sp/>16<sp/>//<sp/>bytes</highlight></codeline>
<codeline lineno="500"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="501"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_Handle<sp/>handle;</highlight></codeline>
<codeline lineno="502"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline lineno="503"><highlight class="comment"><sp/>*<sp/><sp/>int_fast16_t<sp/>encryptionResult;</highlight></codeline>
<codeline lineno="504"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="505"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>For<sp/>example<sp/>purposes<sp/>only.<sp/>Generate<sp/>IVs<sp/>in<sp/>a<sp/>non-static<sp/>way<sp/>in<sp/>practice.</highlight></codeline>
<codeline lineno="506"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Test<sp/>vector<sp/>1<sp/>from<sp/>NIST<sp/>CAPV<sp/>set<sp/>CBCMMT128</highlight></codeline>
<codeline lineno="507"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>iv[16]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0xaa,<sp/>0xd1,<sp/>0x58,<sp/>0x3c,<sp/>0xd9,<sp/>0x13,<sp/>0x65,<sp/>0xe3,</highlight></codeline>
<codeline lineno="508"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xbb,<sp/>0x2f,<sp/>0x0c,<sp/>0x34,<sp/>0x30,<sp/>0xd0,<sp/>0x65,<sp/>0xbb};</highlight></codeline>
<codeline lineno="509"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>plaintext[32]<sp/>=<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{0x06,<sp/>0x8b,<sp/>0x25,<sp/>0xc7,<sp/>0xbf,<sp/>0xb1,<sp/>0xf8,<sp/>0xbd,</highlight></codeline>
<codeline lineno="510"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xd4,<sp/>0xcf,<sp/>0xc9,<sp/>0x08,<sp/>0xf6,<sp/>0x9d,<sp/>0xff,<sp/>0xc5,</highlight></codeline>
<codeline lineno="511"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xdd,<sp/>0xc7,<sp/>0x26,<sp/>0xa1,<sp/>0x97,<sp/>0xf0,<sp/>0xe5,<sp/>0xf7,</highlight></codeline>
<codeline lineno="512"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x20,<sp/>0xf7,<sp/>0x30,<sp/>0x39,<sp/>0x32,<sp/>0x79,<sp/>0xbe,<sp/>0x91};</highlight></codeline>
<codeline lineno="513"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>ciphertext[sizeof(plaintext)];</highlight></codeline>
<codeline lineno="514"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>keyingMaterial[16]<sp/>=<sp/><sp/><sp/><sp/>{0x07,<sp/>0x00,<sp/>0xd6,<sp/>0x03,<sp/>0xa1,<sp/>0xc5,<sp/>0x14,<sp/>0xe4,</highlight></codeline>
<codeline lineno="515"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x6b,<sp/>0x61,<sp/>0x91,<sp/>0xba,<sp/>0x43,<sp/>0x0a,<sp/>0x3a,<sp/>0x0c};</highlight></codeline>
<codeline lineno="516"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="517"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>ciphertext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>encryption<sp/>operation:</highlight></codeline>
<codeline lineno="518"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0xc4,<sp/>0xdc,<sp/>0x61,<sp/>0xd9,<sp/>0x72,<sp/>0x59,<sp/>0x67,<sp/>0xa3</highlight></codeline>
<codeline lineno="519"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x02,<sp/>0x01,<sp/>0x04,<sp/>0xa9,<sp/>0x73,<sp/>0x8f,<sp/>0x23,<sp/>0x86</highlight></codeline>
<codeline lineno="520"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x85,<sp/>0x27,<sp/>0xce,<sp/>0x83,<sp/>0x9a,<sp/>0xab,<sp/>0x17,<sp/>0x52</highlight></codeline>
<codeline lineno="521"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0xfd,<sp/>0x8b,<sp/>0xdb,<sp/>0x95,<sp/>0xa8,<sp/>0x2c,<sp/>0x4d,<sp/>0x00</highlight></codeline>
<codeline lineno="522"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="523"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="524"><highlight class="comment"><sp/>*<sp/><sp/>handle<sp/>=<sp/>AESCBC_open(0,<sp/>NULL);</highlight></codeline>
<codeline lineno="525"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="526"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="527"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="528"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="529"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="530"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="531"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="532"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_SegmentedOperation<sp/>operation;</highlight></codeline>
<codeline lineno="533"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_SegmentedOperation_init(&amp;operation);</highlight></codeline>
<codeline lineno="534"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="535"><highlight class="comment"><sp/>*<sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="536"><highlight class="comment"><sp/>*<sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="537"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>One<sp/>should<sp/>pass<sp/>in<sp/>data<sp/>that<sp/>is<sp/>a<sp/>block-sized<sp/>multiple<sp/>length<sp/>(16<sp/>bytes)</highlight></codeline>
<codeline lineno="538"><highlight class="comment"><sp/>*<sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="539"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="540"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCBC_setupEncrypt(handle,<sp/>&amp;cryptoKey);</highlight></codeline>
<codeline lineno="541"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="542"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="543"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="544"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="545"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCBC_setIV(handle,<sp/>iv,<sp/>AES_BLOCK_SIZE);</highlight></codeline>
<codeline lineno="546"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="547"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="548"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="549"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="550"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCBC_addData(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="551"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="552"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="553"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="554"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="555"><highlight class="comment"><sp/>*<sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="556"><highlight class="comment"><sp/>*<sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="557"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="558"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>You<sp/>can<sp/>also<sp/>finalize<sp/>with<sp/>more<sp/>data<sp/>(non-zero<sp/>inputLength)</highlight></codeline>
<codeline lineno="559"><highlight class="comment"><sp/>*<sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext)<sp/>-<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="560"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCBC_finalize(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="561"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCBC_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="562"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="563"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="564"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="565"><highlight class="comment"><sp/>*<sp/><sp/>AESCBC_close(handle);</highlight></codeline>
<codeline lineno="566"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="567"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="568"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>ti_drivers_AESCBC__include</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ti_drivers_AESCBC__include</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="572"><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdbool.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="_a_e_s_common_8h" kindref="compound">ti/drivers/AESCommon.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="_crypto_key_8h" kindref="compound">ti/drivers/cryptoutils/cryptokey/CryptoKey.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"></highlight></codeline>
<codeline lineno="580"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="582"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"></highlight></codeline>
<codeline lineno="596" refid="_a_e_s_c_b_c_8h_1a3cd55c1962740cbb6e3217d49ddb8cc6" refkind="member"><highlight class="preprocessor">#define<sp/>AESCBC_STATUS_RESERVED<sp/>AES_STATUS_RESERVED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="597"><highlight class="normal"></highlight></codeline>
<codeline lineno="604" refid="_a_e_s_c_b_c_8h_1a0bcb271aa7f9aee37469d242670b6d9d" refkind="member"><highlight class="preprocessor">#define<sp/>AESCBC_STATUS_SUCCESS<sp/>AES_STATUS_SUCCESS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="605"><highlight class="normal"></highlight></codeline>
<codeline lineno="612" refid="_a_e_s_c_b_c_8h_1a114c760826307af69a93538773a58185" refkind="member"><highlight class="preprocessor">#define<sp/>AESCBC_STATUS_ERROR<sp/>AES_STATUS_ERROR</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="613"><highlight class="normal"></highlight></codeline>
<codeline lineno="622" refid="_a_e_s_c_b_c_8h_1ad92a5502a5a56aaf28b7d930be275271" refkind="member"><highlight class="preprocessor">#define<sp/>AESCBC_STATUS_RESOURCE_UNAVAILABLE<sp/>AES_STATUS_RESOURCE_UNAVAILABLE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="623"><highlight class="normal"></highlight></codeline>
<codeline lineno="627" refid="_a_e_s_c_b_c_8h_1aa3ff5d2f23cdceb6652dbe490c6ec93f" refkind="member"><highlight class="preprocessor">#define<sp/>AESCBC_STATUS_CANCELED<sp/>AES_STATUS_CANCELED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"></highlight></codeline>
<codeline lineno="636" refid="_a_e_s_c_b_c_8h_1a75fee21f079588cba1b516720b553f1a" refkind="member"><highlight class="preprocessor">#define<sp/>AESCBC_STATUS_FEATURE_NOT_SUPPORTED<sp/>AES_STATUS_FEATURE_NOT_SUPPORTED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="637"><highlight class="normal"></highlight></codeline>
<codeline lineno="641" refid="_a_e_s_c_b_c_8h_1adad2a122e8b54e8c2e0d1563ac1095a7" refkind="member"><highlight class="preprocessor">#define<sp/>AESCBC_STATUS_KEYSTORE_INVALID_ID<sp/>AES_STATUS_KEYSTORE_INVALID_ID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="642"><highlight class="normal"></highlight></codeline>
<codeline lineno="647" refid="_a_e_s_c_b_c_8h_1a65047ed053730a6dee6332cd98fc377c" refkind="member"><highlight class="preprocessor">#define<sp/>AESCBC_STATUS_KEYSTORE_GENERIC_ERROR<sp/>AES_STATUS_KEYSTORE_GENERIC_ERROR</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"></highlight></codeline>
<codeline lineno="655" refid="_a_e_s_c_b_c_8h_1adf65612b9131789ae5db3e3151473bbc" refkind="member"><highlight class="preprocessor">#define<sp/>AESCBC_STATUS_UNALIGNED_IO_NOT_SUPPORTED<sp/>AES_STATUS_UNALIGNED_IO_NOT_SUPPORTED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"></highlight></codeline>
<codeline lineno="668" refid="_a_e_s_c_b_c_8h_1af5f0c2913e25511cc73288b1db71d6e7" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_common___config" kindref="compound">AESCommon_Config</ref><sp/><ref refid="_a_e_s_c_b_c_8h_1af5f0c2913e25511cc73288b1db71d6e7" kindref="member">AESCBC_Config</ref>;</highlight></codeline>
<codeline lineno="669"><highlight class="normal"></highlight></codeline>
<codeline lineno="673" refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/>AESCBC_Config<sp/>*<ref refid="_a_e_s_c_b_c_8h_1a4222a78a8c695fc2c97bbef11d28f04e" kindref="member">AESCBC_Handle</ref>;</highlight></codeline>
<codeline lineno="674"><highlight class="normal"></highlight></codeline>
<codeline lineno="696" refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="697"><highlight class="normal">{</highlight></codeline>
<codeline lineno="698" refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5acedc995468fd1ad451c6aa24f56d456d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5acedc995468fd1ad451c6aa24f56d456d" kindref="member">AESCBC_RETURN_BEHAVIOR_CALLBACK</ref><sp/>=<sp/><ref refid="_a_e_s_common_8h_1a2820f6d52c454af5c0d7b20215e4a448a1960d364137ea874dd37fa582d97be46" kindref="member">AES_RETURN_BEHAVIOR_CALLBACK</ref>,</highlight></codeline>
<codeline lineno="705" refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5ad4cf399115e78f5253b12f88605d212e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5ad4cf399115e78f5253b12f88605d212e" kindref="member">AESCBC_RETURN_BEHAVIOR_BLOCKING</ref><sp/>=<sp/><ref refid="_a_e_s_common_8h_1a2820f6d52c454af5c0d7b20215e4a448a2f37373d3f057f1696056d9124285398" kindref="member">AES_RETURN_BEHAVIOR_BLOCKING</ref>,</highlight></codeline>
<codeline lineno="710" refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5aeccf5cad47aac1edcef820125f7c361d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5aeccf5cad47aac1edcef820125f7c361d" kindref="member">AESCBC_RETURN_BEHAVIOR_POLLING</ref><sp/><sp/>=<sp/><ref refid="_a_e_s_common_8h_1a2820f6d52c454af5c0d7b20215e4a448a671eba846166015af2e6f06a017f1716" kindref="member">AES_RETURN_BEHAVIOR_POLLING</ref>,</highlight></codeline>
<codeline lineno="715"><highlight class="normal">}<sp/><ref refid="_a_e_s_c_b_c_8h_1a34f3e7f586935c9328167d1e03973af5" kindref="member">AESCBC_ReturnBehavior</ref>;</highlight></codeline>
<codeline lineno="716"><highlight class="normal"></highlight></codeline>
<codeline lineno="720" refid="_a_e_s_c_b_c_8h_1a3d0b3dbc7f859b9d0c6acf102adb4d39" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="721"><highlight class="normal">{</highlight></codeline>
<codeline lineno="722" refid="_a_e_s_c_b_c_8h_1a3d0b3dbc7f859b9d0c6acf102adb4d39a6937032fe648623f9b9a5f7b4dcce26a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a3d0b3dbc7f859b9d0c6acf102adb4d39a6937032fe648623f9b9a5f7b4dcce26a" kindref="member">AESCBC_MODE_ENCRYPT</ref><sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="723" refid="_a_e_s_c_b_c_8h_1a3d0b3dbc7f859b9d0c6acf102adb4d39afacbd481470a984c92878b82c17a825c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a3d0b3dbc7f859b9d0c6acf102adb4d39afacbd481470a984c92878b82c17a825c" kindref="member">AESCBC_MODE_DECRYPT</ref><sp/>=<sp/>2</highlight></codeline>
<codeline lineno="724"><highlight class="normal">}<sp/><ref refid="_a_e_s_c_b_c_8h_1a3d0b3dbc7f859b9d0c6acf102adb4d39" kindref="member">AESCBC_Mode</ref>;</highlight></codeline>
<codeline lineno="725"><highlight class="normal"></highlight></codeline>
<codeline lineno="730" refid="struct_a_e_s_c_b_c___one_step_operation" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="731"><highlight class="normal">{</highlight></codeline>
<codeline lineno="732" refid="struct_a_e_s_c_b_c___one_step_operation_1a6518aed6d5da1e00d44d65287a57f034" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_a_e_s_c_b_c___one_step_operation_1a6518aed6d5da1e00d44d65287a57f034" kindref="member">key</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="733" refid="struct_a_e_s_c_b_c___one_step_operation_1a1a1180919f9129c518d0084caf0a4fe1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_b_c___one_step_operation_1a1a1180919f9129c518d0084caf0a4fe1" kindref="member">input</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="738" refid="struct_a_e_s_c_b_c___one_step_operation_1a30277677266cfe2d47c5552aa68be2a4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_b_c___one_step_operation_1a30277677266cfe2d47c5552aa68be2a4" kindref="member">output</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="744" refid="struct_a_e_s_c_b_c___one_step_operation_1ab1fde4ea69a4a3d3f9e3a5bb96c29704" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_b_c___one_step_operation_1ab1fde4ea69a4a3d3f9e3a5bb96c29704" kindref="member">iv</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="750" refid="struct_a_e_s_c_b_c___one_step_operation_1a9c2335b721113543e47347afb0664ecd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_b_c___one_step_operation_1a9c2335b721113543e47347afb0664ecd" kindref="member">inputLength</ref>;<sp/></highlight></codeline>
<codeline lineno="759" refid="struct_a_e_s_c_b_c___one_step_operation_1a917352c22d76fa8f36cdd00a2754f684" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_b_c___one_step_operation_1a917352c22d76fa8f36cdd00a2754f684" kindref="member">ivInternallyGenerated</ref>;<sp/></highlight></codeline>
<codeline lineno="763"><highlight class="normal">}<sp/><ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref>;</highlight></codeline>
<codeline lineno="764"><highlight class="normal"></highlight></codeline>
<codeline lineno="770" refid="struct_a_e_s_c_b_c___segmented_operation" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal">{</highlight></codeline>
<codeline lineno="772" refid="struct_a_e_s_c_b_c___segmented_operation_1ad3cd2fd51a7ccf0c8259b17491c449a3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_b_c___segmented_operation_1ad3cd2fd51a7ccf0c8259b17491c449a3" kindref="member">input</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="777" refid="struct_a_e_s_c_b_c___segmented_operation_1a6446fd7e04dfcfa648c90f6340acb41b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_b_c___segmented_operation_1a6446fd7e04dfcfa648c90f6340acb41b" kindref="member">output</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="783" refid="struct_a_e_s_c_b_c___segmented_operation_1a916fa6f486eccadc0addf6d0fc66ef4a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_b_c___segmented_operation_1a916fa6f486eccadc0addf6d0fc66ef4a" kindref="member">inputLength</ref>;<sp/></highlight></codeline>
<codeline lineno="791"><highlight class="normal">}<sp/><ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref>;</highlight></codeline>
<codeline lineno="792"><highlight class="normal"></highlight></codeline>
<codeline lineno="800" refid="_a_e_s_c_b_c_8h_1a4f412502b110e7046c203e23722aaa89" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref><sp/><ref refid="_a_e_s_c_b_c_8h_1a4f412502b110e7046c203e23722aaa89" kindref="member">AESCBC_Operation</ref>;</highlight></codeline>
<codeline lineno="801"><highlight class="normal"></highlight></codeline>
<codeline lineno="806" refid="union_a_e_s_c_b_c___operation_union" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">union<sp/></highlight><highlight class="normal"><ref refid="union_a_e_s_c_b_c___operation_union" kindref="compound">AESCBC_OperationUnion</ref></highlight></codeline>
<codeline lineno="807"><highlight class="normal">{</highlight></codeline>
<codeline lineno="808" refid="union_a_e_s_c_b_c___operation_union_1a2ec760a838b7b4d5d64f6bd439e389f5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref><sp/><ref refid="union_a_e_s_c_b_c___operation_union_1a2ec760a838b7b4d5d64f6bd439e389f5" kindref="member">oneStepOperation</ref>;<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>One-step<sp/>operation<sp/>element<sp/>of<sp/>the<sp/>operation<sp/>union<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="809" refid="union_a_e_s_c_b_c___operation_union_1a41e5cf06fad7c50b7b50b53063cffc8e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref><sp/><ref refid="union_a_e_s_c_b_c___operation_union_1a41e5cf06fad7c50b7b50b53063cffc8e" kindref="member">segmentedOperation</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Segmented<sp/>operation<sp/>element<sp/>of<sp/>the<sp/>operation<sp/>union<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="810"><highlight class="normal">}<sp/><ref refid="_a_e_s_c_b_c_8h_1aa2bc486e0f51737928f21514715a537c" kindref="member">AESCBC_OperationUnion</ref>;</highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="815" refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="816"><highlight class="normal">{</highlight></codeline>
<codeline lineno="817" refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959ae9f86ebbb5b543515e8cf4b63d533924" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959ae9f86ebbb5b543515e8cf4b63d533924" kindref="member">AESCBC_OPERATION_TYPE_ENCRYPT</ref><sp/><sp/><sp/><sp/>=<sp/>1,<sp/></highlight><highlight class="comment">/*<sp/>Fields<sp/>1<sp/>and<sp/>2<sp/>are<sp/>for<sp/>backward<sp/>compatibility<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="818" refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a9c63c1a604a8ef68797d84bed9cf20a5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a9c63c1a604a8ef68797d84bed9cf20a5" kindref="member">AESCBC_OPERATION_TYPE_DECRYPT</ref><sp/><sp/><sp/><sp/>=<sp/>2,</highlight></codeline>
<codeline lineno="819" refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a28e1fd2ea29d9c7cdd2534686f50ec5b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a28e1fd2ea29d9c7cdd2534686f50ec5b" kindref="member">AESCBC_OP_TYPE_ONESTEP_ENCRYPT</ref><sp/><sp/><sp/>=<sp/>1,<sp/></highlight><highlight class="comment">/*<sp/>Names<sp/>changed<sp/>to<sp/>_OP_TYPE_<sp/>to<sp/>avoid<sp/>MISRA<sp/>deviation<sp/>from<sp/>first<sp/>31<sp/>chars<sp/>not</highlight></codeline>
<codeline lineno="820"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>being<sp/>unique<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="821" refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959ad06b3a66a8906cbcdb2f21cb6ea57e89" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959ad06b3a66a8906cbcdb2f21cb6ea57e89" kindref="member">AESCBC_OP_TYPE_ONESTEP_DECRYPT</ref><sp/><sp/><sp/>=<sp/>2,</highlight></codeline>
<codeline lineno="822" refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a4d9d7bab075783ce371f817a1b4c0a37" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a4d9d7bab075783ce371f817a1b4c0a37" kindref="member">AESCBC_OP_TYPE_ENCRYPT_SEGMENTED</ref><sp/>=<sp/>3,</highlight></codeline>
<codeline lineno="823" refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959aa8e0e67a9f80b534073fc07030415085" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959aa8e0e67a9f80b534073fc07030415085" kindref="member">AESCBC_OP_TYPE_DECRYPT_SEGMENTED</ref><sp/>=<sp/>4,</highlight></codeline>
<codeline lineno="824" refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a15314c3bc0356e0a1cea870ffc2f5075" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a15314c3bc0356e0a1cea870ffc2f5075" kindref="member">AESCBC_OP_TYPE_FINALIZE_ENCRYPT_SEGMENTED</ref><sp/>=<sp/>5,</highlight></codeline>
<codeline lineno="825" refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a9fcc96b5e73a699498f3627085aa02cf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959a9fcc96b5e73a699498f3627085aa02cf" kindref="member">AESCBC_OP_TYPE_FINALIZE_DECRYPT_SEGMENTED</ref><sp/>=<sp/>6</highlight></codeline>
<codeline lineno="826"><highlight class="normal">}<sp/><ref refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959" kindref="member">AESCBC_OperationType</ref>;</highlight></codeline>
<codeline lineno="827"><highlight class="normal"></highlight></codeline>
<codeline lineno="843" refid="_a_e_s_c_b_c_8h_1ad3c538c1ce2d9aa37bd538a90f278b45" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/>void<sp/>(*<ref refid="_a_e_s_c_b_c_8h_1ad3c538c1ce2d9aa37bd538a90f278b45" kindref="member">AESCBC_CallbackFxn</ref>)(AESCBC_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="union_a_e_s_c_b_c___operation_union" kindref="compound">AESCBC_OperationUnion</ref><sp/>*operation,</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1a498551584800977637726dde45cd9959" kindref="member">AESCBC_OperationType</ref><sp/>operationType);</highlight></codeline>
<codeline lineno="847"><highlight class="normal"></highlight></codeline>
<codeline lineno="856" refid="struct_a_e_s_c_b_c___params" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="857"><highlight class="normal">{</highlight></codeline>
<codeline lineno="858" refid="struct_a_e_s_c_b_c___params_1aaf9f67c02267e03a5ffbc5ccb4e7580a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>AESCBC_ReturnBehavior<sp/><ref refid="struct_a_e_s_c_b_c___params_1aaf9f67c02267e03a5ffbc5ccb4e7580a" kindref="member">returnBehavior</ref>;<sp/></highlight></codeline>
<codeline lineno="859" refid="struct_a_e_s_c_b_c___params_1a57b3ac8537584ca0bc3ed743792df321" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_b_c_8h_1ad3c538c1ce2d9aa37bd538a90f278b45" kindref="member">AESCBC_CallbackFxn</ref><sp/><ref refid="struct_a_e_s_c_b_c___params_1a57b3ac8537584ca0bc3ed743792df321" kindref="member">callbackFxn</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="860" refid="struct_a_e_s_c_b_c___params_1a9d78b09aba375e0e6a3416c4166374e3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/><ref refid="struct_a_e_s_c_b_c___params_1a9d78b09aba375e0e6a3416c4166374e3" kindref="member">timeout</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="863" refid="struct_a_e_s_c_b_c___params_1a9a933064fd7fd7484d922654bf79278f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="struct_a_e_s_c_b_c___params_1a9a933064fd7fd7484d922654bf79278f" kindref="member">custom</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="866"><highlight class="normal">}<sp/><ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref>;</highlight></codeline>
<codeline lineno="867"><highlight class="normal"></highlight></codeline>
<codeline lineno="873"><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref><sp/><ref refid="_a_e_s_c_b_c_8h_1a65d438667291f32d79714a3b24b7e9bb" kindref="member">AESCBC_defaultParams</ref>;</highlight></codeline>
<codeline lineno="874"><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_b_c_8h_1a72ae710de057086ca1d4e96f1a92a9a1" kindref="member">AESCBC_init</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="884"><highlight class="normal"></highlight></codeline>
<codeline lineno="897"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_b_c_8h_1a3c0ff1f31e58390f960f927f12756a98" kindref="member">AESCBC_Params_init</ref>(<ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref><sp/>*<ref refid="_driver___init_8h_1af93f10d4f7393a01dff58c92f91d8cbc" kindref="member">params</ref>);</highlight></codeline>
<codeline lineno="898"><highlight class="normal"></highlight></codeline>
<codeline lineno="916"><highlight class="normal">AESCBC_Handle<sp/><ref refid="_a_e_s_c_b_c_8h_1ac4e418c0f71f339935513126d37fbc9f" kindref="member">AESCBC_open</ref>(uint_least8_t<sp/>index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref><sp/>*<ref refid="_driver___init_8h_1af93f10d4f7393a01dff58c92f91d8cbc" kindref="member">params</ref>);</highlight></codeline>
<codeline lineno="917"><highlight class="normal"></highlight></codeline>
<codeline lineno="927"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_b_c_8h_1a3189993c935516a40c09110092e6ef19" kindref="member">AESCBC_close</ref>(AESCBC_Handle<sp/>handle);</highlight></codeline>
<codeline lineno="928"><highlight class="normal"></highlight></codeline>
<codeline lineno="940"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_b_c_8h_1a0864488e0826602937308930ab60e200" kindref="member">AESCBC_Operation_init</ref>(AESCBC_Operation<sp/>*operationStruct);</highlight></codeline>
<codeline lineno="941"><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_b_c_8h_1a6715fbb822cc1ef0b60869588f60f7e2" kindref="member">AESCBC_OneStepOperation_init</ref>(<ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref><sp/>*operationStruct);</highlight></codeline>
<codeline lineno="951"><highlight class="normal"></highlight></codeline>
<codeline lineno="960"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_b_c_8h_1a6b97cc99a27c2c2f20defb663d6eca26" kindref="member">AESCBC_SegmentedOperation_init</ref>(<ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref><sp/>*operationStruct);</highlight></codeline>
<codeline lineno="961"><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_b_c_8h_1af3cf6e72eacee43c28450dad9dc3f046" kindref="member">AESCBC_oneStepEncrypt</ref>(AESCBC_Handle<sp/>handle,<sp/><ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref><sp/>*operationStruct);</highlight></codeline>
<codeline lineno="983"><highlight class="normal"></highlight></codeline>
<codeline lineno="1004"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_b_c_8h_1a3e603f77710ad26615805f9bb27672d3" kindref="member">AESCBC_oneStepDecrypt</ref>(AESCBC_Handle<sp/>handle,<sp/><ref refid="struct_a_e_s_c_b_c___one_step_operation" kindref="compound">AESCBC_OneStepOperation</ref><sp/>*operationStruct);</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_b_c_8h_1a5e3356cffdfd0671cdefb1aa11a97bca" kindref="member">AESCBC_setupEncrypt</ref>(AESCBC_Handle<sp/>handle,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*key);</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"></highlight></codeline>
<codeline lineno="1042"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_b_c_8h_1a144ccb3985ceeee03b370d68dd1ea4b2" kindref="member">AESCBC_setupDecrypt</ref>(AESCBC_Handle<sp/>handle,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*key);</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"></highlight></codeline>
<codeline lineno="1065"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_b_c_8h_1a1a32ec040a89052bf3f6e08ddb5657e2" kindref="member">AESCBC_setIV</ref>(AESCBC_Handle<sp/>handle,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*iv,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ivLength);</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"></highlight></codeline>
<codeline lineno="1093"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_b_c_8h_1af8e25f2268d83629d9799a165bc7683c" kindref="member">AESCBC_generateIV</ref>(AESCBC_Handle<sp/>handle,<sp/>uint8_t<sp/>*iv,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>ivSize,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>*ivLength);</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"></highlight></codeline>
<codeline lineno="1118"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_b_c_8h_1ab3f6ed48e40f396b1f99f071d74652c8" kindref="member">AESCBC_addData</ref>(AESCBC_Handle<sp/>handle,<sp/><ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"></highlight></codeline>
<codeline lineno="1142"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_b_c_8h_1a2e0e343511ed0d1ca298b22a09fc36a6" kindref="member">AESCBC_finalize</ref>(AESCBC_Handle<sp/>handle,<sp/><ref refid="struct_a_e_s_c_b_c___segmented_operation" kindref="compound">AESCBC_SegmentedOperation</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"></highlight></codeline>
<codeline lineno="1157"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_b_c_8h_1a807f254a97d04e2b8e2c73d026d3c81a" kindref="member">AESCBC_cancelOperation</ref>(AESCBC_Handle<sp/>handle);</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"></highlight></codeline>
<codeline lineno="1182"><highlight class="normal">AESCBC_Handle<sp/><ref refid="_a_e_s_c_b_c_8h_1a0cab3841802fa8f8cb8d19993d25e88d" kindref="member">AESCBC_construct</ref>(AESCBC_Config<sp/>*config,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_b_c___params" kindref="compound">AESCBC_Params</ref><sp/>*<ref refid="_driver___init_8h_1af93f10d4f7393a01dff58c92f91d8cbc" kindref="member">params</ref>);</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"></highlight></codeline>
<codeline lineno="1184"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1185"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1187"><highlight class="normal"></highlight></codeline>
<codeline lineno="1188"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>ti_drivers_AESCBC__include<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="source/ti/drivers/AESCBC.h"/>
  </compounddef>
</doxygen>
