<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.12">
  <compounddef id="_a_e_s_c_c_m_8h" kind="file" language="C++">
    <compoundname>AESCCM.h</compoundname>
    <includes local="no">stdbool.h</includes>
    <includes local="no">stddef.h</includes>
    <includes local="no">stdint.h</includes>
    <includes refid="_a_e_s_common_8h" local="no">ti/drivers/AESCommon.h</includes>
    <includes refid="_crypto_key_8h" local="no">ti/drivers/cryptoutils/cryptokey/CryptoKey.h</includes>
    <includedby refid="_a_e_s_c_c_m_c_c26_x4_8h" local="no">AESCCMCC26X4.h</includedby>
    <includedby refid="_a_e_s_c_c_m_c_c26_x4__ns_8h" local="no">AESCCMCC26X4_ns.h</includedby>
    <includedby refid="_a_e_s_c_c_m_c_c26_x4__s_8h" local="no">AESCCMCC26X4_s.h</includedby>
    <includedby refid="_a_e_s_c_c_m_c_c26_x_x_8h" local="no">AESCCMCC26XX.h</includedby>
    <incdepgraph>
      <node id="121">
        <label>stdbool.h</label>
      </node>
      <node id="124">
        <label>ti/drivers/AESCommon.h</label>
        <link refid="_a_e_s_common_8h"/>
        <childnode refid="121" relation="include">
        </childnode>
        <childnode refid="122" relation="include">
        </childnode>
        <childnode refid="123" relation="include">
        </childnode>
      </node>
      <node id="123">
        <label>stdint.h</label>
      </node>
      <node id="125">
        <label>ti/drivers/cryptoutils/cryptokey/CryptoKey.h</label>
        <link refid="_crypto_key_8h"/>
        <childnode refid="123" relation="include">
        </childnode>
        <childnode refid="121" relation="include">
        </childnode>
      </node>
      <node id="120">
        <label>AESCCM.h</label>
        <link refid="_a_e_s_c_c_m_8h"/>
        <childnode refid="121" relation="include">
        </childnode>
        <childnode refid="122" relation="include">
        </childnode>
        <childnode refid="123" relation="include">
        </childnode>
        <childnode refid="124" relation="include">
        </childnode>
        <childnode refid="125" relation="include">
        </childnode>
      </node>
      <node id="122">
        <label>stddef.h</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="128">
        <label>AESCCMCC26X4_ns.h</label>
        <link refid="_a_e_s_c_c_m_c_c26_x4__ns_8h"/>
      </node>
      <node id="126">
        <label>AESCCM.h</label>
        <link refid="_a_e_s_c_c_m_8h"/>
        <childnode refid="127" relation="include">
        </childnode>
        <childnode refid="128" relation="include">
        </childnode>
        <childnode refid="129" relation="include">
        </childnode>
        <childnode refid="130" relation="include">
        </childnode>
      </node>
      <node id="130">
        <label>AESCCMCC26XX.h</label>
        <link refid="_a_e_s_c_c_m_c_c26_x_x_8h"/>
      </node>
      <node id="127">
        <label>AESCCMCC26X4.h</label>
        <link refid="_a_e_s_c_c_m_c_c26_x4_8h"/>
      </node>
      <node id="129">
        <label>AESCCMCC26X4_s.h</label>
        <link refid="_a_e_s_c_c_m_c_c26_x4__s_8h"/>
      </node>
    </invincdepgraph>
    <innerclass refid="struct_a_e_s_c_c_m___one_step_operation" prot="public">AESCCM_OneStepOperation</innerclass>
    <innerclass refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" prot="public">AESCCM_SegmentedAADOperation</innerclass>
    <innerclass refid="struct_a_e_s_c_c_m___segmented_data_operation" prot="public">AESCCM_SegmentedDataOperation</innerclass>
    <innerclass refid="struct_a_e_s_c_c_m___segmented_finalize_operation" prot="public">AESCCM_SegmentedFinalizeOperation</innerclass>
    <innerclass refid="union_a_e_s_c_c_m___operation_union" prot="public">AESCCM_OperationUnion</innerclass>
    <innerclass refid="struct_a_e_s_c_c_m___params" prot="public">AESCCM_Params</innerclass>
      <sectiondef kind="define">
      <memberdef kind="define" id="_a_e_s_c_c_m_8h_1a92006b2b0e406614ca650c88b5d393ef" prot="public" static="no">
        <name>AESCCM_STATUS_RESERVED</name>
        <initializer><ref refid="_a_e_s_common_8h_1a4896831b1a3a4ead39a3c58eb13a05f5" kindref="member">AES_STATUS_RESERVED</ref></initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Common AESCCM status code reservation offset. AESCCM driver implementations should offset status codes with AESCCM_STATUS_RESERVED growing negatively.</para><para>Example implementation specific status codes: <programlisting><codeline><highlight class="normal">#define<sp/>AESCCMXYZ_STATUS_ERROR0<sp/><sp/><sp/><sp/>AESCCM_STATUS_RESERVED<sp/>-<sp/>0</highlight></codeline>
<codeline><highlight class="normal">#define<sp/>AESCCMXYZ_STATUS_ERROR1<sp/><sp/><sp/><sp/>AESCCM_STATUS_RESERVED<sp/>-<sp/>1</highlight></codeline>
<codeline><highlight class="normal">#define<sp/>AESCCMXYZ_STATUS_ERROR2<sp/><sp/><sp/><sp/>AESCCM_STATUS_RESERVED<sp/>-<sp/>2</highlight></codeline>
</programlisting> </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="730" column="9" bodyfile="source/ti/drivers/AESCCM.h" bodystart="730" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" prot="public" static="no">
        <name>AESCCM_STATUS_SUCCESS</name>
        <initializer><ref refid="_a_e_s_common_8h_1a40238be3b30c09acbb966b8cf64d8db6" kindref="member">AES_STATUS_SUCCESS</ref></initializer>
        <briefdescription>
<para>Successful status code. </para>        </briefdescription>
        <detaileddescription>
<para>Functions return AESCCM_STATUS_SUCCESS if the function was executed successfully. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="738" column="9" bodyfile="source/ti/drivers/AESCCM.h" bodystart="738" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" prot="public" static="no">
        <name>AESCCM_STATUS_ERROR</name>
        <initializer><ref refid="_a_e_s_common_8h_1ac6963a06e1923ad116a23c0e1a17dba8" kindref="member">AES_STATUS_ERROR</ref></initializer>
        <briefdescription>
<para>Generic error status code. </para>        </briefdescription>
        <detaileddescription>
<para>Functions return AESCCM_STATUS_ERROR if the function was not executed successfully and no more pertinent error code could be returned. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="746" column="9" bodyfile="source/ti/drivers/AESCCM.h" bodystart="746" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_c_m_8h_1aabf9f8e552b6a5a12f512d6c862f04fa" prot="public" static="no">
        <name>AESCCM_STATUS_RESOURCE_UNAVAILABLE</name>
        <initializer><ref refid="_a_e_s_common_8h_1a4720c275153144c20096dc2d85f93889" kindref="member">AES_STATUS_RESOURCE_UNAVAILABLE</ref></initializer>
        <briefdescription>
<para>An error status code returned if the hardware or software resource is currently unavailable. </para>        </briefdescription>
        <detaileddescription>
<para>AESCCM driver implementations may have hardware or software limitations on how many clients can simultaneously perform operations. This status code is returned if the mutual exclusion mechanism signals that an operation cannot currently be performed. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="756" column="9" bodyfile="source/ti/drivers/AESCCM.h" bodystart="756" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_c_m_8h_1aedda3f3cdad624c827dffda8e2cad3a1" prot="public" static="no">
        <name>AESCCM_STATUS_CANCELED</name>
        <initializer><ref refid="_a_e_s_common_8h_1aa8d5ff0dd5cde60089ac5d84cfb4a702" kindref="member">AES_STATUS_CANCELED</ref></initializer>
        <briefdescription>
<para>The ongoing operation was canceled. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="761" column="9" bodyfile="source/ti/drivers/AESCCM.h" bodystart="761" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_c_m_8h_1adf7ebf9930072745c454b0bf932d694b" prot="public" static="no">
        <name>AESCCM_STATUS_MAC_INVALID</name>
        <initializer><ref refid="_a_e_s_common_8h_1a145da39116c94a54f073894402508d53" kindref="member">AES_STATUS_MAC_INVALID</ref></initializer>
        <briefdescription>
<para>An error status code returned if the MAC provided by the application for a decryption operation does not match the one calculated during the operation. </para>        </briefdescription>
        <detaileddescription>
<para>This code is returned by <ref refid="_a_e_s_c_c_m_8h_1a5024c43a06ca27339788c6ad6ddd4b87" kindref="member">AESCCM_oneStepDecrypt()</ref> or <ref refid="_a_e_s_c_c_m_8h_1a980b983808740d02da02123989453cc4" kindref="member">AESCCM_finalizeDecrypt()</ref> if the verification of the MAC fails. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="770" column="9" bodyfile="source/ti/drivers/AESCCM.h" bodystart="770" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" prot="public" static="no">
        <name>AESCCM_STATUS_FEATURE_NOT_SUPPORTED</name>
        <initializer><ref refid="_a_e_s_common_8h_1a671e5331015411e6db491d8eee23732c" kindref="member">AES_STATUS_FEATURE_NOT_SUPPORTED</ref></initializer>
        <briefdescription>
<para>The operation requested is not supported either by the target hardware or the driver implementation. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="776" column="9" bodyfile="source/ti/drivers/AESCCM.h" bodystart="776" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_c_m_8h_1a8a80abb1ad1626c0687f399efa7f5109" prot="public" static="no">
        <name>AESCCM_STATUS_KEYSTORE_INVALID_ID</name>
        <initializer><ref refid="_a_e_s_common_8h_1aeaab212abda07968840db525e114d1ae" kindref="member">AES_STATUS_KEYSTORE_INVALID_ID</ref></initializer>
        <briefdescription>
<para>The operation tried to load a key from the keystore using an invalid key ID. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="781" column="9" bodyfile="source/ti/drivers/AESCCM.h" bodystart="781" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_c_m_8h_1af3bee65918c7fc3f7d8614d82f305584" prot="public" static="no">
        <name>AESCCM_STATUS_KEYSTORE_GENERIC_ERROR</name>
        <initializer><ref refid="_a_e_s_common_8h_1a89e9ed71ffb10f4f6d5b52b8afbd4389" kindref="member">AES_STATUS_KEYSTORE_GENERIC_ERROR</ref></initializer>
        <briefdescription>
<para>The key store module returned a generic error. See key store documentation for additional details. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="787" column="9" bodyfile="source/ti/drivers/AESCCM.h" bodystart="787" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="_a_e_s_c_c_m_8h_1a2c1fecff89d36c4e712c8ffd5a8c2fe0" prot="public" static="no">
        <name>AESCCM_STATUS_UNALIGNED_IO_NOT_SUPPORTED</name>
        <initializer><ref refid="_a_e_s_common_8h_1ab367c0137dd8d9bda4107b1545bfdb12" kindref="member">AES_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></initializer>
        <briefdescription>
<para>The operation does not support non-word-aligned input and/or output. </para>        </briefdescription>
        <detaileddescription>
<para>AESCCM driver implementations may have restrictions on the alignment of input/output data due to performance limitations of the hardware. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="795" column="9" bodyfile="source/ti/drivers/AESCCM.h" bodystart="795" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="enum">
      <memberdef kind="enum" id="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4a" prot="public" static="no">
        <name>AESCCM_ReturnBehavior</name>
        <enumvalue id="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aab768e7c12bd6bf9e87bfba1c6bf3d2a4" prot="public">
          <name>AESCCM_RETURN_BEHAVIOR_CALLBACK</name>
          <initializer>= AES_RETURN_BEHAVIOR_CALLBACK</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will return immediately while the CCM operation goes on in the background. The registered callback function is called after the operation completes. The context the callback function is called (task, HWI, SWI) is implementation-dependent. </para>          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aa1761cf2c8bd972890a0193f772281a8c" prot="public">
          <name>AESCCM_RETURN_BEHAVIOR_BLOCKING</name>
          <initializer>= AES_RETURN_BEHAVIOR_BLOCKING</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will block while the CCM operation goes on in the background. CCM operation results are available after the function returns. </para>          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aa8077fa385d151d93ed7762a998abd567" prot="public">
          <name>AESCCM_RETURN_BEHAVIOR_POLLING</name>
          <initializer>= AES_RETURN_BEHAVIOR_POLLING</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
<para>The function call will continuously poll a flag while CCM operation goes on in the background. CCM operation results are available after the function returns. </para>          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>The way in which CCM function calls return after performing an encryption + authentication or decryption + verification operation. </para>        </briefdescription>
        <detaileddescription>
<para>Not all CCM operations exhibit the specified return behavior. Functions that do not require significant computation and cannot offload that computation to a background thread behave like regular functions. Which functions exhibit the specified return behavior is not implementation dependent. Specifically, a software-backed implementation run on the same CPU as the application will emulate the return behavior while not actually offloading the computation to the background thread.</para><para>AESCCM functions exhibiting the specified return behavior have restrictions on the context from which they may be called.</para><para><table rows="4" cols="4"><row>
<entry thead="yes"><para></para></entry><entry thead="yes"><para>Task </para></entry><entry thead="yes"><para>Hwi </para></entry><entry thead="yes"><para>Swi  </para></entry></row>
<row>
<entry thead="no"><para>AESCCM_RETURN_BEHAVIOR_CALLBACK </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry></row>
<row>
<entry thead="no"><para>AESCCM_RETURN_BEHAVIOR_BLOCKING </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para></para></entry><entry thead="no"><para></para></entry></row>
<row>
<entry thead="no"><para>AESCCM_RETURN_BEHAVIOR_POLLING </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry><entry thead="no"><para>X </para></entry></row>
</table>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="837" column="1" bodyfile="source/ti/drivers/AESCCM.h" bodystart="836" bodyend="855"/>
      </memberdef>
      <memberdef kind="enum" id="_a_e_s_c_c_m_8h_1aa8e2ac1695595c7d416ba650c9110b5c" prot="public" static="no">
        <name>AESCCM_Mode</name>
        <enumvalue id="_a_e_s_c_c_m_8h_1aa8e2ac1695595c7d416ba650c9110b5ca1366ac9470982aa8b1457e305df7e026" prot="public">
          <name>AESCCM_MODE_ENCRYPT</name>
          <initializer>= 1</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1aa8e2ac1695595c7d416ba650c9110b5ca4f3b682868aaacf1a33856fa85543ae3" prot="public">
          <name>AESCCM_MODE_DECRYPT</name>
          <initializer>= 2</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Enum for the direction of the CCM operation. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="861" column="1" bodyfile="source/ti/drivers/AESCCM.h" bodystart="860" bodyend="864"/>
      </memberdef>
      <memberdef kind="enum" id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0" prot="public" static="no">
        <name>AESCCM_OperationType</name>
        <enumvalue id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a1c0ce6f811d6c8d513027375449b9fc7" prot="public">
          <name>AESCCM_OPERATION_TYPE_ENCRYPT</name>
          <initializer>= 1</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ab20c9152379db6153e39a74f09d0a874" prot="public">
          <name>AESCCM_OPERATION_TYPE_DECRYPT</name>
          <initializer>= 2</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a56cc5668458a7419c6cc53934c92cc04" prot="public">
          <name>AESCCM_OP_TYPE_ONESTEP_ENCRYPT</name>
          <initializer>= 1</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ab27d592644eb32362723b6f263f6b6cb" prot="public">
          <name>AESCCM_OP_TYPE_ONESTEP_DECRYPT</name>
          <initializer>= 2</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a21671c7c511d7a39a9c6752cc2f2274a" prot="public">
          <name>AESCCM_OP_TYPE_AAD_ENCRYPT</name>
          <initializer>= 3</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ad57252d7dbd1656f1f2e17c7af8c8e3e" prot="public">
          <name>AESCCM_OP_TYPE_AAD_DECRYPT</name>
          <initializer>= 4</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ae6d3be7cfaf6e0c33dbd47ba30a939ce" prot="public">
          <name>AESCCM_OP_TYPE_DATA_ENCRYPT</name>
          <initializer>= 5</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ac26cca8eeecc8a9b958dd795725e38da" prot="public">
          <name>AESCCM_OP_TYPE_DATA_DECRYPT</name>
          <initializer>= 6</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ac0967aba400c9818f857894bf457076b" prot="public">
          <name>AESCCM_OP_TYPE_FINALIZE_ENCRYPT</name>
          <initializer>= 7</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <enumvalue id="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a93c7993431a00f336ade13e625580a16" prot="public">
          <name>AESCCM_OP_TYPE_FINALIZE_DECRYPT</name>
          <initializer>= 8</initializer>
          <briefdescription>
          </briefdescription>
          <detaileddescription>
          </detaileddescription>
        </enumvalue>
        <briefdescription>
<para>Enum for the operation types supported by the driver. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1030" column="1" bodyfile="source/ti/drivers/AESCCM.h" bodystart="1029" bodyend="1042"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="typedef">
      <memberdef kind="typedef" id="_a_e_s_c_c_m_8h_1a91d80cb57f9660003f6cc75a155215a7" prot="public" static="no">
        <type><ref refid="struct_a_e_s_common___config" kindref="compound">AESCommon_Config</ref></type>
        <definition>typedef AESCommon_Config AESCCM_Config</definition>
        <argsstring></argsstring>
        <name>AESCCM_Config</name>
        <briefdescription>
<para>AESCCM Global configuration. </para>        </briefdescription>
        <detaileddescription>
<para>The AESCCM_Config structure contains a set of pointers used to characterize the AESCCM driver implementation.</para><para>This structure needs to be defined before calling <ref refid="_a_e_s_c_c_m_8h_1a51982c7e9ace406edb69a0345f4c9dfc" kindref="member">AESCCM_init()</ref> and it must not be changed thereafter.</para><para><simplesect kind="see"><para><ref refid="_a_e_s_c_c_m_8h_1a51982c7e9ace406edb69a0345f4c9dfc" kindref="member">AESCCM_init()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="808" column="1" bodyfile="source/ti/drivers/AESCCM.h" bodystart="808" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" prot="public" static="no">
        <type><ref refid="_a_e_s_c_c_m_8h_1a91d80cb57f9660003f6cc75a155215a7" kindref="member">AESCCM_Config</ref> *</type>
        <definition>typedef AESCCM_Config* AESCCM_Handle</definition>
        <argsstring></argsstring>
        <name>AESCCM_Handle</name>
        <briefdescription>
<para>A handle that is returned from an <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> call. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="813" column="1" bodyfile="source/ti/drivers/AESCCM.h" bodystart="813" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="_a_e_s_c_c_m_8h_1a1546f451996da52b51b153524f4ad6e0" prot="public" static="no">
        <type><ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref></type>
        <definition>typedef AESCCM_OneStepOperation AESCCM_Operation</definition>
        <argsstring></argsstring>
        <name>AESCCM_Operation</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para><xrefsect id="deprecated_1_deprecated000004"><xreftitle>Deprecated</xreftitle><xrefdescription><para>Define a typedef for deprecated operation AESCCM_Operation. Existing code should be refactored to use <ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref>. This reference may be removed at some point in the future</para></xrefdescription></xrefsect></para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1011" column="1" bodyfile="source/ti/drivers/AESCCM.h" bodystart="1011" bodyend="-1"/>
      </memberdef>
      <memberdef kind="typedef" id="_a_e_s_c_c_m_8h_1a1f32498fec196ebb5edad85c910057a8" prot="public" static="no">
        <type>union <ref refid="union_a_e_s_c_c_m___operation_union" kindref="compound">AESCCM_OperationUnion</ref></type>
        <definition>typedef union AESCCM_OperationUnion  AESCCM_OperationUnion</definition>
        <argsstring></argsstring>
        <name>AESCCM_OperationUnion</name>
        <briefdescription>
<para>Union containing a reference to a one step, segmented AAD, segmented data, or segmented finalize operation. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1024" column="1"/>
      </memberdef>
      <memberdef kind="typedef" id="_a_e_s_c_c_m_8h_1ad9f54d289ab9013555d4ce5e2cbd7411" prot="public" static="no">
        <type>void(*</type>
        <definition>typedef void(* AESCCM_CallbackFxn) (AESCCM_Handle handle, int_fast16_t returnValue, AESCCM_OperationUnion *operation, AESCCM_OperationType operationType)</definition>
        <argsstring>)(AESCCM_Handle handle, int_fast16_t returnValue, AESCCM_OperationUnion *operation, AESCCM_OperationType operationType)</argsstring>
        <name>AESCCM_CallbackFxn</name>
        <briefdescription>
<para>The definition of a callback function used by the AESCCM driver when used in <ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aab768e7c12bd6bf9e87bfba1c6bf3d2a4" kindref="member">AESCCM_RETURN_BEHAVIOR_CALLBACK</ref>. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>handle</parametername>
</parameternamelist>
<parameterdescription>
<para>Handle of the client that started the CCM operation.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>returnValue</parametername>
</parameternamelist>
<parameterdescription>
<para>The result of the CCM operation. May contain an error code. Informs the application of why the callback function was called.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>operationUnion</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to an operation union.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>operationType</parametername>
</parameternamelist>
<parameterdescription>
<para>This parameter determines which operation the callback refers to. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1059" column="1" bodyfile="source/ti/drivers/AESCCM.h" bodystart="1059" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="_a_e_s_c_c_m_8h_1a7057e1ce2ca8a0f7087a8a664ac3560d" prot="public" static="no" mutable="no">
        <type>const <ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref></type>
        <definition>const AESCCM_Params AESCCM_defaultParams</definition>
        <argsstring></argsstring>
        <name>AESCCM_defaultParams</name>
        <briefdescription>
<para>Default <ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref> structure. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="see"><para><ref refid="_a_e_s_c_c_m_8h_1ab48597e7c8931af81234c786efac7cee" kindref="member">AESCCM_Params_init()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1089" column="1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a51982c7e9ace406edb69a0345f4c9dfc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCCM_init</definition>
        <argsstring>(void)</argsstring>
        <name>AESCCM_init</name>
        <param>
          <type>void</type>
        </param>
        <briefdescription>
<para>This function initializes the CCM module. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para>The AESCCM_config structure must exist and be persistent before this function can be called. This function must also be called before any other CCM driver APIs. This function call does not modify any peripheral registers. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1099" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1ab48597e7c8931af81234c786efac7cee" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCCM_Params_init</definition>
        <argsstring>(AESCCM_Params *params)</argsstring>
        <name>AESCCM_Params_init</name>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>Function to initialize the <ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>params</parametername>
</parameternamelist>
<parameterdescription>
<para>An pointer to <ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are: returnBehavior = AESCCM_RETURN_BEHAVIOR_BLOCKING callbackFxn = NULL timeout = SemaphoreP_WAIT_FOREVER custom = NULL </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1113" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
        <definition>AESCCM_Handle AESCCM_open</definition>
        <argsstring>(uint_least8_t index, const AESCCM_Params *params)</argsstring>
        <name>AESCCM_open</name>
        <param>
          <type>uint_least8_t</type>
          <declname>index</declname>
        </param>
        <param>
          <type>const <ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>This function opens a given CCM peripheral. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para>CCM controller has been initialized using <ref refid="_a_e_s_c_c_m_8h_1a51982c7e9ace406edb69a0345f4c9dfc" kindref="member">AESCCM_init()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">index</parametername>
</parameternamelist>
<parameterdescription>
<para>Logical peripheral number for the CCM indexed into the AESCCM_config table</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">params</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to an parameter block, if NULL it will use default values.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>An AESCCM_Handle on success or a NULL on an error or if it has been opened already.</para></simplesect>
<simplesect kind="see"><para><ref refid="_a_e_s_c_c_m_8h_1a51982c7e9ace406edb69a0345f4c9dfc" kindref="member">AESCCM_init()</ref> </para></simplesect>
<simplesect kind="see"><para><ref refid="_a_e_s_c_c_m_8h_1a2cb2636c081846cfc81b801999a21ec5" kindref="member">AESCCM_close()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1132" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a2cb2636c081846cfc81b801999a21ec5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCCM_close</definition>
        <argsstring>(AESCCM_Handle handle)</argsstring>
        <name>AESCCM_close</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <briefdescription>
<para>Function to close a CCM peripheral specified by the CCM handle. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1143" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1aa793f126c596136ce4af66b38c7bccd6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_setupEncrypt</definition>
        <argsstring>(AESCCM_Handle handle, const CryptoKey *key, size_t totalAADLength, size_t totalPlaintextLength, size_t macLength)</argsstring>
        <name>AESCCM_setupEncrypt</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type>const <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> *</type>
          <declname>key</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>totalAADLength</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>totalPlaintextLength</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>macLength</declname>
        </param>
        <briefdescription>
<para>Function to prepare a segmented AESCCM encryption operation. </para>        </briefdescription>
        <detaileddescription>
<para>This function sets up a segmented AESCCM encryption operation.</para><para><simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">key</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to a previously initialized <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">totalAADLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Total size of the AAD in bytes. This value can be 0 and later provided by <ref refid="_a_e_s_c_c_m_8h_1a2376b9edaffed9f9afff639ee421f9d6" kindref="member">AESCCM_setLengths()</ref>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">totalPlaintextLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Total size of the plaintext in bytes. This value can be 0 and later provided by <ref refid="_a_e_s_c_c_m_8h_1a2376b9edaffed9f9afff639ee421f9d6" kindref="member">AESCCM_setLengths()</ref>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">macLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Size of the MAC in bytes. This value can be 0 and later provided by <ref refid="_a_e_s_c_c_m_8h_1a2376b9edaffed9f9afff639ee421f9d6" kindref="member">AESCCM_setLengths()</ref>.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" kindref="member">AESCCM_STATUS_FEATURE_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation is not supported in this device.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD()</ref> </para></simplesect>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1176" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1af1d437ca38c617046b61501b0a9491b0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_setupDecrypt</definition>
        <argsstring>(AESCCM_Handle handle, const CryptoKey *key, size_t totalAADLength, size_t totalPlaintextLength, size_t macLength)</argsstring>
        <name>AESCCM_setupDecrypt</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type>const <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> *</type>
          <declname>key</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>totalAADLength</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>totalPlaintextLength</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>macLength</declname>
        </param>
        <briefdescription>
<para>Function to prepare a segmented AESCCM decryption operation. </para>        </briefdescription>
        <detaileddescription>
<para>This function sets up a segmented AESCCM decryption operation.</para><para><simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">key</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to a previously initialized <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">totalAADLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Total size of the AAD in bytes. This value can be 0 and later provided by <ref refid="_a_e_s_c_c_m_8h_1a2376b9edaffed9f9afff639ee421f9d6" kindref="member">AESCCM_setLengths()</ref>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">totalPlaintextLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Total size of the plaintext in bytes This value can be 0 and later provided by <ref refid="_a_e_s_c_c_m_8h_1a2376b9edaffed9f9afff639ee421f9d6" kindref="member">AESCCM_setLengths()</ref>.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">macLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Size of the MAC in bytes. This value can be 0 and later provided by <ref refid="_a_e_s_c_c_m_8h_1a2376b9edaffed9f9afff639ee421f9d6" kindref="member">AESCCM_setLengths()</ref>.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" kindref="member">AESCCM_STATUS_FEATURE_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation is not supported in this device.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD()</ref> </para></simplesect>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1213" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a2376b9edaffed9f9afff639ee421f9d6" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_setLengths</definition>
        <argsstring>(AESCCM_Handle handle, size_t aadLength, size_t plaintextLength, size_t macLength)</argsstring>
        <name>AESCCM_setLengths</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>aadLength</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>plaintextLength</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>macLength</declname>
        </param>
        <briefdescription>
<para>Function to set the lengths of the message, additional data, and MAC. </para>        </briefdescription>
        <detaileddescription>
<para>This function declares the lengths of the message, additional authenticated data (AAD), and MAC.</para><para><simplesect kind="note"><para>This function doesn&apos;t have to be called if the lengths above were specified in <ref refid="_a_e_s_c_c_m_8h_1aa793f126c596136ce4af66b38c7bccd6" kindref="member">AESCCM_setupEncrypt()</ref> or <ref refid="_a_e_s_c_c_m_8h_1af1d437ca38c617046b61501b0a9491b0" kindref="member">AESCCM_setupDecrypt()</ref>.</para></simplesect>
<simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1aa793f126c596136ce4af66b38c7bccd6" kindref="member">AESCCM_setupEncrypt()</ref> or <ref refid="_a_e_s_c_c_m_8h_1af1d437ca38c617046b61501b0a9491b0" kindref="member">AESCCM_setupDecrypt()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">aadLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Size of the non-encrypted AAD in bytes</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">plaintextLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Size of the plaintext or ciphertext to encrypt or decrypt in bytes</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">macLength</parametername>
</parameternamelist>
<parameterdescription>
<para>Size of the MAC in bytes</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" kindref="member">AESCCM_STATUS_FEATURE_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation is not supported in this device.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1ad4c8bb8a6061a91e8a544f73cb4de780" kindref="member">AESCCM_setNonce()</ref> </para></simplesect>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a10d1d4f7c669a03ade23a057c501b8f9" kindref="member">AESCCM_generateNonce()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1246" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1ad4c8bb8a6061a91e8a544f73cb4de780" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_setNonce</definition>
        <argsstring>(AESCCM_Handle handle, const uint8_t *nonce, size_t nonceLength)</argsstring>
        <name>AESCCM_setNonce</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type>const uint8_t *</type>
          <declname>nonce</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>nonceLength</declname>
        </param>
        <briefdescription>
<para>Function to set the nonce for an AES CCM segmented operation. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1aa793f126c596136ce4af66b38c7bccd6" kindref="member">AESCCM_setupEncrypt()</ref>, <ref refid="_a_e_s_c_c_m_8h_1af1d437ca38c617046b61501b0a9491b0" kindref="member">AESCCM_setupDecrypt()</ref>, or <ref refid="_a_e_s_c_c_m_8h_1a2376b9edaffed9f9afff639ee421f9d6" kindref="member">AESCCM_setLengths()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">nonce</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the buffer containing the nonce</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">nonceLength</parametername>
</parameternamelist>
<parameterdescription>
<para>The length of the nonce in bytes</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" kindref="member">AESCCM_STATUS_FEATURE_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation is not supported in this device.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD()</ref> </para></simplesect>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1268" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a10d1d4f7c669a03ade23a057c501b8f9" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_generateNonce</definition>
        <argsstring>(AESCCM_Handle handle, uint8_t *nonce, size_t nonceSize, size_t *nonceLength)</argsstring>
        <name>AESCCM_generateNonce</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type>uint8_t *</type>
          <declname>nonce</declname>
        </param>
        <param>
          <type>size_t</type>
          <declname>nonceSize</declname>
        </param>
        <param>
          <type>size_t *</type>
          <declname>nonceLength</declname>
        </param>
        <briefdescription>
<para>Function to generate a nonce for an AES CCM segmented encryption operation. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1aa793f126c596136ce4af66b38c7bccd6" kindref="member">AESCCM_setupEncrypt()</ref> or <ref refid="_a_e_s_c_c_m_8h_1a2376b9edaffed9f9afff639ee421f9d6" kindref="member">AESCCM_setLengths()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">nonce</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to the buffer where the generated nonce is to be written to</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">nonceSize</parametername>
</parameternamelist>
<parameterdescription>
<para>The length of the nonce buffer in bytes</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="out">nonceLength</parametername>
</parameternamelist>
<parameterdescription>
<para>The length of the nonce actually written if the operation was successful</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" kindref="member">AESCCM_STATUS_FEATURE_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation is not supported in this device.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD()</ref> </para></simplesect>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1294" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_addAAD</definition>
        <argsstring>(AESCCM_Handle handle, AESCCM_SegmentedAADOperation *operation)</argsstring>
        <name>AESCCM_addAAD</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" kindref="compound">AESCCM_SegmentedAADOperation</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Adds a segment of <emphasis>aad</emphasis> with a <emphasis>length</emphasis> in bytes to the generated MAC. The length must be a multiple of a block size, 16 bytes, unless passing in the last chunk of AAD. </para>        </briefdescription>
        <detaileddescription>
<para><ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD()</ref> may be called an arbitrary number of times before continuing the operation with <ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref>, <ref refid="_a_e_s_c_c_m_8h_1a402aec97da286d158a81deb01e28fd73" kindref="member">AESCCM_finalizeEncrypt()</ref> or <ref refid="_a_e_s_c_c_m_8h_1a980b983808740d02da02123989453cc4" kindref="member">AESCCM_finalizeDecrypt()</ref>.</para><para>This function returns according to the return behavior set when opening the driver.</para><para><simplesect kind="note"><para>This function must not be called after passing data to encrypt or decrypt with <ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref>.</para></simplesect>
<simplesect kind="warning"><para>When decrypting, do not use the output until <ref refid="_a_e_s_c_c_m_8h_1a980b983808740d02da02123989453cc4" kindref="member">AESCCM_finalizeDecrypt()</ref> succeeds.</para></simplesect>
<simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1ad4c8bb8a6061a91e8a544f73cb4de780" kindref="member">AESCCM_setNonce()</ref> or <ref refid="_a_e_s_c_c_m_8h_1a10d1d4f7c669a03ade23a057c501b8f9" kindref="member">AESCCM_generateNonce()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to segmented AAD CCM operation structure</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1aabf9f8e552b6a5a12f512d6c862f04fa" kindref="member">AESCCM_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" kindref="member">AESCCM_STATUS_FEATURE_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation is not supported in this device. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1aedda3f3cdad624c827dffda8e2cad3a1" kindref="member">AESCCM_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD()</ref> </para></simplesect>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref> </para></simplesect>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a402aec97da286d158a81deb01e28fd73" kindref="member">AESCCM_finalizeEncrypt()</ref> </para></simplesect>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a980b983808740d02da02123989453cc4" kindref="member">AESCCM_finalizeDecrypt()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1330" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_addData</definition>
        <argsstring>(AESCCM_Handle handle, AESCCM_SegmentedDataOperation *operation)</argsstring>
        <name>AESCCM_addData</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___segmented_data_operation" kindref="compound">AESCCM_SegmentedDataOperation</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Adds a segment of <emphasis>data</emphasis> with a <emphasis>length</emphasis> in bytes to the plaintext/ciphertext output and generated MAC. The length must be a multiple of a block size, 16 bytes, unless passing in the last chunk of payload data. </para>        </briefdescription>
        <detaileddescription>
<para><ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref> may be called an arbitrary number of times before finishing the operation with <ref refid="_a_e_s_c_c_m_8h_1a402aec97da286d158a81deb01e28fd73" kindref="member">AESCCM_finalizeEncrypt()</ref> or <ref refid="_a_e_s_c_c_m_8h_1a980b983808740d02da02123989453cc4" kindref="member">AESCCM_finalizeDecrypt()</ref>.</para><para>This function returns according to the return behavior set when opening the driver.</para><para><simplesect kind="warning"><para>When decrypting, do not use the output until <ref refid="_a_e_s_c_c_m_8h_1a980b983808740d02da02123989453cc4" kindref="member">AESCCM_finalizeDecrypt()</ref> succeeds.</para></simplesect>
<simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1ad4c8bb8a6061a91e8a544f73cb4de780" kindref="member">AESCCM_setNonce()</ref> or <ref refid="_a_e_s_c_c_m_8h_1a10d1d4f7c669a03ade23a057c501b8f9" kindref="member">AESCCM_generateNonce()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to segmented data CCM operation structure</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1aabf9f8e552b6a5a12f512d6c862f04fa" kindref="member">AESCCM_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" kindref="member">AESCCM_STATUS_FEATURE_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation is not supported in this device. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1aedda3f3cdad624c827dffda8e2cad3a1" kindref="member">AESCCM_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1a2c1fecff89d36c4e712c8ffd5a8c2fe0" kindref="member">AESCCM_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The input and/or output buffer were not word-aligned.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref> </para></simplesect>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a402aec97da286d158a81deb01e28fd73" kindref="member">AESCCM_finalizeEncrypt()</ref> </para></simplesect>
<simplesect kind="post"><para><ref refid="_a_e_s_c_c_m_8h_1a980b983808740d02da02123989453cc4" kindref="member">AESCCM_finalizeDecrypt()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1363" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a402aec97da286d158a81deb01e28fd73" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_finalizeEncrypt</definition>
        <argsstring>(AESCCM_Handle handle, AESCCM_SegmentedFinalizeOperation *operation)</argsstring>
        <name>AESCCM_finalizeEncrypt</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Finalize the MAC and ciphertext. </para>        </briefdescription>
        <detaileddescription>
<para>This function finalizes the encryption of a dataset earlier provided by calls to <ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD()</ref> and <ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref> and creates a message authentication code. If additional data needs to be encrypted and verified as part of this call, set the operation structure <emphasis>inputLength</emphasis> accordingly.</para><para>The resulting output is a message authentication code and ciphertext.</para><para><simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD()</ref> or <ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to segmented finalize CCM operation structure</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>In <ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aa1761cf2c8bd972890a0193f772281a8c" kindref="member">AESCCM_RETURN_BEHAVIOR_BLOCKING</ref> and <ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aa8077fa385d151d93ed7762a998abd567" kindref="member">AESCCM_RETURN_BEHAVIOR_POLLING</ref>, this means the MAC was generated successfully. In <ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aab768e7c12bd6bf9e87bfba1c6bf3d2a4" kindref="member">AESCCM_RETURN_BEHAVIOR_CALLBACK</ref>, this means the operation started successfully. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1aedda3f3cdad624c827dffda8e2cad3a1" kindref="member">AESCCM_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" kindref="member">AESCCM_STATUS_FEATURE_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation is not supported in this device. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1a2c1fecff89d36c4e712c8ffd5a8c2fe0" kindref="member">AESCCM_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The input and/or output buffer were not word-aligned. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1390" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a980b983808740d02da02123989453cc4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_finalizeDecrypt</definition>
        <argsstring>(AESCCM_Handle handle, AESCCM_SegmentedFinalizeOperation *operation)</argsstring>
        <name>AESCCM_finalizeDecrypt</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref> *</type>
          <declname>operation</declname>
        </param>
        <briefdescription>
<para>Finalize the MAC and plaintext and verify it. </para>        </briefdescription>
        <detaileddescription>
<para>This function finalizes the decryption of a dataset earlier provided by calls to <ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD()</ref> and <ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref> and verifies a provided message authentication code. If additional data needs to be decrypted and verified as part of this call, set the operation structure <emphasis>inputLength</emphasis> accordingly.</para><para><simplesect kind="note"><para>None of the buffers provided as arguments may be altered by the application during an ongoing operation. Doing so can yield a corrupted MAC comparison.</para></simplesect>
The resulting output is a verification return code and plaintext.</para><para><simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD()</ref> or <ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData()</ref></para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operation</parametername>
</parameternamelist>
<parameterdescription>
<para>Pointer to segmented finalize CCM operation structure</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>In <ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aa1761cf2c8bd972890a0193f772281a8c" kindref="member">AESCCM_RETURN_BEHAVIOR_BLOCKING</ref> and <ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aa8077fa385d151d93ed7762a998abd567" kindref="member">AESCCM_RETURN_BEHAVIOR_POLLING</ref>, this means the MAC was verified successfully. In <ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aab768e7c12bd6bf9e87bfba1c6bf3d2a4" kindref="member">AESCCM_RETURN_BEHAVIOR_CALLBACK</ref>, this means the operation started successfully. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1adf7ebf9930072745c454b0bf932d694b" kindref="member">AESCCM_STATUS_MAC_INVALID</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The provided MAC did not match the recomputed one. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1aedda3f3cdad624c827dffda8e2cad3a1" kindref="member">AESCCM_STATUS_CANCELED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" kindref="member">AESCCM_STATUS_FEATURE_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation is not supported in this device. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1a2c1fecff89d36c4e712c8ffd5a8c2fe0" kindref="member">AESCCM_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The input and/or output buffer were not word-aligned. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1421" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a737c52bee6913123f4f1fa54c5c3c2a0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCCM_Operation_init</definition>
        <argsstring>(AESCCM_Operation *operationStruct)</argsstring>
        <name>AESCCM_Operation_init</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1a1546f451996da52b51b153524f4ad6e0" kindref="member">AESCCM_Operation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="_a_e_s_c_c_m_8h_1a1546f451996da52b51b153524f4ad6e0" kindref="member">AESCCM_Operation</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><xrefsect id="deprecated_1_deprecated000005"><xreftitle>Deprecated</xreftitle><xrefdescription><para>This function should be replaced by calls to operation-specific init functions.</para></xrefdescription></xrefsect></para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to an <ref refid="_a_e_s_c_c_m_8h_1a1546f451996da52b51b153524f4ad6e0" kindref="member">AESCCM_Operation</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1434" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a1787f57315eb14b2ce26a937283ee162" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCCM_OneStepOperation_init</definition>
        <argsstring>(AESCCM_OneStepOperation *operationStruct)</argsstring>
        <name>AESCCM_OneStepOperation_init</name>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to an <ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1444" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a268f64e5abea1f206c7fb8b1e07577d7" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCCM_SegmentedAADOperation_init</definition>
        <argsstring>(AESCCM_SegmentedAADOperation *operationStruct)</argsstring>
        <name>AESCCM_SegmentedAADOperation_init</name>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" kindref="compound">AESCCM_SegmentedAADOperation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" kindref="compound">AESCCM_SegmentedAADOperation</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to an <ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" kindref="compound">AESCCM_SegmentedAADOperation</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1454" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a8706786780b43627e0e19cae051fc8fb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCCM_SegmentedDataOperation_init</definition>
        <argsstring>(AESCCM_SegmentedDataOperation *operationStruct)</argsstring>
        <name>AESCCM_SegmentedDataOperation_init</name>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___segmented_data_operation" kindref="compound">AESCCM_SegmentedDataOperation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_a_e_s_c_c_m___segmented_data_operation" kindref="compound">AESCCM_SegmentedDataOperation</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to an <ref refid="struct_a_e_s_c_c_m___segmented_data_operation" kindref="compound">AESCCM_SegmentedDataOperation</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1464" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a5a1cf361100f2ef1d230a5e7273ff24f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void AESCCM_SegmentedFinalizeOperation_init</definition>
        <argsstring>(AESCCM_SegmentedFinalizeOperation *operationStruct)</argsstring>
        <name>AESCCM_SegmentedFinalizeOperation_init</name>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to initialize an <ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref> struct to its defaults. </para>        </briefdescription>
        <detaileddescription>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to an <ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref> structure for initialization</para></parameterdescription>
</parameteritem>
</parameterlist>
Defaults values are all zeros. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1474" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a74573b19e19c89139951ae345f0ba1fa" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_oneStepEncrypt</definition>
        <argsstring>(AESCCM_Handle handle, AESCCM_OneStepOperation *operationStruct)</argsstring>
        <name>AESCCM_oneStepEncrypt</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to perform an AESCCM encryption + authentication operation in one call. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="note"><para>None of the buffers provided as arguments may be altered by the application during an ongoing operation. Doing so can yield corrupted ciphertext or incorrect authentication.</para></simplesect>
<simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref> and <ref refid="_a_e_s_c_c_m_8h_1a737c52bee6913123f4f1fa54c5c3c2a0" kindref="member">AESCCM_Operation_init()</ref> have to be called first.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the parameters required to perform the operation.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1aabf9f8e552b6a5a12f512d6c862f04fa" kindref="member">AESCCM_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1a2c1fecff89d36c4e712c8ffd5a8c2fe0" kindref="member">AESCCM_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The input and/or output buffer were not word-aligned.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="_a_e_s_c_c_m_8h_1a5024c43a06ca27339788c6ad6ddd4b87" kindref="member">AESCCM_oneStepDecrypt()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1496" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1a5024c43a06ca27339788c6ad6ddd4b87" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_oneStepDecrypt</definition>
        <argsstring>(AESCCM_Handle handle, AESCCM_OneStepOperation *operationStruct)</argsstring>
        <name>AESCCM_oneStepDecrypt</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <param>
          <type><ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref> *</type>
          <declname>operationStruct</declname>
        </param>
        <briefdescription>
<para>Function to perform an AESCCM decryption + verification operation in one call. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="note"><para>None of the buffers provided as arguments may be altered by the application during an ongoing operation. Doing so can yield corrupted plaintext or incorrectly failed verification.</para></simplesect>
<simplesect kind="pre"><para><ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref> and <ref refid="_a_e_s_c_c_m_8h_1a737c52bee6913123f4f1fa54c5c3c2a0" kindref="member">AESCCM_Operation_init()</ref> have to be called first.</para></simplesect>
<parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>A CCM handle returned from <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> or <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref></para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername direction="in">operationStruct</parametername>
</parameternamelist>
<parameterdescription>
<para>A pointer to a struct containing the parameters required to perform the operation.</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation succeeded. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation failed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1aabf9f8e552b6a5a12f512d6c862f04fa" kindref="member">AESCCM_STATUS_RESOURCE_UNAVAILABLE</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The required hardware resource was not available. Try again later. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1adf7ebf9930072745c454b0bf932d694b" kindref="member">AESCCM_STATUS_MAC_INVALID</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The provided MAC did not match the recomputed one. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1a2c1fecff89d36c4e712c8ffd5a8c2fe0" kindref="member">AESCCM_STATUS_UNALIGNED_IO_NOT_SUPPORTED</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The input and/or output buffer were not word-aligned.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="see"><para><ref refid="_a_e_s_c_c_m_8h_1a74573b19e19c89139951ae345f0ba1fa" kindref="member">AESCCM_oneStepEncrypt()</ref> </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1519" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1afc9d5aa7105de5d54f1e380efa0eaef0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int_fast16_t</type>
        <definition>int_fast16_t AESCCM_cancelOperation</definition>
        <argsstring>(AESCCM_Handle handle)</argsstring>
        <name>AESCCM_cancelOperation</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
          <declname>handle</declname>
        </param>
        <briefdescription>
<para>Cancels an ongoing AESCCM operation. </para>        </briefdescription>
        <detaileddescription>
<para>Asynchronously cancels an AESCCM operation. Only available when using AESCCM_RETURN_BEHAVIOR_CALLBACK. The operation will terminate as though an error occurred. The return status code of the operation will be AESCCM_STATUS_CANCELED.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername direction="in">handle</parametername>
</parameternamelist>
<parameterdescription>
<para>Handle of the operation to cancel</para></parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="retval"><parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" kindref="member">AESCCM_STATUS_SUCCESS</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The operation was canceled, or the operation had already completed. </para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername><ref refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" kindref="member">AESCCM_STATUS_ERROR</ref></parametername>
</parameternamelist>
<parameterdescription>
<para>The driver was not in callback mode, or the operation&apos;s output and generated MAC weren&apos;t properly cleared. </para></parameterdescription>
</parameteritem>
</parameterlist>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1535" column="1"/>
      </memberdef>
      <memberdef kind="function" id="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref></type>
        <definition>AESCCM_Handle AESCCM_construct</definition>
        <argsstring>(AESCCM_Config *config, const AESCCM_Params *params)</argsstring>
        <name>AESCCM_construct</name>
        <param>
          <type><ref refid="_a_e_s_c_c_m_8h_1a91d80cb57f9660003f6cc75a155215a7" kindref="member">AESCCM_Config</ref> *</type>
          <declname>config</declname>
        </param>
        <param>
          <type>const <ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref> *</type>
          <declname>params</declname>
        </param>
        <briefdescription>
<para>Constructs a new AESCCM object. </para>        </briefdescription>
        <detaileddescription>
<para>Unlike <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref>, <ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct()</ref> does not require the hwAttrs and object to be allocated in a <ref refid="_a_e_s_c_c_m_8h_1a91d80cb57f9660003f6cc75a155215a7" kindref="member">AESCCM_Config</ref> array that is indexed into. Instead, the <ref refid="_a_e_s_c_c_m_8h_1a91d80cb57f9660003f6cc75a155215a7" kindref="member">AESCCM_Config</ref>, hwAttrs, and object can be allocated at any location. This allows for relatively simple run-time allocation of temporary driver instances on the stack or the heap. The drawback is that this makes it more difficult to write device-agnostic code. If you use an ifdef with DeviceFamily, you can choose the correct object and hwAttrs to allocate. That compilation unit will be tied to the device it was compiled for at this point. To change devices, recompilation of the application with a different DeviceFamily setting is necessary.</para><para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>config</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="_a_e_s_c_c_m_8h_1a91d80cb57f9660003f6cc75a155215a7" kindref="member">AESCCM_Config</ref> describing the location of the object and hwAttrs.</para></parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>params</parametername>
</parameternamelist>
<parameterdescription>
<para><ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref> to configure the driver instance.</para></parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Returns a <ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref> on success or NULL on failure.</para></simplesect>
<simplesect kind="pre"><para>The object struct <computeroutput>config</computeroutput> points to must be zeroed out prior to calling this function. Otherwise, unexpected behavior may ensue. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="source/ti/drivers/AESCCM.h" line="1560" column="1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>AESCCM driver header. </para>    </briefdescription>
    <detaileddescription>
<para><hruler/>
</para><para><anchor id="_a_e_s_c_c_m_8h_1ti_drivers_AESCCM_Overview"/><heading level="1">Overview</heading>
</para><para>The Counter with CBC-MAC (CCM) mode of operation is a generic authenticated encryption block cipher mode. It can be used with any block cipher. AESCCM combines CBC-MAC with an AES block cipher in CTR mode of operation.</para><para>This combination of block cipher modes enables CCM to encrypt messages of any length and not only multiples of the block cipher block size.</para><para>CTR provides confidentiality. The defined application of CBC-MAC provides message integrity and authentication.</para><para>AESCCM has the following inputs and outputs:</para><para><table rows="10" cols="2"><caption>AES-CCM input and output parameters</caption>
<row>
<entry thead="yes"><para>Encryption</para></entry><entry thead="yes"><para>Decryption </para></entry></row>
<row>
<entry thead="yes"><para>Input </para></entry></row>
<row>
<entry thead="no"><para>Shared AES key</para></entry><entry thead="no"><para>Shared AES key </para></entry></row>
<row>
<entry thead="no"><para>Nonce</para></entry><entry thead="no"><para>Nonce </para></entry></row>
<row>
<entry thead="no"><para>Cleartext</para></entry><entry thead="no"><para>Ciphertext </para></entry></row>
<row>
<entry thead="no"><para></para></entry><entry thead="no"><para>MAC </para></entry></row>
<row>
<entry thead="no"><para>AAD (optional)</para></entry><entry thead="no"><para>AAD (optional) </para></entry></row>
<row>
<entry thead="yes"><para>Output </para></entry></row>
<row>
<entry thead="no"><para>Ciphertext</para></entry><entry thead="no"><para>Cleartext </para></entry></row>
<row>
<entry thead="no"><para>MAC</para></entry><entry thead="no"><para></para></entry></row>
</table>
</para><para>The AES key is a shared secret between the two parties and has a length of 128, 192, or 256 bits.</para><para>The nonce is generated by the party performing the authenticated encryption operation. Within the scope of any authenticated encryption key, the nonce value must be unique. That is, the set of nonce values used with any given key must not contain any duplicate values. Using the same nonce for two different messages encrypted with the same key destroys the security properties.</para><para>The length of the nonce determines the maximum number of messages that may be encrypted and authenticated before you must regenerate the key. Reasonable session key rotation schemes will regenerate the key before reaching this limit. There is a trade-off between the nonce-length and the maximum length of the plaintext to encrypt and authenticate per nonce. This is because CTR concatenates the nonce and an internal counter into one 16-byte IV. The counter is incremented after generating an AES-block-sized pseudo-random bitstream. This bitstream is XOR&apos;d with the plaintext. The counter would eventually roll over for a sufficiently long message. This is must not happen. Hence, the longer the nonce and the more messages you can send before needing to rotate the key, the shorter the lengths of individual messages sent may be. The minimum and maximum nonce length defined by the CCM standard provide for both a reasonable number of messages before key rotation and a reasonable maximum message length. Check NIST SP 800-38C for details.</para><para>The optional additional authentication data (AAD) is authenticated but not encrypted. Thus, the AAD is not included in the AES-CCM output. It can be used to authenticate packet headers.</para><para>After the encryption operation, the ciphertext contains the encrypted data. The message authentication code (MAC) is also provided.</para><para><heading level="1">CCM Variations</heading>
</para><para>The AESCCM driver supports both classic CCM as defined by NIST SP 800-38C and the CCM* variant used in IEEE 802.15.4. CCM* allows for unauthenticated encryption using CCM by permitting a MAC length of 0. It also imposes the requirement that the MAC length be embedded in the nonce used for each message if the MAC length varies within the protocol using CCM*.</para><para><anchor id="_a_e_s_c_c_m_8h_1ti_drivers_AESCCM_Usage"/><heading level="1">Usage</heading>
</para><para><heading level="2">Before starting a CCM operation</heading>
</para><para>Before starting a CCM operation, the application must do the following:<itemizedlist>
<listitem><para>Call <ref refid="_a_e_s_c_c_m_8h_1a51982c7e9ace406edb69a0345f4c9dfc" kindref="member">AESCCM_init()</ref> to initialize the driver</para></listitem><listitem><para>Call <ref refid="_a_e_s_c_c_m_8h_1ab48597e7c8931af81234c786efac7cee" kindref="member">AESCCM_Params_init()</ref> to initialize the <ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref> to default values.</para></listitem><listitem><para>Modify the <ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref> as desired</para></listitem><listitem><para>Call <ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open()</ref> to open an instance of the driver</para></listitem><listitem><para>Initialize a <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>. These opaque data structures are representations of keying material and its storage. Depending on how the keying material is stored (RAM or flash, key store), the <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> must be initialized differently. The AESCCM API can handle all types of <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>. However, not all device-specific implementations support all types of <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref>. Devices without a key store will not support CryptoKeys with keying material stored in a key store for example. All devices support plaintext CryptoKeys.</para></listitem><listitem><para>Initialize the appropriate AESCCM operation struct using the relevant operation init functions and set all fields. For example, one-step (one-shot or single call) operations should initialize AESCCM_Operation or <ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref> using <ref refid="_a_e_s_c_c_m_8h_1a737c52bee6913123f4f1fa54c5c3c2a0" kindref="member">AESCCM_Operation_init()</ref> or <ref refid="_a_e_s_c_c_m_8h_1a1787f57315eb14b2ce26a937283ee162" kindref="member">AESCCM_OneStepOperation_init()</ref>. For multi-step (segmented or multiple call) operations, <ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" kindref="compound">AESCCM_SegmentedAADOperation</ref> must be initialized and set when processing AAD. <ref refid="struct_a_e_s_c_c_m___segmented_data_operation" kindref="compound">AESCCM_SegmentedDataOperation</ref> must be initialized and set when dealing with payload data (plaintext or ciphertext). <ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref> must be initialized and set when finalizing the segmented operation.</para></listitem></itemizedlist>
</para><para><heading level="2">Starting a CCM operation</heading>
</para><para>The AESCCM_oneStepEncrypt and AESCCM_oneStepDecrypt functions do a CCM operation in a single call. They will always be the most highly optimized routines with the least overhead and the fastest runtime. However, they require all AAD and plaintext or ciphertext data to be available to the function at the start of the call. All devices support single call operations.</para><para>When performing a decryption operation with <ref refid="_a_e_s_c_c_m_8h_1a5024c43a06ca27339788c6ad6ddd4b87" kindref="member">AESCCM_oneStepDecrypt()</ref>, the MAC is automatically verified.</para><para><heading level="2">After the CCM operation completes</heading>
</para><para>After the CCM operation completes, the application should either start another operation or close the driver by calling <ref refid="_a_e_s_c_c_m_8h_1a2cb2636c081846cfc81b801999a21ec5" kindref="member">AESCCM_close()</ref></para><para><anchor id="_a_e_s_c_c_m_8h_1ti_drivers_AESCCM_Synopsis"/><heading level="2">Synopsis</heading>
</para><para><anchor id="_a_e_s_c_c_m_8h_1ti_drivers_AESCCM_Synopsis_Code"/><programlisting><codeline><highlight class="normal">//<sp/>Import<sp/>AESCCM<sp/>Driver<sp/>definitions</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Define<sp/>name<sp/>for<sp/>AESCCM<sp/>channel<sp/>index</highlight></codeline>
<codeline><highlight class="normal">#define<sp/>AESCCM_INSTANCE<sp/>0</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCCM_init();</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">handle<sp/>=<sp/>AESCCM_open(AESCCM_INSTANCE,<sp/>NULL);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Initialize<sp/>symmetric<sp/>key</highlight></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>Set<sp/>up<sp/>AESCCM_OneStepOperation</highlight></codeline>
<codeline><highlight class="normal">AESCCM_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline><highlight class="normal">operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline><highlight class="normal">operation.aad<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>aad;</highlight></codeline>
<codeline><highlight class="normal">operation.aadLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline><highlight class="normal">operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal">operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal">operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext);</highlight></codeline>
<codeline><highlight class="normal">operation.nonce<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>nonce;</highlight></codeline>
<codeline><highlight class="normal">operation.nonceLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(nonce);</highlight></codeline>
<codeline><highlight class="normal">operation.mac<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>mac;</highlight></codeline>
<codeline><highlight class="normal">operation.macLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(mac);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCCM_oneStepEncrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCCM_close(handle);</highlight></codeline>
</programlisting></para><para><anchor id="_a_e_s_c_c_m_8h_1ti_drivers_AESCCM_Examples"/><heading level="2">Examples</heading>
</para><para>### Single call CCM encryption + authentication with plaintext <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> in blocking return mode # <programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCCM_Handle<sp/>handle;</highlight></codeline>
<codeline><highlight class="normal">CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline><highlight class="normal">int_fast16_t<sp/>encryptionResult;</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>nonce[]<sp/>=<sp/>&quot;Thisisanonce&quot;;</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>aad[]<sp/>=<sp/>&quot;This<sp/>string<sp/>will<sp/>be<sp/>authenticated<sp/>but<sp/>not<sp/>encrypted.&quot;;</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>plaintext[]<sp/>=<sp/>&quot;This<sp/>string<sp/>will<sp/>be<sp/>encrypted<sp/>and<sp/>authenticated.&quot;;</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>mac[16];</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ciphertext[sizeof(plaintext)];</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>keyingMaterial[32]<sp/>=<sp/>{0x00,<sp/>0x01,<sp/>0x02,<sp/>0x03,<sp/>0x04,<sp/>0x05,<sp/>0x06,<sp/>0x07,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x08,<sp/>0x09,<sp/>0x0A,<sp/>0x0B,<sp/>0x0C,<sp/>0x0D,<sp/>0x0E,<sp/>0x0F,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x10,<sp/>0x11,<sp/>0x12,<sp/>0x13,<sp/>0x14,<sp/>0x15,<sp/>0x16,<sp/>0x17,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x18,<sp/>0x19,<sp/>0x1A,<sp/>0x1B,<sp/>0x1C,<sp/>0x1D,<sp/>0x1E,<sp/>0x1F};</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">handle<sp/>=<sp/>AESCCM_open(0,<sp/>NULL);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_OneStepOperation<sp/>operation;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.aad<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>aad;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.aadLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.nonce<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>nonce;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.nonceLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(nonce);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.mac<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>mac;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.macLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(mac);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCCM_oneStepEncrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCCM_close(handle);</highlight></codeline>
</programlisting></para><para>### Single call CCM decryption + verification with plaintext <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> in callback return mode # <programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>following<sp/>test<sp/>vector<sp/>is<sp/>Packet<sp/>Vector<sp/>1<sp/>from<sp/>RFC<sp/>3610<sp/>of<sp/>the<sp/>IETF.</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">uint8_t<sp/>nonce[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x00,<sp/>0x00,<sp/>0x03,<sp/>0x02,<sp/>0x01,<sp/>0x00,<sp/>0xA0,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA1,<sp/>0xA2,<sp/>0xA3,<sp/>0xA4,<sp/>0xA5};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>aad[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x01,<sp/>0x02,<sp/>0x03,<sp/>0x04,<sp/>0x05,<sp/>0x06,<sp/>0x07};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>mac[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x17,<sp/>0xE8,<sp/>0xD1,<sp/>0x2C,<sp/>0xFD,<sp/>0xF9,<sp/>0x26,<sp/>0xE0};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ciphertext[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x58,<sp/>0x8C,<sp/>0x97,<sp/>0x9A,<sp/>0x61,<sp/>0xC6,<sp/>0x63,<sp/>0xD2,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,<sp/>0x66,<sp/>0xD0,<sp/>0xC2,<sp/>0xC0,<sp/>0xF9,<sp/>0x89,<sp/>0x80,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x6D,<sp/>0x5F,<sp/>0x6B,<sp/>0x61,<sp/>0xDA,<sp/>0xC3,<sp/>0x84};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>keyingMaterial[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0xC0,<sp/>0xC1,<sp/>0xC2,<sp/>0xC3,<sp/>0xC4,<sp/>0xC5,<sp/>0xC6,<sp/>0xC7,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC8,<sp/>0xC9,<sp/>0xCA,<sp/>0xCB,<sp/>0xCC,<sp/>0xCD,<sp/>0xCE,<sp/>0xCF};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>plaintext[sizeof(ciphertext)];</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>plaintext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>decryption<sp/>operation:</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>{0x08,<sp/>0x09,<sp/>0x0A,<sp/>0x0B,<sp/>0x0C,<sp/>0x0D,<sp/>0x0E,<sp/>0x0F,</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x10,<sp/>0x11,<sp/>0x12,<sp/>0x13,<sp/>0x14,<sp/>0x15,<sp/>0x16,<sp/>0x17,</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x18,<sp/>0x19,<sp/>0x1A,<sp/>0x1B,<sp/>0x1C,<sp/>0x1D,<sp/>0x1E}</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal">void<sp/>ccmCallback(AESCCM_Handle<sp/>handle,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationUnion<sp/>*operation,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationType<sp/>operationType)<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(returnValue<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCCM_OneStepOperation<sp/>operation;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">void<sp/>ccmStartFunction(void)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_Handle<sp/>handle;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_Params<sp/>params;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>int_fast16_t<sp/>decryptionResult;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_Params_init(&amp;params);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>params.returnBehavior<sp/>=<sp/>AESCCM_RETURN_BEHAVIOR_CALLBACK;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>params.callbackFxn<sp/>=<sp/>ccmCallback;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>handle<sp/>=<sp/>AESCCM_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.aad<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>aad;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.aadLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(ciphertext);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.nonce<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>nonce;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.nonceLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(nonce);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.mac<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>mac;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>operation.macLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(mac);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_oneStepDecrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>do<sp/>other<sp/>things<sp/>while<sp/>CCM<sp/>operation<sp/>completes<sp/>in<sp/>the<sp/>background</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para><para>### Multi-step CCM encryption + authentication with plaintext <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> in blocking return mode # <programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">#define<sp/>AES_BLOCK_SIZE<sp/><sp/><sp/><sp/><sp/>16<sp/>//<sp/>bytes</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCCM_Handle<sp/>handle;</highlight></codeline>
<codeline><highlight class="normal">CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline><highlight class="normal">int_fast16_t<sp/>encryptionResult;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>following<sp/>test<sp/>vector<sp/>is<sp/>Packet<sp/>Vector<sp/>1<sp/>from<sp/>RFC<sp/>3610<sp/>of<sp/>the<sp/>IETF.</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">uint8_t<sp/>keyingMaterial[16]<sp/>=<sp/>{0xC0,<sp/>0xC1,<sp/>0xC2,<sp/>0xC3,<sp/>0xC4,<sp/>0xC5,<sp/>0xC6,<sp/>0xC7,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC8,<sp/>0xC9,<sp/>0xCA,<sp/>0xCB,<sp/>0xCC,<sp/>0xCD,<sp/>0xCE,<sp/>0xCF};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>aad[8]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x01,<sp/>0x02,<sp/>0x03,<sp/>0x04,<sp/>0x05,<sp/>0x06,<sp/>0x07};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>plaintext[23]<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x08,<sp/>0x09,<sp/>0x0A,<sp/>0x0B,<sp/>0x0C,<sp/>0x0D,<sp/>0x0E,<sp/>0x0F,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x10,<sp/>0x11,<sp/>0x12,<sp/>0x13,<sp/>0x14,<sp/>0x15,<sp/>0x16,<sp/>0x17,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x18,<sp/>0x19,<sp/>0x1A,<sp/>0x1B,<sp/>0x1C,<sp/>0x1D,<sp/>0x1E};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>nonce[13]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x00,<sp/>0x00,<sp/>0x03,<sp/>0x02,<sp/>0x01,<sp/>0x00,<sp/>0xA0,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA1,<sp/>0xA2,<sp/>0xA3,<sp/>0xA4,<sp/>0xA5};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>mac[8];</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ciphertext[sizeof(plaintext)];</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>ciphertext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>encryption<sp/>operation:</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>{0x58,<sp/>0x8C,<sp/>0x97,<sp/>0x9A,<sp/>0x61,<sp/>0xC6,<sp/>0x63,<sp/>0xD2,</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0xF0,<sp/>0x66,<sp/>0xD0,<sp/>0xC2,<sp/>0xC0,<sp/>0xF9,<sp/>0x89,<sp/>0x80,</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x6D,<sp/>0x5F,<sp/>0x6B,<sp/>0x61,<sp/>0xDA,<sp/>0xC3,<sp/>0x84}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">handle<sp/>=<sp/>AESCCM_open(0,<sp/>NULL);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCCM_setupEncrypt(handle,<sp/>&amp;cryptoKey,<sp/>sizeof(aad),<sp/>sizeof(plaintext),<sp/>sizeof(mac));</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCCM_setNonce(handle,<sp/>nonce,<sp/>sizeof(nonce));</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCCM_SegmentedAADOperation<sp/>segmentedAADOperation;</highlight></codeline>
<codeline><highlight class="normal">AESCCM_SegmentedAADOperation_init(&amp;segmentedAADOperation);</highlight></codeline>
<codeline><highlight class="normal">segmentedAADOperation.aad<sp/>=<sp/>aad;</highlight></codeline>
<codeline><highlight class="normal">segmentedAADOperation.aadLength<sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCCM_addAAD(handle,<sp/>&amp;segmentedAADOperation);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCCM_SegmentedDataOperation<sp/>segmentedDataOperation;</highlight></codeline>
<codeline><highlight class="normal">AESCCM_SegmentedDataOperation_init(&amp;segmentedDataOperation);</highlight></codeline>
<codeline><highlight class="normal">segmentedDataOperation.input<sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal">segmentedDataOperation.output<sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal">//<sp/>One<sp/>should<sp/>pass<sp/>in<sp/>data<sp/>that<sp/>is<sp/>a<sp/>block-sized<sp/>multiple<sp/>length</highlight></codeline>
<codeline><highlight class="normal">//<sp/>until<sp/>passing<sp/>in<sp/>the<sp/>last<sp/>segment<sp/>of<sp/>data.</highlight></codeline>
<codeline><highlight class="normal">//<sp/>In<sp/>that<sp/>case,<sp/>the<sp/>input<sp/>length<sp/>simply<sp/>needs<sp/>to<sp/>be<sp/>a<sp/>non-zero<sp/>value.</highlight></codeline>
<codeline><highlight class="normal">segmentedDataOperation.inputLength<sp/>=<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCCM_addData(handle,<sp/>&amp;segmentedDataOperation);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">segmentedDataOperation.input<sp/>=<sp/>plaintext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline><highlight class="normal">segmentedDataOperation.output<sp/>=<sp/>ciphertext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline><highlight class="normal">segmentedDataOperation.inputLength<sp/>=<sp/>sizeof(plaintext)<sp/>-<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCCM_addData(handle,<sp/>&amp;segmentedDataOperation);</highlight></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCCM_SegmentedFinalizeOperation<sp/>segmentedFinalizeOperation;</highlight></codeline>
<codeline><highlight class="normal">AESCCM_SegmentedFinalizeOperation_init(&amp;egmentedFinalizeOperation);</highlight></codeline>
<codeline><highlight class="normal">segmentedFinalizeOperation.input<sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal">segmentedFinalizeOperation.output<sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>You<sp/>can<sp/>finalize<sp/>with<sp/>no<sp/>new<sp/>data</highlight></codeline>
<codeline><highlight class="normal">segmentedFinalizeOperation.inputLength<sp/>=<sp/>0;</highlight></codeline>
<codeline><highlight class="normal">segmentedFinalizeOperation.mac<sp/>=<sp/>mac;</highlight></codeline>
<codeline><highlight class="normal">segmentedFinalizeOperation.macLength<sp/>=<sp/>sizeof(mac);</highlight></codeline>
<codeline><highlight class="normal">encryptionResult<sp/>=<sp/>AESCCM_finalizeEncrypt(handle,<sp/>&amp;segmentedFinalizeOperation);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">AESCCM_close(handle);</highlight></codeline>
</programlisting></para><para>### Multi-step CCM decryption + verification with plaintext <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> in callback return mode # <programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>following<sp/>test<sp/>vector<sp/>is<sp/>Packet<sp/>Vector<sp/>1<sp/>from<sp/>RFC<sp/>3610<sp/>of<sp/>the<sp/>IETF.</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">uint8_t<sp/>nonce[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x00,<sp/>0x00,<sp/>0x03,<sp/>0x02,<sp/>0x01,<sp/>0x00,<sp/>0xA0,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA1,<sp/>0xA2,<sp/>0xA3,<sp/>0xA4,<sp/>0xA5};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>aad[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x01,<sp/>0x02,<sp/>0x03,<sp/>0x04,<sp/>0x05,<sp/>0x06,<sp/>0x07};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>mac[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x17,<sp/>0xE8,<sp/>0xD1,<sp/>0x2C,<sp/>0xFD,<sp/>0xF9,<sp/>0x26,<sp/>0xE0};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ciphertext[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x58,<sp/>0x8C,<sp/>0x97,<sp/>0x9A,<sp/>0x61,<sp/>0xC6,<sp/>0x63,<sp/>0xD2,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,<sp/>0x66,<sp/>0xD0,<sp/>0xC2,<sp/>0xC0,<sp/>0xF9,<sp/>0x89,<sp/>0x80,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x6D,<sp/>0x5F,<sp/>0x6B,<sp/>0x61,<sp/>0xDA,<sp/>0xC3,<sp/>0x84};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>keyingMaterial[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0xC0,<sp/>0xC1,<sp/>0xC2,<sp/>0xC3,<sp/>0xC4,<sp/>0xC5,<sp/>0xC6,<sp/>0xC7,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC8,<sp/>0xC9,<sp/>0xCA,<sp/>0xCB,<sp/>0xCC,<sp/>0xCD,<sp/>0xCE,<sp/>0xCF};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>plaintext[sizeof(ciphertext)];</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>plaintext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>decryption<sp/>operation:</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>{0x08,<sp/>0x09,<sp/>0x0A,<sp/>0x0B,<sp/>0x0C,<sp/>0x0D,<sp/>0x0E,<sp/>0x0F,</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x10,<sp/>0x11,<sp/>0x12,<sp/>0x13,<sp/>0x14,<sp/>0x15,<sp/>0x16,<sp/>0x17,</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x18,<sp/>0x19,<sp/>0x1A,<sp/>0x1B,<sp/>0x1C,<sp/>0x1D,<sp/>0x1E}</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal">void<sp/>ccmCallback(AESCCM_Handle<sp/>handle,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationUnion<sp/>*operation,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationType<sp/>operationType)<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(returnValue<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if(operationType<sp/>==<sp/>AESCCM_OPERATION_TYPE_DECRYPT<sp/>||</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OPERATION_TYPE_ENCRYPT)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>one-shot<sp/>operations</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;oneStepOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>if(operationType<sp/>==<sp/>AESCCM_OP_TYPE_AAD_DECRYPT<sp/>||</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OP_TYPE_AAD_ENCRYPT)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>AAD<sp/>operations</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedAADOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>if(operationType<sp/>==<sp/>AESCCM_OP_TYPE_DATA_DECRYPT<sp/>||</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OP_TYPE_DATA_ENCRYPT)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>data<sp/>operations</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedDataOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>finalize<sp/>operations</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedFinalizeOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">void<sp/>ccmStartFunction(void)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_Handle<sp/>handle;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_Params<sp/>params;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>int_fast16_t<sp/>decryptionResult;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_Params_init(&amp;params);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>params.returnBehavior<sp/>=<sp/>AESCCM_RETURN_BEHAVIOR_CALLBACK;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>params.callbackFxn<sp/>=<sp/>ccmCallback;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>handle<sp/>=<sp/>AESCCM_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setupDecrypt(handle,<sp/>&amp;cryptoKey,<sp/>0,<sp/>0,<sp/>0);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>setLengths<sp/>must<sp/>be<sp/>called<sp/>if<sp/>the<sp/>AAD,<sp/>input,<sp/>and<sp/>MAC<sp/>lengths<sp/>aren&apos;t<sp/>provided<sp/>in<sp/>setupXXXX.</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setLengths(handle,<sp/>sizeof(aad),<sp/>sizeof(ciphertext),<sp/>sizeof(mac));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setNonce(handle,<sp/>nonce,<sp/>sizeof(nonce));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedAADOperation<sp/>segmentedAADOperation;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedAADOperation_init(&amp;segmentedAADOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedAADOperation.aad<sp/>=<sp/>aad;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedAADOperation.aadLength<sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_addAAD(handle,<sp/>&amp;segmentedAADOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedDataOperation<sp/>segmentedDataOperation;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedDataOperation_init(&amp;segmentedDataOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedDataOperation.input<sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedDataOperation.output<sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedDataOperation.inputLength<sp/>=<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_addData(handle,<sp/>&amp;segmentedDataOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedFinalizeOperation<sp/>segmentedFinalizeOperation;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedFinalizeOperation_init(&amp;egmentedFinalizeOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.input<sp/>=<sp/>ciphertext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.output<sp/>=<sp/>plaintext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.inputLength<sp/>=<sp/>sizeof(ciphertext)<sp/>-<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.mac<sp/>=<sp/>mac;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.macLength<sp/>=<sp/>sizeof(mac);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_finalizeDecrypt(handle,<sp/>&amp;segmentedFinalizeOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>do<sp/>other<sp/>things<sp/>while<sp/>CCM<sp/>operation<sp/>completes<sp/>in<sp/>the<sp/>background</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para><para><heading level="3">Multi-step CCM* decryption + verification with plaintext <ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref> in callback return mode</heading>
</para><para><programlisting><codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline><highlight class="normal">#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">...</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>following<sp/>test<sp/>vector<sp/>is<sp/>Packet<sp/>Vector<sp/>1<sp/>from<sp/>RFC<sp/>3610<sp/>of<sp/>the<sp/>IETF.</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">uint8_t<sp/>nonce[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x00,<sp/>0x00,<sp/>0x03,<sp/>0x02,<sp/>0x01,<sp/>0x00,<sp/>0xA0,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA1,<sp/>0xA2,<sp/>0xA3,<sp/>0xA4,<sp/>0xA5};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>aad[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x01,<sp/>0x02,<sp/>0x03,<sp/>0x04,<sp/>0x05,<sp/>0x06,<sp/>0x07};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>mac[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0};</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>CCM*<sp/>allows<sp/>for<sp/>unauthenticated<sp/>encryption<sp/>using<sp/>CCM<sp/>by<sp/>allowing<sp/>a<sp/>MAC<sp/>length<sp/>of<sp/>0</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>macLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ciphertext[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x58,<sp/>0x8C,<sp/>0x97,<sp/>0x9A,<sp/>0x61,<sp/>0xC6,<sp/>0x63,<sp/>0xD2,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,<sp/>0x66,<sp/>0xD0,<sp/>0xC2,<sp/>0xC0,<sp/>0xF9,<sp/>0x89,<sp/>0x80,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x6D,<sp/>0x5F,<sp/>0x6B,<sp/>0x61,<sp/>0xDA,<sp/>0xC3,<sp/>0x84};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>keyingMaterial[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0xC0,<sp/>0xC1,<sp/>0xC2,<sp/>0xC3,<sp/>0xC4,<sp/>0xC5,<sp/>0xC6,<sp/>0xC7,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC8,<sp/>0xC9,<sp/>0xCA,<sp/>0xCB,<sp/>0xCC,<sp/>0xCD,<sp/>0xCE,<sp/>0xCF};</highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>plaintext[sizeof(ciphertext)];</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">//<sp/>The<sp/>plaintext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>decryption<sp/>operation:</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>{0x08,<sp/>0x09,<sp/>0x0A,<sp/>0x0B,<sp/>0x0C,<sp/>0x0D,<sp/>0x0E,<sp/>0x0F,</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x10,<sp/>0x11,<sp/>0x12,<sp/>0x13,<sp/>0x14,<sp/>0x15,<sp/>0x16,<sp/>0x17,</highlight></codeline>
<codeline><highlight class="normal">//<sp/><sp/>0x18,<sp/>0x19,<sp/>0x1A,<sp/>0x1B,<sp/>0x1C,<sp/>0x1D,<sp/>0x1E}</highlight></codeline>
<codeline></codeline>
<codeline></codeline>
<codeline><highlight class="normal">void<sp/>ccmCallback(AESCCM_Handle<sp/>handle,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationUnion<sp/>*operation,</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationType<sp/>operationType)<sp/>{</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(returnValue<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if(operationType<sp/>==<sp/>AESCCM_OPERATION_TYPE_DECRYPT<sp/>||</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OPERATION_TYPE_ENCRYPT)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>one-shot<sp/>operations</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;oneStepOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>if(operationType<sp/>==<sp/>AESCCM_OP_TYPE_AAD_DECRYPT<sp/>||</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OP_TYPE_AAD_ENCRYPT)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>AAD<sp/>operations</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedAADOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else<sp/>if(operationType<sp/>==<sp/>AESCCM_OP_TYPE_DATA_DECRYPT<sp/>||</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OP_TYPE_DATA_ENCRYPT)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>data<sp/>operations</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedDataOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>else</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>finalize<sp/>operations</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedFinalizeOperation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">void<sp/>ccmStartFunction(void)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_Handle<sp/>handle;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_Params<sp/>params;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>int_fast16_t<sp/>decryptionResult;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_Params_init(&amp;params);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>params.returnBehavior<sp/>=<sp/>AESCCM_RETURN_BEHAVIOR_CALLBACK;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>params.callbackFxn<sp/>=<sp/>ccmCallback;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>handle<sp/>=<sp/>AESCCM_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setupDecrypt(handle,<sp/>&amp;cryptoKey,<sp/>0,<sp/>0,<sp/>0);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>setLengths<sp/>must<sp/>be<sp/>called<sp/>if<sp/>the<sp/>AAD,<sp/>input,<sp/>and<sp/>MAC<sp/>lengths<sp/>aren&apos;t<sp/>provided<sp/>in<sp/>setupXXXX.</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setLengths(handle,<sp/>sizeof(aad),<sp/>sizeof(ciphertext),<sp/>macLength);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setNonce(handle,<sp/>nonce,<sp/>sizeof(nonce));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedAADOperation<sp/>segmentedAADOperation;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedAADOperation_init(&amp;segmentedAADOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedAADOperation.aad<sp/>=<sp/>aad;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedAADOperation.aadLength<sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_addAAD(handle,<sp/>&amp;segmentedAADOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedDataOperation<sp/>segmentedDataOperation;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedDataOperation_init(&amp;segmentedDataOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedDataOperation.input<sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedDataOperation.output<sp/>=<sp/>plaintext;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedDataOperation.inputLength<sp/>=<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_addData(handle,<sp/>&amp;segmentedDataOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedFinalizeOperation<sp/>segmentedFinalizeOperation;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_SegmentedFinalizeOperation_init(&amp;egmentedFinalizeOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.input<sp/>=<sp/>ciphertext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.output<sp/>=<sp/>plaintext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.inputLength<sp/>=<sp/>sizeof(ciphertext)<sp/>-<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.mac<sp/>=<sp/>mac;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.macLength<sp/>=<sp/>macLength;</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_finalizeDecrypt(handle,<sp/>&amp;segmentedFinalizeOperation);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>//<sp/>do<sp/>other<sp/>things<sp/>while<sp/>CCM<sp/>operation<sp/>completes<sp/>in<sp/>the<sp/>background</highlight></codeline>
<codeline></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting> </para>    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*</highlight></codeline>
<codeline lineno="2"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2017-2021,<sp/>Texas<sp/>Instruments<sp/>Incorporated</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>All<sp/>rights<sp/>reserved.</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in<sp/>the</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the<sp/>distribution.</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>*<sp/><sp/>Neither<sp/>the<sp/>name<sp/>of<sp/>Texas<sp/>Instruments<sp/>Incorporated<sp/>nor<sp/>the<sp/>names<sp/>of</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>its<sp/>contributors<sp/>may<sp/>be<sp/>used<sp/>to<sp/>endorse<sp/>or<sp/>promote<sp/>products<sp/>derived</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>from<sp/>this<sp/>software<sp/>without<sp/>specific<sp/>prior<sp/>written<sp/>permission.</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>THE<sp/>COPYRIGHT<sp/>HOLDERS<sp/>AND<sp/>CONTRIBUTORS<sp/>&quot;AS<sp/>IS&quot;</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*<sp/>AND<sp/>ANY<sp/>EXPRESS<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.<sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>COPYRIGHT<sp/>OWNER<sp/>OR</highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/>CONTRIBUTORS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,<sp/>SPECIAL,</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/>DATA,<sp/>OR<sp/>PROFITS;</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/>THEORY<sp/>OF<sp/>LIABILITY,</highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/>OF<sp/>THIS<sp/>SOFTWARE,</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="comment">/*!****************************************************************************</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*<sp/><sp/>@file<sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM.h</highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*<sp/><sp/>@brief<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM<sp/>driver<sp/>header</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/>*<sp/><sp/>@anchor<sp/>ti_drivers_AESCCM_Overview</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*<sp/><sp/>#<sp/>Overview<sp/>#</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>Counter<sp/>with<sp/>CBC-MAC<sp/>(CCM)<sp/>mode<sp/>of<sp/>operation<sp/>is<sp/>a<sp/>generic</highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/>*<sp/><sp/>authenticated<sp/>encryption<sp/>block<sp/>cipher<sp/>mode.<sp/><sp/>It<sp/>can<sp/>be<sp/>used<sp/>with</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/>*<sp/><sp/>any<sp/>block<sp/>cipher.</highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM<sp/>combines<sp/>CBC-MAC<sp/>with<sp/>an<sp/>AES<sp/>block<sp/>cipher<sp/>in<sp/>CTR<sp/>mode<sp/>of<sp/>operation.</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/>*<sp/><sp/>This<sp/>combination<sp/>of<sp/>block<sp/>cipher<sp/>modes<sp/>enables<sp/>CCM<sp/>to<sp/>encrypt<sp/>messages<sp/>of<sp/>any</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/>*<sp/><sp/>length<sp/>and<sp/>not<sp/>only<sp/>multiples<sp/>of<sp/>the<sp/>block<sp/>cipher<sp/>block<sp/>size.</highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/>*<sp/><sp/>CTR<sp/>provides<sp/>confidentiality.<sp/>The<sp/>defined<sp/>application<sp/>of<sp/>CBC-MAC<sp/>provides</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/>*<sp/><sp/>message<sp/>integrity<sp/>and<sp/>authentication.</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM<sp/>has<sp/>the<sp/>following<sp/>inputs<sp/>and<sp/>outputs:</highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="52"><highlight class="comment"><sp/>*<sp/>&lt;table&gt;</highlight></codeline>
<codeline lineno="53"><highlight class="comment"><sp/>*<sp/>&lt;caption<sp/>id=&quot;AESCCM_multi_row&quot;&gt;AES-CCM<sp/>input<sp/>and<sp/>output<sp/>parameters&lt;/caption&gt;</highlight></codeline>
<codeline lineno="54"><highlight class="comment"><sp/>*<sp/>&lt;tr&gt;&lt;th&gt;Encryption&lt;/th&gt;&lt;th&gt;Decryption&lt;/th&gt;&lt;/tr&gt;</highlight></codeline>
<codeline lineno="55"><highlight class="comment"><sp/>*<sp/>&lt;tr&gt;&lt;th<sp/>colspan=2&gt;Input&lt;/th&gt;&lt;/tr&gt;</highlight></codeline>
<codeline lineno="56"><highlight class="comment"><sp/>*<sp/>&lt;tr&gt;&lt;td&gt;Shared<sp/>AES<sp/>key&lt;/td&gt;&lt;td&gt;<sp/>Shared<sp/>AES<sp/>key&lt;/td&gt;&lt;/tr&gt;</highlight></codeline>
<codeline lineno="57"><highlight class="comment"><sp/>*<sp/>&lt;tr&gt;&lt;td&gt;Nonce&lt;/td&gt;&lt;td&gt;Nonce&lt;/td&gt;&lt;/tr&gt;</highlight></codeline>
<codeline lineno="58"><highlight class="comment"><sp/>*<sp/>&lt;tr&gt;&lt;td&gt;Cleartext&lt;/td&gt;&lt;td&gt;Ciphertext&lt;/td&gt;&lt;/tr&gt;</highlight></codeline>
<codeline lineno="59"><highlight class="comment"><sp/>*<sp/>&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;MAC&lt;/td&gt;&lt;/tr&gt;</highlight></codeline>
<codeline lineno="60"><highlight class="comment"><sp/>*<sp/>&lt;tr&gt;&lt;td&gt;AAD<sp/>(optional)&lt;/td&gt;&lt;td&gt;AAD<sp/>(optional)&lt;/td&gt;&lt;/tr&gt;</highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/>*<sp/>&lt;tr&gt;&lt;th<sp/>colspan=2&gt;Output&lt;/th&gt;&lt;/tr&gt;</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/>*<sp/>&lt;tr&gt;&lt;td&gt;Ciphertext&lt;/td&gt;&lt;td&gt;Cleartext&lt;/td&gt;&lt;/tr&gt;</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/>*<sp/>&lt;tr&gt;&lt;td&gt;MAC&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</highlight></codeline>
<codeline lineno="64"><highlight class="comment"><sp/>*<sp/>&lt;/table&gt;</highlight></codeline>
<codeline lineno="65"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>AES<sp/>key<sp/>is<sp/>a<sp/>shared<sp/>secret<sp/>between<sp/>the<sp/>two<sp/>parties<sp/>and<sp/>has<sp/>a<sp/>length</highlight></codeline>
<codeline lineno="67"><highlight class="comment"><sp/>*<sp/><sp/>of<sp/>128,<sp/>192,<sp/>or<sp/>256<sp/>bits.</highlight></codeline>
<codeline lineno="68"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="69"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>nonce<sp/>is<sp/>generated<sp/>by<sp/>the<sp/>party<sp/>performing<sp/>the<sp/>authenticated</highlight></codeline>
<codeline lineno="70"><highlight class="comment"><sp/>*<sp/><sp/>encryption<sp/>operation.<sp/><sp/>Within<sp/>the<sp/>scope<sp/>of<sp/>any<sp/>authenticated</highlight></codeline>
<codeline lineno="71"><highlight class="comment"><sp/>*<sp/><sp/>encryption<sp/>key,<sp/>the<sp/>nonce<sp/>value<sp/>must<sp/>be<sp/>unique.<sp/><sp/>That<sp/>is,<sp/>the<sp/>set<sp/>of</highlight></codeline>
<codeline lineno="72"><highlight class="comment"><sp/>*<sp/><sp/>nonce<sp/>values<sp/>used<sp/>with<sp/>any<sp/>given<sp/>key<sp/>must<sp/>not<sp/>contain<sp/>any<sp/>duplicate</highlight></codeline>
<codeline lineno="73"><highlight class="comment"><sp/>*<sp/><sp/>values.<sp/><sp/>Using<sp/>the<sp/>same<sp/>nonce<sp/>for<sp/>two<sp/>different<sp/>messages<sp/>encrypted</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/>*<sp/><sp/>with<sp/>the<sp/>same<sp/>key<sp/>destroys<sp/>the<sp/>security<sp/>properties.</highlight></codeline>
<codeline lineno="75"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="76"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>length<sp/>of<sp/>the<sp/>nonce<sp/>determines<sp/>the<sp/>maximum<sp/>number<sp/>of<sp/>messages<sp/>that<sp/>may</highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/>*<sp/><sp/>be<sp/>encrypted<sp/>and<sp/>authenticated<sp/>before<sp/>you<sp/>must<sp/>regenerate<sp/>the<sp/>key.</highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/>*<sp/><sp/>Reasonable<sp/>session<sp/>key<sp/>rotation<sp/>schemes<sp/>will<sp/>regenerate<sp/>the<sp/>key<sp/>before<sp/>reaching</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/>*<sp/><sp/>this<sp/>limit.</highlight></codeline>
<codeline lineno="80"><highlight class="comment"><sp/>*<sp/><sp/>There<sp/>is<sp/>a<sp/>trade-off<sp/>between<sp/>the<sp/>nonce-length<sp/>and<sp/>the<sp/>maximum<sp/>length<sp/>of</highlight></codeline>
<codeline lineno="81"><highlight class="comment"><sp/>*<sp/><sp/>the<sp/>plaintext<sp/>to<sp/>encrypt<sp/>and<sp/>authenticate<sp/>per<sp/>nonce.<sp/>This<sp/>is<sp/>because</highlight></codeline>
<codeline lineno="82"><highlight class="comment"><sp/>*<sp/><sp/>CTR<sp/>concatenates<sp/>the<sp/>nonce<sp/>and<sp/>an<sp/>internal<sp/>counter<sp/>into<sp/>one<sp/>16-byte</highlight></codeline>
<codeline lineno="83"><highlight class="comment"><sp/>*<sp/><sp/>IV.<sp/>The<sp/>counter<sp/>is<sp/>incremented<sp/>after<sp/>generating<sp/>an<sp/>AES-block-sized</highlight></codeline>
<codeline lineno="84"><highlight class="comment"><sp/>*<sp/><sp/>pseudo-random<sp/>bitstream.<sp/>This<sp/>bitstream<sp/>is<sp/>XOR&apos;d<sp/>with<sp/>the<sp/>plaintext.</highlight></codeline>
<codeline lineno="85"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>counter<sp/>would<sp/>eventually<sp/>roll<sp/>over<sp/>for<sp/>a<sp/>sufficiently<sp/>long<sp/>message.</highlight></codeline>
<codeline lineno="86"><highlight class="comment"><sp/>*<sp/><sp/>This<sp/>is<sp/>must<sp/>not<sp/>happen.<sp/>Hence,<sp/>the<sp/>longer<sp/>the<sp/>nonce<sp/>and<sp/>the<sp/>more<sp/>messages</highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/>*<sp/><sp/>you<sp/>can<sp/>send<sp/>before<sp/>needing<sp/>to<sp/>rotate<sp/>the<sp/>key,<sp/>the<sp/>shorter<sp/>the</highlight></codeline>
<codeline lineno="88"><highlight class="comment"><sp/>*<sp/><sp/>lengths<sp/>of<sp/>individual<sp/>messages<sp/>sent<sp/>may<sp/>be.<sp/>The<sp/>minimum<sp/>and<sp/>maximum</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/>*<sp/><sp/>nonce<sp/>length<sp/>defined<sp/>by<sp/>the<sp/>CCM<sp/>standard<sp/>provide<sp/>for<sp/>both<sp/>a<sp/>reasonable</highlight></codeline>
<codeline lineno="90"><highlight class="comment"><sp/>*<sp/><sp/>number<sp/>of<sp/>messages<sp/>before<sp/>key<sp/>rotation<sp/>and<sp/>a<sp/>reasonable<sp/>maximum<sp/>message<sp/>length.</highlight></codeline>
<codeline lineno="91"><highlight class="comment"><sp/>*<sp/><sp/>Check<sp/>NIST<sp/>SP<sp/>800-38C<sp/>for<sp/>details.</highlight></codeline>
<codeline lineno="92"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="93"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>optional<sp/>additional<sp/>authentication<sp/>data<sp/>(AAD)<sp/>is<sp/>authenticated</highlight></codeline>
<codeline lineno="94"><highlight class="comment"><sp/>*<sp/><sp/>but<sp/>not<sp/>encrypted.<sp/>Thus,<sp/>the<sp/>AAD<sp/>is<sp/>not<sp/>included<sp/>in<sp/>the<sp/>AES-CCM<sp/>output.</highlight></codeline>
<codeline lineno="95"><highlight class="comment"><sp/>*<sp/><sp/>It<sp/>can<sp/>be<sp/>used<sp/>to<sp/>authenticate<sp/>packet<sp/>headers.</highlight></codeline>
<codeline lineno="96"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="97"><highlight class="comment"><sp/>*<sp/><sp/>After<sp/>the<sp/>encryption<sp/>operation,<sp/>the<sp/>ciphertext<sp/>contains<sp/>the<sp/>encrypted</highlight></codeline>
<codeline lineno="98"><highlight class="comment"><sp/>*<sp/><sp/>data.<sp/>The<sp/>message<sp/>authentication<sp/>code<sp/>(MAC)<sp/>is<sp/>also<sp/>provided.</highlight></codeline>
<codeline lineno="99"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="100"><highlight class="comment"><sp/>*<sp/><sp/>#<sp/>CCM<sp/>Variations<sp/>#</highlight></codeline>
<codeline lineno="101"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>AESCCM<sp/>driver<sp/>supports<sp/>both<sp/>classic<sp/>CCM<sp/>as<sp/>defined<sp/>by<sp/>NIST<sp/>SP<sp/>800-38C<sp/>and</highlight></codeline>
<codeline lineno="102"><highlight class="comment"><sp/>*<sp/><sp/>the<sp/>CCM*<sp/>variant<sp/>used<sp/>in<sp/>IEEE<sp/>802.15.4.</highlight></codeline>
<codeline lineno="103"><highlight class="comment"><sp/>*<sp/><sp/>CCM*<sp/>allows<sp/>for<sp/>unauthenticated<sp/>encryption<sp/>using<sp/>CCM<sp/>by<sp/>permitting<sp/>a<sp/>MAC<sp/>length</highlight></codeline>
<codeline lineno="104"><highlight class="comment"><sp/>*<sp/><sp/>of<sp/>0.<sp/>It<sp/>also<sp/>imposes<sp/>the<sp/>requirement<sp/>that<sp/>the<sp/>MAC<sp/>length<sp/>be<sp/>embedded<sp/>in</highlight></codeline>
<codeline lineno="105"><highlight class="comment"><sp/>*<sp/><sp/>the<sp/>nonce<sp/>used<sp/>for<sp/>each<sp/>message<sp/>if<sp/>the<sp/>MAC<sp/>length<sp/>varies<sp/>within<sp/>the<sp/>protocol</highlight></codeline>
<codeline lineno="106"><highlight class="comment"><sp/>*<sp/><sp/>using<sp/>CCM*.</highlight></codeline>
<codeline lineno="107"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="108"><highlight class="comment"><sp/>*<sp/><sp/>@anchor<sp/>ti_drivers_AESCCM_Usage</highlight></codeline>
<codeline lineno="109"><highlight class="comment"><sp/>*<sp/><sp/>#<sp/>Usage<sp/>#</highlight></codeline>
<codeline lineno="110"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="111"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Before<sp/>starting<sp/>a<sp/>CCM<sp/>operation<sp/>#</highlight></codeline>
<codeline lineno="112"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="113"><highlight class="comment"><sp/>*<sp/><sp/>Before<sp/>starting<sp/>a<sp/>CCM<sp/>operation,<sp/>the<sp/>application<sp/>must<sp/>do<sp/>the<sp/>following:</highlight></codeline>
<codeline lineno="114"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>AESCCM_init()<sp/>to<sp/>initialize<sp/>the<sp/>driver</highlight></codeline>
<codeline lineno="115"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>AESCCM_Params_init()<sp/>to<sp/>initialize<sp/>the<sp/>AESCCM_Params<sp/>to<sp/>default<sp/>values.</highlight></codeline>
<codeline lineno="116"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Modify<sp/>the<sp/>AESCCM_Params<sp/>as<sp/>desired</highlight></codeline>
<codeline lineno="117"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Call<sp/>AESCCM_open()<sp/>to<sp/>open<sp/>an<sp/>instance<sp/>of<sp/>the<sp/>driver</highlight></codeline>
<codeline lineno="118"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Initialize<sp/>a<sp/>CryptoKey.<sp/>These<sp/>opaque<sp/>data<sp/>structures<sp/>are<sp/>representations</highlight></codeline>
<codeline lineno="119"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>keying<sp/>material<sp/>and<sp/>its<sp/>storage.<sp/>Depending<sp/>on<sp/>how<sp/>the<sp/>keying<sp/>material</highlight></codeline>
<codeline lineno="120"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>stored<sp/>(RAM<sp/>or<sp/>flash,<sp/>key<sp/>store),<sp/>the<sp/>CryptoKey<sp/>must<sp/>be</highlight></codeline>
<codeline lineno="121"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>initialized<sp/>differently.<sp/>The<sp/>AESCCM<sp/>API<sp/>can<sp/>handle<sp/>all<sp/>types<sp/>of<sp/>CryptoKey.</highlight></codeline>
<codeline lineno="122"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>However,<sp/>not<sp/>all<sp/>device-specific<sp/>implementations<sp/>support<sp/>all<sp/>types<sp/>of<sp/>CryptoKey.</highlight></codeline>
<codeline lineno="123"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Devices<sp/>without<sp/>a<sp/>key<sp/>store<sp/>will<sp/>not<sp/>support<sp/>CryptoKeys<sp/>with<sp/>keying<sp/>material</highlight></codeline>
<codeline lineno="124"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stored<sp/>in<sp/>a<sp/>key<sp/>store<sp/>for<sp/>example.</highlight></codeline>
<codeline lineno="125"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>All<sp/>devices<sp/>support<sp/>plaintext<sp/>CryptoKeys.</highlight></codeline>
<codeline lineno="126"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Initialize<sp/>the<sp/>appropriate<sp/>AESCCM<sp/>operation<sp/>struct<sp/>using<sp/>the<sp/>relevant</highlight></codeline>
<codeline lineno="127"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operation<sp/>init<sp/>functions<sp/>and<sp/>set<sp/>all<sp/>fields.<sp/>For<sp/>example,<sp/>one-step<sp/>(one-shot</highlight></codeline>
<codeline lineno="128"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>or<sp/>single<sp/>call)<sp/>operations<sp/>should<sp/>initialize<sp/>AESCCM_Operation<sp/>or</highlight></codeline>
<codeline lineno="129"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OneStepOperation<sp/>using<sp/>AESCCM_Operation_init()<sp/>or</highlight></codeline>
<codeline lineno="130"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OneStepOperation_init().<sp/>For<sp/>multi-step<sp/>(segmented<sp/>or<sp/>multiple<sp/>call)</highlight></codeline>
<codeline lineno="131"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operations,<sp/>AESCCM_SegmentedAADOperation<sp/>must<sp/>be<sp/>initialized<sp/>and<sp/>set<sp/>when</highlight></codeline>
<codeline lineno="132"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>processing<sp/>AAD.<sp/>AESCCM_SegmentedDataOperation<sp/>must<sp/>be<sp/>initialized<sp/>and<sp/>set<sp/>when</highlight></codeline>
<codeline lineno="133"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dealing<sp/>with<sp/>payload<sp/>data<sp/>(plaintext<sp/>or<sp/>ciphertext).<sp/>AESCCM_SegmentedFinalizeOperation</highlight></codeline>
<codeline lineno="134"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>must<sp/>be<sp/>initialized<sp/>and<sp/>set<sp/>when<sp/>finalizing<sp/>the<sp/>segmented<sp/>operation.</highlight></codeline>
<codeline lineno="135"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="136"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Starting<sp/>a<sp/>CCM<sp/>operation<sp/>#</highlight></codeline>
<codeline lineno="137"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="138"><highlight class="comment"><sp/>*<sp/><sp/>The<sp/>AESCCM_oneStepEncrypt<sp/>and<sp/>AESCCM_oneStepDecrypt<sp/>functions<sp/>do<sp/>a<sp/>CCM<sp/>operation<sp/>in<sp/>a<sp/>single<sp/>call.</highlight></codeline>
<codeline lineno="139"><highlight class="comment"><sp/>*<sp/><sp/>They<sp/>will<sp/>always<sp/>be<sp/>the<sp/>most<sp/>highly<sp/>optimized<sp/>routines<sp/>with<sp/>the<sp/>least<sp/>overhead<sp/>and<sp/>the<sp/>fastest</highlight></codeline>
<codeline lineno="140"><highlight class="comment"><sp/>*<sp/><sp/>runtime.<sp/>However,<sp/>they<sp/>require<sp/>all<sp/>AAD<sp/>and<sp/>plaintext<sp/>or<sp/>ciphertext<sp/>data<sp/>to<sp/>be</highlight></codeline>
<codeline lineno="141"><highlight class="comment"><sp/>*<sp/><sp/>available<sp/>to<sp/>the<sp/>function<sp/>at<sp/>the<sp/>start<sp/>of<sp/>the<sp/>call.</highlight></codeline>
<codeline lineno="142"><highlight class="comment"><sp/>*<sp/><sp/>All<sp/>devices<sp/>support<sp/>single<sp/>call<sp/>operations.</highlight></codeline>
<codeline lineno="143"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="144"><highlight class="comment"><sp/>*<sp/><sp/>When<sp/>performing<sp/>a<sp/>decryption<sp/>operation<sp/>with<sp/>AESCCM_oneStepDecrypt(),<sp/>the<sp/>MAC<sp/>is</highlight></codeline>
<codeline lineno="145"><highlight class="comment"><sp/>*<sp/><sp/>automatically<sp/>verified.</highlight></codeline>
<codeline lineno="146"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="147"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>After<sp/>the<sp/>CCM<sp/>operation<sp/>completes<sp/>#</highlight></codeline>
<codeline lineno="148"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="149"><highlight class="comment"><sp/>*<sp/><sp/>After<sp/>the<sp/>CCM<sp/>operation<sp/>completes,<sp/>the<sp/>application<sp/>should<sp/>either<sp/>start<sp/>another<sp/>operation</highlight></codeline>
<codeline lineno="150"><highlight class="comment"><sp/>*<sp/><sp/>or<sp/>close<sp/>the<sp/>driver<sp/>by<sp/>calling<sp/>AESCCM_close()</highlight></codeline>
<codeline lineno="151"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="152"><highlight class="comment"><sp/>*<sp/><sp/>@anchor<sp/>ti_drivers_AESCCM_Synopsis</highlight></codeline>
<codeline lineno="153"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Synopsis</highlight></codeline>
<codeline lineno="154"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="155"><highlight class="comment"><sp/>*<sp/><sp/>@anchor<sp/>ti_drivers_AESCCM_Synopsis_Code</highlight></codeline>
<codeline lineno="156"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="157"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="158"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Import<sp/>AESCCM<sp/>Driver<sp/>definitions</highlight></codeline>
<codeline lineno="159"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline lineno="160"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="161"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Define<sp/>name<sp/>for<sp/>AESCCM<sp/>channel<sp/>index</highlight></codeline>
<codeline lineno="162"><highlight class="comment"><sp/>*<sp/><sp/>#define<sp/>AESCCM_INSTANCE<sp/>0</highlight></codeline>
<codeline lineno="163"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="164"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_init();</highlight></codeline>
<codeline lineno="165"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="166"><highlight class="comment"><sp/>*<sp/><sp/>handle<sp/>=<sp/>AESCCM_open(AESCCM_INSTANCE,<sp/>NULL);</highlight></codeline>
<codeline lineno="167"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="168"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Initialize<sp/>symmetric<sp/>key</highlight></codeline>
<codeline lineno="169"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="170"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="171"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>Set<sp/>up<sp/>AESCCM_OneStepOperation</highlight></codeline>
<codeline lineno="172"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline lineno="173"><highlight class="comment"><sp/>*<sp/><sp/>operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline lineno="174"><highlight class="comment"><sp/>*<sp/><sp/>operation.aad<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>aad;</highlight></codeline>
<codeline lineno="175"><highlight class="comment"><sp/>*<sp/><sp/>operation.aadLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline lineno="176"><highlight class="comment"><sp/>*<sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="177"><highlight class="comment"><sp/>*<sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="178"><highlight class="comment"><sp/>*<sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext);</highlight></codeline>
<codeline lineno="179"><highlight class="comment"><sp/>*<sp/><sp/>operation.nonce<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>nonce;</highlight></codeline>
<codeline lineno="180"><highlight class="comment"><sp/>*<sp/><sp/>operation.nonceLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(nonce);</highlight></codeline>
<codeline lineno="181"><highlight class="comment"><sp/>*<sp/><sp/>operation.mac<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>mac;</highlight></codeline>
<codeline lineno="182"><highlight class="comment"><sp/>*<sp/><sp/>operation.macLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(mac);</highlight></codeline>
<codeline lineno="183"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="184"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCCM_oneStepEncrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="185"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="186"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_close(handle);</highlight></codeline>
<codeline lineno="187"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="188"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="189"><highlight class="comment"><sp/>*<sp/><sp/>@anchor<sp/>ti_drivers_AESCCM_Examples</highlight></codeline>
<codeline lineno="190"><highlight class="comment"><sp/>*<sp/><sp/>##<sp/>Examples</highlight></codeline>
<codeline lineno="191"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="192"><highlight class="comment"><sp/>*<sp/><sp/>###<sp/>Single<sp/>call<sp/>CCM<sp/>encryption<sp/>+<sp/>authentication<sp/>with<sp/>plaintext<sp/>CryptoKey<sp/>in<sp/>blocking<sp/>return<sp/>mode<sp/>#</highlight></codeline>
<codeline lineno="193"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="194"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="195"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline lineno="196"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="197"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="198"><highlight class="comment"><sp/>*<sp/><sp/>...</highlight></codeline>
<codeline lineno="199"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="200"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_Handle<sp/>handle;</highlight></codeline>
<codeline lineno="201"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline lineno="202"><highlight class="comment"><sp/>*<sp/><sp/>int_fast16_t<sp/>encryptionResult;</highlight></codeline>
<codeline lineno="203"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>nonce[]<sp/>=<sp/>&quot;Thisisanonce&quot;;</highlight></codeline>
<codeline lineno="204"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>aad[]<sp/>=<sp/>&quot;This<sp/>string<sp/>will<sp/>be<sp/>authenticated<sp/>but<sp/>not<sp/>encrypted.&quot;;</highlight></codeline>
<codeline lineno="205"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>plaintext[]<sp/>=<sp/>&quot;This<sp/>string<sp/>will<sp/>be<sp/>encrypted<sp/>and<sp/>authenticated.&quot;;</highlight></codeline>
<codeline lineno="206"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>mac[16];</highlight></codeline>
<codeline lineno="207"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>ciphertext[sizeof(plaintext)];</highlight></codeline>
<codeline lineno="208"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>keyingMaterial[32]<sp/>=<sp/>{0x00,<sp/>0x01,<sp/>0x02,<sp/>0x03,<sp/>0x04,<sp/>0x05,<sp/>0x06,<sp/>0x07,</highlight></codeline>
<codeline lineno="209"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x08,<sp/>0x09,<sp/>0x0A,<sp/>0x0B,<sp/>0x0C,<sp/>0x0D,<sp/>0x0E,<sp/>0x0F,</highlight></codeline>
<codeline lineno="210"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x10,<sp/>0x11,<sp/>0x12,<sp/>0x13,<sp/>0x14,<sp/>0x15,<sp/>0x16,<sp/>0x17,</highlight></codeline>
<codeline lineno="211"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x18,<sp/>0x19,<sp/>0x1A,<sp/>0x1B,<sp/>0x1C,<sp/>0x1D,<sp/>0x1E,<sp/>0x1F};</highlight></codeline>
<codeline lineno="212"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="213"><highlight class="comment"><sp/>*<sp/><sp/>handle<sp/>=<sp/>AESCCM_open(0,<sp/>NULL);</highlight></codeline>
<codeline lineno="214"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="215"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="216"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="217"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="218"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="219"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="220"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="221"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OneStepOperation<sp/>operation;</highlight></codeline>
<codeline lineno="222"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline lineno="223"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="224"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline lineno="225"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.aad<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>aad;</highlight></codeline>
<codeline lineno="226"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.aadLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline lineno="227"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="228"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="229"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(plaintext);</highlight></codeline>
<codeline lineno="230"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.nonce<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>nonce;</highlight></codeline>
<codeline lineno="231"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.nonceLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(nonce);</highlight></codeline>
<codeline lineno="232"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.mac<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>mac;</highlight></codeline>
<codeline lineno="233"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.macLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(mac);</highlight></codeline>
<codeline lineno="234"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="235"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCCM_oneStepEncrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="236"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="237"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="238"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="239"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="240"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="241"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_close(handle);</highlight></codeline>
<codeline lineno="242"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="243"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="244"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="245"><highlight class="comment"><sp/>*<sp/><sp/>###<sp/>Single<sp/>call<sp/>CCM<sp/>decryption<sp/>+<sp/>verification<sp/>with<sp/>plaintext<sp/>CryptoKey<sp/>in<sp/>callback<sp/>return<sp/>mode<sp/>#</highlight></codeline>
<codeline lineno="246"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="247"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="248"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline lineno="249"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="250"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="251"><highlight class="comment"><sp/>*<sp/><sp/>...</highlight></codeline>
<codeline lineno="252"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="253"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>following<sp/>test<sp/>vector<sp/>is<sp/>Packet<sp/>Vector<sp/>1<sp/>from<sp/>RFC<sp/>3610<sp/>of<sp/>the<sp/>IETF.</highlight></codeline>
<codeline lineno="254"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="255"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>nonce[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x00,<sp/>0x00,<sp/>0x03,<sp/>0x02,<sp/>0x01,<sp/>0x00,<sp/>0xA0,</highlight></codeline>
<codeline lineno="256"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA1,<sp/>0xA2,<sp/>0xA3,<sp/>0xA4,<sp/>0xA5};</highlight></codeline>
<codeline lineno="257"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>aad[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x01,<sp/>0x02,<sp/>0x03,<sp/>0x04,<sp/>0x05,<sp/>0x06,<sp/>0x07};</highlight></codeline>
<codeline lineno="258"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>mac[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x17,<sp/>0xE8,<sp/>0xD1,<sp/>0x2C,<sp/>0xFD,<sp/>0xF9,<sp/>0x26,<sp/>0xE0};</highlight></codeline>
<codeline lineno="259"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>ciphertext[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x58,<sp/>0x8C,<sp/>0x97,<sp/>0x9A,<sp/>0x61,<sp/>0xC6,<sp/>0x63,<sp/>0xD2,</highlight></codeline>
<codeline lineno="260"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,<sp/>0x66,<sp/>0xD0,<sp/>0xC2,<sp/>0xC0,<sp/>0xF9,<sp/>0x89,<sp/>0x80,</highlight></codeline>
<codeline lineno="261"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x6D,<sp/>0x5F,<sp/>0x6B,<sp/>0x61,<sp/>0xDA,<sp/>0xC3,<sp/>0x84};</highlight></codeline>
<codeline lineno="262"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>keyingMaterial[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0xC0,<sp/>0xC1,<sp/>0xC2,<sp/>0xC3,<sp/>0xC4,<sp/>0xC5,<sp/>0xC6,<sp/>0xC7,</highlight></codeline>
<codeline lineno="263"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC8,<sp/>0xC9,<sp/>0xCA,<sp/>0xCB,<sp/>0xCC,<sp/>0xCD,<sp/>0xCE,<sp/>0xCF};</highlight></codeline>
<codeline lineno="264"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>plaintext[sizeof(ciphertext)];</highlight></codeline>
<codeline lineno="265"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="266"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>plaintext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>decryption<sp/>operation:</highlight></codeline>
<codeline lineno="267"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>{0x08,<sp/>0x09,<sp/>0x0A,<sp/>0x0B,<sp/>0x0C,<sp/>0x0D,<sp/>0x0E,<sp/>0x0F,</highlight></codeline>
<codeline lineno="268"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x10,<sp/>0x11,<sp/>0x12,<sp/>0x13,<sp/>0x14,<sp/>0x15,<sp/>0x16,<sp/>0x17,</highlight></codeline>
<codeline lineno="269"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x18,<sp/>0x19,<sp/>0x1A,<sp/>0x1B,<sp/>0x1C,<sp/>0x1D,<sp/>0x1E}</highlight></codeline>
<codeline lineno="270"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="271"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="272"><highlight class="comment"><sp/>*<sp/><sp/>void<sp/>ccmCallback(AESCCM_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="273"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline lineno="274"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationUnion<sp/>*operation,</highlight></codeline>
<codeline lineno="275"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationType<sp/>operationType)<sp/>{</highlight></codeline>
<codeline lineno="276"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="277"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(returnValue<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="278"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="279"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="280"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="281"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="282"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_OneStepOperation<sp/>operation;</highlight></codeline>
<codeline lineno="283"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="284"><highlight class="comment"><sp/>*<sp/><sp/>void<sp/>ccmStartFunction(void)<sp/>{</highlight></codeline>
<codeline lineno="285"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_Handle<sp/>handle;</highlight></codeline>
<codeline lineno="286"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_Params<sp/>params;</highlight></codeline>
<codeline lineno="287"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline lineno="288"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>decryptionResult;</highlight></codeline>
<codeline lineno="289"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="290"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_Params_init(&amp;params);</highlight></codeline>
<codeline lineno="291"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>params.returnBehavior<sp/>=<sp/>AESCCM_RETURN_BEHAVIOR_CALLBACK;</highlight></codeline>
<codeline lineno="292"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>params.callbackFxn<sp/>=<sp/>ccmCallback;</highlight></codeline>
<codeline lineno="293"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="294"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>handle<sp/>=<sp/>AESCCM_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline lineno="295"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="296"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="297"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="298"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="299"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="300"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="301"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="302"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OneStepOperation_init(&amp;operation);</highlight></codeline>
<codeline lineno="303"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="304"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.key<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>&amp;cryptoKey;</highlight></codeline>
<codeline lineno="305"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.aad<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>aad;</highlight></codeline>
<codeline lineno="306"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.aadLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline lineno="307"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.input<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="308"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.output<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="309"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.inputLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(ciphertext);</highlight></codeline>
<codeline lineno="310"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.nonce<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>nonce;</highlight></codeline>
<codeline lineno="311"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.nonceLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(nonce);</highlight></codeline>
<codeline lineno="312"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.mac<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>mac;</highlight></codeline>
<codeline lineno="313"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>operation.macLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>sizeof(mac);</highlight></codeline>
<codeline lineno="314"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="315"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_oneStepDecrypt(handle,<sp/>&amp;operation);</highlight></codeline>
<codeline lineno="316"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="317"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="318"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="319"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="320"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="321"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>other<sp/>things<sp/>while<sp/>CCM<sp/>operation<sp/>completes<sp/>in<sp/>the<sp/>background</highlight></codeline>
<codeline lineno="322"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="323"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="324"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="325"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="326"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="327"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="328"><highlight class="comment"><sp/>*<sp/><sp/>###<sp/>Multi-step<sp/>CCM<sp/>encryption<sp/>+<sp/>authentication<sp/>with<sp/>plaintext<sp/>CryptoKey<sp/>in<sp/>blocking<sp/>return<sp/>mode<sp/>#</highlight></codeline>
<codeline lineno="329"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="330"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="331"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline lineno="332"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="333"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="334"><highlight class="comment"><sp/>*<sp/><sp/>...</highlight></codeline>
<codeline lineno="335"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="336"><highlight class="comment"><sp/>*<sp/><sp/>#define<sp/>AES_BLOCK_SIZE<sp/><sp/><sp/><sp/><sp/>16<sp/>//<sp/>bytes</highlight></codeline>
<codeline lineno="337"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="338"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_Handle<sp/>handle;</highlight></codeline>
<codeline lineno="339"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline lineno="340"><highlight class="comment"><sp/>*<sp/><sp/>int_fast16_t<sp/>encryptionResult;</highlight></codeline>
<codeline lineno="341"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="342"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>following<sp/>test<sp/>vector<sp/>is<sp/>Packet<sp/>Vector<sp/>1<sp/>from<sp/>RFC<sp/>3610<sp/>of<sp/>the<sp/>IETF.</highlight></codeline>
<codeline lineno="343"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="344"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>keyingMaterial[16]<sp/>=<sp/>{0xC0,<sp/>0xC1,<sp/>0xC2,<sp/>0xC3,<sp/>0xC4,<sp/>0xC5,<sp/>0xC6,<sp/>0xC7,</highlight></codeline>
<codeline lineno="345"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC8,<sp/>0xC9,<sp/>0xCA,<sp/>0xCB,<sp/>0xCC,<sp/>0xCD,<sp/>0xCE,<sp/>0xCF};</highlight></codeline>
<codeline lineno="346"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>aad[8]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x01,<sp/>0x02,<sp/>0x03,<sp/>0x04,<sp/>0x05,<sp/>0x06,<sp/>0x07};</highlight></codeline>
<codeline lineno="347"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>plaintext[23]<sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x08,<sp/>0x09,<sp/>0x0A,<sp/>0x0B,<sp/>0x0C,<sp/>0x0D,<sp/>0x0E,<sp/>0x0F,</highlight></codeline>
<codeline lineno="348"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x10,<sp/>0x11,<sp/>0x12,<sp/>0x13,<sp/>0x14,<sp/>0x15,<sp/>0x16,<sp/>0x17,</highlight></codeline>
<codeline lineno="349"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x18,<sp/>0x19,<sp/>0x1A,<sp/>0x1B,<sp/>0x1C,<sp/>0x1D,<sp/>0x1E};</highlight></codeline>
<codeline lineno="350"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>nonce[13]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x00,<sp/>0x00,<sp/>0x03,<sp/>0x02,<sp/>0x01,<sp/>0x00,<sp/>0xA0,</highlight></codeline>
<codeline lineno="351"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA1,<sp/>0xA2,<sp/>0xA3,<sp/>0xA4,<sp/>0xA5};</highlight></codeline>
<codeline lineno="352"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>mac[8];</highlight></codeline>
<codeline lineno="353"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>ciphertext[sizeof(plaintext)];</highlight></codeline>
<codeline lineno="354"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="355"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>ciphertext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>encryption<sp/>operation:</highlight></codeline>
<codeline lineno="356"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>{0x58,<sp/>0x8C,<sp/>0x97,<sp/>0x9A,<sp/>0x61,<sp/>0xC6,<sp/>0x63,<sp/>0xD2,</highlight></codeline>
<codeline lineno="357"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0xF0,<sp/>0x66,<sp/>0xD0,<sp/>0xC2,<sp/>0xC0,<sp/>0xF9,<sp/>0x89,<sp/>0x80,</highlight></codeline>
<codeline lineno="358"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x6D,<sp/>0x5F,<sp/>0x6B,<sp/>0x61,<sp/>0xDA,<sp/>0xC3,<sp/>0x84}</highlight></codeline>
<codeline lineno="359"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="360"><highlight class="comment"><sp/>*<sp/><sp/>handle<sp/>=<sp/>AESCCM_open(0,<sp/>NULL);</highlight></codeline>
<codeline lineno="361"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="362"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="363"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="364"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="365"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="366"><highlight class="comment"><sp/>*<sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="367"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="368"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCCM_setupEncrypt(handle,<sp/>&amp;cryptoKey,<sp/>sizeof(aad),<sp/>sizeof(plaintext),<sp/>sizeof(mac));</highlight></codeline>
<codeline lineno="369"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="370"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="371"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="372"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="373"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCCM_setNonce(handle,<sp/>nonce,<sp/>sizeof(nonce));</highlight></codeline>
<codeline lineno="374"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="375"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="376"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="377"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="378"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_SegmentedAADOperation<sp/>segmentedAADOperation;</highlight></codeline>
<codeline lineno="379"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_SegmentedAADOperation_init(&amp;segmentedAADOperation);</highlight></codeline>
<codeline lineno="380"><highlight class="comment"><sp/>*<sp/><sp/>segmentedAADOperation.aad<sp/>=<sp/>aad;</highlight></codeline>
<codeline lineno="381"><highlight class="comment"><sp/>*<sp/><sp/>segmentedAADOperation.aadLength<sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline lineno="382"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="383"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCCM_addAAD(handle,<sp/>&amp;segmentedAADOperation);</highlight></codeline>
<codeline lineno="384"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="385"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="386"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="387"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="388"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_SegmentedDataOperation<sp/>segmentedDataOperation;</highlight></codeline>
<codeline lineno="389"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_SegmentedDataOperation_init(&amp;segmentedDataOperation);</highlight></codeline>
<codeline lineno="390"><highlight class="comment"><sp/>*<sp/><sp/>segmentedDataOperation.input<sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="391"><highlight class="comment"><sp/>*<sp/><sp/>segmentedDataOperation.output<sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="392"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>One<sp/>should<sp/>pass<sp/>in<sp/>data<sp/>that<sp/>is<sp/>a<sp/>block-sized<sp/>multiple<sp/>length</highlight></codeline>
<codeline lineno="393"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>until<sp/>passing<sp/>in<sp/>the<sp/>last<sp/>segment<sp/>of<sp/>data.</highlight></codeline>
<codeline lineno="394"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>In<sp/>that<sp/>case,<sp/>the<sp/>input<sp/>length<sp/>simply<sp/>needs<sp/>to<sp/>be<sp/>a<sp/>non-zero<sp/>value.</highlight></codeline>
<codeline lineno="395"><highlight class="comment"><sp/>*<sp/><sp/>segmentedDataOperation.inputLength<sp/>=<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="396"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="397"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCCM_addData(handle,<sp/>&amp;segmentedDataOperation);</highlight></codeline>
<codeline lineno="398"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="399"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="400"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="401"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="402"><highlight class="comment"><sp/>*<sp/><sp/>segmentedDataOperation.input<sp/>=<sp/>plaintext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="403"><highlight class="comment"><sp/>*<sp/><sp/>segmentedDataOperation.output<sp/>=<sp/>ciphertext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="404"><highlight class="comment"><sp/>*<sp/><sp/>segmentedDataOperation.inputLength<sp/>=<sp/>sizeof(plaintext)<sp/>-<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="405"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="406"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCCM_addData(handle,<sp/>&amp;segmentedDataOperation);</highlight></codeline>
<codeline lineno="407"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="408"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="409"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="410"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="411"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_SegmentedFinalizeOperation<sp/>segmentedFinalizeOperation;</highlight></codeline>
<codeline lineno="412"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_SegmentedFinalizeOperation_init(&amp;egmentedFinalizeOperation);</highlight></codeline>
<codeline lineno="413"><highlight class="comment"><sp/>*<sp/><sp/>segmentedFinalizeOperation.input<sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="414"><highlight class="comment"><sp/>*<sp/><sp/>segmentedFinalizeOperation.output<sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="415"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="416"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>You<sp/>can<sp/>finalize<sp/>with<sp/>no<sp/>new<sp/>data</highlight></codeline>
<codeline lineno="417"><highlight class="comment"><sp/>*<sp/><sp/>segmentedFinalizeOperation.inputLength<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="418"><highlight class="comment"><sp/>*<sp/><sp/>segmentedFinalizeOperation.mac<sp/>=<sp/>mac;</highlight></codeline>
<codeline lineno="419"><highlight class="comment"><sp/>*<sp/><sp/>segmentedFinalizeOperation.macLength<sp/>=<sp/>sizeof(mac);</highlight></codeline>
<codeline lineno="420"><highlight class="comment"><sp/>*<sp/><sp/>encryptionResult<sp/>=<sp/>AESCCM_finalizeEncrypt(handle,<sp/>&amp;segmentedFinalizeOperation);</highlight></codeline>
<codeline lineno="421"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="422"><highlight class="comment"><sp/>*<sp/><sp/>if<sp/>(encryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="423"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="424"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="425"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="426"><highlight class="comment"><sp/>*<sp/><sp/>AESCCM_close(handle);</highlight></codeline>
<codeline lineno="427"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="428"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="429"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="430"><highlight class="comment"><sp/>*<sp/><sp/>###<sp/>Multi-step<sp/>CCM<sp/>decryption<sp/>+<sp/>verification<sp/>with<sp/>plaintext<sp/>CryptoKey<sp/>in<sp/>callback<sp/>return<sp/>mode<sp/>#</highlight></codeline>
<codeline lineno="431"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="432"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="433"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline lineno="434"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="435"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="436"><highlight class="comment"><sp/>*<sp/><sp/>...</highlight></codeline>
<codeline lineno="437"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="438"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>following<sp/>test<sp/>vector<sp/>is<sp/>Packet<sp/>Vector<sp/>1<sp/>from<sp/>RFC<sp/>3610<sp/>of<sp/>the<sp/>IETF.</highlight></codeline>
<codeline lineno="439"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="440"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>nonce[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x00,<sp/>0x00,<sp/>0x03,<sp/>0x02,<sp/>0x01,<sp/>0x00,<sp/>0xA0,</highlight></codeline>
<codeline lineno="441"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA1,<sp/>0xA2,<sp/>0xA3,<sp/>0xA4,<sp/>0xA5};</highlight></codeline>
<codeline lineno="442"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>aad[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x01,<sp/>0x02,<sp/>0x03,<sp/>0x04,<sp/>0x05,<sp/>0x06,<sp/>0x07};</highlight></codeline>
<codeline lineno="443"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>mac[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x17,<sp/>0xE8,<sp/>0xD1,<sp/>0x2C,<sp/>0xFD,<sp/>0xF9,<sp/>0x26,<sp/>0xE0};</highlight></codeline>
<codeline lineno="444"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>ciphertext[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x58,<sp/>0x8C,<sp/>0x97,<sp/>0x9A,<sp/>0x61,<sp/>0xC6,<sp/>0x63,<sp/>0xD2,</highlight></codeline>
<codeline lineno="445"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,<sp/>0x66,<sp/>0xD0,<sp/>0xC2,<sp/>0xC0,<sp/>0xF9,<sp/>0x89,<sp/>0x80,</highlight></codeline>
<codeline lineno="446"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x6D,<sp/>0x5F,<sp/>0x6B,<sp/>0x61,<sp/>0xDA,<sp/>0xC3,<sp/>0x84};</highlight></codeline>
<codeline lineno="447"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>keyingMaterial[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0xC0,<sp/>0xC1,<sp/>0xC2,<sp/>0xC3,<sp/>0xC4,<sp/>0xC5,<sp/>0xC6,<sp/>0xC7,</highlight></codeline>
<codeline lineno="448"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC8,<sp/>0xC9,<sp/>0xCA,<sp/>0xCB,<sp/>0xCC,<sp/>0xCD,<sp/>0xCE,<sp/>0xCF};</highlight></codeline>
<codeline lineno="449"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>plaintext[sizeof(ciphertext)];</highlight></codeline>
<codeline lineno="450"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="451"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>plaintext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>decryption<sp/>operation:</highlight></codeline>
<codeline lineno="452"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>{0x08,<sp/>0x09,<sp/>0x0A,<sp/>0x0B,<sp/>0x0C,<sp/>0x0D,<sp/>0x0E,<sp/>0x0F,</highlight></codeline>
<codeline lineno="453"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x10,<sp/>0x11,<sp/>0x12,<sp/>0x13,<sp/>0x14,<sp/>0x15,<sp/>0x16,<sp/>0x17,</highlight></codeline>
<codeline lineno="454"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x18,<sp/>0x19,<sp/>0x1A,<sp/>0x1B,<sp/>0x1C,<sp/>0x1D,<sp/>0x1E}</highlight></codeline>
<codeline lineno="455"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="456"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="457"><highlight class="comment"><sp/>*<sp/><sp/>void<sp/>ccmCallback(AESCCM_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="458"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline lineno="459"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationUnion<sp/>*operation,</highlight></codeline>
<codeline lineno="460"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationType<sp/>operationType)<sp/>{</highlight></codeline>
<codeline lineno="461"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="462"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(returnValue<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="463"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="464"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="465"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="466"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if(operationType<sp/>==<sp/>AESCCM_OPERATION_TYPE_DECRYPT<sp/>||</highlight></codeline>
<codeline lineno="467"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OPERATION_TYPE_ENCRYPT)</highlight></codeline>
<codeline lineno="468"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="469"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>one-shot<sp/>operations</highlight></codeline>
<codeline lineno="470"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;oneStepOperation</highlight></codeline>
<codeline lineno="471"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="472"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>if(operationType<sp/>==<sp/>AESCCM_OP_TYPE_AAD_DECRYPT<sp/>||</highlight></codeline>
<codeline lineno="473"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OP_TYPE_AAD_ENCRYPT)</highlight></codeline>
<codeline lineno="474"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="475"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>AAD<sp/>operations</highlight></codeline>
<codeline lineno="476"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedAADOperation</highlight></codeline>
<codeline lineno="477"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>if(operationType<sp/>==<sp/>AESCCM_OP_TYPE_DATA_DECRYPT<sp/>||</highlight></codeline>
<codeline lineno="479"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OP_TYPE_DATA_ENCRYPT)</highlight></codeline>
<codeline lineno="480"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="481"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>data<sp/>operations</highlight></codeline>
<codeline lineno="482"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedDataOperation</highlight></codeline>
<codeline lineno="483"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="484"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>else</highlight></codeline>
<codeline lineno="485"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="486"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>finalize<sp/>operations</highlight></codeline>
<codeline lineno="487"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedFinalizeOperation</highlight></codeline>
<codeline lineno="488"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="489"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="490"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="491"><highlight class="comment"><sp/>*<sp/><sp/>void<sp/>ccmStartFunction(void)<sp/>{</highlight></codeline>
<codeline lineno="492"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_Handle<sp/>handle;</highlight></codeline>
<codeline lineno="493"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_Params<sp/>params;</highlight></codeline>
<codeline lineno="494"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline lineno="495"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>decryptionResult;</highlight></codeline>
<codeline lineno="496"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="497"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_Params_init(&amp;params);</highlight></codeline>
<codeline lineno="498"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>params.returnBehavior<sp/>=<sp/>AESCCM_RETURN_BEHAVIOR_CALLBACK;</highlight></codeline>
<codeline lineno="499"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>params.callbackFxn<sp/>=<sp/>ccmCallback;</highlight></codeline>
<codeline lineno="500"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="501"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>handle<sp/>=<sp/>AESCCM_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline lineno="502"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="503"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="504"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="505"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="506"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="507"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="508"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="509"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setupDecrypt(handle,<sp/>&amp;cryptoKey,<sp/>0,<sp/>0,<sp/>0);</highlight></codeline>
<codeline lineno="510"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="511"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="512"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="513"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="514"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>setLengths<sp/>must<sp/>be<sp/>called<sp/>if<sp/>the<sp/>AAD,<sp/>input,<sp/>and<sp/>MAC<sp/>lengths<sp/>aren&apos;t<sp/>provided<sp/>in<sp/>setupXXXX.</highlight></codeline>
<codeline lineno="515"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setLengths(handle,<sp/>sizeof(aad),<sp/>sizeof(ciphertext),<sp/>sizeof(mac));</highlight></codeline>
<codeline lineno="516"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="517"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="518"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="519"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="520"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setNonce(handle,<sp/>nonce,<sp/>sizeof(nonce));</highlight></codeline>
<codeline lineno="521"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="522"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="523"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="524"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="525"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedAADOperation<sp/>segmentedAADOperation;</highlight></codeline>
<codeline lineno="526"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedAADOperation_init(&amp;segmentedAADOperation);</highlight></codeline>
<codeline lineno="527"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedAADOperation.aad<sp/>=<sp/>aad;</highlight></codeline>
<codeline lineno="528"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedAADOperation.aadLength<sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline lineno="529"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="530"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_addAAD(handle,<sp/>&amp;segmentedAADOperation);</highlight></codeline>
<codeline lineno="531"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="532"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="533"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="534"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="535"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedDataOperation<sp/>segmentedDataOperation;</highlight></codeline>
<codeline lineno="536"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedDataOperation_init(&amp;segmentedDataOperation);</highlight></codeline>
<codeline lineno="537"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedDataOperation.input<sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="538"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedDataOperation.output<sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="539"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedDataOperation.inputLength<sp/>=<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="540"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="541"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_addData(handle,<sp/>&amp;segmentedDataOperation);</highlight></codeline>
<codeline lineno="542"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="543"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="544"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="545"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="546"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedFinalizeOperation<sp/>segmentedFinalizeOperation;</highlight></codeline>
<codeline lineno="547"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedFinalizeOperation_init(&amp;egmentedFinalizeOperation);</highlight></codeline>
<codeline lineno="548"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.input<sp/>=<sp/>ciphertext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="549"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.output<sp/>=<sp/>plaintext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="550"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.inputLength<sp/>=<sp/>sizeof(ciphertext)<sp/>-<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="551"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.mac<sp/>=<sp/>mac;</highlight></codeline>
<codeline lineno="552"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.macLength<sp/>=<sp/>sizeof(mac);</highlight></codeline>
<codeline lineno="553"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="554"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_finalizeDecrypt(handle,<sp/>&amp;segmentedFinalizeOperation);</highlight></codeline>
<codeline lineno="555"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="556"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="557"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="558"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="559"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>other<sp/>things<sp/>while<sp/>CCM<sp/>operation<sp/>completes<sp/>in<sp/>the<sp/>background</highlight></codeline>
<codeline lineno="560"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="561"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="562"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="563"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="564"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="565"><highlight class="comment"><sp/>*<sp/><sp/>###<sp/>Multi-step<sp/>CCM*<sp/>decryption<sp/>+<sp/>verification<sp/>with<sp/>plaintext<sp/>CryptoKey<sp/>in<sp/>callback<sp/>return<sp/>mode<sp/>#</highlight></codeline>
<codeline lineno="566"><highlight class="comment"><sp/>*<sp/><sp/>@code</highlight></codeline>
<codeline lineno="567"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="568"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/AESCCM.h&gt;</highlight></codeline>
<codeline lineno="569"><highlight class="comment"><sp/>*<sp/><sp/>#include<sp/>&lt;ti/drivers/cryptoutils/cryptokey/CryptoKeyPlaintext.h&gt;</highlight></codeline>
<codeline lineno="570"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="571"><highlight class="comment"><sp/>*<sp/><sp/>...</highlight></codeline>
<codeline lineno="572"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="573"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>following<sp/>test<sp/>vector<sp/>is<sp/>Packet<sp/>Vector<sp/>1<sp/>from<sp/>RFC<sp/>3610<sp/>of<sp/>the<sp/>IETF.</highlight></codeline>
<codeline lineno="574"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="575"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>nonce[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x00,<sp/>0x00,<sp/>0x03,<sp/>0x02,<sp/>0x01,<sp/>0x00,<sp/>0xA0,</highlight></codeline>
<codeline lineno="576"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xA1,<sp/>0xA2,<sp/>0xA3,<sp/>0xA4,<sp/>0xA5};</highlight></codeline>
<codeline lineno="577"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>aad[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x00,<sp/>0x01,<sp/>0x02,<sp/>0x03,<sp/>0x04,<sp/>0x05,<sp/>0x06,<sp/>0x07};</highlight></codeline>
<codeline lineno="578"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>mac[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="579"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="580"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>CCM*<sp/>allows<sp/>for<sp/>unauthenticated<sp/>encryption<sp/>using<sp/>CCM<sp/>by<sp/>allowing<sp/>a<sp/>MAC<sp/>length<sp/>of<sp/>0</highlight></codeline>
<codeline lineno="581"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>macLength<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="582"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>ciphertext[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0x58,<sp/>0x8C,<sp/>0x97,<sp/>0x9A,<sp/>0x61,<sp/>0xC6,<sp/>0x63,<sp/>0xD2,</highlight></codeline>
<codeline lineno="583"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xF0,<sp/>0x66,<sp/>0xD0,<sp/>0xC2,<sp/>0xC0,<sp/>0xF9,<sp/>0x89,<sp/>0x80,</highlight></codeline>
<codeline lineno="584"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x6D,<sp/>0x5F,<sp/>0x6B,<sp/>0x61,<sp/>0xDA,<sp/>0xC3,<sp/>0x84};</highlight></codeline>
<codeline lineno="585"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>keyingMaterial[]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>{0xC0,<sp/>0xC1,<sp/>0xC2,<sp/>0xC3,<sp/>0xC4,<sp/>0xC5,<sp/>0xC6,<sp/>0xC7,</highlight></codeline>
<codeline lineno="586"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0xC8,<sp/>0xC9,<sp/>0xCA,<sp/>0xCB,<sp/>0xCC,<sp/>0xCD,<sp/>0xCE,<sp/>0xCF};</highlight></codeline>
<codeline lineno="587"><highlight class="comment"><sp/>*<sp/><sp/>uint8_t<sp/>plaintext[sizeof(ciphertext)];</highlight></codeline>
<codeline lineno="588"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="589"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/>The<sp/>plaintext<sp/>should<sp/>be<sp/>the<sp/>following<sp/>after<sp/>the<sp/>decryption<sp/>operation:</highlight></codeline>
<codeline lineno="590"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>{0x08,<sp/>0x09,<sp/>0x0A,<sp/>0x0B,<sp/>0x0C,<sp/>0x0D,<sp/>0x0E,<sp/>0x0F,</highlight></codeline>
<codeline lineno="591"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x10,<sp/>0x11,<sp/>0x12,<sp/>0x13,<sp/>0x14,<sp/>0x15,<sp/>0x16,<sp/>0x17,</highlight></codeline>
<codeline lineno="592"><highlight class="comment"><sp/>*<sp/><sp/>//<sp/><sp/>0x18,<sp/>0x19,<sp/>0x1A,<sp/>0x1B,<sp/>0x1C,<sp/>0x1D,<sp/>0x1E}</highlight></codeline>
<codeline lineno="593"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="594"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="595"><highlight class="comment"><sp/>*<sp/><sp/>void<sp/>ccmCallback(AESCCM_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="596"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline lineno="597"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationUnion<sp/>*operation,</highlight></codeline>
<codeline lineno="598"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_OperationType<sp/>operationType)<sp/>{</highlight></codeline>
<codeline lineno="599"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="600"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(returnValue<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="601"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="602"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="603"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="604"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if(operationType<sp/>==<sp/>AESCCM_OPERATION_TYPE_DECRYPT<sp/>||</highlight></codeline>
<codeline lineno="605"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OPERATION_TYPE_ENCRYPT)</highlight></codeline>
<codeline lineno="606"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="607"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>one-shot<sp/>operations</highlight></codeline>
<codeline lineno="608"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;oneStepOperation</highlight></codeline>
<codeline lineno="609"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="610"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>if(operationType<sp/>==<sp/>AESCCM_OP_TYPE_AAD_DECRYPT<sp/>||</highlight></codeline>
<codeline lineno="611"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OP_TYPE_AAD_ENCRYPT)</highlight></codeline>
<codeline lineno="612"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="613"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>AAD<sp/>operations</highlight></codeline>
<codeline lineno="614"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedAADOperation</highlight></codeline>
<codeline lineno="615"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="616"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>else<sp/>if(operationType<sp/>==<sp/>AESCCM_OP_TYPE_DATA_DECRYPT<sp/>||</highlight></codeline>
<codeline lineno="617"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operationType<sp/>==<sp/>AESCCM_OP_TYPE_DATA_ENCRYPT)</highlight></codeline>
<codeline lineno="618"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="619"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>data<sp/>operations</highlight></codeline>
<codeline lineno="620"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedDataOperation</highlight></codeline>
<codeline lineno="621"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="622"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>else</highlight></codeline>
<codeline lineno="623"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="624"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Callback<sp/>fxn<sp/>only<sp/>used<sp/>for<sp/>segmented<sp/>finalize<sp/>operations</highlight></codeline>
<codeline lineno="625"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>Use<sp/>operation-&gt;segmentedFinalizeOperation</highlight></codeline>
<codeline lineno="626"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="627"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="628"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="629"><highlight class="comment"><sp/>*<sp/><sp/>void<sp/>ccmStartFunction(void)<sp/>{</highlight></codeline>
<codeline lineno="630"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_Handle<sp/>handle;</highlight></codeline>
<codeline lineno="631"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_Params<sp/>params;</highlight></codeline>
<codeline lineno="632"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>CryptoKey<sp/>cryptoKey;</highlight></codeline>
<codeline lineno="633"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>decryptionResult;</highlight></codeline>
<codeline lineno="634"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="635"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_Params_init(&amp;params);</highlight></codeline>
<codeline lineno="636"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>params.returnBehavior<sp/>=<sp/>AESCCM_RETURN_BEHAVIOR_CALLBACK;</highlight></codeline>
<codeline lineno="637"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>params.callbackFxn<sp/>=<sp/>ccmCallback;</highlight></codeline>
<codeline lineno="638"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="639"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>handle<sp/>=<sp/>AESCCM_open(0,<sp/>&amp;params);</highlight></codeline>
<codeline lineno="640"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="641"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(handle<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="642"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="643"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="644"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="645"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>CryptoKeyPlaintext_initKey(&amp;cryptoKey,<sp/>keyingMaterial,<sp/>sizeof(keyingMaterial));</highlight></codeline>
<codeline lineno="646"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="647"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setupDecrypt(handle,<sp/>&amp;cryptoKey,<sp/>0,<sp/>0,<sp/>0);</highlight></codeline>
<codeline lineno="648"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="649"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="650"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="651"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="652"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>setLengths<sp/>must<sp/>be<sp/>called<sp/>if<sp/>the<sp/>AAD,<sp/>input,<sp/>and<sp/>MAC<sp/>lengths<sp/>aren&apos;t<sp/>provided<sp/>in<sp/>setupXXXX.</highlight></codeline>
<codeline lineno="653"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setLengths(handle,<sp/>sizeof(aad),<sp/>sizeof(ciphertext),<sp/>macLength);</highlight></codeline>
<codeline lineno="654"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="655"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="656"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="657"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="658"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_setNonce(handle,<sp/>nonce,<sp/>sizeof(nonce));</highlight></codeline>
<codeline lineno="659"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="660"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="661"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="662"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="663"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedAADOperation<sp/>segmentedAADOperation;</highlight></codeline>
<codeline lineno="664"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedAADOperation_init(&amp;segmentedAADOperation);</highlight></codeline>
<codeline lineno="665"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedAADOperation.aad<sp/>=<sp/>aad;</highlight></codeline>
<codeline lineno="666"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedAADOperation.aadLength<sp/>=<sp/>sizeof(aad);</highlight></codeline>
<codeline lineno="667"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="668"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_addAAD(handle,<sp/>&amp;segmentedAADOperation);</highlight></codeline>
<codeline lineno="669"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="670"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="671"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="672"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="673"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedDataOperation<sp/>segmentedDataOperation;</highlight></codeline>
<codeline lineno="674"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedDataOperation_init(&amp;segmentedDataOperation);</highlight></codeline>
<codeline lineno="675"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedDataOperation.input<sp/>=<sp/>ciphertext;</highlight></codeline>
<codeline lineno="676"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedDataOperation.output<sp/>=<sp/>plaintext;</highlight></codeline>
<codeline lineno="677"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedDataOperation.inputLength<sp/>=<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="678"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="679"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_addData(handle,<sp/>&amp;segmentedDataOperation);</highlight></codeline>
<codeline lineno="680"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="681"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="682"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="683"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="684"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedFinalizeOperation<sp/>segmentedFinalizeOperation;</highlight></codeline>
<codeline lineno="685"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>AESCCM_SegmentedFinalizeOperation_init(&amp;egmentedFinalizeOperation);</highlight></codeline>
<codeline lineno="686"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.input<sp/>=<sp/>ciphertext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="687"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.output<sp/>=<sp/>plaintext<sp/>+<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="688"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.inputLength<sp/>=<sp/>sizeof(ciphertext)<sp/>-<sp/>AES_BLOCK_SIZE;</highlight></codeline>
<codeline lineno="689"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.mac<sp/>=<sp/>mac;</highlight></codeline>
<codeline lineno="690"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>segmentedFinalizeOperation.macLength<sp/>=<sp/>macLength;</highlight></codeline>
<codeline lineno="691"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="692"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>decryptionResult<sp/>=<sp/>AESCCM_finalizeDecrypt(handle,<sp/>&amp;segmentedFinalizeOperation);</highlight></codeline>
<codeline lineno="693"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(decryptionResult<sp/>!=<sp/>AESCCM_STATUS_SUCCESS)<sp/>{</highlight></codeline>
<codeline lineno="694"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>handle<sp/>error</highlight></codeline>
<codeline lineno="695"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="696"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="697"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/>//<sp/>do<sp/>other<sp/>things<sp/>while<sp/>CCM<sp/>operation<sp/>completes<sp/>in<sp/>the<sp/>background</highlight></codeline>
<codeline lineno="698"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="699"><highlight class="comment"><sp/>*<sp/><sp/>}</highlight></codeline>
<codeline lineno="700"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="701"><highlight class="comment"><sp/>*<sp/><sp/>@endcode</highlight></codeline>
<codeline lineno="702"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="703"><highlight class="normal"></highlight></codeline>
<codeline lineno="704"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>ti_drivers_AESCCM__include</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="705"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ti_drivers_AESCCM__include</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal"></highlight></codeline>
<codeline lineno="707"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdbool.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stddef.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="709"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="710"><highlight class="normal"></highlight></codeline>
<codeline lineno="711"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="_a_e_s_common_8h" kindref="compound">ti/drivers/AESCommon.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="_crypto_key_8h" kindref="compound">ti/drivers/cryptoutils/cryptokey/CryptoKey.h</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="713"><highlight class="normal"></highlight></codeline>
<codeline lineno="714"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="715"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="716"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="717"><highlight class="normal"></highlight></codeline>
<codeline lineno="730" refid="_a_e_s_c_c_m_8h_1a92006b2b0e406614ca650c88b5d393ef" refkind="member"><highlight class="preprocessor">#define<sp/>AESCCM_STATUS_RESERVED<sp/>AES_STATUS_RESERVED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="731"><highlight class="normal"></highlight></codeline>
<codeline lineno="738" refid="_a_e_s_c_c_m_8h_1afde7b16d8daa5643d3d9e4c0ed9fe60d" refkind="member"><highlight class="preprocessor">#define<sp/>AESCCM_STATUS_SUCCESS<sp/>AES_STATUS_SUCCESS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="739"><highlight class="normal"></highlight></codeline>
<codeline lineno="746" refid="_a_e_s_c_c_m_8h_1af5a6b56e602e7d8730b86ffd0ec46938" refkind="member"><highlight class="preprocessor">#define<sp/>AESCCM_STATUS_ERROR<sp/>AES_STATUS_ERROR</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"></highlight></codeline>
<codeline lineno="756" refid="_a_e_s_c_c_m_8h_1aabf9f8e552b6a5a12f512d6c862f04fa" refkind="member"><highlight class="preprocessor">#define<sp/>AESCCM_STATUS_RESOURCE_UNAVAILABLE<sp/>AES_STATUS_RESOURCE_UNAVAILABLE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"></highlight></codeline>
<codeline lineno="761" refid="_a_e_s_c_c_m_8h_1aedda3f3cdad624c827dffda8e2cad3a1" refkind="member"><highlight class="preprocessor">#define<sp/>AESCCM_STATUS_CANCELED<sp/>AES_STATUS_CANCELED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="762"><highlight class="normal"></highlight></codeline>
<codeline lineno="770" refid="_a_e_s_c_c_m_8h_1adf7ebf9930072745c454b0bf932d694b" refkind="member"><highlight class="preprocessor">#define<sp/>AESCCM_STATUS_MAC_INVALID<sp/>AES_STATUS_MAC_INVALID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal"></highlight></codeline>
<codeline lineno="776" refid="_a_e_s_c_c_m_8h_1af58fa1294f47e145af3c184e9c9bd13b" refkind="member"><highlight class="preprocessor">#define<sp/>AESCCM_STATUS_FEATURE_NOT_SUPPORTED<sp/>AES_STATUS_FEATURE_NOT_SUPPORTED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"></highlight></codeline>
<codeline lineno="781" refid="_a_e_s_c_c_m_8h_1a8a80abb1ad1626c0687f399efa7f5109" refkind="member"><highlight class="preprocessor">#define<sp/>AESCCM_STATUS_KEYSTORE_INVALID_ID<sp/>AES_STATUS_KEYSTORE_INVALID_ID</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="782"><highlight class="normal"></highlight></codeline>
<codeline lineno="787" refid="_a_e_s_c_c_m_8h_1af3bee65918c7fc3f7d8614d82f305584" refkind="member"><highlight class="preprocessor">#define<sp/>AESCCM_STATUS_KEYSTORE_GENERIC_ERROR<sp/>AES_STATUS_KEYSTORE_GENERIC_ERROR</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="788"><highlight class="normal"></highlight></codeline>
<codeline lineno="795" refid="_a_e_s_c_c_m_8h_1a2c1fecff89d36c4e712c8ffd5a8c2fe0" refkind="member"><highlight class="preprocessor">#define<sp/>AESCCM_STATUS_UNALIGNED_IO_NOT_SUPPORTED<sp/>AES_STATUS_UNALIGNED_IO_NOT_SUPPORTED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="796"><highlight class="normal"></highlight></codeline>
<codeline lineno="808" refid="_a_e_s_c_c_m_8h_1a91d80cb57f9660003f6cc75a155215a7" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_common___config" kindref="compound">AESCommon_Config</ref><sp/><ref refid="_a_e_s_c_c_m_8h_1a91d80cb57f9660003f6cc75a155215a7" kindref="member">AESCCM_Config</ref>;</highlight></codeline>
<codeline lineno="809"><highlight class="normal"></highlight></codeline>
<codeline lineno="813" refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/>AESCCM_Config<sp/>*<ref refid="_a_e_s_c_c_m_8h_1aed94613dec497c0a0110c08a3ebaad57" kindref="member">AESCCM_Handle</ref>;</highlight></codeline>
<codeline lineno="814"><highlight class="normal"></highlight></codeline>
<codeline lineno="836" refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4a" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="837"><highlight class="normal">{</highlight></codeline>
<codeline lineno="838" refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aab768e7c12bd6bf9e87bfba1c6bf3d2a4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aab768e7c12bd6bf9e87bfba1c6bf3d2a4" kindref="member">AESCCM_RETURN_BEHAVIOR_CALLBACK</ref><sp/>=<sp/><ref refid="_a_e_s_common_8h_1a2820f6d52c454af5c0d7b20215e4a448a1960d364137ea874dd37fa582d97be46" kindref="member">AES_RETURN_BEHAVIOR_CALLBACK</ref>,</highlight></codeline>
<codeline lineno="845" refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aa1761cf2c8bd972890a0193f772281a8c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aa1761cf2c8bd972890a0193f772281a8c" kindref="member">AESCCM_RETURN_BEHAVIOR_BLOCKING</ref><sp/>=<sp/><ref refid="_a_e_s_common_8h_1a2820f6d52c454af5c0d7b20215e4a448a2f37373d3f057f1696056d9124285398" kindref="member">AES_RETURN_BEHAVIOR_BLOCKING</ref>,</highlight></codeline>
<codeline lineno="850" refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aa8077fa385d151d93ed7762a998abd567" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4aa8077fa385d151d93ed7762a998abd567" kindref="member">AESCCM_RETURN_BEHAVIOR_POLLING</ref><sp/><sp/>=<sp/><ref refid="_a_e_s_common_8h_1a2820f6d52c454af5c0d7b20215e4a448a671eba846166015af2e6f06a017f1716" kindref="member">AES_RETURN_BEHAVIOR_POLLING</ref>,</highlight></codeline>
<codeline lineno="855"><highlight class="normal">}<sp/><ref refid="_a_e_s_c_c_m_8h_1acd172e5c4f62e036371b2095c0af6e4a" kindref="member">AESCCM_ReturnBehavior</ref>;</highlight></codeline>
<codeline lineno="856"><highlight class="normal"></highlight></codeline>
<codeline lineno="860" refid="_a_e_s_c_c_m_8h_1aa8e2ac1695595c7d416ba650c9110b5c" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="861"><highlight class="normal">{</highlight></codeline>
<codeline lineno="862" refid="_a_e_s_c_c_m_8h_1aa8e2ac1695595c7d416ba650c9110b5ca1366ac9470982aa8b1457e305df7e026" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1aa8e2ac1695595c7d416ba650c9110b5ca1366ac9470982aa8b1457e305df7e026" kindref="member">AESCCM_MODE_ENCRYPT</ref><sp/>=<sp/>1,</highlight></codeline>
<codeline lineno="863" refid="_a_e_s_c_c_m_8h_1aa8e2ac1695595c7d416ba650c9110b5ca4f3b682868aaacf1a33856fa85543ae3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1aa8e2ac1695595c7d416ba650c9110b5ca4f3b682868aaacf1a33856fa85543ae3" kindref="member">AESCCM_MODE_DECRYPT</ref><sp/>=<sp/>2,</highlight></codeline>
<codeline lineno="864"><highlight class="normal">}<sp/><ref refid="_a_e_s_c_c_m_8h_1aa8e2ac1695595c7d416ba650c9110b5c" kindref="member">AESCCM_Mode</ref>;</highlight></codeline>
<codeline lineno="865"><highlight class="normal"></highlight></codeline>
<codeline lineno="870" refid="struct_a_e_s_c_c_m___one_step_operation" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="871"><highlight class="normal">{</highlight></codeline>
<codeline lineno="872" refid="struct_a_e_s_c_c_m___one_step_operation_1a60597c184ac7cded3c0fd5cf95dff7e6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*<ref refid="struct_a_e_s_c_c_m___one_step_operation_1a60597c184ac7cded3c0fd5cf95dff7e6" kindref="member">key</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="873" refid="struct_a_e_s_c_c_m___one_step_operation_1af618d273e0ed9d2629d6ff7de2c10b14" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___one_step_operation_1af618d273e0ed9d2629d6ff7de2c10b14" kindref="member">aad</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="877" refid="struct_a_e_s_c_c_m___one_step_operation_1a2890f67345534f6453fa7542aae73792" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___one_step_operation_1a2890f67345534f6453fa7542aae73792" kindref="member">input</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="882" refid="struct_a_e_s_c_c_m___one_step_operation_1a98489a8a4e1f92a2ff993a08cd96b175" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___one_step_operation_1a98489a8a4e1f92a2ff993a08cd96b175" kindref="member">output</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="888" refid="struct_a_e_s_c_c_m___one_step_operation_1a4f4ae8d0db8c2fd1e70d18d390aefac5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___one_step_operation_1a4f4ae8d0db8c2fd1e70d18d390aefac5" kindref="member">nonce</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="893" refid="struct_a_e_s_c_c_m___one_step_operation_1a8fe60faf602193ced93c44a48b9c3ff2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___one_step_operation_1a8fe60faf602193ced93c44a48b9c3ff2" kindref="member">mac</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="899" refid="struct_a_e_s_c_c_m___one_step_operation_1a2f79d51135f6ede8769c72985f4f82b4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_c_m___one_step_operation_1a2f79d51135f6ede8769c72985f4f82b4" kindref="member">aadLength</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="904" refid="struct_a_e_s_c_c_m___one_step_operation_1a88686ae1dc18f7360c85ab2be5199e3d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_c_m___one_step_operation_1a88686ae1dc18f7360c85ab2be5199e3d" kindref="member">inputLength</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="910" refid="struct_a_e_s_c_c_m___one_step_operation_1a12ae0ab7f346b31e1721e4ddacbd56ef" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/><ref refid="struct_a_e_s_c_c_m___one_step_operation_1a12ae0ab7f346b31e1721e4ddacbd56ef" kindref="member">nonceLength</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="913" refid="struct_a_e_s_c_c_m___one_step_operation_1ae605f001589478c0726b233e60479fd7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/><ref refid="struct_a_e_s_c_c_m___one_step_operation_1ae605f001589478c0726b233e60479fd7" kindref="member">macLength</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="918" refid="struct_a_e_s_c_c_m___one_step_operation_1ab33a582cb0c6fcd3008fad8a7fd2af32" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_c_m___one_step_operation_1ab33a582cb0c6fcd3008fad8a7fd2af32" kindref="member">nonceInternallyGenerated</ref>;<sp/></highlight></codeline>
<codeline lineno="922"><highlight class="normal">}<sp/><ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref>;</highlight></codeline>
<codeline lineno="923"><highlight class="normal"></highlight></codeline>
<codeline lineno="929" refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal">{</highlight></codeline>
<codeline lineno="931" refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation_1a4423f75bd0c0c2711d38aade96c0dbfe" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation_1a4423f75bd0c0c2711d38aade96c0dbfe" kindref="member">aad</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="935" refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation_1a2b9e8f7c098accd81d2002d2d88235f0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation_1a2b9e8f7c098accd81d2002d2d88235f0" kindref="member">aadLength</ref>;<sp/></highlight></codeline>
<codeline lineno="940"><highlight class="normal">}<sp/><ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" kindref="compound">AESCCM_SegmentedAADOperation</ref>;</highlight></codeline>
<codeline lineno="941"><highlight class="normal"></highlight></codeline>
<codeline lineno="947" refid="struct_a_e_s_c_c_m___segmented_data_operation" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="948"><highlight class="normal">{</highlight></codeline>
<codeline lineno="949" refid="struct_a_e_s_c_c_m___segmented_data_operation_1a350b08527a5c8a6b1099bad246f1a6c3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___segmented_data_operation_1a350b08527a5c8a6b1099bad246f1a6c3" kindref="member">input</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="954" refid="struct_a_e_s_c_c_m___segmented_data_operation_1ac89f37fea59d78c4c5d51b674e22704e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___segmented_data_operation_1ac89f37fea59d78c4c5d51b674e22704e" kindref="member">output</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="960" refid="struct_a_e_s_c_c_m___segmented_data_operation_1a0f33aa769a5b84921143e3eb2e2ea727" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_c_m___segmented_data_operation_1a0f33aa769a5b84921143e3eb2e2ea727" kindref="member">inputLength</ref>;<sp/></highlight></codeline>
<codeline lineno="965"><highlight class="normal">}<sp/><ref refid="struct_a_e_s_c_c_m___segmented_data_operation" kindref="compound">AESCCM_SegmentedDataOperation</ref>;</highlight></codeline>
<codeline lineno="966"><highlight class="normal"></highlight></codeline>
<codeline lineno="972" refid="struct_a_e_s_c_c_m___segmented_finalize_operation" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="973"><highlight class="normal">{</highlight></codeline>
<codeline lineno="974" refid="struct_a_e_s_c_c_m___segmented_finalize_operation_1ae1e010fc3fa90226f2c5a8e322643222" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation_1ae1e010fc3fa90226f2c5a8e322643222" kindref="member">input</ref>;<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="979" refid="struct_a_e_s_c_c_m___segmented_finalize_operation_1a0e5d886410590c1fa39889cf42d12848" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation_1a0e5d886410590c1fa39889cf42d12848" kindref="member">output</ref>;<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="985" refid="struct_a_e_s_c_c_m___segmented_finalize_operation_1a174df9973f9c618b0ad86316a94a3774" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/>*<ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation_1a174df9973f9c618b0ad86316a94a3774" kindref="member">mac</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="991" refid="struct_a_e_s_c_c_m___segmented_finalize_operation_1ab066420a911cc29a1d424998ce6b415c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation_1ab066420a911cc29a1d424998ce6b415c" kindref="member">inputLength</ref>;<sp/></highlight></codeline>
<codeline lineno="997" refid="struct_a_e_s_c_c_m___segmented_finalize_operation_1a6701486aa8d92211ea993c670933a956" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint8_t<sp/><ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation_1a6701486aa8d92211ea993c670933a956" kindref="member">macLength</ref>;<sp/><sp/></highlight></codeline>
<codeline lineno="1002"><highlight class="normal">}<sp/><ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref>;</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"></highlight></codeline>
<codeline lineno="1011" refid="_a_e_s_c_c_m_8h_1a1546f451996da52b51b153524f4ad6e0" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref><sp/><ref refid="_a_e_s_c_c_m_8h_1a1546f451996da52b51b153524f4ad6e0" kindref="member">AESCCM_Operation</ref>;</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"></highlight></codeline>
<codeline lineno="1017" refid="union_a_e_s_c_c_m___operation_union" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">union<sp/></highlight><highlight class="normal"><ref refid="union_a_e_s_c_c_m___operation_union" kindref="compound">AESCCM_OperationUnion</ref></highlight></codeline>
<codeline lineno="1018"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1019" refid="union_a_e_s_c_c_m___operation_union_1aa2888b4c15a5bd2ad52207733881f0d7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref><sp/><ref refid="union_a_e_s_c_c_m___operation_union_1aa2888b4c15a5bd2ad52207733881f0d7" kindref="member">oneStepOperation</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>One-step<sp/>operation<sp/>element<sp/>of<sp/>the<sp/>operation<sp/>union<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1020" refid="union_a_e_s_c_c_m___operation_union_1a019971667ccb11f1ef95c17f3bd0a654" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" kindref="compound">AESCCM_SegmentedAADOperation</ref><sp/><ref refid="union_a_e_s_c_c_m___operation_union_1a019971667ccb11f1ef95c17f3bd0a654" kindref="member">segmentedAADOperation</ref>;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Segmented<sp/>AAD<sp/>operation<sp/>element<sp/>of<sp/>the<sp/>operation<sp/>union<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1021" refid="union_a_e_s_c_c_m___operation_union_1a01d7a7f752ae48d982eef35efa95c728" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_a_e_s_c_c_m___segmented_data_operation" kindref="compound">AESCCM_SegmentedDataOperation</ref><sp/><ref refid="union_a_e_s_c_c_m___operation_union_1a01d7a7f752ae48d982eef35efa95c728" kindref="member">segmentedDataOperation</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Segmented<sp/>data<sp/>operation<sp/>element<sp/>of<sp/>the<sp/>operation<sp/>union<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1022" refid="union_a_e_s_c_c_m___operation_union_1a68d7eac9e5bb0dd46e0a3316edf1963e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref><sp/><ref refid="union_a_e_s_c_c_m___operation_union_1a68d7eac9e5bb0dd46e0a3316edf1963e" kindref="member">segmentedFinalizeOperation</ref>;<sp/></highlight><highlight class="comment">/*<sp/>Segmented<sp/>finalize<sp/>operation<sp/>element<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="1023"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operation<sp/>union<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1024"><highlight class="normal">}<sp/><ref refid="_a_e_s_c_c_m_8h_1a1f32498fec196ebb5edad85c910057a8" kindref="member">AESCCM_OperationUnion</ref>;</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"></highlight></codeline>
<codeline lineno="1029" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">enum</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1030"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1031" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a1c0ce6f811d6c8d513027375449b9fc7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a1c0ce6f811d6c8d513027375449b9fc7" kindref="member">AESCCM_OPERATION_TYPE_ENCRYPT</ref><sp/><sp/><sp/>=<sp/>1,<sp/></highlight><highlight class="comment">/*<sp/>Fields<sp/>1<sp/>and<sp/>2<sp/>are<sp/>for<sp/>backward<sp/>compatibility<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1032" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ab20c9152379db6153e39a74f09d0a874" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ab20c9152379db6153e39a74f09d0a874" kindref="member">AESCCM_OPERATION_TYPE_DECRYPT</ref><sp/><sp/><sp/>=<sp/>2,</highlight></codeline>
<codeline lineno="1033" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a56cc5668458a7419c6cc53934c92cc04" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a56cc5668458a7419c6cc53934c92cc04" kindref="member">AESCCM_OP_TYPE_ONESTEP_ENCRYPT</ref><sp/><sp/>=<sp/>1,<sp/></highlight><highlight class="comment">/*<sp/>Names<sp/>changed<sp/>to<sp/>_OP_TYPE_<sp/>to<sp/>avoid<sp/>MISRA<sp/>deviation<sp/>from<sp/>first<sp/>31<sp/>chars<sp/>not</highlight></codeline>
<codeline lineno="1034"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>being<sp/>unique<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1035" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ab27d592644eb32362723b6f263f6b6cb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ab27d592644eb32362723b6f263f6b6cb" kindref="member">AESCCM_OP_TYPE_ONESTEP_DECRYPT</ref><sp/><sp/>=<sp/>2,</highlight></codeline>
<codeline lineno="1036" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a21671c7c511d7a39a9c6752cc2f2274a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a21671c7c511d7a39a9c6752cc2f2274a" kindref="member">AESCCM_OP_TYPE_AAD_ENCRYPT</ref><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>3,</highlight></codeline>
<codeline lineno="1037" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ad57252d7dbd1656f1f2e17c7af8c8e3e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ad57252d7dbd1656f1f2e17c7af8c8e3e" kindref="member">AESCCM_OP_TYPE_AAD_DECRYPT</ref><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>4,</highlight></codeline>
<codeline lineno="1038" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ae6d3be7cfaf6e0c33dbd47ba30a939ce" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ae6d3be7cfaf6e0c33dbd47ba30a939ce" kindref="member">AESCCM_OP_TYPE_DATA_ENCRYPT</ref><sp/><sp/><sp/><sp/><sp/>=<sp/>5,</highlight></codeline>
<codeline lineno="1039" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ac26cca8eeecc8a9b958dd795725e38da" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ac26cca8eeecc8a9b958dd795725e38da" kindref="member">AESCCM_OP_TYPE_DATA_DECRYPT</ref><sp/><sp/><sp/><sp/><sp/>=<sp/>6,</highlight></codeline>
<codeline lineno="1040" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ac0967aba400c9818f857894bf457076b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0ac0967aba400c9818f857894bf457076b" kindref="member">AESCCM_OP_TYPE_FINALIZE_ENCRYPT</ref><sp/>=<sp/>7,</highlight></codeline>
<codeline lineno="1041" refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a93c7993431a00f336ade13e625580a16" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0a93c7993431a00f336ade13e625580a16" kindref="member">AESCCM_OP_TYPE_FINALIZE_DECRYPT</ref><sp/>=<sp/>8,</highlight></codeline>
<codeline lineno="1042"><highlight class="normal">}<sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0" kindref="member">AESCCM_OperationType</ref>;</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"></highlight></codeline>
<codeline lineno="1059" refid="_a_e_s_c_c_m_8h_1ad9f54d289ab9013555d4ce5e2cbd7411" refkind="member"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/>void<sp/>(*<ref refid="_a_e_s_c_c_m_8h_1ad9f54d289ab9013555d4ce5e2cbd7411" kindref="member">AESCCM_CallbackFxn</ref>)(AESCCM_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int_fast16_t<sp/>returnValue,</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="union_a_e_s_c_c_m___operation_union" kindref="compound">AESCCM_OperationUnion</ref><sp/>*operation,</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1a8b4c0474e73f047a2b920ba2acd5fed0" kindref="member">AESCCM_OperationType</ref><sp/>operationType);</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"></highlight></codeline>
<codeline lineno="1072" refid="struct_a_e_s_c_c_m___params" refkind="compound"><highlight class="keyword">typedef</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">struct</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1073"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1074" refid="struct_a_e_s_c_c_m___params_1af69e42bceb41b56c193e380fb9c0372e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>AESCCM_ReturnBehavior<sp/><ref refid="struct_a_e_s_c_c_m___params_1af69e42bceb41b56c193e380fb9c0372e" kindref="member">returnBehavior</ref>;<sp/></highlight></codeline>
<codeline lineno="1075" refid="struct_a_e_s_c_c_m___params_1a91e1da388f2a419951fa6007a1466a02" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="_a_e_s_c_c_m_8h_1ad9f54d289ab9013555d4ce5e2cbd7411" kindref="member">AESCCM_CallbackFxn</ref><sp/><ref refid="struct_a_e_s_c_c_m___params_1a91e1da388f2a419951fa6007a1466a02" kindref="member">callbackFxn</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1076" refid="struct_a_e_s_c_c_m___params_1ac133664c1c80a69d856e7b13682fe698" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/><ref refid="struct_a_e_s_c_c_m___params_1ac133664c1c80a69d856e7b13682fe698" kindref="member">timeout</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1079" refid="struct_a_e_s_c_c_m___params_1a7b3f3acc4aafd5f7fada1bd18a25f968" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>*<ref refid="struct_a_e_s_c_c_m___params_1a7b3f3acc4aafd5f7fada1bd18a25f968" kindref="member">custom</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1082"><highlight class="normal">}<sp/><ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref>;</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"></highlight></codeline>
<codeline lineno="1089"><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref><sp/><ref refid="_a_e_s_c_c_m_8h_1a7057e1ce2ca8a0f7087a8a664ac3560d" kindref="member">AESCCM_defaultParams</ref>;</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"></highlight></codeline>
<codeline lineno="1099"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_c_m_8h_1a51982c7e9ace406edb69a0345f4c9dfc" kindref="member">AESCCM_init</ref>(</highlight><highlight class="keywordtype">void</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"></highlight></codeline>
<codeline lineno="1113"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_c_m_8h_1ab48597e7c8931af81234c786efac7cee" kindref="member">AESCCM_Params_init</ref>(<ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref><sp/>*<ref refid="_driver___init_8h_1af93f10d4f7393a01dff58c92f91d8cbc" kindref="member">params</ref>);</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"></highlight></codeline>
<codeline lineno="1132"><highlight class="normal">AESCCM_Handle<sp/><ref refid="_a_e_s_c_c_m_8h_1a37eee15ffa76522272907ab2f8e868dc" kindref="member">AESCCM_open</ref>(uint_least8_t<sp/>index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref><sp/>*<ref refid="_driver___init_8h_1af93f10d4f7393a01dff58c92f91d8cbc" kindref="member">params</ref>);</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"></highlight></codeline>
<codeline lineno="1143"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_c_m_8h_1a2cb2636c081846cfc81b801999a21ec5" kindref="member">AESCCM_close</ref>(AESCCM_Handle<sp/>handle);</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"></highlight></codeline>
<codeline lineno="1176"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1aa793f126c596136ce4af66b38c7bccd6" kindref="member">AESCCM_setupEncrypt</ref>(AESCCM_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*key,</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>totalAADLength,</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>totalPlaintextLength,</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>macLength);</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"></highlight></codeline>
<codeline lineno="1213"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1af1d437ca38c617046b61501b0a9491b0" kindref="member">AESCCM_setupDecrypt</ref>(AESCCM_Handle<sp/>handle,</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_crypto_key" kindref="compound">CryptoKey</ref><sp/>*key,</highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>totalAADLength,</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>totalPlaintextLength,</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>macLength);</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"></highlight></codeline>
<codeline lineno="1246"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1a2376b9edaffed9f9afff639ee421f9d6" kindref="member">AESCCM_setLengths</ref>(AESCCM_Handle<sp/>handle,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>aadLength,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>plaintextLength,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>macLength);</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"></highlight></codeline>
<codeline lineno="1268"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1ad4c8bb8a6061a91e8a544f73cb4de780" kindref="member">AESCCM_setNonce</ref>(AESCCM_Handle<sp/>handle,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint8_t<sp/>*nonce,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>nonceLength);</highlight></codeline>
<codeline lineno="1269"><highlight class="normal"></highlight></codeline>
<codeline lineno="1294"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1a10d1d4f7c669a03ade23a057c501b8f9" kindref="member">AESCCM_generateNonce</ref>(AESCCM_Handle<sp/>handle,<sp/>uint8_t<sp/>*nonce,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>nonceSize,<sp/></highlight><highlight class="keywordtype">size_t</highlight><highlight class="normal"><sp/>*nonceLength);</highlight></codeline>
<codeline lineno="1295"><highlight class="normal"></highlight></codeline>
<codeline lineno="1330"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1a53440fa4ec513e2e4c873c5d549ff38e" kindref="member">AESCCM_addAAD</ref>(AESCCM_Handle<sp/>handle,<sp/><ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" kindref="compound">AESCCM_SegmentedAADOperation</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"></highlight></codeline>
<codeline lineno="1363"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1a07bf2f9a1aecf33d109af4661983e35b" kindref="member">AESCCM_addData</ref>(AESCCM_Handle<sp/>handle,<sp/><ref refid="struct_a_e_s_c_c_m___segmented_data_operation" kindref="compound">AESCCM_SegmentedDataOperation</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"></highlight></codeline>
<codeline lineno="1390"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1a402aec97da286d158a81deb01e28fd73" kindref="member">AESCCM_finalizeEncrypt</ref>(AESCCM_Handle<sp/>handle,<sp/><ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"></highlight></codeline>
<codeline lineno="1421"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1a980b983808740d02da02123989453cc4" kindref="member">AESCCM_finalizeDecrypt</ref>(AESCCM_Handle<sp/>handle,<sp/><ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref><sp/>*operation);</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"></highlight></codeline>
<codeline lineno="1434"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_c_m_8h_1a737c52bee6913123f4f1fa54c5c3c2a0" kindref="member">AESCCM_Operation_init</ref>(AESCCM_Operation<sp/>*operationStruct);</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"></highlight></codeline>
<codeline lineno="1444"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_c_m_8h_1a1787f57315eb14b2ce26a937283ee162" kindref="member">AESCCM_OneStepOperation_init</ref>(<ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref><sp/>*operationStruct);</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"></highlight></codeline>
<codeline lineno="1454"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_c_m_8h_1a268f64e5abea1f206c7fb8b1e07577d7" kindref="member">AESCCM_SegmentedAADOperation_init</ref>(<ref refid="struct_a_e_s_c_c_m___segmented_a_a_d_operation" kindref="compound">AESCCM_SegmentedAADOperation</ref><sp/>*operationStruct);</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"></highlight></codeline>
<codeline lineno="1464"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_c_m_8h_1a8706786780b43627e0e19cae051fc8fb" kindref="member">AESCCM_SegmentedDataOperation_init</ref>(<ref refid="struct_a_e_s_c_c_m___segmented_data_operation" kindref="compound">AESCCM_SegmentedDataOperation</ref><sp/>*operationStruct);</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"></highlight></codeline>
<codeline lineno="1474"><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="_a_e_s_c_c_m_8h_1a5a1cf361100f2ef1d230a5e7273ff24f" kindref="member">AESCCM_SegmentedFinalizeOperation_init</ref>(<ref refid="struct_a_e_s_c_c_m___segmented_finalize_operation" kindref="compound">AESCCM_SegmentedFinalizeOperation</ref><sp/>*operationStruct);</highlight></codeline>
<codeline lineno="1475"><highlight class="normal"></highlight></codeline>
<codeline lineno="1496"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1a74573b19e19c89139951ae345f0ba1fa" kindref="member">AESCCM_oneStepEncrypt</ref>(AESCCM_Handle<sp/>handle,<sp/><ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref><sp/>*operationStruct);</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"></highlight></codeline>
<codeline lineno="1519"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1a5024c43a06ca27339788c6ad6ddd4b87" kindref="member">AESCCM_oneStepDecrypt</ref>(AESCCM_Handle<sp/>handle,<sp/><ref refid="struct_a_e_s_c_c_m___one_step_operation" kindref="compound">AESCCM_OneStepOperation</ref><sp/>*operationStruct);</highlight></codeline>
<codeline lineno="1520"><highlight class="normal"></highlight></codeline>
<codeline lineno="1535"><highlight class="normal">int_fast16_t<sp/><ref refid="_a_e_s_c_c_m_8h_1afc9d5aa7105de5d54f1e380efa0eaef0" kindref="member">AESCCM_cancelOperation</ref>(AESCCM_Handle<sp/>handle);</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"></highlight></codeline>
<codeline lineno="1560"><highlight class="normal">AESCCM_Handle<sp/><ref refid="_a_e_s_c_c_m_8h_1aad168bcba329aef8c1b77b032afb5823" kindref="member">AESCCM_construct</ref>(AESCCM_Config<sp/>*config,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="struct_a_e_s_c_c_m___params" kindref="compound">AESCCM_Params</ref><sp/>*<ref refid="_driver___init_8h_1af93f10d4f7393a01dff58c92f91d8cbc" kindref="member">params</ref>);</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"></highlight></codeline>
<codeline lineno="1562"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>__cplusplus</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1563"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1565"><highlight class="normal"></highlight></codeline>
<codeline lineno="1566"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/></highlight><highlight class="comment">/*<sp/>ti_drivers_AESCCM__include<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
    </programlisting>
    <location file="source/ti/drivers/AESCCM.h"/>
  </compounddef>
</doxygen>
