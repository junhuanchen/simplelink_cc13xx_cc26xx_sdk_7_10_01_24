<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RAM &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
BLE5-Stack User&#39;s Guide
 2.02.08.01 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TI Over-the-Air Download (OAD)" href="../ble-stack-5.x-guide/ble5-oad-index-cc13xx_cc26xx.html" />
    <link rel="prev" title="Flash" href="flash_memory-cc13xx_cc26xx.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug ble-stack-common ram_allocation-cc13xx_cc26xx";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../ble-stack-5.x-guide/index-cc13xx_cc26xx.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
BLE5-Stack User's Guide

          </a>
              <div class="version">
                2.02.08.01
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/disclaimer.html">Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/quickstart-intro-cc13xx_cc26xx.html">Introduction to the SimpleLink CC13xx/CC26xx SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/ble5-quick-start.html">TI BLE5-Stack Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/platform-cc13xx_cc26xx.html">The CC13xx or CC26xx SDK Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/tirtos-index-cc13xx_cc26xx.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/freertos-index.html">FreeRTOS (RTOS Kernel) Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/ble-stack-5-index-cc13xx_cc26xx.html">BLE5-Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/developing-with-sdk-index-cc13xx_cc26xx.html">Developing a Bluetooth LE Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coexistence/coexistence.html">Coexistence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/localization-index-cc13xx_cc26xx.html">RTLS Toolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-mesh/index.html">Bluetooth Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/u-stack-index-cc13xx_cc26xx.html">Micro BLE Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensor-controller/sensor-controller.html">Sensor Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../ble-stack-5.x-guide/memory-index.html">Memory Overview</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="memory_map.html">Memory Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory/memory_management.html">Flash Vector Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory/memory_management.html#customer-configuration-ccfg-table">Customer Configuration (CCFG) Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="flash_memory-cc13xx_cc26xx.html">Flash</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">RAM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ram-vector-table">RAM Vector Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-stack">System Stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-memory-allocation">Dynamic Memory Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-the-heap">Configuring the Heap</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cache">Cache</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#using-the-cache-as-ram">Using the Cache as RAM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aux-ram">AUX RAM</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#using-the-aux-ram-as-ram">Using the AUX RAM as RAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modifying-the-application">Modifying the application</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="npi-index.html">Network Processor Interface (NPI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/ble5-oad-index-cc13xx_cc26xx.html">TI Over-the-Air Download (OAD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/ble5-oad-index-mcuboot.html">MCUBoot Over-the-Air Download (OAD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security-tfm/index.html">Security Features of CC13x4 and CC26x4 Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/sysconfig-index-cc13xx_cc26xx.html">System Configuration Tool (SysConfig)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/migration-cc13xx_cc26xx.html">Porting Guide and Migration Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/api-reference-cc13xx_cc26xx.html">API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/reference-cc13xx_cc26xx.html">Terms and Definitions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../ble-stack-5.x-guide/index-cc13xx_cc26xx.html">
SimpleLink™ CC13XX/CC26XX SDK
BLE5-Stack User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../ble-stack-5.x-guide/index-cc13xx_cc26xx.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../ble-stack-5.x-guide/memory-index.html">Memory Overview</a> &raquo;</li>
      <li>RAM</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="ram">
<span id="ram-allocation-cc13xx-cc26xx"></span><h1>RAM<a class="headerlink" href="#ram" title="Permalink to this headline">¶</a></h1>
<p>There is 80 kB of RAM available in the CC13x2x1 or CC26x2x1, 144 kB in CC13x2x7 or CC26x2x7, and
32 kB in CC13x1x3 or CC26x1x3. The various sections of RAM and their associated linker
files are as follows.</p>
<ul class="simple">
<li><p><strong>CSTACK</strong>: This the system callstack used by the C main function and HWIs.
See <a class="reference internal" href="#sec-memory-management-system-stack"><span class="std std-ref">System Stack</span></a> for more information</p></li>
<li><p><strong>RAM Reset Vector Table</strong>: This table holds entries for all supported
reset vectors. It is initialized from the flash reset vector table at boot
time and is used to plug interrupt table entries at runtime. See
<a class="reference internal" href="#sec-ram-vector-table"><span class="std std-ref">RAM Vector Table</span></a> for more information.</p></li>
<li><p><strong>ROM Reserved RAM</strong>: When building a configuration that links to code in
ROM certain sections of RAM must be reserved for the static allocations
performed in ROM. If the active configuration doesn’t use
ROM, these sections may be used for other purposes.</p></li>
<li><p><strong>HEAP</strong>: See <a class="reference internal" href="#dynamic-memory-allocation"><span class="std std-ref">Dynamic Memory Allocation</span></a> for
information about heaps.</p></li>
</ul>
<p>For projects where the stack project builds a <strong>library</strong>:</p>
<ul class="simple">
<li><p><strong>Application and Stack statically allocated data</strong>: This includes any
initialized and uninitialized variables used by the application or stack.
(.data,.bss)</p></li>
</ul>
<div class="section" id="ram-vector-table">
<span id="sec-ram-vector-table"></span><h2>RAM Vector Table<a class="headerlink" href="#ram-vector-table" title="Permalink to this headline">¶</a></h2>
<p>This table is initialized at kernel boot time with the contents of
the flash vector table. The location of this table is controlled by SysConfig
in the <code class="docutils literal notranslate"><span class="pre">TI</span> <span class="pre">RTOS</span></code> configuration settings, it defaults to address 0x20000000.
The VTOR register will point to this table, which allows the creation of
dynamic interrupts at runtime. This table will contain entries for all 50
supported interrupts.</p>
</div>
<div class="section" id="system-stack">
<span id="sec-memory-management-system-stack"></span><h2>System Stack<a class="headerlink" href="#system-stack" title="Permalink to this headline">¶</a></h2>
<p>As described in <a class="reference internal" href="../ble-stack-tirtos/tasks.html#sec-rtos-overview-tasks"><span class="std std-ref">Tasks</span></a>, each task has its own runtime
stack for context switching. Another runtime stack is used by the RTOS for
main(), HWIs, and SWIs. This system stack is allocated in the
application linker file to be placed at the end of the RAM of the
application.</p>
<p>For IAR, this RTOS system stack is defined by the CSTACK symbol in the <code class="docutils literal notranslate"><span class="pre">.icf</span></code>
file. To change the size of the CSTACK, adjust the STACK_SIZE symbol value (see
highlighted line).</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">     </span><span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="w">     </span><span class="c1">// Stack</span>
<span class="hll"><span class="w">     </span><span class="n">define</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">STACK_SIZE</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mh">0x400</span><span class="p">;</span><span class="w"></span>
</span><span class="w">     </span><span class="n">define</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">STACK_START</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="n">RAM_END</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="n">define</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">STACK_END</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="n">STACK_START</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">STACK_SIZE</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="c1">//</span>
<span class="w">     </span><span class="n">define</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">STACK_TOP</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="n">RAM_END</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">     </span><span class="n">export</span><span class="w"> </span><span class="n">symbol</span><span class="w"> </span><span class="n">STACK_TOP</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">////////////////////////////////////////////////////////////////////////////////</span>
<span class="c1">// Memory Placement</span>
<span class="c1">////////////////////////////////////////////////////////////////////////////////</span>

<span class="c1">//...</span>

<span class="w">      </span><span class="c1">// Runtime Stack</span>
<span class="w">      </span><span class="n">define</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">CSTACK</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">alignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STACK_SIZE</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">section</span><span class="w"> </span><span class="p">.</span><span class="n">stack</span><span class="w"> </span><span class="p">};</span><span class="w"></span>

<span class="c1">//...</span>

<span class="w">      </span><span class="n">define</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">END_OF_RAM</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">fixed</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                                      </span><span class="n">block</span><span class="w"> </span><span class="n">HEAP_END</span><span class="p">,</span><span class="w"></span>
<span class="w">                                      </span><span class="n">block</span><span class="w"> </span><span class="n">CSTACK</span><span class="w"></span>
<span class="w">                                    </span><span class="p">};</span><span class="w"></span>

<span class="n">place</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">RAM</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">END_OF_RAM</span><span class="w"> </span><span class="p">};</span><span class="w"></span>
</pre></div>
</div>
<p>For CCS, the <a class="reference internal" href="../ble-stack-5.x-guide/reference-cc13xx_cc26xx.html#term-RTOS"><span class="xref std std-term">RTOS</span></a> system stack size is defined in the linker file as
shown below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">stack_size</span><span class="o">=</span><span class="mi">1024</span><span class="w">   </span><span class="cm">/* C stack is also used for ISR stack */</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="dynamic-memory-allocation">
<span id="id2"></span><h2>Dynamic Memory Allocation<a class="headerlink" href="#dynamic-memory-allocation" title="Permalink to this headline">¶</a></h2>
<p>The system uses a single heap for dynamic memory allocation. This heap is shared
between TI-RTOS7, the protocol stack, and the application.</p>
<p>The heap configuration is configured via SysConfig inside <code class="docutils literal notranslate"><span class="pre">TI-RTOS</span></code> →
<code class="docutils literal notranslate"><span class="pre">BIOS</span></code> → <code class="docutils literal notranslate"><span class="pre">Default</span> <span class="pre">Heap</span> <span class="pre">Settings</span></code>. Using SysConfig, the heap can be
configured in a few ways. Regardless of the underlying heap
implementation, the APIs to access the heap are common.</p>
<ul class="simple">
<li><p>TI-RTOS7 HeapMem - The flexible heap implementation offered by
the TI-RTOS7 kernel. HeapMem supports creating variable sized blocks as well
as freeing blocks. It is implemented by <code class="docutils literal notranslate"><span class="pre">rtos_heapmem.h</span></code> when using RTOS in
ROM and by direct calls when using RTOS in flash.</p></li>
<li><p>TI-RTOS7 HeapMem with HeapTrack - The most flexible heap implementation
offered by the TI-RTOS7 kernel. HeapMem supports creating variable sized
blocks as well as freeing blocks. It is implemented by <code class="docutils literal notranslate"><span class="pre">rtos_heaptrack.h</span></code>
when using RTOS in ROM and by direct calls when using RTOS in flash.
On top of the functionality offered by HeapMem, HeapTrack offers additional
debugging capability, at the cost of runtime performance. To enable HeapTrack,
select the <code class="docutils literal notranslate"><span class="pre">Use</span> <span class="pre">HeapTrack</span> <span class="pre">with</span> <span class="pre">system</span> <span class="pre">default</span> <span class="pre">heap</span></code> option in SysConfig.</p></li>
</ul>
</div>
<div class="section" id="configuring-the-heap">
<span id="sec-configuring-the-heap"></span><h2>Configuring the Heap<a class="headerlink" href="#configuring-the-heap" title="Permalink to this headline">¶</a></h2>
<p>The heap configuration is configured via SysConfig inside <code class="docutils literal notranslate"><span class="pre">TI-RTOS</span></code> →
<code class="docutils literal notranslate"><span class="pre">BIOS</span></code> → <code class="docutils literal notranslate"><span class="pre">Default</span> <span class="pre">Heap</span> <span class="pre">Settings</span></code>.</p>
<p>For more information regarding configuration options, please refer to
Section 7.4 Heap Implementations of the <a class="reference external" href="../../../../tirtos7/Bios_User_Guide.pdf">TI-RTOS7 Kernel (SYS/BIOS) User’s Guide</a>.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>When using static heap size, it’s a good idea to review the heap size thoroughly.</p>
</div>
</div>
<div class="section" id="cache">
<h2>Cache<a class="headerlink" href="#cache" title="Permalink to this headline">¶</a></h2>
<p>The cache is an 8 kB section of the device’s RAM reserved for the
processor. The cache module temporarily stores data that has been read from the
Flash, so that frequently used data is not fetched from Flash on each access.
This reduces the number of CPU wait-states and saves power. When the cache is
not used, it is not powered. This is true for Standby and Idle states where the
cache is not in use.</p>
<div class="section" id="using-the-cache-as-ram">
<span id="section-cache-as-ram"></span><h3>Using the Cache as RAM<a class="headerlink" href="#using-the-cache-as-ram" title="Permalink to this headline">¶</a></h3>
<p>The cache can be disabled temporarily or permanently and used as RAM instead.
A disabled cache will result in a slower execution time for software because all
data needs to be fetched from flash. This increases the device power
consumption. If you want to temporarily disable the chache for extra RAM at
runtime, jump ahead to the <a class="reference internal" href="#section-cache-as-ram-dynamic-gpram"><span class="std std-ref">Dynamic GPRAM</span></a> section. If
you want to permanently allocate cache for RAM usage, see the
<a class="reference internal" href="#section-cache-as-ram-configure-cache"><span class="std std-ref">Configure the Cache as GPRAM</span></a> section.</p>
<p>If your application needs more memory, or if you need more space in SRAM, the
cache can be re-purposed as RAM. This will allow the linker to store parts of
the compiled application in this section of the RAM. This section will be
referred to as the general purpose RAM (<a class="reference internal" href="../ble-stack-5.x-guide/reference-cc13xx_cc26xx.html#term-GPRAM"><span class="xref std std-term">GPRAM</span></a>). This will cause the
program to run at a slightly reduced speed, and it will increase the device
power consumption in sleep. This is because the <a class="reference internal" href="../ble-stack-5.x-guide/reference-cc13xx_cc26xx.html#term-GPRAM"><span class="xref std std-term">GPRAM</span></a>, contrary to a
cache, will have to be powered even when the device is sleeping. The current
consumption in standby mode with and without cache retained is listed in the
CC13xx or CC26xx datasheet. How this will affect the device power consumption will
depend on application. For some applications the added power consumption will be
very small, but for processing intensive application it will be slightly higher.
Please verify your application current consumption by using the method described
in the
<a class="reference external" href="http://www.ti.com/lit/pdf/swra478">Measuring CC13xx and CC26xx current consumption (SWRA478)</a>.</p>
<div class="section" id="configure-the-cache-as-gpram">
<span id="section-cache-as-ram-configure-cache"></span><h4>Configure the Cache as GPRAM<a class="headerlink" href="#configure-the-cache-as-gpram" title="Permalink to this headline">¶</a></h4>
<p>In order to enable using the cache as RAM, two things need to be done. Firstly, the
program must be told to retain the cache/GPRAM when it’s being used. Secondly,
the linker must be told to allocate the memory region used as cache to GPRAM,
and what parts of code to store in the GPRAM. This is done in the linker
command/configuration file. The syntax for the linker command/configuration
file is slightly different in CCS and IAR. To read more about the CCS linker
command file, see the article <a class="reference external" href="http://software-dl.ti.com/ccs/esd/documents/sdto_cgt_Linker-Command-File-Primer.html">Linker Command File Primer</a>.
To read more about the IAR linker, see <a class="reference external" href="http://ftp.iar.se/WWWfiles/arm/webic/doc/EWARM_DevelopmentGuide.ENU.pdf">IAR C/C++ Development Guide</a>.</p>
<p><strong>If you want to use the cache as RAM in a project, follow these steps:</strong></p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The steps will be different for CCS users and IAR users. The steps will
also differ depending on what example project your project is based on. For
the example projects found in the BLE5-Stack folder, only step 1-5 will be
required.</p>
</div>
<p>1. In the syscfg file, go to <em>TI Devices</em> → <em>Device Configuration</em> and
select <em>Disable Flash Cache</em></p>
<ol class="arabic simple" start="2">
<li><p>In <code class="docutils literal notranslate"><span class="pre">main()</span></code>, add the following code:</p></li>
</ol>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-number">Listing 202. </span><span class="caption-text">Retain cache in sleep.</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#ifdef CACHE_AS_RAM</span>
<span class="c1">// retain cache during standby</span>
<span class="n">Power_setConstraint</span><span class="p">(</span><span class="n">PowerCC26XX_SB_VIMS_CACHE_RETAIN</span><span class="p">);</span><span class="w"></span>
<span class="n">Power_setConstraint</span><span class="p">(</span><span class="n">PowerCC26XX_NEED_FLASH_IN_IDLE</span><span class="p">);</span><span class="w"></span>
<span class="cp">#else</span>
<span class="c1">// Enable iCache pre-fetching</span>
<span class="n">VIMSConfigure</span><span class="p">(</span><span class="n">VIMS_BASE</span><span class="p">,</span><span class="w"> </span><span class="n">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">TRUE</span><span class="p">);</span><span class="w"></span>
<span class="c1">// Enable cache</span>
<span class="n">VIMSModeSet</span><span class="p">(</span><span class="n">VIMS_BASE</span><span class="p">,</span><span class="w"> </span><span class="n">VIMS_MODE_ENABLED</span><span class="p">);</span><span class="w"></span>
<span class="cp">#endif </span><span class="c1">//CACHE_AS_RAM</span>
</pre></div>
</div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Please make sure your program is not using <a class="reference internal" href="../ble-stack-5.x-guide/reference-cc13xx_cc26xx.html#term-VIMS"><span class="xref std std-term">VIMS</span></a> while using cache as RAM.</p>
</div>
</div></blockquote>
<p>In the same file, include the following files:</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Power Driver */</span><span class="w"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ti/drivers/Power.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ti/drivers/power/PowerCC26XX.h&gt;</span><span class="cp"></span>
<span class="cm">/* Header files required to enable instruction fetch cache */</span><span class="w"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ti/devices/cc26x0r2/inc/hw_memmap.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ti/devices/cc26x0r2/driverlib/vims.h&gt;</span><span class="cp"></span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Go to the <strong>compiler</strong> predefines and add <code class="docutils literal notranslate"><span class="pre">CACHE_AS_RAM</span></code>.</p></li>
</ol>
<p>4. The GPRAM memory area must be defined in the linker command file. This
syntax is different for the CCS and IAR linker. IAR specific instructions
will follow the CCS specific instructions.</p>
<p>In CCS, the linker command file ends with <code class="docutils literal notranslate"><span class="pre">.cmd</span></code> (e.g.
<code class="docutils literal notranslate"><span class="pre">cc13x2_cc26x2_app.cmd</span></code>).</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-number">Listing 203. </span><span class="caption-text">CCS Linker File. Under <code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">Sizes</span></code>, add defines for GPRAM
start and length.</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  /*******************************************************************************
   * Memory Sizes
   */
  #define FLASH_BASE   0x00000000
  #define GPRAM_BASE   0x11000000
  #define RAM_BASE     0x20000000
  #define ROM_BASE     0x10000000

  #define FLASH_SIZE   0x00058000
  #define GPRAM_SIZE   0x00002000
  #define RAM_SIZE     0x00014000
  #define ROM_SIZE     0x00040000
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-number">Listing 204. </span><span class="caption-text">Add GPRAM under <code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">Definitions</span></code>.</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="cm">/*******************************************************************************</span>
<span class="cm">   * GPRAM</span>
<span class="cm">   */</span><span class="w"></span>

<span class="w">  </span><span class="cp">#ifdef CACHE_AS_RAM</span>
<span class="w">    </span><span class="cp">#define GPRAM_START GPRAM_BASE</span>
<span class="w">    </span><span class="cp">#define GPRAM_END   (GPRAM_START + GPRAM_SIZE - 1)</span>
<span class="w">  </span><span class="cp">#endif </span><span class="cm">/* CACHE_AS_RAM */</span><span class="cp"></span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-number">Listing 205. </span><span class="caption-text">In <code class="docutils literal notranslate"><span class="pre">MEMORY{}</span></code>, allocate room for GPRAM.</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    #ifdef CACHE_AS_RAM
      GPRAM(RWX) : origin = GPRAM_START, length = GPRAM_SIZE
    #endif /* CACHE_AS_RAM */
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<span id="mm-cacheasram-ccs-code"></span><div class="code-block-caption"><span class="caption-number">Listing 206. </span><span class="caption-text">In <code class="docutils literal notranslate"><span class="pre">SECTIONS{}</span></code>, move .bss from SRAM to GPRAM.</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  GROUP &gt; SRAM
  {
    .data
    #ifndef CACHE_AS_RAM
    .bss
    #endif /* CACHE_AS_RAM */
    .vtable
    .vtable_ram
    vtable_ram
    .sysmem
    .nonretenvar

  } LOAD_END(heapStart)

  .stack            :   &gt;  SRAM (HIGH) LOAD_START(heapEnd)

  #ifdef CACHE_AS_RAM
  .bss :
  {
    *(.bss)
  } &gt; GPRAM
  #endif /* CACHE_AS_RAM */
</pre></div>
</div>
</div>
<p>Rebuild your application. This will move <a class="reference internal" href="../ble-stack-5.x-guide/reference-cc13xx_cc26xx.html#term-.bss"><span class="xref std std-term">.bss</span></a> from SRAM to GPRAM and
place the auto-heap size start after. Other objects can also be moved. See
<a class="reference internal" href="#using-the-aux-as-ram"><span class="std std-ref">Using the AUX RAM as RAM</span></a> for an example of this.</p>
<p>In IAR, the linker configuration file ends with <code class="docutils literal notranslate"><span class="pre">.icf</span></code> (e.g.
<code class="docutils literal notranslate"><span class="pre">cc26xx_app.icf</span></code>).</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-number">Listing 207. </span><span class="caption-text">IAR Linker File. Add defines for GPRAM start and length under
<code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">Definitions</span></code>.</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  //////////////////////////////////////////////////////////////////////////////
  // GPRAM
  //
  if ( isdefinedsymbol(CACHE_AS_RAM) )
  {
    define symbol GPRAM_START           = 0x11000000;
    define symbol GPRAM_SIZE            = 0x2000;
    define symbol GPRAM_END             = GPRAM_START + GPRAM_SIZE;
  }
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-number">Listing 208. </span><span class="caption-text">Under <code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">Regions</span></code>, allocate room for GPRAM.</span><a class="headerlink" href="#id10" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  if ( isdefinedsymbol(CACHE_AS_RAM) )
  {
    define region GPRAM               = mem:[from GPRAM_START to GPRAM_END];
  }
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id11">
<span id="mm-cacheasram-iar-code"></span><div class="code-block-caption"><span class="caption-number">Listing 209. </span><span class="caption-text">Under <code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">Placement</span></code>, move .bss from SRAM to GPRAM.</span><a class="headerlink" href="#id11" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  if ( isdefinedsymbol(CACHE_AS_RAM) )
  {
    // GPRAM
    define block GPDATA { section .bss };
    place in GPRAM { block GPDATA } except { object ll.o };
  }
</pre></div>
</div>
</div>
<p>Rebuild your application. This will move <a class="reference internal" href="../ble-stack-5.x-guide/reference-cc13xx_cc26xx.html#term-.bss"><span class="xref std std-term">.bss</span></a> from SRAM to GPRAM. Other
objects can also be moved. See <a class="reference internal" href="#using-the-aux-as-ram"><span class="std std-ref">Using the AUX RAM as RAM</span></a> for an example
of this.</p>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="dynamic-gpram">
<span id="section-cache-as-ram-dynamic-gpram"></span><h4>Dynamic GPRAM<a class="headerlink" href="#dynamic-gpram" title="Permalink to this headline">¶</a></h4>
<p>In this mode, the cache will be temporarily used as RAM. At all other
times, the cache will operate as normal. The current consumption changes are
described in the <a class="reference internal" href="#section-cache-as-ram-configure-cache"><span class="std std-ref">Configure the Cache as GPRAM</span></a> section.</p>
<p>An example use-case is a device that sometimes receives or sends a data stream
with a high throughput. When the device is not streaming, it can use the cache
as usual. When the device receives the signal to start streaming, the device
disables the cache and uses the GPRAM to store a buffer for the stream. When the
device receives the command to stop streaming, the memory is freed and the cache
is re-enabled.</p>
<p>To use the <a class="reference internal" href="../ble-stack-5.x-guide/reference-cc13xx_cc26xx.html#term-GPRAM"><span class="xref std std-term">GPRAM</span></a> to dynamically store a data buffer, follow these steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>In order to use this functionality, the following files should be
included:</p></li>
</ol>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ti/sysbios/family/arm/m3/Hwi.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ti/drivers/Power.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ti/drivers/power/PowerCC26XX.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ti/devices/cc13x2_cc26x2/driverlib/vims.h&gt;</span><span class="cp"></span>
</pre></div>
</div>
<p>2. In the application, make sure you disable the cache when before you start
using the memory area. Use <a class="reference internal" href="../ble-stack-5.x-guide/reference-cc13xx_cc26xx.html#term-VIMS"><span class="xref std std-term">VIMS</span></a> and the power driver.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*********************************************************************</span>
<span class="cm">* @fn      SimplePeripheral_disableCache</span>
<span class="cm">*</span>
<span class="cm">* @brief   Disables the instruction cache and sets power constaints</span>
<span class="cm">*          This prevents the device from sleeping while streaming</span>
<span class="cm">*</span>
<span class="cm">* @param   None.</span>
<span class="cm">*</span>
<span class="cm">* @return  None.</span>
<span class="cm">*/</span><span class="w"></span>
<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">SimplePeripheral_disableCache</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint_least16_t</span><span class="w"> </span><span class="n">hwiKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hwi_disable</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">Power_setConstraint</span><span class="p">(</span><span class="n">PowerCC26XX_SB_VIMS_CACHE_RETAIN</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Power_setConstraint</span><span class="p">(</span><span class="n">PowerCC26XX_NEED_FLASH_IN_IDLE</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">VIMSModeSafeSet</span><span class="p">(</span><span class="n">VIMS_BASE</span><span class="p">,</span><span class="w"> </span><span class="n">VIMS_MODE_DISABLED</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Hwi_restore</span><span class="p">(</span><span class="n">hwiKey</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Make sure to re-enable the cache after you are finished using it.</p></li>
</ol>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*********************************************************************</span>
<span class="cm">* @fn      SimplePeripheral_enableCache</span>
<span class="cm">*</span>
<span class="cm">* @brief   Enables the instruction cache and releases power constaints</span>
<span class="cm">*          Allows device to sleep again</span>
<span class="cm">*</span>
<span class="cm">* @param   None.</span>
<span class="cm">*</span>
<span class="cm">* @return  None.</span>
<span class="cm">*/</span><span class="w"></span>
<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">SimplePeripheral_enableCache</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint_least16_t</span><span class="w"> </span><span class="n">hwiKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Hwi_disable</span><span class="p">();</span><span class="w"></span>
<span class="w">    </span><span class="n">Power_releaseConstraint</span><span class="p">(</span><span class="n">PowerCC26XX_SB_VIMS_CACHE_RETAIN</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Power_releaseConstraint</span><span class="p">(</span><span class="n">PowerCC26XX_NEED_FLASH_IN_IDLE</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">VIMSModeSafeSet</span><span class="p">(</span><span class="n">VIMS_BASE</span><span class="p">,</span><span class="w"> </span><span class="n">VIMS_MODE_ENABLED</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">Hwi_restore</span><span class="p">(</span><span class="n">hwiKey</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>4. We will use the <code class="docutils literal notranslate"><span class="pre">GPRAM_BASE</span></code> define from <code class="docutils literal notranslate"><span class="pre">hw_memmap.h</span></code>.
<code class="docutils literal notranslate"><span class="pre">hw_memmap.h</span></code> contains defines for the base addresses of the memories and
peripherals on the CC13xx or CC26xx.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define GPRAM_BASE   0x11000000</span>
</pre></div>
</div>
<p>In the application file, initialize the buffer:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Initialize buffer</span>
<span class="k">static</span><span class="w"> </span><span class="kt">int16_t</span><span class="w"> </span><span class="o">*</span><span class="n">gpram_buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Disable instruction cache to use for the buffer</span>
<span class="n">SimplePeripheral_disableCache</span><span class="p">();</span><span class="w"></span>
<span class="n">gpram_buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int16_t</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">GPRAM_BASE</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Use the buffer:</p></li>
</ol>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gpram_buffer</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Use buffer</span>
<span class="w">    </span><span class="n">gpram_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">gpram_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Remember to free the memory and re-enable the cache when the buffer is no
longer in use.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//Buffer no longer needed</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">gpram_buffer</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">gpram_buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="n">SimplePeripheral_enableCache</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="aux-ram">
<h2>AUX RAM<a class="headerlink" href="#aux-ram" title="Permalink to this headline">¶</a></h2>
<p>The AUX RAM is a 4 kB memory area belonging to the
<a class="reference internal" href="../sensor-controller/sensor-controller.html#sensor-controller"><span class="std std-ref">Sensor Controller</span></a>. This is not available on CC13x1x3 or CC26x1x3 devices.</p>
<div class="section" id="using-the-aux-ram-as-ram">
<span id="using-the-aux-as-ram"></span><h3>Using the AUX RAM as RAM<a class="headerlink" href="#using-the-aux-ram-as-ram" title="Permalink to this headline">¶</a></h3>
<p>For variants other than the CC13x1x3 or CC26x1x3, you can use this memory as RAM for
your application if the Sensor Controller is not used. However, access to this
memory is significantly slower than access to the SRAM. This may lead to
increased power consumption and slower program execution. Additionally, if using
the AUX RAM as RAM it is important that you test <strong>thoroughly</strong>. Certain
objects, when put in AUX RAM can cause the application to crash. One should test
for each object they want to store in AUX RAM.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The user application can do other tasks while the data is being
transferred to AUX RAM, but if the bus buffer gets full during back to back
writes, it will stall the AP until there is free space in the buffer. After
you write a series of data to AUX RAM you should implement a singe read access
to make sure all the data has been written. The read access will stall the AP
until all the data has been transferred to AUX RAM.</p>
</div>
</div>
<div class="section" id="modifying-the-application">
<h3>Modifying the application<a class="headerlink" href="#modifying-the-application" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Open the project properties and add the symbol <code class="docutils literal notranslate"><span class="pre">AUX_AS_RAM=1</span></code> to the linker options:</p></li>
</ol>
<ul class="simple">
<li><p>In CCS, right click on the Project → select Properties → Build → ARM Linker → Advanced Options → Command File Preprocessing. Click on the small <strong>Add…</strong> button at the top right of the box <em>Pre-define preprocessor macro _name_to_value_</em> and type the symbol <code class="docutils literal notranslate"><span class="pre">AUX_AS_RAM=1</span></code>.</p></li>
<li><p>In IAR, right click on the Project → Options → Linker. Locate the box <em>Configuration file symbol definitions</em> and type the symbol <code class="docutils literal notranslate"><span class="pre">AUX_AS_RAM=1</span></code>.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Modify the linker command/configuration file. Each toolchain has different options, pragmas and syntax, therefore check the steps below for the three supported toolchains: TI ARMCL, TI ARM Clang and IAR.</p></li>
</ol>
<p><strong>TI ARMCL:</strong></p>
<ul>
<li><p>In the linker command file <code class="docutils literal notranslate"><span class="pre">cc26xx_app.cmd</span></code>, define the AUX_RAM
memory area:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#ifdef AUX_AS_RAM
#define AUX_RAM_BASE            0x400E0000
#define AUX_RAM_SIZE            0x800
#endif /* AUX_AS_RAM */
</pre></div>
</div>
</li>
<li><p>Create a AUX_RAM memory section in <code class="docutils literal notranslate"><span class="pre">MEMORY{}</span></code></p></li>
</ul>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#ifdef AUX_AS_RAM
AUX_RAM (RWX) : origin = AUX_RAM_BASE, length = AUX_RAM_SIZE
#endif /* AUX_AS_RAM */
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p>Add sections of memory or code to AUX_RAM in <code class="docutils literal notranslate"><span class="pre">SECTIONS{}</span></code></p>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-number">Listing 210. </span><span class="caption-text">Move object files into AUX_RAM. Example from simple_peripheral (<code class="docutils literal notranslate"><span class="pre">cc26xx_app.cmd</span></code>).</span><a class="headerlink" href="#id12" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#ifdef AUX_AS_RAM
  reorganized_into_auxram
  {
    simple_peripheral.obj(.data)
    devinfoservice.obj(.data)
    simple_gatt_profile.obj(.data)
    icall.obj(.data)
    board.obj(.bss)
    } &gt; AUX_RAM
#endif/* AUX_AS_RAM */
</pre></div>
</div>
</div>
</li>
</ul>
<p>The .obj files are listed in the FlashROM folder of the app project.
They are also listed with size in the .map file. A detailed
description of the linker command file and memory sections is given
in this article <a class="reference external" href="http://software-dl.ti.com/ccs/esd/documents/sdto_cgt_Linker-Command-File-Primer.html">Linker Command File Primer</a>.</p>
<p>If you want more control over what is stored in AUX_RAM, individual
variables can be stored there with the <code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">DATA_SECTION</span></code> command.
Please note that this is only possible for global variables.</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-number">Listing 211. </span><span class="caption-text">Move the global <em>display handle</em> variable into a new  AUX RAM section called <code class="docutils literal notranslate"><span class="pre">my_section</span></code>.</span><a class="headerlink" href="#id13" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Display Interface</span>
<span class="cp">#pragma DATA_SECTION(dispHandle, &quot;my_section&quot;)</span>
<span class="n">Display_Handle</span><span class="w"> </span><span class="n">dispHandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div></blockquote>
<p>You can find <code class="docutils literal notranslate"><span class="pre">my_section</span></code> in the map-file. Here you will find the names of the
objects included in <code class="docutils literal notranslate"><span class="pre">my_section</span></code>. In this case, the object is
<code class="docutils literal notranslate"><span class="pre">simple_peripheral.obj</span> <span class="pre">(my_section)</span></code>.</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-number">Listing 212. </span><span class="caption-text">In the linker command file (<code class="docutils literal notranslate"><span class="pre">cc26xx_app.cmd</span></code>), add the section to AUX_RAM.</span><a class="headerlink" href="#id14" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#ifdef AUX_AS_RAM
  reorganized_into_auxram
  {
    simple_peripheral.obj(my_section)
  } &gt; AUX_RAM
#endif /* AUX_AS_RAM */
</pre></div>
</div>
</div>
</div></blockquote>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When making alterations only to the linker command file, please make sure to
press <em>Rebuild</em>, not just <em>Build</em>.
(CCS will not recognize that you have made changes to the project before you
press <em>Rebuild</em>.)</p>
</div>
<p><strong>TI ARM Clang:</strong></p>
<p>The linker command file is very similar to the TI ARMCL toolchain. For additional details, check chapter 5 of the <a class="reference external" href="https://software-dl.ti.com/codegen/docs/tiarmclang/rel1_0_0_sts/tiarmclang_ug/tiarmclang-portfolio/index.html">TI ARM Clang User’s Guide</a>.</p>
<ul>
<li><p>In the linker command file <code class="docutils literal notranslate"><span class="pre">cc26xx_app.cmd</span></code>, define the AUX_RAM memory area:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#ifdef AUX_AS_RAM
#define AUX_RAM_BASE            0x400E0000
#define AUX_RAM_SIZE            0x800
#endif /* AUX_AS_RAM */
</pre></div>
</div>
</li>
<li><p>Create a AUX_RAM memory section in <code class="docutils literal notranslate"><span class="pre">MEMORY{}</span></code></p></li>
</ul>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#ifdef AUX_AS_RAM
AUX_RAM (RWX) : origin = AUX_RAM_BASE, length = AUX_RAM_SIZE
#endif /* AUX_AS_RAM */
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p>Add sections of memory or code to AUX_RAM in <code class="docutils literal notranslate"><span class="pre">SECTIONS{}</span></code></p>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-number">Listing 213. </span><span class="caption-text">Move object files into AUX_RAM. Example from simple_peripheral (<code class="docutils literal notranslate"><span class="pre">cc26xx_app.cmd</span></code>).</span><a class="headerlink" href="#id15" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#ifdef AUX_AS_RAM
  reorganized_into_auxram
  {
    simple_peripheral.o(.data)
    devinfoservice.o(.data)
    simple_gatt_profile.o(.data)
    icall.o(.data)
    board.o(.bss)
    } &gt; AUX_RAM
#endif/* AUX_AS_RAM */
</pre></div>
</div>
</div>
</li>
</ul>
<p>The .o files are listed in the FlashROM folder of the app project.
They are also listed with size in the .map file. A detailed description of the
linker command file and memory sections is given in this article <a class="reference external" href="http://software-dl.ti.com/ccs/esd/documents/sdto_cgt_Linker-Command-File-Primer.html">Linker Command File Primer</a>.</p>
<p>If you want more control over what is stored in AUX_RAM, individual
variables can be stored there with the <code class="docutils literal notranslate"><span class="pre">__attribute__((section(&quot;section_name&quot;)))</span></code> command.
Please note that this is only possible for global variables.</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-number">Listing 214. </span><span class="caption-text">Move the global <em>display handle</em> variable into a new  AUX RAM section called <code class="docutils literal notranslate"><span class="pre">my_section</span></code>.</span><a class="headerlink" href="#id16" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Display Interface</span>
<span class="n">__attribute__</span><span class="p">((</span><span class="n">section</span><span class="p">(</span><span class="s">&quot;my_section&quot;</span><span class="p">)))</span><span class="w"></span>
<span class="n">Display_Handle</span><span class="w"> </span><span class="n">dispHandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div></blockquote>
<p>You can find <code class="docutils literal notranslate"><span class="pre">my_section</span></code> in the map-file. Here you will find the names of the
objects included in <code class="docutils literal notranslate"><span class="pre">my_section</span></code>. In this case, the object is
<code class="docutils literal notranslate"><span class="pre">simple_peripheral.o</span> <span class="pre">(my_section)</span></code>.</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-number">Listing 215. </span><span class="caption-text">In the linker command file (<code class="docutils literal notranslate"><span class="pre">cc26xx_app.cmd</span></code>), add the section to AUX_RAM.</span><a class="headerlink" href="#id17" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#ifdef AUX_AS_RAM
  reorganized_into_auxram
  {
    simple_peripheral.o(my_section)
  } &gt; AUX_RAM
#endif /* AUX_AS_RAM */
</pre></div>
</div>
</div>
</div></blockquote>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When making alterations only to the linker command file, please make sure to
press <em>Rebuild</em>, not just <em>Build</em>.
(CCS will not recognize that you have made changes to the project before you
press <em>Rebuild</em>.)</p>
</div>
<p><strong>IAR:</strong></p>
<ul>
<li><p>Open the linker configuration file <code class="docutils literal notranslate"><span class="pre">cc26xx_app.icf</span></code>. Under <code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">Definitions</span></code>, add</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>////////////////////////////////////////////////////////////////////////////////
// AUX_RAM
//
if ( isdefinedsymbol(AUX_AS_RAM) )
{
  define symbol AUX_RAM_START        = 0x400E0000;
  define symbol AUX_RAM_SIZE         = 0x800;
  define symbol AUX_RAM_END          = AUX_RAM_START + AUX_RAM_SIZE;
}
</pre></div>
</div>
</li>
<li><p>Under <code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">Regions</span></code>, add</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if ( isdefinedsymbol(AUX_AS_RAM) )
{
  define region AUX_RAM               = mem:[from AUX_RAM_START to AUX_RAM_END];
}
</pre></div>
</div>
</li>
<li><p>Under <code class="docutils literal notranslate"><span class="pre">Memory</span> <span class="pre">Placement</span></code>, add</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-number">Listing 216. </span><span class="caption-text">Move object files into AUX_RAM. Example from simple_peripheral (<code class="docutils literal notranslate"><span class="pre">cc26xx_app.icf</span></code>).</span><a class="headerlink" href="#id18" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if ( isdefinedsymbol(AUX_AS_RAM) )
{
  // AUX_RAM
  define block AUXDATA { section .data object simple_peripheral.o,
                         section .data object devinfoservice.o,
                         section .data object simple_gatt_profile,
                         section .data object icall.o,
                         section .data object board.o};
  place in AUX_RAM { block AUXDATA };
}
</pre></div>
</div>
</div>
</li>
</ul>
<p>The .o-files are listed in the .map file. For more information on the linker
configuration file, please see <a class="reference external" href="http://ftp.iar.se/WWWfiles/arm/webic/doc/EWARM_DevelopmentGuide.ENU.pdf">IAR C/C++ Development Guide</a>.</p>
<p>If you want more control over what is stored in AUX_RAM, individual
variables can be stored there with the <code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">location</span></code> command.
Please note that this is only possible for global variables.</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-number">Listing 217. </span><span class="caption-text">Move the global <em>display handle</em> variable into a new Cache RAM section called <code class="docutils literal notranslate"><span class="pre">my_section</span></code>.</span><a class="headerlink" href="#id19" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Display Interface</span>
<span class="cp">#pragma location=&quot;my_section&quot;</span>
<span class="n">Display_Handle</span><span class="w"> </span><span class="n">dispHandle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</div>
</div></blockquote>
<p>You can find <code class="docutils literal notranslate"><span class="pre">my_section</span></code> in the map-file. Here you will find the names of the
objects included in <code class="docutils literal notranslate"><span class="pre">my_section</span></code>. In this case, the object is
<code class="docutils literal notranslate"><span class="pre">simple_peripheral.o</span> <span class="pre">(my_section)</span></code>.</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-number">Listing 218. </span><span class="caption-text">In the linker configuration file (<code class="docutils literal notranslate"><span class="pre">cc26xx_app.cmd</span></code>), add the section to AUX_RAM.</span><a class="headerlink" href="#id20" title="Permalink to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>if ( isdefinedsymbol(AUX_AS_RAM) )
{
  // AUX_RAM
  define block AUXDATA { section my_section object simple_peripheral.o };
  place in AUX_RAM { block AUXDATA };
}
</pre></div>
</div>
</div>
</div></blockquote>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="flash_memory-cc13xx_cc26xx.html" class="btn btn-neutral float-left" title="Flash" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../ble-stack-5.x-guide/ble5-oad-index-cc13xx_cc26xx.html" class="btn btn-neutral float-right" title="TI Over-the-Air Download (OAD)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2010-2022, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>