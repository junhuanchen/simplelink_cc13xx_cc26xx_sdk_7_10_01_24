<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Frequency-Hopping Mode &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
TI 15.4-Stack User&#39;s Guide
 6.10.01.00 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ARIB Regulation Type" href="arib-regulation-type.html" />
    <link rel="prev" title="Non-Beacon Mode" href="non-beacon-mode.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug ti154stack frequency-hopping-mode";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../ti154stack-guide/index-cc13xx_cc26xx.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
TI 15.4-Stack User's Guide

          </a>
              <div class="version">
                6.10.01.00
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/quickstart-intro-cc13xx_cc26xx.html">Introduction to the SimpleLink CC13xx/CC26xx SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/index-platform.html">SimpleLink Wireless MCU CC13xx and CC26xx Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/tirtos-index-cc13xx_cc26xx.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../ti154stack-guide/ti154stack-index-cc13xx_cc26xx.html">TI 15.4-Stack</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ti154stack-overview-cc13xx_cc26xx.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="ti154stack-overview-cc13xx_cc26xx.html#architecture-choices">Architecture Choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="ti154stack-overview-cc13xx_cc26xx.html#data-rate-and-phy">Data Rate and PHY</a></li>
<li class="toctree-l2"><a class="reference internal" href="application-overview.html">Application Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="example-applications.html">Example Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-user-interface.html">Common User Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="secure-commissioning.html">Secure Commissioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="beacon-mode.html">Beacon Enabled Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="non-beacon-mode.html">Non-Beacon Mode</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Frequency-Hopping Mode</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#network-operations">Network Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-start-up">Network Start-Up</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-start-up">Device Start-Up</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-join">Network Join</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-exchange">Data Exchange</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stack-configuration-knobs">Stack Configuration Knobs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="arib-regulation-type.html">ARIB Regulation Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring-stack.html">Configuring Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="packet-sniffer.html">SmartRF Protocol Packet Sniffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-custom-applications.html">Creating Custom Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cc13xx_cc26xx/fcc-certification.html">FCC Certification Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ti154stack-guide/oad-secure-index.html">Over-the-Air Download (OAD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ti154stack-guide/sysconfig-index.html">System Configuration (SysConfig)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/custom-hardware-cc13xx_cc26xx.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coexistence/coexistence-ieee.html">Wi-Fi Coexistence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/memory-index.html">Memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security-tfm/index.html">Security Features of CC13x4 and CC26x4 Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/migration-guide-cc13xx_cc26xx.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html">API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#terms-and-acronyms">Terms and Acronyms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../ti154stack-guide/index-cc13xx_cc26xx.html">
SimpleLink™ CC13XX/CC26XX SDK
TI 15.4-Stack User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../ti154stack-guide/index-cc13xx_cc26xx.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../ti154stack-guide/ti154stack-index-cc13xx_cc26xx.html">TI 15.4-Stack</a> &raquo;</li>
      <li>Frequency-Hopping Mode</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="frequency-hopping-mode">
<span id="sec-frequency-hopping"></span><h1>Frequency-Hopping Mode<a class="headerlink" href="#frequency-hopping-mode" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<span id="sec-fh-intro"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Applications that are developed using TI 15.4-Stack can be configured to
operate the network in frequency-hopping configuration where the network
devices hop on different frequencies. TI 15.4-Stack supports an unslotted
channel-hopping feature based on the directed frame exchange (<a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-DFE"><span class="xref std std-term">DFE</span></a>) mode
of the <a class="reference external" href="https://www.wi-sun.org">Wi-SUN FAN specification</a> v1.0.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Frequency hopping is only supported on Sub-1 GHz frequency bands.</p>
</div>
<p>Two types of end devices are supported:</p>
<ul class="simple">
<li><p><strong>Sleepy End Device</strong>: These devices do not change channels by themselves
but follow that of the collector. All communication to these devices should
be made using short addressing.</p></li>
<li><p><strong>Non-Sleepy End Device</strong>: These devices can either hop on multiple
channels based on direct hash channel function (DH1CF) or operate on a
fixed channel based on the channel function configuration. All
communication to these devices should be made using extended address mode.</p></li>
</ul>
<p>The Collector device can either hop on multiple channels based on direct hash
channel function <a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-DH1CF"><span class="xref std std-term">DH1CF</span></a> or operate on a fixed channel based on
the channel function configuration.</p>
<p>DH1CF generates a pseudo-random sequence of channels on which to hop based on
the extended address of the node; thus, the pseudo-random sequence of channels
is unique to each node. Each node supports two types of channel-hopping
sequences:</p>
<ul class="simple">
<li><p>Unicast</p></li>
<li><p>Broadcast</p></li>
</ul>
<p>Frequency hopping for each node is based on the unicast channel hopping
sequence of those nodes (see <a class="reference internal" href="#fig-unicast-sequence"><span class="std std-numref">Figure 68.</span></a>).</p>
<div class="figure align-center" id="fig-unicast-sequence">
<img alt="../_images/fig-unicast-sequence.png" src="../_images/fig-unicast-sequence.png" />
<p class="caption"><span class="caption-number">Figure 68. </span><span class="caption-text">Unicast Hopping Sequence</span><a class="headerlink" href="#fig-unicast-sequence" title="Permalink to this image">¶</a></p>
</div>
<p>To enable broadcast transmissions, the coordinator starts a broadcast schedule
(see <a class="reference internal" href="#fig-broadcast-sequence"><span class="std std-numref">Figure 69.</span></a>). Every other device follows the
broadcast-hopping sequence received from the PAN coordinator. A device performs
unicast hopping until the next broadcast dwell time. Then, the device switches
to the broadcast- hopping channel for the broadcast dwell time and resumes
unicast hopping at the end of the broadcast dwell interval.</p>
<div class="figure align-center" id="fig-broadcast-sequence">
<img alt="../_images/fig-broadcast-sequence.png" src="../_images/fig-broadcast-sequence.png" />
<p class="caption"><span class="caption-number">Figure 69. </span><span class="caption-text">Broadcast Channel Hopping Sequence</span><a class="headerlink" href="#fig-broadcast-sequence" title="Permalink to this image">¶</a></p>
</div>
<p>The application can specify the broadcast dwell interval (default is 250 ms),
channel hopping function (default is Fixed Channel), and the list of channels
to hop (based on PHY Descriptor ID; for example, the default value of 1
represents 129 channels). Additionally, the broadcast interval (default is 4250
ms) can be specified on the PAN coordinator. When the hopping function is set
to <em>Fixed</em>, the node must stay on the channel set by
<code class="docutils literal notranslate"><span class="pre">ApiMac_FHAttribute_unicastFixedChannel</span></code> or
<code class="docutils literal notranslate"><span class="pre">ApiMac_FHAttribute_broadcastFixedChannel</span></code> during the unicast and broadcast
dwell times, respectively.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The FH_BROADCAST_INTERVAL sets the rate at which sample application generates
broadcast packets but the 15.4-Stack itself configures the broadcast interval
to half of this value (and therefore wakes up twice as much) by design to
ensure that too many broadcast application messages do not get queued up due
to non availability of opportunity to transmit packets.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The broadcast dwell time can be set to 0 to disable broadcast transmission.
This can be especially helpful in saving power on sleepy end devices when
broadcast transmission are not used in application as the device would no
longer be required to power up during broadcast slots.</p>
<p>A set of channels can also be excluded from the hopping channels by using
the <code class="docutils literal notranslate"><span class="pre">ApiMac_FHAttribute_unicastExcludedChannels</span></code> and
<code class="docutils literal notranslate"><span class="pre">ApiMac_FHAttribute_broadcastExcludedChannels</span></code> PIBs as defined in
<a class="reference internal" href="#sec-fh-config-knobs"><span class="std std-ref">Stack Configuration Knobs</span></a>.</p>
</div>
<p>A special type of transmission called <em>async transmission</em> is also supported.
In frequency-hopping mode, a device transmits any one of the Async frame types
(as defined in the Wi-SUN FAN specification) in all of the requested channels
(see <a class="reference external" href="https://www.wi-sun.org">Wi-SUN FAN Specification</a>). This enables a hopping device to receive
such a frame irrespective of the hopping sequence. Thus, the async transmission
can be used to exchange channel-hopping information. This feature is especially
useful in initial network formation as explained in <a class="reference internal" href="#sec-fh-network-join"><span class="std std-ref">Network Join</span></a>.</p>
<p>When channel-hopping information of a neighbor is received, TI 15.4-Stack
tracks the hopping sequences of the neighbor hopping devices and enables
successful unicast and broadcast transmissions; thus, hiding the complexities
of maintaining synchronization from the application and easing the task of
developing applications with frequency hopping feature. To support short
address mode the <code class="docutils literal notranslate"><span class="pre">FH_COORD_SHORT_ADDRESS</span></code> should be configured on end device
to match the short address of the collector used.</p>
<div class="section" id="network-operations">
<h3>Network Operations<a class="headerlink" href="#network-operations" title="Permalink to this headline">¶</a></h3>
<p>In frequency hopping mode, nodes operate as one of the following device types:</p>
<ul class="simple">
<li><p>PAN coordinator</p></li>
<li><p>Non-sleepy device</p></li>
<li><p>Sleepy device</p></li>
</ul>
<p>A typical star topology has a single PAN coordinator connected to a set of
non-sleepy or sleepy devices. Each network is identified by a specific network
name, which is an ASCII value of 32 bytes and a 16-bit PAN Identifier. The
network name (NetName) is a unique network identifier that is configured by the
application using frequency hopping and PAN information base (FH-PIB)
attributes. Maintenance of the NetName is beyond the scope of TI 15.4-Stack and
is not used to filter frames.</p>
<p>The sections below explain various network operations important to understand
when developing a frequency hopping-enabled network over TI 15.4-Stack.</p>
</div>
<div class="section" id="network-start-up">
<span id="sec-fh-network-start-up"></span><h3>Network Start-Up<a class="headerlink" href="#network-start-up" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#fig-coord-start-up"><span class="std std-numref">Figure 70.</span></a> shows how a frequency-hopping network is started
by starting the PAN coordinator in frequency-hopping mode.</p>
<div class="figure align-center" id="fig-coord-start-up">
<img alt="../_images/fig-coord-start-up.png" src="../_images/fig-coord-start-up.png" />
<p class="caption"><span class="caption-number">Figure 70. </span><span class="caption-text">Start-Up Sequence of PAN Coordinator</span><a class="headerlink" href="#fig-coord-start-up" title="Permalink to this image">¶</a></p>
</div>
<p>The PIB attributes that are related to frequency-hopping configuration are
explained in <a class="reference internal" href="#sec-fh-config-knobs"><span class="std std-ref">Stack Configuration Knobs</span></a>. The NetName is a 32-bit ASCII value to
be set by the application. The routing cost must be set to zero.</p>
<p>Initially, the PAN size must be set to zero; later, the PAN size must be
updated based upon the number of nodes joined.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This NetName value is not used by the TI 15.4-Stack to make any decision;
instead, the value is carried in a PAN Advertisement frame that can be
parsed by a receiving application. Similarly, the GTK HASH 0, GTK HASH 1,
GTK HASH2, and GTK HASH 3 can be used to determine the validity of GMK keys
that are in use and are beyond the scope of TI 15.4-Stack.</p>
</div>
<p>Finally, start MAC using the macStart API, which specifies that the node is a
coordinator.</p>
</div>
<div class="section" id="device-start-up">
<h3>Device Start-Up<a class="headerlink" href="#device-start-up" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#fig-fh-device-start-up"><span class="std std-numref">Figure 71.</span></a> shows the start-up sequence of the device.</p>
<div class="figure align-center" id="fig-fh-device-start-up">
<img alt="../_images/fig-fh-device-start-up.png" src="../_images/fig-fh-device-start-up.png" />
<p class="caption"><span class="caption-number">Figure 71. </span><span class="caption-text">Start-Up Sequence of the Device</span><a class="headerlink" href="#fig-fh-device-start-up" title="Permalink to this image">¶</a></p>
</div>
<p>Wi-SUN FAN v1.0 does not specify sleep mode operation, but the TI 15.4-Stack
implements a proprietary extension over the behavior defined in the Wi-SUN FAN
and IEEE 802.15.4 MAC protocols (see <a class="reference internal" href="#sec-fh-sleep-operation"><span class="std std-ref">Sleep Mode Operation</span></a>) to enable
sleepy devices in the frequency-hopping networks based on TI 15.4-Stack.
The channel-hopping function for a sleepy device must be set to <em>Fixed</em>, and
the fixed channel can be set to any desired channel. The security keys can be
set at start-up (if the security keys are already pre-configured for the
network), or the security keys can be set after obtaining the same through a
key exchange. The key exchange protocol must be handled above the MAC layer.</p>
<p>The routing cost must be set to a high value (0xFFFF) to indicate that the
device has not joined the network; later, it can be updated by the application
based on the routing metric used.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The sequence to start the sleepy and non-sleepy devices is the same until
they join a network. A sleepy device is configured to be sleepy by setting
the MAC PIB (macRxOnWhenIdle) to zero only after it joins the network (see
<a class="reference internal" href="#sec-fh-network-join"><span class="std std-ref">Network Join</span></a>). In other words, the sleep mode operation uses
low-power mode only for data exchange after successfully joining the
network.</p>
</div>
</div>
<div class="section" id="network-join">
<span id="sec-fh-network-join"></span><h3>Network Join<a class="headerlink" href="#network-join" title="Permalink to this headline">¶</a></h3>
<p>To join to a network, a node must go through the two phases described as follows.</p>
<div class="section" id="phase-1-exchange-of-channel-hopping-sequence-information-through-asynchronous-messages">
<h4>Phase 1: Exchange of Channel-Hopping Sequence Information Through Asynchronous Messages<a class="headerlink" href="#phase-1-exchange-of-channel-hopping-sequence-information-through-asynchronous-messages" title="Permalink to this headline">¶</a></h4>
<p>Asynchronous messages are sent back-to-back over a specified channel list. This
action enables a receiver to receive such frames with high probability,
irrespective of the hopping sequence. Four different asynchronous messages are
supported by TI 15.4-Stack as defined in the Wi-SUN FAN specification. All
asynchronous frames are transmitted based on a trickle timer [RFC 6206]. The
Imin, Imax, and K for the trickle algorithm are recommended to be set at 1 min,
16 min, and 1, respectively.</p>
<p>Brief descriptions of the four types of asynchronous messages follow:</p>
<ul class="simple">
<li><p>PAN Advertisement Solicit (PAS):</p>
<ul>
<li><p>PAS messages are used by a device to request a coordinator or other
joined nodes to transmit a PAN Advertisement frame.</p></li>
<li><p>Upon reception of the PAN Advertisement frame, a joining application
can detect the NetName IE in the frame and then use the name to
determine whether or not to reset PA trickle timer.</p></li>
</ul>
</li>
<li><p>PAN Advertisement (PA):</p>
<ul>
<li><p>PA frames can be transmitted by a coordinator or by a joined node to
inform neighbors about the PAN size, Routing cost, and PAN ID.</p></li>
<li><p>The trickle timer associated with PA transmissions is programmed to be
reset on reception of a PAS frame.</p></li>
<li><p>Upon, reception of the PAS frame, nodes communicate with the
transmitter of the PA frames (note the hopping sequence is carried in
the PA frame).</p></li>
<li><p>The device can choose one of the source nodes of the PA frame as relay
to perform an <em>Authentication and Secure Key Exchange</em> protocol that
must be implemented by the application running over the TI 15.4-Stack.
Example applications (collector and sensor) included in TI 15.4- Stack
<strong>do not</strong> demonstrate this feature.</p></li>
</ul>
</li>
<li><p>PAN Configuration Solicit (PCS):</p>
<ul>
<li><p>When a device has the group master key (GMK), the device can request
the transmission of a PAN Configuration frame.</p></li>
<li><p>PCS messages are transmitted by a node to request neighbors or the
coordinator transmit a PAN Config frame.</p></li>
</ul>
</li>
<li><p>PAN Configuration (PC):</p>
<ul>
<li><p>PC messages are transmitted by the coordinator or a joined node based
on a trickle timer that must be reset upon reception of a PCS frame.</p></li>
<li><p>PC frames carry the broadcast-hopping sequence and the hash values of
the list of GMK keys that are actively used.</p></li>
<li><p>Upon reception of a PC frame, a device detects that the channel-hopping
exchanges are completed.</p></li>
</ul>
</li>
</ul>
<p>When using the frequency-hopping configuration on star-network topology, TI recommends the following:</p>
<ul class="simple">
<li><p>The PAN coordinator transmits PA and PC frames based on separate trickle
timers. TI recommends that developers refer to the collector example
application implementation located under the examples folder in the TI
15.4-Stack installation directory).</p></li>
<li><p>Devices transmit PAS and PCS frames for the purpose of joining; then, the
devices suspend the trickle timer after a successful join. TI recommends
that developers refer to the sensor example application as a reference on
how to implement this action, or that they use the implementation in the
sensor example application <em>as-is</em> as a starting point for custom
applications.</p></li>
<li><p>Devices must also implement the suppression mechanism to limit the number
of PAS and PCS frames transmitted. TI recommends developers refer to the
sensor example application (examples folder in the TI 15.4-Stack
installation directory) as a reference for implementing this action, or use
the implementation in the sensor example application <em>as-is</em> as a starting
point for custom applications.</p></li>
</ul>
</div>
<div class="section" id="phase-2-proprietary-association-procedure-to-inform-coordinator-of-the-network-join-this-is-an-optional-step">
<h4>Phase 2: Proprietary Association Procedure to Inform Coordinator of the Network Join (This is an Optional Step)<a class="headerlink" href="#phase-2-proprietary-association-procedure-to-inform-coordinator-of-the-network-join-this-is-an-optional-step" title="Permalink to this headline">¶</a></h4>
<p>Because the frequency hopping join procedure (defined by the Wi-SUN
specification) is silent, the PAN coordinator cannot detect if the device has
successfully joined the network. The TI 15.4-Stack example applications use an
additional step for network join. The MAC layer association procedure described
in the IEEE 802.15.4 specification is used after the PCS indicates to the PAN
coordinator that the device has successfully joined the frequency-hopping
network.</p>
<p>In addition to informing the coordinator that the device has successfully
joined the network, the optional mechanism allows the PAN coordinator to detect
if the joining node is sleepy or always-on through the <em>capability information</em>
field of the association request message sent by the device to the PAN
coordinator. This optional mechanism is required for the PAN coordinator
application to determine the following:</p>
<ul class="simple">
<li><p>If the application must buffer the message until the device polls for some
configured amount of time in case the message is for a sleepy device</p></li>
<li><p>If the application must send the message OTA as soon as the message-
transmit request is generated</p></li>
</ul>
<p>Although this step is not required for data exchange (because EUI addresses are
used instead of short addresses for communication in frequency-hopping mode),
TI recommends using this optional procedure in the applications using the
frequency-hopping configuration of the TI 15.4-Stack to enable the coordinator
application to build the list of joined nodes and to detect if the newly joined
device is sleepy or is an always-on device.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The association procedure must be started at least 2 seconds after
reception of a PAN configuration frame. Upon failure, the association
procedure can be independently retried up to the retry limit of the
application. For a sleepy device, the <code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_RxOnWhenIdle</span></code>
should be set to zero only after a successful completion of the mac-
association procedure.</p>
</div>
<p><a class="reference internal" href="#fig-fh-sleepy-join"><span class="std std-numref">Figure 72.</span></a> and <a class="reference internal" href="#fig-fh-non-sleepy-join"><span class="std std-numref">Figure 73.</span></a> shows the
procedure for sleepy and non-sleepy devices, respectively.</p>
<div class="figure align-center" id="fig-fh-sleepy-join">
<img alt="../_images/fig-fh-sleepy-join.png" src="../_images/fig-fh-sleepy-join.png" />
<p class="caption"><span class="caption-number">Figure 72. </span><span class="caption-text">Joining Procedure for a Sleepy Frequency-Hopping Device</span><a class="headerlink" href="#fig-fh-sleepy-join" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="fig-fh-non-sleepy-join">
<img alt="../_images/fig-fh-non-sleepy-join.png" src="../_images/fig-fh-non-sleepy-join.png" />
<p class="caption"><span class="caption-number">Figure 73. </span><span class="caption-text">Joining Procedure for a Nonsleepy Frequency-Hopping Device</span><a class="headerlink" href="#fig-fh-non-sleepy-join" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition note" id="sec-fh-data-exchange">
<p class="admonition-title">Note</p>
<p>In order for the collector device to allow sleepy devices that disconnect from the
network and attempt to reconnect/rejoin afterwards, the network needs to be OPEN.
Permit join must be True.
<code class="code docutils literal notranslate"><span class="pre">ApiMac_mlmeSetReqBool(ApiMac_attribute_associatePermit,</span> <span class="pre">true);</span></code></p>
</div>
</div>
</div>
<div class="section" id="data-exchange">
<h3>Data Exchange<a class="headerlink" href="#data-exchange" title="Permalink to this headline">¶</a></h3>
<p>Three types of data-exchange mechanisms are supported by the TI 15.4-Stack:</p>
<ul class="simple">
<li><p>Unicast data exchange</p></li>
<li><p>Broadcast data exchange</p></li>
<li><p>Asynchronous frame exchange</p></li>
</ul>
<p>Destination address mode should be based on end-device being sleepy or non-
sleepy. To initiate a unicast or broadcast frame exchange, the API
<code class="docutils literal notranslate"><span class="pre">ApiMac_mcpsDataReq</span></code> should be used. To transmit an asynchronous frame,
<code class="docutils literal notranslate"><span class="pre">ApiMac_mlmeWSAsyncReq</span></code> should be used. The determination of whether the
message is unicast or broadcast is done based on the destination address mode
used in the data request parameter type <code class="docutils literal notranslate"><span class="pre">ApiMac_mcpsDataReq_t</span></code> (see
<a class="reference internal" href="#tab-fh-addressing"><span class="std std-numref">Table 8.</span></a>).</p>
<table class="docutils align-default" id="tab-fh-addressing">
<caption><span class="caption-number">Table 8. </span><span class="caption-text">Addressing Modes for Unicast and Broadcast Message With TI 15.4-Stack in Frequency-Hopping Configuration</span><a class="headerlink" href="#tab-fh-addressing" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 22%" />
<col style="width: 26%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Message Type</strong></p></th>
<th class="head"><p><strong>Source Address Mode</strong></p></th>
<th class="head"><p><strong>Destination Address Mode</strong></p></th>
<th class="head"><p><strong>Destination Address</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Unicast (sleepy device)</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>Specified by the application</p></td>
</tr>
<tr class="row-odd"><td><p>Unicast (non-sleepy device)</p></td>
<td><p>3</p></td>
<td><p>3</p></td>
<td><p>Specified by the application</p></td>
</tr>
<tr class="row-even"><td><p>Broadcast</p></td>
<td><p>3/2</p></td>
<td><p>0</p></td>
<td><p>Ignored by stack</p></td>
</tr>
</tbody>
</table>
<div class="section" id="unicast-data-exchange">
<h4><strong>Unicast Data Exchange</strong><a class="headerlink" href="#unicast-data-exchange" title="Permalink to this headline">¶</a></h4>
<p>Unicast data exchange in frequency-hopping mode occurs on the channel of the
destination node. A node transmits the frame on the expected receive channel of
the destination node. The entire frame exchange occurs on the same channel (see
<a class="reference internal" href="#fig-fh-data-exchange"><span class="std std-numref">Figure 74.</span></a>). Subsequent data exchange occurs on the channel
on which the receiver is hopping at the time of transmission; this subsequent
data exchange is independent from earlier transmissions.</p>
<div class="figure align-center" id="fig-fh-data-exchange">
<img alt="../_images/fig-fh-data-exchange.png" src="../_images/fig-fh-data-exchange.png" />
<p class="caption"><span class="caption-number">Figure 74. </span><span class="caption-text">Data Exchange With TI 15.4-Stack in Frequency-Hopping Configuration</span><a class="headerlink" href="#fig-fh-data-exchange" title="Permalink to this image">¶</a></p>
</div>
<p>To transmit a unicast frame to a neighbor, the hopping information was received
by the node in some earlier frame. The hopping information could have been
received through the reception of any type of asynchronous frames from the
destination node. Hence, an application should ensure that such a frame is
received from destination node before initiating a data request.</p>
<p>If a data request is issued to a node whose entry is not in the neighbor table,
the error code <code class="docutils literal notranslate"><span class="pre">ApiMac_status_fhNotInNeighborTable</span></code> (0x64) specifies that the
node that is not in the neighbor table is returned to the application by TI
15.4-Stack. Also, an expiry is associated with each neighbor table entry. The
default time of the expiry is 2 hours for hopping neighbors. The 2 hour default
expiry is set because the hopping information stored in the neighbor table may
not be useful beyond that time limit for a successful data exchange (due to loss
in synchronization caused by inherent clock drifts). Any data exchange helps the
node to resynchronize the entry; thus, the entry is considered active for the
next 2 hours. If a data request is sent for an expired neighbor, the message is
not sent to the destination and a status of <code class="docutils literal notranslate"><span class="pre">ApiMac_status_fhExpiredNode</span></code>
(0x6C) is returned to the application. Unicast frames are only transmitted in
unicast slots.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The lifetime of a hopping neighbor can be changed to any other desired value
in the range of 5 minutes to 600 minutes (10 hours) by using the PIB
attribute, <code class="docutils literal notranslate"><span class="pre">ApiMac_FHAttribute_neighborValidTime</span></code>, which is specified in
minutes.</p>
</div>
</div>
<div class="section" id="broadcast-frame-exchange">
<h4><strong>Broadcast Frame Exchange</strong><a class="headerlink" href="#broadcast-frame-exchange" title="Permalink to this headline">¶</a></h4>
<p>Broadcast frames are transmitted only during the broadcast dwell interval as
shown in <a class="reference internal" href="#fig-broadcast-sequence"><span class="std std-numref">Figure 69.</span></a>. This can lead to situations where
frames are out of order between a unicast and broadcast frame (that is, the
order in which frames are requested to be transmitted by the application could
be different from the order in which they are transmitted over the air). Thus,
the order in which the <code class="docutils literal notranslate"><span class="pre">ApiMac_mcpsDataReq</span></code> confirm is received may be
different from the order in which <code class="docutils literal notranslate"><span class="pre">ApiMac_mcpsDataReq</span></code> is sent. The msdu-
handle should be used to match the request primitive to the corresponding
confirm primitive by the application.</p>
<p>An application on the PAN coordinator can transmit a broadcast frame any time
because the PAN coordinator starts the broadcast hopping as soon as the
application is started. All other nodes should wait for the reception of a PAN
Configuration frame from the PAN coordinator to start the broadcast-hopping
sequence. An application on these other nodes should wait for the reception of
the PAN Configuration frames; then the application can set the source address of
the PAN Configuration frame (if it selects to use that node as a Parent) to the
<code class="docutils literal notranslate"><span class="pre">FH_MAC_TRACK_PARENT</span></code> PIB before issuing a request of broadcast frame
exchange. If an application issues a broadcast data request while the node has
not yet started following a broadcast hopping sequence, the stack returns an
<code class="docutils literal notranslate"><span class="pre">ApiMac_status_badState</span></code> (0x19) error code.</p>
</div>
<div class="section" id="asynchronous-frame-exchange">
<h4><strong>Asynchronous Frame Exchange</strong><a class="headerlink" href="#asynchronous-frame-exchange" title="Permalink to this headline">¶</a></h4>
<p>Asynchronous frames are transmitted by a device on the list of channels
specified by user in the Async request. <a class="reference internal" href="#fig-async-frame"><span class="std std-numref">Figure 75.</span></a> shows that the
device deviates from the hopping sequence and performs this operation.</p>
<div class="figure align-center" id="fig-async-frame">
<img alt="../_images/fig-async-frame.png" src="../_images/fig-async-frame.png" />
<p class="caption"><span class="caption-number">Figure 75. </span><span class="caption-text">Asynchronous Frame Exchange</span><a class="headerlink" href="#fig-async-frame" title="Permalink to this image">¶</a></p>
</div>
<p>The objective of asynchronous frame exchange is to transmit data on all
available channels (default = 129); thus, asynchronous frame exchange can take a
few seconds to complete (worst case is approximately 4 seconds). Such
transmissions are typically controlled by trickle timers and are not recommended
to be transmitted frequently (refer to <a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#chap-references"><span class="std std-ref">References</span></a>). Optionally, a
device may issue an Async Request with a Stop command, which will stop an
ongoing Async frame exchange.</p>
</div>
<div class="section" id="sleep-mode-operation">
<span id="sec-fh-sleep-operation"></span><h4>Sleep Mode Operation<a class="headerlink" href="#sleep-mode-operation" title="Permalink to this headline">¶</a></h4>
<p>Wi-SUN FAN v1.0 does not define a sleep mode operation. However, TI 15.4-Stack
supports a proprietary sleep mode operation using a mechanism similar to TI
15.4Stack non-beacon configuration operation, which uses indirect transmissions.
In sleep mode operation the address mode should be set to short address mode.</p>
<p>The sleep mode operation is explained in <a class="reference internal" href="#fig-fh-sleepy-sequence"><span class="std std-numref">Figure 76.</span></a>.
Because the joining procedure is explained in <a class="reference internal" href="non-beacon-mode.html#sec-non-beacon-join"><span class="std std-ref">Network Join</span></a>, the
data exchange mechanism is emphasized in this section.</p>
<p>After reception of PAN Config frame, the macRxOnWhenIdle should be set to zero
to enable sleep mode operation. The sleepy device transmits frames to the PAN
coordinator based on the hopping sequence. TI 15.4-Stack on the sleepy device
operates on a fixed channel and will not hop independently.</p>
<div class="figure align-center" id="fig-fh-sleepy-sequence">
<img alt="../_images/fig-fh-sleepy-sequence.png" src="../_images/fig-fh-sleepy-sequence.png" />
<p class="caption"><span class="caption-number">Figure 76. </span><span class="caption-text">Sleep Mode Operation in Frequency-Hopping Mode</span><a class="headerlink" href="#fig-fh-sleepy-sequence" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="maintaining-a-connection-for-end-nodes">
<h4>Maintaining a Connection for End Nodes<a class="headerlink" href="#maintaining-a-connection-for-end-nodes" title="Permalink to this headline">¶</a></h4>
<p>In a typical star network, the devices have to keep track of unicast and
broadcast timing of Coordinator’s hopping sequences while the coordinator has to
do for the unicast timing information of all the connected devices.</p>
<p>The timing information of the unicast and broadcast sequence of a device is
carried in unicast timing and frame type information element (UTT-IE) and
broadcast timing Information element (BT-IE), respectively. All data frames with
destination address mode set to extended or None shall carry UTT-IE and BT-IE.
The ACK frames from PAN-Coordinator will contain both the UTT-IE and BT-IE
irrespective of address mode, while those from other non-sleepy end devices will
carry UTT-IE alone. The timing information corresponding to the source of the
received Data/ACK frame is updated based on received frames.</p>
<p>The lifetime of a neighbor table is based on the last time the entry was
updated. As long as a frame is received from a neighbor once every <em>neighbor
valid time</em>, it is kept active. The neighbor valid time for a hopping neighbor
is set to 2 hours by default. Neighbor valid time can be changed using the
<code class="docutils literal notranslate"><span class="pre">MAC_FHPIB_NEIGHBOR_VALID_TIME</span></code> PIB attribute. After that period the entry is
considered as expired. Any neighbor table entry is deleted if it is not updated
within the last 10 hours.</p>
<p>The period within which at least one data frame should be exchanged to maintain
reliable communication depends on the dwell time value used by the PAN
coordinator. TI recommends keeping this period for at most 10 minutes or 25
minutes, for a PAN coordinator dwell time of 100 ms and 250 ms respectively.</p>
</div>
<div class="section" id="disassociating">
<h4>Disassociating<a class="headerlink" href="#disassociating" title="Permalink to this headline">¶</a></h4>
<p>The frequency-hopping mode also supports the disassociation command defined in
IEEE 802.15.4, similar to the nonfrequency-hopping mode.</p>
</div>
</div>
<div class="section" id="stack-configuration-knobs">
<span id="sec-fh-config-knobs"></span><h3>Stack Configuration Knobs<a class="headerlink" href="#stack-configuration-knobs" title="Permalink to this headline">¶</a></h3>
<p>The frequency-hopping mode features can be controlled through a set of MAC FHPIB
attributes. Some of these PIBs affect TI 15.4-Stack operation directly,
while others are provided to help applications generate the required
Asynchronous frames. This section explains the MAC FHPIB attributes.</p>
<div class="section" id="parameters-controlling-the-unicast-channel-hopping-sequence-of-the-node">
<span id="sec-fh-unicast-parameters"></span><h4>Parameters Controlling the Unicast Channel-Hopping Sequence of the Node<a class="headerlink" href="#parameters-controlling-the-unicast-channel-hopping-sequence-of-the-node" title="Permalink to this headline">¶</a></h4>
<p>The parameters controlling the unicast hopping must be set after the FH is
enabled and before the MAC or FH-start API is called (see
<a class="reference internal" href="#tab-unicast-parameters"><span class="std std-numref">Table 9.</span></a>). These
values must not be changed after the node starts the hopping sequence. To change
these values the nodes have to be power cycled or reset.</p>
<table class="docutils align-default" id="tab-unicast-parameters">
<caption><span class="caption-number">Table 9. </span><span class="caption-text">Unicast Channel-Hopping PIB Parameters</span><a class="headerlink" href="#tab-unicast-parameters" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 4%" />
<col style="width: 17%" />
<col style="width: 5%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>PIB</strong></p></th>
<th class="head"><p><strong>PIB ID</strong></p></th>
<th class="head"><p><strong>Range</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ApiMac_FHAttribute_unicastDwellInterval</p></td>
<td><p>0x2004</p></td>
<td><p>15 to 250 (ms)</p></td>
<td><p>250</p></td>
<td><p>Amount of time spent on each channel</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_FHAttribute_unicastChannelFunction</p></td>
<td><p>0x2008</p></td>
<td><p>0 or 2</p></td>
<td><p>0</p></td>
<td><p>Whether to hop or not. Only two values are supported:
0 – Fixed
2 – DH1CF-based hopping</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_FHAttribute_unicastFixedChannel</p></td>
<td><p>0x200C</p></td>
<td><p>0 – maximum channel based on PHY configuration</p></td>
<td><p>0</p></td>
<td><p>The channel to use during unicast hopping when the channel function is fixed</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_FHAttribute_unicastExcludedChannels</p></td>
<td><p>0x2002</p></td>
<td><p>17 bytes</p></td>
<td><p>All zeros</p></td>
<td><p>The list of channels to avoid when channel function is 2. Each bit represents a channel, starting from the LSB of the first byte which, represents Channel 0</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="parameters-controlling-the-broadcast-channel-hopping-sequence">
<span id="sec-fh-broadcast-parameters"></span><h4>Parameters Controlling the Broadcast Channel-Hopping Sequence<a class="headerlink" href="#parameters-controlling-the-broadcast-channel-hopping-sequence" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>These parameters must only be set on the PAN coordinator (see
<a class="reference internal" href="#tab-broadcast-parameters"><span class="std std-numref">Table 10.</span></a>). The parameters must be set after the FH
is enabled and before the MAC or FH-start API is called. Other devices
obtain this information on reception of a PC (an Asynchronous message)
message from the PAN- Coordinator. Devices then perform their broadcast
hopping based on the received configuration. The received configuration can
be read from these PIBs after the reception of a PAN Config frame from the
parent of a node.</p>
</div></blockquote>
<table class="docutils align-default" id="tab-broadcast-parameters">
<caption><span class="caption-number">Table 10. </span><span class="caption-text">Broadcast Channel-Hopping PIB Parameters</span><a class="headerlink" href="#tab-broadcast-parameters" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 4%" />
<col style="width: 17%" />
<col style="width: 5%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>PIB</strong></p></th>
<th class="head"><p><strong>PIB Id</strong></p></th>
<th class="head"><p><strong>Range</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ApiMac_FHAttribute_broadcastInterval</p></td>
<td><p>0x2001</p></td>
<td><p>15 to
16777215 ms</p></td>
<td><p>4250</p></td>
<td><p>The interval between two different broadcast dwell interval</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_FHAttribute_broadcastDwellInterval</p></td>
<td><p>0x2005</p></td>
<td><p>0 to 250 ms</p></td>
<td><p>250</p></td>
<td><p>Amount of time spent during broadcast dwell interval. Setting this value to 0 will disable broadcast transmissions.</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_FHAttribute_broadcastChannelFunction</p></td>
<td><p>0x2009</p></td>
<td><p>0 or 2</p></td>
<td><p>0</p></td>
<td><p>Whether to hop or not. Only two values are supported:
0 – Fixed
2 – DH1CF based hopping</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_FHAttribute_broadcastFixedChannel</p></td>
<td><p>0x200D</p></td>
<td><p>0 – maximum channel based on PHY configuration</p></td>
<td><p>0</p></td>
<td><p>The channel to use during broadcast dwell interval when the channel function is fixed</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_FHAttribute_broadcastExcludedChannels</p></td>
<td><p>0x2003</p></td>
<td><p>17 bytes</p></td>
<td><p>All zeros</p></td>
<td><p>The list of channels to avoid when the channel function is 2. Each bit represents a channel, starting from the LSB of the first byte, which represents Channel
0.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A large value of broadcast interval implies a higher delay in
transmitting broadcast frames.
An application could decide to increase or decrease this interval based on
the perceived requirement for handling broadcast frames.</p>
</div>
<p>On the device side, an application must set the source address of the chosen
parent to the MAC TRACK PARENT PIB (see <a class="reference internal" href="#tab-fh-parent"><span class="std std-numref">Table 11.</span></a>). FH stack
follows the
broadcast hopping sequence of the chosen parent. An application can choose a
parent based on the received source address of the PAN configuration frames.
However, performance loss may occur due to loss in broadcast synchronization,
which is corrected based on the subsequent PAN Configuration frame received from
the new parent.</p>
<table class="docutils align-default" id="tab-fh-parent">
<caption><span class="caption-number">Table 11. </span><span class="caption-text">Frequency-Hopping Parent Address PIB Attribute</span><a class="headerlink" href="#tab-fh-parent" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 34%" />
<col style="width: 12%" />
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>PIB</strong></p></th>
<th class="head"><p><strong>PIB Id</strong></p></th>
<th class="head"><p><strong>Range</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ApiMac_FHAttribute_trackParentEUI</p></td>
<td><p>0x2000</p></td>
<td><p>Any</p></td>
<td><p>0xFFFFFFFF</p></td>
<td><p>Source address of the parent.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="changing-broadcast-sequence-values-in-the-middle-of-network-operation">
<h4>Changing Broadcast Sequence Values in the Middle of Network Operation<a class="headerlink" href="#changing-broadcast-sequence-values-in-the-middle-of-network-operation" title="Permalink to this headline">¶</a></h4>
<p>A PAN coordinator may choose to modify the broadcast interval during a network
operation. To do so the application of the PAN coordinator must set the values
as required, and then increment the value of the MAC_FHPIB_BROCAST_SCHED_ID
PIB (see <a class="reference internal" href="#tab-broadcast-interval"><span class="std std-numref">Table 12.</span></a>).</p>
<table class="docutils align-default" id="tab-broadcast-interval">
<caption><span class="caption-number">Table 12. </span><span class="caption-text">Broadcast Interval PIB Attribute</span><a class="headerlink" href="#tab-broadcast-interval" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 7%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>PIB</strong></p></th>
<th class="head"><p><strong>PIB Id</strong></p></th>
<th class="head"><p><strong>Range</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ApiMac_FHAttribute_broadcastSchedId</p></td>
<td><p>0x200B</p></td>
<td><p>0 to 65535</p></td>
<td><p>0</p></td>
<td><p>A value representing a given broadcast configuration. It must be incremented when broadcast configurations are changed.</p></td>
</tr>
</tbody>
</table>
<p>Transmit PAN Config frames more frequently to enable the dissemination of this
information to the network.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The performance of the network may be affected during this change in
configuration time as it requires some time for the nodes to update their hopping sequences.</p>
</div>
</div>
<div class="section" id="parameters-to-control-frequency-of-the-operation-of-hopping-mode">
<h4>Parameters to Control Frequency of the Operation of Hopping Mode<a class="headerlink" href="#parameters-to-control-frequency-of-the-operation-of-hopping-mode" title="Permalink to this headline">¶</a></h4>
<p>The following parameters can be set to control specific functions, as defined in
<a class="reference internal" href="#tab-fh-control"><span class="std std-numref">Table 13.</span></a>.</p>
<table class="docutils align-default" id="tab-fh-control">
<caption><span class="caption-number">Table 13. </span><span class="caption-text">Frequency Hopping Control PIB Attributes</span><a class="headerlink" href="#tab-fh-control" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 6%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>PIB</strong></p></th>
<th class="head"><p><strong>PIB Id</strong></p></th>
<th class="head"><p><strong>Range</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ApiMac_FHAttribute_clockDrift</p></td>
<td><p>0x2006</p></td>
<td><p>0 to 255</p></td>
<td><p>20</p></td>
<td><p>Represents the accuracy of the system clock in ppm. A value of 255 implies that the information is not provided.</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_FHAttribute_timingAccuracy</p></td>
<td><p>0x2007</p></td>
<td><p>0 to 255</p></td>
<td><p>0</p></td>
<td><p>Accuracy of provided timing information in 10s of micro seconds.</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_FHAttribute_neighborValidTime</p></td>
<td><p>0x2019</p></td>
<td><p>5 to 600 (minutes)</p></td>
<td><p>120</p></td>
<td><p>The time in minutes for which a hopping neighbor is considered valid after reception of a Data/ACK from it.</p></td>
</tr>
</tbody>
</table>
<p>TI recommends not changing the values listed in <a class="reference internal" href="#tab-fh-control"><span class="std std-numref">Table 13.</span></a>, and
using the default values.</p>
</div>
<div class="section" id="parameters-to-control-neighbor-table-size">
<span id="sec-fh-neighbor-parameters"></span><h4>Parameters to Control Neighbor Table Size<a class="headerlink" href="#parameters-to-control-neighbor-table-size" title="Permalink to this headline">¶</a></h4>
<p>The amount of heap memory occupied by the FH neighbor table can be controlled
through FH PIB attributes. The total number of end devices supported must be
less than 50. If a deployment only requires a lesser number of devices, a lower
number of neighbor table entries can be specified, thereby allowing more heap
for the application. When configuring the number of neighbor table entries, both
non-sleepy and sleepy devices must be changed together with
MAC_FHPIB_NUM_NON_SLEEPY_DEVICES set first.</p>
<table class="docutils align-default" id="tab-fh-neighbor-control">
<caption><span class="caption-number">Table 14. </span><span class="caption-text">Frequency Hopping Neighbor Control PIB Attributes</span><a class="headerlink" href="#tab-fh-neighbor-control" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 10%" />
<col style="width: 9%" />
<col style="width: 11%" />
<col style="width: 41%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>PIB</strong></p></th>
<th class="head"><p><strong>PIB Id</strong></p></th>
<th class="head"><p><strong>Range</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MAC_FHPIB_NUM_NON_SLEEPY_DEVICES</p></td>
<td><p>0x201b</p></td>
<td><p>0 to 50</p></td>
<td><p>2</p></td>
<td><p>Total number of non-sleepy neighbors supported.</p></td>
</tr>
<tr class="row-odd"><td><p>MAC_FHPIB_NUM_SLEEPY_DEVICES</p></td>
<td><p>0x201c</p></td>
<td><p>0 to 50</p></td>
<td><p>48</p></td>
<td><p>Total number of sleepy neighbors supported.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of non-sleepy and sleepy neighbors can only be configured
before issuing a network start or FHAPI_start API. The total number of end
devices supported must be less than 50. When configuring the number of
neighbor table entries, both non-sleepy and sleepy devices must be changed
together with MAC_FHPIB_NUM_NON_SLEEPY_DEVICES set first.</p>
</div>
<table class="docutils align-default" id="tab-fh-backoff">
<caption><span class="caption-number">Table 15. </span><span class="caption-text">Frequency Hopping Backoff PIB Attributes</span><a class="headerlink" href="#tab-fh-backoff" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 6%" />
<col style="width: 12%" />
<col style="width: 7%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>PIB</strong></p></th>
<th class="head"><p><strong>PIB Id</strong></p></th>
<th class="head"><p><strong>Range</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>MAC_FHPIB_BASE_BACKOFF</p></td>
<td><p>0x201a</p></td>
<td><p>0 to 16</p></td>
<td><p>8</p></td>
<td><p>Additional back off parameter on target channel to account for interference (ms).</p></td>
</tr>
<tr class="row-odd"><td><p>MAC_FHPIB_NEIGHBOR_VALID_TIME</p></td>
<td><p>0x2019</p></td>
<td><p>0 to 65535 (minutes)</p></td>
<td><p>120</p></td>
<td><p>The time in minutes for which a hopping neighbor is considered valid after reception of a Data/ACK from it.</p></td>
</tr>
</tbody>
</table>
<p>The MAC_FHPIB_BASE_BACKOFF enables FH devices to mitigate interference, which
causes a higher delay for packet transmission when interference is observed. The
interference mitigation feature can be disabled by setting this parameter to
zero (although it is not recommended to do so). TI recommends not changing these
values and using the default values.</p>
</div>
<div class="section" id="parameters-to-enable-application-generate-and-process-asynchronous-frames">
<span id="sec-fh-async-parameters"></span><h4>Parameters to Enable Application Generate and Process Asynchronous Frames<a class="headerlink" href="#parameters-to-enable-application-generate-and-process-asynchronous-frames" title="Permalink to this headline">¶</a></h4>
<p>The following PIB attributes represent different fields of the Asynchronous
frames (see <a class="reference internal" href="#tab-fh-async"><span class="std std-numref">Table 16.</span></a>). The attributes are used to generate the
required IEs when an async request is made by application based on the async
frame type. The TI 15.4-Stack is responsible for only using these PIBs to encode
the async frames and does not use these values to make any decisions on its
operation. It is up to the application to use these fields if needed to perform
any relevant operation.</p>
<table class="docutils align-default" id="tab-fh-async">
<caption><span class="caption-number">Table 16. </span><span class="caption-text">PIB Attributes for Asynchronous Messages</span><a class="headerlink" href="#tab-fh-async" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 16%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 6%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>PIB</strong></p></th>
<th class="head"><p><strong>PIB Id</strong></p></th>
<th class="head"><p><strong>Range</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ApiMac_FHAttribute_panSize</p></td>
<td><p>0x200E</p></td>
<td><p>0 to 65535</p></td>
<td><p>0</p></td>
<td><p>The size of PAN network</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_FHAttribute_routingCost</p></td>
<td><p>0x200F</p></td>
<td><p>0 to 255</p></td>
<td><p>0</p></td>
<td><p>Zero for PAN Coordinator and Non- Zero for other devices. Actual metric used is beyond the scope of MAC. This can be used to choose a parent.</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_FHAttribute_routingMethod</p></td>
<td><p>0x2010</p></td>
<td><p>0 or 1</p></td>
<td><p>1</p></td>
<td><p>Specify the type of routing protocol used. Typical values are 0 – MHDS,
1 – RPL</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_FHAttribute_eapolReady</p></td>
<td><p>0x2011</p></td>
<td><p>0 or 1</p></td>
<td><p>1</p></td>
<td><p>Specify whether the node can support EAPOL to perform authentication and key exchange</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_FHAttribute_fanTPSVersion</p></td>
<td><p>0x2012</p></td>
<td><p>0 to 255</p></td>
<td><p>1</p></td>
<td><p>Wi-SUN FAN version number</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_FHAttribute_netName</p></td>
<td><p>0x2013</p></td>
<td><p>32 bytes</p></td>
<td><p>All zeros</p></td>
<td><p>Null terminated string</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_FHAttribute_panVersion</p></td>
<td><p>0x2014</p></td>
<td><p>0 to 65535</p></td>
<td><p>00000</p></td>
<td><p>Must be incremented whenever a configuration changes such as broadcast information or GTK Hash values are changed.</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_FHAttribute_gtk0Hash</p></td>
<td><p>0x2015</p></td>
<td><p>8 bytes</p></td>
<td><p>All zeros</p></td>
<td><p>The Hash value that can be used by the application to decide the validity of an exchanged GMK key with ID 0.</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_FHAttribute_gtk1Hash</p></td>
<td><p>0x2016</p></td>
<td><p>8 bytes</p></td>
<td><p>All zeros</p></td>
<td><p>The Hash value that can be used by the application to decide the validity of an exchanged GMK key with ID 1.</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_FHAttribute_gtk2Hash</p></td>
<td><p>0x2017</p></td>
<td><p>8 bytes</p></td>
<td><p>All zeros</p></td>
<td><p>The Hash value that can be used by the application to decide the validity of an exchanged GMK key with ID 2.</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_FHAttribute_gtk3Hash</p></td>
<td><p>0x2018</p></td>
<td><p>8 bytes</p></td>
<td><p>All zeros</p></td>
<td><p>The Hash value that can be used by the application to decide the validity of an exchanged GMK key with ID 3.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="non-beacon-mode.html" class="btn btn-neutral float-left" title="Non-Beacon Mode" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="arib-regulation-type.html" class="btn btn-neutral float-right" title="ARIB Regulation Type" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>