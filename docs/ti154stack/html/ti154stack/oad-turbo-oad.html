<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Turbo OAD Protocol &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
TI 15.4-Stack User&#39;s Guide
 6.10.01.00 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="OAD Image Tool" href="../oad-secure/tools.html" />
    <link rel="prev" title="TI 15.4-Stack OAD" href="oad-transport.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug ti154stack oad-turbo-oad";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../ti154stack-guide/index-cc13xx_cc26xx.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
TI 15.4-Stack User's Guide

          </a>
              <div class="version">
                6.10.01.00
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/quickstart-intro-cc13xx_cc26xx.html">Introduction to the SimpleLink CC13xx/CC26xx SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/index-platform.html">SimpleLink Wireless MCU CC13xx and CC26xx Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/tirtos-index-cc13xx_cc26xx.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../ti154stack-guide/ti154stack-index-cc13xx_cc26xx.html">TI 15.4-Stack</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ti154stack-overview-cc13xx_cc26xx.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="ti154stack-overview-cc13xx_cc26xx.html#architecture-choices">Architecture Choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="ti154stack-overview-cc13xx_cc26xx.html#data-rate-and-phy">Data Rate and PHY</a></li>
<li class="toctree-l2"><a class="reference internal" href="application-overview.html">Application Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="example-applications.html">Example Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-user-interface.html">Common User Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="secure-commissioning.html">Secure Commissioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="beacon-mode.html">Beacon Enabled Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="non-beacon-mode.html">Non-Beacon Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="frequency-hopping-mode.html">Frequency-Hopping Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="arib-regulation-type.html">ARIB Regulation Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring-stack.html">Configuring Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="packet-sniffer.html">SmartRF Protocol Packet Sniffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-custom-applications.html">Creating Custom Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cc13xx_cc26xx/fcc-certification.html">FCC Certification Considerations</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../ti154stack-guide/oad-secure-index.html">Over-the-Air Download (OAD)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../oad-secure/intro.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../oad-secure/bim.html">Boot Image Manager (BIM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../oad-secure/bim-off-chip.html">BIM for Off-Chip OAD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../oad-secure/bim-on-chip-stack-library.html">BIM for On-Chip OAD (Stack Library)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../oad-secure/image-header.html">OAD Image Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="../oad-secure/ext-flash-image-header.html">OAD External Flash Image Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="../oad-secure/flash-layout-off-chip.html">Flash Layout for Off-Chip OAD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../oad-secure/flash-layout-on-chip-stack-library.html">Flash Layout for On-Chip OAD</a></li>
<li class="toctree-l3"><a class="reference internal" href="oad-transport.html">TI 15.4-Stack OAD</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Turbo OAD Protocol</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#turbo-oad-image-tool">Turbo OAD Image Tool</a></li>
<li class="toctree-l4"><a class="reference internal" href="#turbo-oad-block-transfer-overview">Turbo OAD Block Transfer Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#turbo-oad-image-reconstruction-process-overview">Turbo OAD Image Reconstruction Process Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#turbo-oad-delta-image-header">Turbo OAD Delta Image Header</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../oad-secure/tools.html">OAD Image Tool</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ti154stack-guide/sysconfig-index.html">System Configuration (SysConfig)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/custom-hardware-cc13xx_cc26xx.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coexistence/coexistence-ieee.html">Wi-Fi Coexistence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/memory-index.html">Memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security-tfm/index.html">Security Features of CC13x4 and CC26x4 Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/migration-guide-cc13xx_cc26xx.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html">API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#terms-and-acronyms">Terms and Acronyms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../ti154stack-guide/index-cc13xx_cc26xx.html">
SimpleLink™ CC13XX/CC26XX SDK
TI 15.4-Stack User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../ti154stack-guide/index-cc13xx_cc26xx.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../ti154stack-guide/ti154stack-index-cc13xx_cc26xx.html">TI 15.4-Stack</a> &raquo;</li>
          <li><a href="../ti154stack-guide/oad-secure-index.html">Over-the-Air Download (OAD)</a> &raquo;</li>
      <li>Turbo OAD Protocol</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="turbo-oad-protocol">
<span id="sec-turbo-oad"></span><h1>Turbo OAD Protocol<a class="headerlink" href="#turbo-oad-protocol" title="Permalink to this headline">¶</a></h1>
<p>The Turbo OAD Protocol was designed to speed up the traditional OAD protocol,
specifically in terms of power consumption and over the air time.</p>
<p>Turbo OAD enables the support of using delta software updates in
the OAD protocol. Delta updates are software updates that contain only the
changed or updated content in the new software image.</p>
<p>This section describes the Turbo OAD process and how it is used in conjunction
with the traditional OAD protocol described above. For information on how to
enable Turbo OAD, please refer to the TI 15.4 stack OAD examples’ readme files.</p>
<div class="figure align-center" id="fig-toad-high-level">
<img alt="../_images/fig-toad-high-level.png" src="../_images/fig-toad-high-level.png" />
<p class="caption"><span class="caption-number">Figure 99. </span><span class="caption-text">High Level Overview of Turbo OAD integration</span><a class="headerlink" href="#fig-toad-high-level" title="Permalink to this image">¶</a></p>
</div>
<p>As shown in <a class="reference internal" href="#fig-toad-high-level"><span class="std std-numref">Figure 99.</span></a>, the core logic of Turbo OAD to create
delta images is done with the Turbo OAD Image Tool, while reconstructing the
delta image is done on the OAD Target device.</p>
<div class="section" id="turbo-oad-image-tool">
<h2>Turbo OAD Image Tool<a class="headerlink" href="#turbo-oad-image-tool" title="Permalink to this headline">¶</a></h2>
<p>The Turbo OAD Image tool is invoked as a post-build step by the OAD project.
The purpose of the tool is to perform the delta and run-length encoding
processes. The Turbo OAD Image tool takes in two binary images and outputs one delta image,
which is then sent to the target OAD device through the OAD protocol described
above.</p>
<p>The tool will also determine if a Turbo OAD is needed based on the
delta image. If there is no power / image size savings by using Turbo OAD, then
regular OAD will be used. The tool will output an error message indicating that
the delta image was not created.</p>
</div>
<div class="section" id="turbo-oad-block-transfer-overview">
<h2>Turbo OAD Block Transfer Overview<a class="headerlink" href="#turbo-oad-block-transfer-overview" title="Permalink to this headline">¶</a></h2>
<p>The OAD protocol for transferring the image mainly remains the same. However,
instead of directly writing received OAD blocks to external/internal flash, OAD
blocks are cached in RAM and are decoded (during the OAD image transfer) before
writing to flash. This has the following implications:</p>
<blockquote>
<div><ul class="simple">
<li><p>No additional flash space is required to store the delta image.</p></li>
<li><p>RAM is required to store received OAD blocks and a write buffer to store
decoded image data before flashing. In general, the more RAM used, the
faster the OAD and decoding process will be.</p></li>
<li><p>Since the RAM used is dynamically allocated, the OAD update could fail on
initialization if there are insufficient resources to decode the delta image.</p></li>
<li><p>OAD block requests may need to be temporarily ‘paused’ if the block buffer
cache is full and the device is still decoding data. OAD block requests will
resume once there is space in the storage buffer to continue the transfer.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="turbo-oad-image-reconstruction-process-overview">
<h2>Turbo OAD Image Reconstruction Process Overview<a class="headerlink" href="#turbo-oad-image-reconstruction-process-overview" title="Permalink to this headline">¶</a></h2>
<p>The 15.4 OAD protocol initiates the OAD transfer by having the collector select
the delta image to transfer and sending the ImgIdentifyReq to the sensor. The
Turbo OAD segment header fields have been added to the ImgIdentifyReq to
facilitate the transfer of delta images. For more information regarding the
Turbo OAD header segment, see the Turbo OAD Delta Image Header section.</p>
<div class="figure align-center" id="fig-toad-image-validation">
<img alt="../_images/fig-toad-image-validation.png" src="../_images/fig-toad-image-validation.png" />
<p class="caption"><span class="caption-number">Figure 100. </span><span class="caption-text">Turbo OAD Image Validation and Reconstruction Overview</span><a class="headerlink" href="#fig-toad-image-validation" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Performing a Turbo OAD to a target device that has been flashed with
traditional OAD firmware is not supported.</p>
</div>
<p>The image reconstruction process is done during the OAD transfer. The decoding
process consists of a temporary block cache (ring buffer) that stores received
blocks which have not been decoded. Decoded blocks are written to an image
buffer that is then flashed to the device when filled.</p>
<p>The process begins with receiving an OAD block from the collector. After a
control block instruction has been received, the decoding process will begin.
When the data from the OAD block has been decoded, the block will be marked to
indicate that the space can be used to store a subsequent OAD block.</p>
<p>Note that each OAD block is a pre-determined size as specified by the
<code class="docutils literal notranslate"><span class="pre">OAD_BLOCK_SIZE</span></code> define. A Delta Image block can be any arbitrary size, and
typically will be larger than <code class="docutils literal notranslate"><span class="pre">OAD_BLOCK_SIZE</span></code>. The implication of this is
that multiple OAD blocks must be received by the sensor until a decoding
instruction can fully be processed. However, the complete instruction does not
need to be received in order to begin the decoding process.</p>
<p>OAD blocks are still requested at the rate defined by <code class="docutils literal notranslate"><span class="pre">OAD_BLOCK_REQ_RATE</span></code>.
However, if the OAD block cache is full, the OAD transfer will be paused until
there is room to store the next block.</p>
<div class="figure align-center" id="fig-toad-state-machine">
<img alt="../_images/fig-toad-state-machine.png" src="../_images/fig-toad-state-machine.png" />
<p class="caption"><span class="caption-number">Figure 101. </span><span class="caption-text">Turbo OAD Decoding State Machine</span><a class="headerlink" href="#fig-toad-state-machine" title="Permalink to this image">¶</a></p>
</div>
<table class="docutils align-default" id="tab-toad-decode-defines">
<caption><span class="caption-number">Table 23. </span><span class="caption-text">Turbo OAD Decoding State Machine Descriptions</span><a class="headerlink" href="#tab-toad-decode-defines" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 8%" />
<col style="width: 92%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>State</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Uninitialized</p></td>
<td><p>Starting state before the Turbo OAD module has been initialized</p></td>
</tr>
<tr class="row-odd"><td><p>Idle</p></td>
<td><p>The module is waiting for new data to be received in the block cache</p></td>
</tr>
<tr class="row-even"><td><p>Decoding</p></td>
<td><p>The module is currently decoding a delta block</p></td>
</tr>
<tr class="row-odd"><td><p>Waiting</p></td>
<td><p>The module is either currently decoding a delta block or is ready to begin decoding the next block. However, not enough data is available in the block cache to continue decoding</p></td>
</tr>
<tr class="row-even"><td><p>Done</p></td>
<td><p>Completion of decoding the delta image</p></td>
</tr>
</tbody>
</table>
<p>Since the length of the uncompressed delta block is variable, the decoding
process will yield to the application task if the image buffer has been flushed,
or a full instruction has been decoded. If an instruction has not been fully
decoded, the decoding process will resume after any pending application code has
been executed.</p>
</div>
<div class="section" id="turbo-oad-delta-image-header">
<h2>Turbo OAD Delta Image Header<a class="headerlink" href="#turbo-oad-delta-image-header" title="Permalink to this headline">¶</a></h2>
<p>Upon completion of the OAD transfer and delta image decoding, the Turbo OAD
process is complete, and the normal process of verifying the image CRC and
rebooting remains the same.</p>
<p>The modified OAD Image Header can be seen in <code class="docutils literal notranslate"><span class="pre">oad_image_header_app.c</span></code> as shown here:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">imgID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OAD_IMG_ID_VAL</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">crc32</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_CRC</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">bimVer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BIM_VER</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">metaVer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">META_VER</span><span class="p">,</span><span class="w">                   </span><span class="c1">//!&lt; Metadata version */</span>

<span class="w">    </span><span class="p">.</span><span class="n">techType</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">OAD_WIRELESS_TECH_TIMAC</span><span class="p">,</span><span class="w">    </span><span class="c1">//!&lt; Wireless protocol type BLE/TI-MAC/ZIGBEE etc. */</span>

<span class="w">    </span><span class="p">.</span><span class="n">imgCpStat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_STATE</span><span class="p">,</span><span class="w">            </span><span class="c1">//!&lt; Image copy status bytes */</span>
<span class="w">    </span><span class="p">.</span><span class="n">crcStat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DEFAULT_STATE</span><span class="p">,</span><span class="w">              </span><span class="c1">//!&lt; CRC status */</span>
<span class="w">    </span><span class="p">.</span><span class="n">imgNo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x1</span><span class="p">,</span><span class="w">                          </span><span class="c1">//!&lt; Image number of &#39;image type&#39; */</span>
<span class="w">    </span><span class="p">.</span><span class="n">imgVld</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w">                  </span><span class="c1">//!&lt; In indicates if the current image in valid 0xff - valid, 0x00 invalid image */</span>
<span class="w">    </span><span class="p">.</span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INVALID_LEN</span><span class="p">,</span><span class="w">                     </span><span class="c1">//!&lt; Image length in bytes. */</span>
<span class="w">    </span><span class="p">.</span><span class="n">softVer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SOFTWARE_VER</span><span class="p">,</span><span class="w">               </span><span class="c1">//!&lt; Software version of the image */</span>
<span class="w">    </span><span class="p">.</span><span class="n">hdrLen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">offsetof</span><span class="p">(</span><span class="n">imgHdr_t</span><span class="p">,</span><span class="w"> </span><span class="n">fixedHdr</span><span class="p">.</span><span class="n">rfu</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(((</span><span class="n">imgHdr_t</span><span class="p">){</span><span class="mi">0</span><span class="p">}).</span><span class="n">fixedHdr</span><span class="p">.</span><span class="n">rfu</span><span class="p">),</span><span class="w"></span>
<span class="w">                                            </span><span class="c1">//!&lt; Total length of the image header */</span>
<span class="w">    </span><span class="p">.</span><span class="n">rfu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xFFFF</span><span class="p">,</span><span class="w">                         </span><span class="c1">//!&lt; reserved bytes */</span>
<span class="cp">#ifdef __TI_COMPILER_VERSION__</span>
<span class="w">    </span><span class="p">.</span><span class="n">prgEntry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">prgEntryAddr</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">.</span><span class="n">imgEndAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span><span class="o">&amp;</span><span class="n">flashEndAddr</span><span class="p">,</span><span class="w"></span>
<span class="cp">#elif  defined(__IAR_SYSTEMS_ICC__)</span>
<span class="w">    </span><span class="p">.</span><span class="n">prgEntry</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)(</span><span class="n">__section_begin</span><span class="p">(</span><span class="s">&quot;.intvec&quot;</span><span class="p">)),</span><span class="w"> </span><span class="c1">//!&lt; Program entry address */</span>
<span class="w">    </span><span class="p">.</span><span class="n">imgEndAddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)(</span><span class="n">__section_end</span><span class="p">(</span><span class="s">&quot;ROSTK&quot;</span><span class="p">)),</span><span class="w"></span>
<span class="cp">#endif</span>
<span class="w">  </span><span class="cp">#if defined HAL_IMAGE_A</span>
<span class="w">    </span><span class="p">.</span><span class="n">imgType</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">OAD_IMG_TYPE_PERSISTENT_APP</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="cp">#else</span>
<span class="w">    </span><span class="p">.</span><span class="n">imgType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OAD_IMG_TYPE_APPSTACKLIB</span><span class="p">,</span><span class="w"></span>
<span class="w">  </span><span class="cp">#endif</span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<table class="docutils align-default" id="tab-toad-image-header-seg-val">
<caption><span class="caption-number">Table 24. </span><span class="caption-text">Turbo OAD Image Segment Values</span><a class="headerlink" href="#tab-toad-image-header-seg-val" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 75%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Segment Type</p></td>
<td><p>0x05 (Delta Image)</p></td>
</tr>
<tr class="row-odd"><td><p>Wireless Technology</p></td>
<td><p>0xFFFD (Sub-1 Ghz) or 0xFFFB (2.4 Ghz)</p></td>
</tr>
<tr class="row-even"><td><p>Reserved</p></td>
<td><p>0xFF</p></td>
</tr>
<tr class="row-odd"><td><p>Payload Length</p></td>
<td><p>0x14</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="tab-toad-image-header-seg-format">
<caption><span class="caption-number">Table 25. </span><span class="caption-text">Turbo OAD Segment Header</span><a class="headerlink" href="#tab-toad-image-header-seg-format" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 12%" />
<col style="width: 16%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Size (in bytes)</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>isDeltaImg</p></td>
<td><p>1</p></td>
<td><p>Indicates if the image is a delta image</p></td>
</tr>
<tr class="row-odd"><td><p>memoryCfg</p></td>
<td><p>1</p></td>
<td><p>OAD flash configuration (off-chip or on-chip)</p></td>
</tr>
<tr class="row-even"><td><p>newImgCrc</p></td>
<td><p>4</p></td>
<td><p>Crc value of the new/updated application image to be flashed on the device</p></td>
</tr>
<tr class="row-odd"><td><p>oldImgCrc</p></td>
<td><p>4</p></td>
<td><p>Crc value of the old/current application image running on the device</p></td>
</tr>
<tr class="row-even"><td><p>toadMetaVer</p></td>
<td><p>1</p></td>
<td><p>Version of the delta image header segment</p></td>
</tr>
<tr class="row-odd"><td><p>toadVer</p></td>
<td><p>1</p></td>
<td><p>Version of the Turbo OAD decoding algorithm</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="tab-toad-image-header-oad-data">
<caption><span class="caption-number">Table 26. </span><span class="caption-text">Modified OAD Header data</span><a class="headerlink" href="#tab-toad-image-header-oad-data" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 11%" />
<col style="width: 15%" />
<col style="width: 74%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Image Length</p></td>
<td><p>Delta Image Length</p></td>
<td><p>Uncompressed image’s length is stored in the Turbo OAD segment header after image is reconstructed</p></td>
</tr>
</tbody>
</table>
<p>The Turbo OAD Version and Original Image CRC field is used during the
ImgIdentifyReq to ensure that the delta image can properly be reconstructed. The
length of the new image is stored in the Turbo OAD header because the OAD
header’s length field is the size of the delta image and not the reconstructed
image size. When the OAD header is received from delta image, the length field
will be replaced with the value stored in the ‘Image Length’ field, also the
Turbo OAD header segment will not be re-written from the binary image into flash
when the OAD target receives the image. This is done to preserve compatibility
with cc13x0 BIM.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Turbo OAD is currently not supported for on-chip OAD.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="oad-transport.html" class="btn btn-neutral float-left" title="TI 15.4-Stack OAD" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../oad-secure/tools.html" class="btn btn-neutral float-right" title="OAD Image Tool" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>