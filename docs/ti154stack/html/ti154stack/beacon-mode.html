<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Beacon Enabled Mode &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
TI 15.4-Stack User&#39;s Guide
 6.10.01.00 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Non-Beacon Mode" href="non-beacon-mode.html" />
    <link rel="prev" title="Secure Commissioning" href="secure-commissioning.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug ti154stack beacon-mode";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../ti154stack-guide/index-cc13xx_cc26xx.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
TI 15.4-Stack User's Guide

          </a>
              <div class="version">
                6.10.01.00
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/quickstart-intro-cc13xx_cc26xx.html">Introduction to the SimpleLink CC13xx/CC26xx SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/index-platform.html">SimpleLink Wireless MCU CC13xx and CC26xx Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/tirtos-index-cc13xx_cc26xx.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../ti154stack-guide/ti154stack-index-cc13xx_cc26xx.html">TI 15.4-Stack</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ti154stack-overview-cc13xx_cc26xx.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="ti154stack-overview-cc13xx_cc26xx.html#architecture-choices">Architecture Choices</a></li>
<li class="toctree-l2"><a class="reference internal" href="ti154stack-overview-cc13xx_cc26xx.html#data-rate-and-phy">Data Rate and PHY</a></li>
<li class="toctree-l2"><a class="reference internal" href="application-overview.html">Application Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="example-applications.html">Example Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="common-user-interface.html">Common User Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="secure-commissioning.html">Secure Commissioning</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Beacon Enabled Mode</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#background-information">Background Information</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#beacon-interval">Beacon Interval</a></li>
<li class="toctree-l4"><a class="reference internal" href="#beacon-payload">Beacon Payload</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#network-operations">Network Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#network-start-up">Network Start-Up</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-association">Network Association</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-exchange">Data Exchange</a></li>
<li class="toctree-l4"><a class="reference internal" href="#maintaining-a-connection-for-end-nodes">Maintaining a Connection for End Nodes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#network-disassociation">Network Disassociation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#stack-configuration-knobs">Stack Configuration Knobs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#attribute-configuration">Attribute Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-constants">Configuration Constants</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="non-beacon-mode.html">Non-Beacon Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="frequency-hopping-mode.html">Frequency-Hopping Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="arib-regulation-type.html">ARIB Regulation Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring-stack.html">Configuring Stack</a></li>
<li class="toctree-l2"><a class="reference internal" href="packet-sniffer.html">SmartRF Protocol Packet Sniffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="creating-custom-applications.html">Creating Custom Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cc13xx_cc26xx/fcc-certification.html">FCC Certification Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ti154stack-guide/oad-secure-index.html">Over-the-Air Download (OAD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ti154stack-guide/sysconfig-index.html">System Configuration (SysConfig)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/custom-hardware-cc13xx_cc26xx.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coexistence/coexistence-ieee.html">Wi-Fi Coexistence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/memory-index.html">Memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security-tfm/index.html">Security Features of CC13x4 and CC26x4 Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/migration-guide-cc13xx_cc26xx.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html">API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#terms-and-acronyms">Terms and Acronyms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../ti154stack-guide/index-cc13xx_cc26xx.html">
SimpleLink™ CC13XX/CC26XX SDK
TI 15.4-Stack User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../ti154stack-guide/index-cc13xx_cc26xx.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../ti154stack-guide/ti154stack-index-cc13xx_cc26xx.html">TI 15.4-Stack</a> &raquo;</li>
      <li>Beacon Enabled Mode</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="beacon-enabled-mode">
<span id="sec-beacon-mode"></span><h1>Beacon Enabled Mode<a class="headerlink" href="#beacon-enabled-mode" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-IEEE"><span class="xref std std-term">IEEE</span></a> 802.15.4 specification defines beacon-enabled mode of
operation where the personal area network (<a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-PAN"><span class="xref std std-term">PAN</span></a>) coordinator device
transmits periodic beacons to indicate its presence and allows other devices to
perform PAN discovery and synchronization. The beacons provide beacon-related
information and also mark the start of the new superframe. The beacon has
information on the superframe specification, which helps the device intending
to join the network to synchronize timing and network related parameters before
starting the join process. The beacon helps the existing device in the PAN to
maintain the network synchronization. The superframe is divided into an active
and an inactive period. During the active period, devices communicate using the
<a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-CSMA-CA"><span class="xref std std-term">CSMA-CA</span></a> procedure except in 863MHz band where <a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-LBT"><span class="xref std std-term">LBT</span></a> is used for
channel access. The inactive period allows the devices in the network to
conserve energy.</p>
</div>
<div class="section" id="background-information">
<h2>Background Information<a class="headerlink" href="#background-information" title="Permalink to this headline">¶</a></h2>
<p>This section gives an outline of how IEEE beacon mode works. If you are already
familiar with the spec description you can skip this section.</p>
<p><a class="reference internal" href="#fig-superframe"><span class="std std-numref">Figure 52.</span></a> shows the beacon progression. Here is a chronological overview of
the beacon superframe:</p>
<div class="figure align-center" id="id5">
<span id="fig-superframe"></span><img alt="../_images/superframe-progression.png" src="../_images/superframe-progression.png" />
<p class="caption"><span class="caption-number">Figure 52. </span><span class="caption-text">Beacon Superframe</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<ol class="arabic simple">
<li><p>The coordinator transmits the beacon</p></li>
<li><p>Contention assessment period (<a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-CAP"><span class="xref std std-term">CAP</span></a>). In this period, nodes can transmit
messages using the <a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-CSMA-CA"><span class="xref std std-term">CSMA-CA</span></a> mechanism. This mechanism allows any node
to try to transmit a message at any time, the node order is not set.</p></li>
<li><p>Contention free period (<a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-CFP"><span class="xref std std-term">CFP</span></a>). The contention free period contains
assigned slots where only an assigned node can transmit. Please note the TI
15.4-Stack does not implement CFP functionality.</p></li>
<li><p>The coordinator can go into an inactive period. During this period all the
devices in the network sleep.</p></li>
<li><p>After the inactive period the coordinator transmits the next beacon and the
cycle is repeated.</p></li>
</ol>
<table class="docutils align-default" id="id6">
<caption><span class="caption-number">Table 3. </span><span class="caption-text">Stages of the beacon superframe</span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 21%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Stage</p></th>
<th class="head"><p>Collector action</p></th>
<th class="head"><p>Node action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Beacon</p></td>
<td><p>Transmit beacon</p></td>
<td><p>Optional Rx or sleep</p></td>
</tr>
<tr class="row-odd"><td><p>CAP</p></td>
<td><p>Rx</p></td>
<td><p>Optional: Use CSMA-CA to transmit package</p></td>
</tr>
<tr class="row-even"><td><p>CFP</p></td>
<td><p>Rx</p></td>
<td><p>If applicable: Transmit package in alloted slot</p></td>
</tr>
<tr class="row-odd"><td><p>Inactive period</p></td>
<td><p>Sleep</p></td>
<td><p>Sleep</p></td>
</tr>
</tbody>
</table>
<div class="section" id="beacon-interval">
<h3>Beacon Interval<a class="headerlink" href="#beacon-interval" title="Permalink to this headline">¶</a></h3>
<p>The time between two Beacons is called the beacon interval. According to the IEEE
standard it is not possible to directly configure the beacon interval. However,
by tweaking other beacon enabled mode settings the beacon interval can be adjusted.</p>
<ul class="simple">
<li><p><strong>Beacon order (BO)</strong></p></li>
<li><p><strong>Superframe order (SO)</strong></p></li>
<li><dl class="simple">
<dt><strong>Superframe duration which in turn is decided by:</strong></dt><dd><ul>
<li><p>Slot duration</p></li>
<li><p>Number of slots in the superframe</p></li>
<li><p>Symbol rate</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Calculations for the superframe duration is found in the
<a class="reference internal" href="#sec-network-association"><span class="std std-ref">Network Association</span></a> section.</p>
<p>On the coordinator application, the BO is used to configure the interval between
beacon transmissions. On the nodes, it is used to set the beacon order
during the joining phase, after the passive scan of beacons and after the device
makes the decision on which coordinator to join. The BO must be set to the same
value on the coordinator and the nodes. BO is a number between 0 and 15.</p>
<p>The SO configures the length of the active portion of the superframe. On the
nodes, this setting is used to set the superframe order during the joining phase,
after the passive scan of beacons and after the device makes the decision on
which coordinator to join. The SO must be set to the same value on the coordinator
and the nodes. SO is a number between 0 and 15.</p>
<p>For developers who wish to configure a beacon enabled network with a target
beacon interval, the recommended work flow is outlined below:</p>
<ol class="arabic">
<li><p><strong>Configure all parameters except the BO</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>PHY and symbol rate</p></li>
<li><p>Superframe order</p></li>
<li><p>Security settings</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>Experiment with different BO settings and calculate or measure the resulting
beacon order</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>The beacon interval can be calculated based on equations in the IEEE
standard</p></li>
<li><p>Choosing different BO values, the beacon interval can be measured by
sniffing the TI 15.4-Stack network.</p></li>
</ul>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="beacon-payload">
<h3>Beacon Payload<a class="headerlink" href="#beacon-payload" title="Permalink to this headline">¶</a></h3>
<p>Developers can add a payload to the beacon, to achive this a developer can call use the
following code block.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">ApiMac_mlmeSetReqUint8</span><span class="p">(</span><span class="n">ApiMac_attribute_beaconPayloadLength</span><span class="p">,</span><span class="w"> </span><span class="n">sizeOfBuf</span><span class="p">);</span><span class="w"> </span><span class="c1">//set the beacon payload length</span>
<span class="n">ApiMac_mlmeSetReqArray</span><span class="p">(</span><span class="n">ApiMac_attribute_beaconPayload</span><span class="p">,</span><span class="w"> </span><span class="n">buf</span><span class="p">);</span><span class="w"> </span><span class="c1">// set the beacon payload</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The beacon size cannot exceed 56 bytes.</p>
</div>
</div>
</div>
<div class="section" id="network-operations">
<h2>Network Operations<a class="headerlink" href="#network-operations" title="Permalink to this headline">¶</a></h2>
<p>This section describes critical network operations for the beacon-enabled mode
of operation.</p>
<div class="section" id="network-start-up">
<h3>Network Start-Up<a class="headerlink" href="#network-start-up" title="Permalink to this headline">¶</a></h3>
<p>A network is always started by a fully functional device after performing a MAC
sublayer reset. The network operates on a single channel (frequency hopping is
not available in this configuration, although frequency agility may be
implemented by application-specific means). To select the most optimal channel
of operation, the fully functional device (before starting the network) can
optionally scan for the channels with the least amount of radio interference by
first performing the energy-detect scan to identify the list of channels with
the least amount of <a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-RF"><span class="xref std std-term">RF</span></a> energy. When a list of channels is identified,
the fully functional device can (optionally) perform active scan to find the
channel with the least number of active networks. When the channel with the
least RF energy and lowest number of active networks is selected, the PAN
coordinator must set its short address (the PAN identifier) beacon payload and
turn on the associate permit flag. The network starts upon the following
actions:</p>
<ul class="simple">
<li><p>Call to <code class="docutils literal notranslate"><span class="pre">ApiMac_mlmeStartReq()</span></code> API</p>
<ul>
<li><p>With the PAN coordinator parameter set to <em>TRUE</em></p></li>
<li><p>With the desired superframe configuration</p></li>
<li><p>Coordinator realignment parameter set to <em>FALSE</em></p></li>
</ul>
</li>
</ul>
<p><a class="reference internal" href="#fig-beacon-mode-network-start-up-sequence"><span class="std std-numref">Figure 53.</span></a> shows the interaction
between the application and TI 15.4-Stack to start the beacon-enabled network by
the PAN coordinator.</p>
<div class="figure align-center" id="fig-beacon-mode-network-start-up-sequence">
<img alt="../_images/fig-beacon-mode-network-start-up-sequence.png" src="../_images/fig-beacon-mode-network-start-up-sequence.png" />
<p class="caption"><span class="caption-number">Figure 53. </span><span class="caption-text">Beacon Mode Network Start-Up Sequence</span><a class="headerlink" href="#fig-beacon-mode-network-start-up-sequence" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="network-association">
<span id="sec-network-association"></span><h3>Network Association<a class="headerlink" href="#network-association" title="Permalink to this headline">¶</a></h3>
<p>A device that is intended to join the beacon-enabled network must first perform
a passive channel scan. The results of the channel scan can then be used to
choose a suitable network. Following the selection of an association network,
the application should set the following <a class="reference internal" href="../ti154stack-guide/references-cc13xx_cc26xx.html#term-PIB"><span class="xref std std-term">PIB</span></a> items:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_beaconOrder</span></code></p>
<ul>
<li><p>Set to the value received in the beacon superframe specification of
the chosen PAN</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_superframeOrder</span></code></p>
<ul>
<li><p>Set to the value received in the beacon superframe specification of
the chosen PAN</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_panId</span></code></p>
<ul>
<li><p>PAN identifier of the PAN</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_coordShortAddress</span></code></p>
<ul>
<li><p>Short address of the PAN coordinator</p></li>
</ul>
</li>
</ul>
<p>The next step is to perform beacon synchronization to track the beacon and to
detect any pending messages. Synchronization is requested by using the
<code class="docutils literal notranslate"><span class="pre">ApiMac_mlmeSyncReq()</span></code> API call and setting the following parameters:</p>
<ul class="simple">
<li><p>Channel</p></li>
<li><p>PHY identifier</p></li>
<li><p>Channel page</p></li>
<li><p>Setting track beacon to TRUE</p></li>
</ul>
<p>To acquire beacon synchronization, the device searches for the maximum time calculated as follows:</p>
<blockquote>
<div><p><img class="math" src="../_images/math/1ed217962e3755bc7a560e15bb681d75613bb5d0.svg" alt="aBaseSuperframeDuration* (2n + 1), where n is the value of the beacon order"/></p>
</div></blockquote>
<p>and</p>
<blockquote>
<div><p><img class="math" src="../_images/math/b1da56ed8257e60e318a2fdb60ecac3db358700a.svg" alt="aBaseSuperframeDuration = aBaseSlotDuration X aNumSuperframeSlots = 60*16 = 960 symbols"/></p>
</div></blockquote>
<p>Note that <cite>aBaseSlotDuration</cite> and <cite>aNumSuperframeSlots</cite> are constants. Refer to
the IEEE 802.15.4 specification for their definition.</p>
<p>The device must to wait for the previously stated time period for the
synchronization process to complete. Alternatively the device can turn off the
Auto Request by setting the <code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_autoRequest</span></code> attribute item to
FALSE, which forces the MAC sublayer to send the beacon notification to the
upper layer. If the application receives beacon notification indications for
the normal beacon and no sync loss indication, it is a good indication that the
device has synchronized with the coordinator beacons. TI recommends waiting for
at least two beacon notifications before turning on the Auto Request.</p>
<p>When the device is synchronized to the network and is tracking the beacon, the
application can perform the network association. The
<code class="docutils literal notranslate"><span class="pre">ApiMac_mlmeAssociateReq()</span></code> API call is used to send the association request
message to the coordinator. The association process is successful when the
application receives the association confirmation.</p>
<p><a class="reference internal" href="#fig-beacon-mode-associate-sequence"><span class="std std-numref">Figure 54.</span></a> shows a device performing the
network association.</p>
<div class="figure align-center" id="fig-beacon-mode-associate-sequence">
<img alt="../_images/fig-beacon-mode-associate-sequence.png" src="../_images/fig-beacon-mode-associate-sequence.png" />
<p class="caption"><span class="caption-number">Figure 54. </span><span class="caption-text">Beacon Mode Device Association Sequence</span><a class="headerlink" href="#fig-beacon-mode-associate-sequence" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="data-exchange">
<h3>Data Exchange<a class="headerlink" href="#data-exchange" title="Permalink to this headline">¶</a></h3>
<p>The sequence diagram in <a class="reference internal" href="#fig-beacon-mode-direct-data-sequence"><span class="std std-numref">Figure 55.</span></a> depicts
the various direct data transactions between an always-on (mains powered)
device and a coordinator in a beacon-enabled network.</p>
<div class="figure align-center" id="fig-beacon-mode-direct-data-sequence">
<img alt="../_images/fig-beacon-mode-direct-data-sequence.png" src="../_images/fig-beacon-mode-direct-data-sequence.png" />
<p class="caption"><span class="caption-number">Figure 55. </span><span class="caption-text">Beacon Mode Direct Data Exchange Sequence</span><a class="headerlink" href="#fig-beacon-mode-direct-data-sequence" title="Permalink to this image">¶</a></p>
</div>
<p>The sequence diagram in <a class="reference internal" href="#fig-beacon-mode-indirect-data-sequence"><span class="std std-numref">Figure 56.</span></a>
depicts the indirect data transaction in a beacon-enabled network.</p>
<div class="figure align-center" id="fig-beacon-mode-indirect-data-sequence">
<img alt="../_images/fig-beacon-mode-indirect-data-sequence.png" src="../_images/fig-beacon-mode-indirect-data-sequence.png" />
<p class="caption"><span class="caption-number">Figure 56. </span><span class="caption-text">Beacon Mode Indirect Data Exchange Sequence</span><a class="headerlink" href="#fig-beacon-mode-indirect-data-sequence" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="maintaining-a-connection-for-end-nodes">
<h3>Maintaining a Connection for End Nodes<a class="headerlink" href="#maintaining-a-connection-for-end-nodes" title="Permalink to this headline">¶</a></h3>
<p>All devices operating on a beacon-enabled PAN must acquire beacon
synchronization with a coordinator. Synchronization is performed by receiving
and decoding the beacon frame information. The beacon frame contains the super-
frame specification which lets the device sync its timing information with the
coordinator and detect any pending messages.</p>
<p>During the network association phase, the end device calls the
<code class="docutils literal notranslate"><span class="pre">ApiMac_mlmeSyncReq()</span></code> API with the <code class="docutils literal notranslate"><span class="pre">trackBeacon</span></code> parameter set to TRUE to
acquire beacon and keep track of it (see <a class="reference internal" href="#fig-beacon-mode-sync-loss-sequence"><span class="std std-numref">Figure 57.</span></a>
). With the track beacon set to TRUE, the MAC sublayer shall enable
its receiver at a time before the next expected beacon frame transmission. If
the number of consecutive beacons missed by the MAC sub layer reaches the
maximum allowed (four beacons), the TI 15.4-Stack makes a callback
<code class="docutils literal notranslate"><span class="pre">ApiMac_syncLossIndFp_t()</span></code> with a status of <code class="docutils literal notranslate"><span class="pre">ApiMac_status_beaconLoss</span></code> to
the application. The application tries to resynchronize with the coordinator by
calling <code class="docutils literal notranslate"><span class="pre">ApiMac_mlmeSyncReq()</span></code> with <code class="docutils literal notranslate"><span class="pre">trackBeacon</span></code> set to TRUE.</p>
<div class="figure align-center" id="fig-beacon-mode-sync-loss-sequence">
<img alt="../_images/fig-beacon-mode-sync-loss-sequence.png" src="../_images/fig-beacon-mode-sync-loss-sequence.png" />
<p class="caption"><span class="caption-number">Figure 57. </span><span class="caption-text">Beacon Mode Sync Loss Sequence</span><a class="headerlink" href="#fig-beacon-mode-sync-loss-sequence" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="network-disassociation">
<h3>Network Disassociation<a class="headerlink" href="#network-disassociation" title="Permalink to this headline">¶</a></h3>
<p>This section describes three scenarios. The first two scenarios are initiated
by the coordinator (one for the mains powered end device and the other for the
battery powered end device). In the third scenario, the end device
disassociates itself from the network.</p>
<p>When the coordinator application requires an associated device to leave the
network, the coordinator application requests that TI 15.4-Stack sends a
disassociation notification command by using the
<code class="docutils literal notranslate"><span class="pre">ApiMac_mlmeDisassociateReq()</span></code> call. If the <code class="docutils literal notranslate"><span class="pre">txIndirect</span></code> parameter is set
to TRUE, the TI 15.4-Stack sends the disassociation notification command to the
device using indirect transmission; then, the disassociation notification
command is added to the list of pending transactions stored on the coordinator
and pulled by the device using a data request command (see
<a class="reference internal" href="#fig-beacon-mode-indirect-disassociation-sequence"><span class="std std-numref">Figure 58.</span></a>).</p>
<div class="figure align-center" id="fig-beacon-mode-indirect-disassociation-sequence">
<img alt="../_images/fig-beacon-mode-indirect-disassociation-sequence.png" src="../_images/fig-beacon-mode-indirect-disassociation-sequence.png" />
<p class="caption"><span class="caption-number">Figure 58. </span><span class="caption-text">Beacon Mode Coordinator Initiated Indirect Disassociation Sequence</span><a class="headerlink" href="#fig-beacon-mode-indirect-disassociation-sequence" title="Permalink to this image">¶</a></p>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">txIndirect</span></code> parameter is set to FALSE, TI 15.4-Stack sends the
disassociation notification command frame to the device using direct
transmission (see <a class="reference internal" href="#fig-beacon-mode-direct-disassociation-sequence"><span class="std std-numref">Figure 59.</span></a>).
The TI 15.4-Stack layer at the coordinator makes a callback to the application
using the registered function pointer of type <code class="docutils literal notranslate"><span class="pre">ApiMac_disassociateCnfFp_t</span></code>
after completion of the disassociation. TI 15.4-Stack at the end-device makes a
callback to the application using the registered function pointer of type
<code class="docutils literal notranslate"><span class="pre">ApiMac_disassociateIndFp_t</span></code> on reception of the disassociation notification
command frame from the coordinator.</p>
<div class="figure align-center" id="fig-beacon-mode-direct-disassociation-sequence">
<img alt="../_images/fig-beacon-mode-direct-disassociation-sequence.png" src="../_images/fig-beacon-mode-direct-disassociation-sequence.png" />
<p class="caption"><span class="caption-number">Figure 59. </span><span class="caption-text">Beacon Mode Coordinator-Initiated Direct Disassociation Sequence</span><a class="headerlink" href="#fig-beacon-mode-direct-disassociation-sequence" title="Permalink to this image">¶</a></p>
</div>
<p>The end-device application can also initiate the disassociation process as
described in <a class="reference internal" href="#fig-beacon-mode-device-disassociation-sequence"><span class="std std-numref">Figure 60.</span></a>.</p>
<div class="figure align-center" id="fig-beacon-mode-device-disassociation-sequence">
<img alt="../_images/fig-beacon-mode-device-disassociation-sequence.png" src="../_images/fig-beacon-mode-device-disassociation-sequence.png" />
<p class="caption"><span class="caption-number">Figure 60. </span><span class="caption-text">Beacon Mode Device-Initiated Disassociation Sequence</span><a class="headerlink" href="#fig-beacon-mode-device-disassociation-sequence" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="stack-configuration-knobs">
<h2>Stack Configuration Knobs<a class="headerlink" href="#stack-configuration-knobs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="attribute-configuration">
<h3>Attribute Configuration<a class="headerlink" href="#attribute-configuration" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#tab-beacon-mode-configuration"><span class="std std-numref">Table 4.</span></a> lists the attribute configuration for
beacon mode.</p>
<span id="tab-beacon-mode-configuration"></span><table class="docutils align-default" id="id7">
<caption><span class="caption-number">Table 4. </span><span class="caption-text">Attribute Configuration for Beacon Mode</span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 6%" />
<col style="width: 8%" />
<col style="width: 9%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Type</strong></p></th>
<th class="head"><p><strong>Range</strong></p></th>
<th class="head"><p><strong>API Number</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ApiMac_attribute_associatePermit</p></td>
<td><p>bool</p></td>
<td><p>TRUE, FALSE</p></td>
<td><p>0x41</p></td>
<td><p>TRUE if a coordinator is currently allowing association</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_attribute_autoRequest</p></td>
<td><p>bool</p></td>
<td><p>TRUE, FALSE</p></td>
<td><p>0x42</p></td>
<td><p>TRUE if a device automatically sends a data request if its address is listed in the beacon frame</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_attribute_beaconOrder</p></td>
<td><p>uint8</p></td>
<td><p>0–15</p></td>
<td><p>0x47</p></td>
<td><p>How often the coordinator transmits a beacon</p></td>
</tr>
<tr class="row-odd"><td><p>ApiMac_attribute_RxOnWhenIdle</p></td>
<td><p>bool</p></td>
<td><p>TRUE, FALSE</p></td>
<td><p>0x52</p></td>
<td><p>TRUE if the MAC enables its receiver during idle periods</p></td>
</tr>
<tr class="row-even"><td><p>ApiMac_attribute_superframeOrder</p></td>
<td><p>uint8</p></td>
<td><p>0–15</p></td>
<td><p>0x54</p></td>
<td><p>This specifies the length of the active portion of the superframe.</p></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_associatePermit</span></code> is used by the coordinator application
to indicate to the joining devices whether it allows association or not.
Setting this attribute item to TRUE by the coordinator indicates to the joining
devices in its beacon frame that the coordinator application allows
association.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_RxOnWhenIdle</span></code>, if set to TRUE, enables the receiver
during the idle period.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_RxOnWhenIdle</span></code>, if set to TRUE, enables the receiver
during the idle in the contention period of the superframe. The coordinator
application sets this item to TRUE.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_beaconOrder</span></code> item is used by the device application to
set the beacon order during the joining phase, after the passive scan of
beacons, and after the device makes the decision on which coordinator to join.
This attribute shall be set to the selected coordinators beacon order value.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ApiMac_attribute_superframeOrder</span></code> item is used by the device application
to set the superframe order during the joining phase, after the passive scan
of beacons, and after the device makes the decision on which coordinator to
join. This attribute shall be set to the selected coordinators beacon order
value.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The ApiMac_beaconType_enhanced beacon type is not supported on 15.4 projects
and will not affect project functionality if used.</p>
</div>
</div>
<div class="section" id="configuration-constants">
<h3>Configuration Constants<a class="headerlink" href="#configuration-constants" title="Permalink to this headline">¶</a></h3>
<p>TI 15.4-Stack uses a structure containing various user-configurable parameters
(at compile time). This structure, called <code class="docutils literal notranslate"><span class="pre">macCfg_t</span></code>, is in the <code class="docutils literal notranslate"><span class="pre">mac_cfg.c</span></code>
file. <a class="reference internal" href="#tab-beacon-config-constants"><span class="std std-numref">Table 5.</span></a> describes the configuration
elements.</p>
<span id="tab-beacon-config-constants"></span><table class="docutils align-default" id="id8">
<caption><span class="caption-number">Table 5. </span><span class="caption-text">Configuration Constants</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 8%" />
<col style="width: 78%" />
<col style="width: 7%" />
<col style="width: 6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Range</strong></p></th>
<th class="head"><p><strong>Default</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>txDataMax</p></td>
<td><p>Maximum number of data frames queued in the transmit data queue.</p></td>
<td><p>1–255</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>txMax</p></td>
<td><p>Maximum number of frames of all types queued in the transmit data queue.</p></td>
<td><p>1–255</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-even"><td><p>rxMax</p></td>
<td><p>Maximum number of frames queued in the receive data queue.</p></td>
<td><p>1–255</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>dataIndOffset</p></td>
<td><p>Allocate additional bytes in the data indication for application-defined headers.</p></td>
<td><p>0–127</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>appPendingQueue</p></td>
<td><p>When TRUE, registered callback of type ApiMac_pollIndFp_t will be made to the application when a data request command frame is received from another device.</p></td>
<td><p>TRUE or FALSE</p></td>
<td><p>FALSE</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="secure-commissioning.html" class="btn btn-neutral float-left" title="Secure Commissioning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="non-beacon-mode.html" class="btn btn-neutral float-right" title="Non-Beacon Mode" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>