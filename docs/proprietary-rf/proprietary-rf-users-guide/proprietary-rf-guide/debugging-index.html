<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Debugging &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
Proprietary RF User&#39;s Guide
 6.10.01 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Memory overview" href="memory-index.html" />
    <link rel="prev" title="Time synchronization over the air" href="../proprietary-rf/time-synchronization.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug proprietary-rf-guide debugging-index";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index-cc13xx_cc26xx.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
Proprietary RF User's Guide

          </a>
              <div class="version">
                6.10.01
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/proprietary-rf-quick-start.html">Proprietary RF Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/index-platform.html">SimpleLink Wireless MCU CC13xx and CC26xx Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples-cc13xx_cc26xx.html">Examples User’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom-hardware.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="tirtos-index-cc13xx_cc26xx.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="nortos-index.html">noRTOS Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="rf-core-index.html">RF Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="physical-rf-layer-cc13xx_cc26xx.html">Physical Layer (PHY)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Debugging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#external-resources">External Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debug-interfaces">Debug Interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#xds110-debug-probe">XDS110 Debug Probe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-debugger-in-code-composer-studio">Configuring Debugger in Code Composer Studio</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#find-the-serial-number">Find The Serial Number</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configure-serial-number">Configure Serial Number</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connecting-to-the-xds-debugger">Connecting to the XDS Debugger</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-debugger-in-iar">Configuring Debugger in IAR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#breakpoints">Breakpoints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#considerations">Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#breakpoints-and-timing">Breakpoints and Timing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#breakpoints-and-optimization">Breakpoints and Optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#breakpoints-in-ccs">Breakpoints in CCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#breakpoints-in-iar">Breakpoints in IAR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#watching-variables-and-registers">Watching Variables and Registers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variables-in-ccs">Variables in CCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#variables-in-iar">Variables in IAR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#memory-watchpoints">Memory Watchpoints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#watchpoints-in-ccs">Watchpoints in CCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#watchpoints-in-iar">Watchpoints in IAR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ti-rtos-object-viewer">TI-RTOS Object Viewer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scanning-the-bios-for-errors">Scanning the BIOS for Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#viewing-the-state-of-each-task">Viewing the State of Each Task</a></li>
<li class="toctree-l3"><a class="reference internal" href="#viewing-the-system-stack">Viewing the System Stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rov-in-ccs">ROV in CCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rov-in-iar">ROV in IAR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-memory-browser">Using the Memory Browser</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connect-the-debugger-to-a-running-target">Connect the debugger to a running target</a></li>
<li class="toctree-l2"><a class="reference internal" href="#optimizations">Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#optimizations-in-ccs">Optimizations in CCS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#project-wide-optimizations">Project-Wide Optimizations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#single-file-optimizations">Single-File Optimizations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#single-function-optimizations">Single-Function Optimizations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#optimizations-in-iar">Optimizations in IAR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">Project-Wide Optimizations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Single-File Optimizations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Single-Function Optimizations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deciphering-cpu-exceptions">Deciphering CPU Exceptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exception-cause">Exception Cause</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-ti-rtos-and-rov-to-parse-exceptions">Using TI-RTOS and ROV to Parse Exceptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#debugging-rf-output">Debugging RF Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debugging-guide-for-serial-interfaces">Debugging guide for serial interfaces</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#i2c">I2C</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spi">SPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#uart">UART</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="memory-index.html">Memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="sysconfig-index.html">System Configuration Tool (SysConfig)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration-cc13xx_cc26xx.html">Migration Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference-cc13xx_cc26xx.html">API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary-cc13xx_cc26xx.html">Terms and acronyms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index-cc13xx_cc26xx.html">
SimpleLink™ CC13XX/CC26XX SDK
Proprietary RF User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index-cc13xx_cc26xx.html" class="icon icon-home"></a> &raquo;</li>
      <li>Debugging</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="debugging">
<span id="sec-debugging"></span><h1>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h1>
<p>This chapter covers debugging issues in TI-RTOS7, using the debugging tools
provided in the CCS and IAR IDEs and how to decipher CPU exceptions. For more
information on how to understand and debug status codes from the RF driver,
please see the <a class="reference internal" href="../rf-core/radio-operation-commands.html#rf-core-execution-states-status-codes"><span class="std std-ref">Execution States and Status Codes</span></a> chapter.</p>
<div class="section" id="external-resources">
<h2>External Resources<a class="headerlink" href="#external-resources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://training.ti.com/debugging-common-application-issues-ti-rtos">Debugging common application problems with TI-RTOS</a> video
presentation on training.ti.com.</p></li>
<li><p><a class="reference external" href="https://software-dl.ti.com/ccs/esd/documents/users_guide/index.html">Code Composer Studio (CCS) User’s Guide</a>
and in particular the <a class="reference external" href="https://software-dl.ti.com/ccs/esd/documents/users_guide/index_debug.html">section dealing with CCS debug environment</a>.
More resources (training videos, documentation to run CCS on different OS,
tips, etc.) are available
<a class="reference external" href="https://dev.ti.com/tirex/explore/node?node=APvvp0UXqShKs8PjZtNfzA__FUz-xrs__LATEST">here</a></p></li>
</ul>
</div>
<div class="section" id="debug-interfaces">
<span id="sec-debug-interface"></span><h2>Debug Interfaces<a class="headerlink" href="#debug-interfaces" title="Permalink to this headline">¶</a></h2>
<p>The CC13xx and CC26xx platform supports both the <a class="reference internal" href="glossary-cc13xx_cc26xx.html#term-cJTAG"><span class="xref std std-term">cJTAG</span></a> and <a class="reference internal" href="glossary-cc13xx_cc26xx.html#term-JTAG"><span class="xref std std-term">JTAG</span></a> debug
interfaces. Debug probes that support cJTAG, like the TI XDS110 and XDS100v3,
can work natively with the CC13xx or CC26xx. Other debug probes that only support JTAG,
like the IAR I-Jet and Segger J-Link, need to inject a cJTAG sequence to enable
JTAG functionality. The hardware resources included on the devices for
debugging are listed as follows. Not all debugging functionality is available
in all combinations of debug probe and IDE.</p>
<ul class="simple">
<li><p>Flash Patch and Breakpoint Unit (FPB) - 6 instruction comparators, 2 literal
comparators</p></li>
<li><p>Data Watchpoint and Trace Unit (DWT) - 5 watchpoints on memory access</p></li>
<li><p>Instrumentation Trace Macrocell (ITM) - 32 x 32 bit stimulus registers</p></li>
<li><p>Trace Port Interface Unit (TPIU) - serialization and time-stamping of DWT and
ITM events</p></li>
</ul>
<div class="section" id="xds110-debug-probe">
<h3>XDS110 Debug Probe<a class="headerlink" href="#xds110-debug-probe" title="Permalink to this headline">¶</a></h3>
<p>The CC13xx or CC26xx LaunchPad has an on-board XDS110, and this is the assumed debug probe
for most development.</p>
<p>The XDS110 is the latest entry level debug probe (emulators) for TI embedded
processors. Designed to be a complete solution that delivers JTAG and SWD
connectivity at a low cost, the XDS110 is the debug probe of choice for
entry-level debugging of TI microcontrollers, processors and SimpleLink
devices. Also, both Core Processor and System Trace are available for all Arm
and DSP devices that support Embedded Trace Buffer (ETB).</p>
<p>It is possible to buy the XDS110 as a standalone debugger. See the <a class="reference external" href="http://www.ti.com/tool/TMDSEMU110-U">XDS110 JTAG
Debug Probe</a> product page.</p>
</div>
<div class="section" id="configuring-debugger-in-code-composer-studio">
<h3>Configuring Debugger in Code Composer Studio<a class="headerlink" href="#configuring-debugger-in-code-composer-studio" title="Permalink to this headline">¶</a></h3>
<p>If only one debug probe is attached, <a class="reference internal" href="glossary-cc13xx_cc26xx.html#term-CCS"><span class="xref std std-term">CCS</span></a> will automatically select the
connected debug probe when a debug session is started. You can start a debug
session by clicking the debug icon <img alt="img_icon_debug_ccs" src="../_images/icon_debug_ccs.png" /> on the toolbar.</p>
<p>If more than one debug probe is attached when a debug session is started, CCS
will prompt you to select a debug probe as seen in
<a class="reference internal" href="#fig-ccs-probe-select"><span class="std std-numref">Figure 37.</span></a> CCS will save the selected debug probe in the
target configuration for the project.</p>
<div class="figure align-center" id="id7">
<span id="fig-ccs-probe-select"></span><img alt="../_images/ccs_probe_select.png" src="../_images/ccs_probe_select.png" />
<p class="caption"><span class="caption-number">Figure 37. </span><span class="caption-text">CCS Probe Selection</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p>To set or change the selected debug probe for a project, it is necessary to set
the serial number for the probe in the project’s target configuration.</p>
<div class="section" id="find-the-serial-number">
<h4>Find The Serial Number<a class="headerlink" href="#find-the-serial-number" title="Permalink to this headline">¶</a></h4>
<p>To find the serial number for XDS110 debug probe, open a command prompt and run
the <code class="docutils literal notranslate"><span class="pre">xdsdfu.exe</span></code> command for your <a class="reference internal" href="glossary-cc13xx_cc26xx.html#term-CCS"><span class="xref std std-term">CCS</span></a> version, e.g.
<code class="docutils literal notranslate"><span class="pre">c:\ti\ccs_7_3_0_00019\ccsv7\ccs_base\common\uscif\xds110\xdsdfu.exe</span> <span class="pre">-e</span></code>.
This will enumerate all the attached XDS110 debug probes. This should result in
output like the following.</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">C:\&gt;</span>c<span class="p">:</span><span class="nl">\ti\ccs_7_3_0_00019\ccsv7\ccs_base\common\uscif\xds110\xdsdfu.exe</span><span class="c1"> -e</span>

<span class="go">USB Device Firmware Upgrade Utility</span>
<span class="go">Copyright (c) 2008-2015 Texas Instruments Incorporated.  All rights reserved.</span>

<span class="go">Scanning USB buses for supported XDS110 devices...</span>


<span class="gp">&lt;&lt;&lt;&lt; Device 0 &gt;</span><span class="p">&gt;&gt;</span>&gt;

<span class="go">VID: 0x0451    PID: 0xbef3</span>
<span class="go">Device Name:   XDS110 Embed with CMSIS-DAP</span>
<span class="go">Version:       2.3.0.9</span>
<span class="go">Manufacturer:  Texas Instruments</span>
<span class="go">Serial Num:    L1100017</span>
<span class="go">Mode:          Runtime</span>

<span class="gp">&lt;&lt;&lt;&lt; Device 1 &gt;</span><span class="p">&gt;&gt;</span>&gt;

<span class="go">VID: 0x0451    PID: 0xbef3</span>
<span class="go">Device Name:   XDS110 Embed with CMSIS-DAP</span>
<span class="go">Version:       2.3.0.9</span>
<span class="go">Manufacturer:  Texas Instruments</span>
<span class="go">Serial Num:    L11000EN</span>
<span class="go">Mode:          Runtime</span>

<span class="go">Found 2 devices.</span>

<span class="gp">C:\&gt;</span>
</pre></div>
</div>
<p>For XDS100 series debug probes, open a command prompt and run the
<code class="docutils literal notranslate"><span class="pre">xds100serial.exe</span></code> command for your CCS version, e.g. <code class="docutils literal notranslate"><span class="pre">c:\ti\ccs_7_3_0_00019</span>
<span class="pre">\ccsv7\ccs_base\common\uscif\xds100serial.exe</span></code>. This should result in output
like the following:</p>
<div class="highlight-doscon notranslate"><div class="highlight"><pre><span></span><span class="gp">C:\&gt;</span>c<span class="p">:</span><span class="nl">\ti\ccs_7_3_0_00019\ccsv7\ccs_base\common\uscif\xds100serial.exe</span>
<span class="go">Scanning for XDS100 emulators...</span>

<span class="go">VID/PID    Type            Serial #    Description</span>
<span class="go">0403/a6d1  XDS100v3        06EB12213144  Texas Instruments XDS100v3</span>

<span class="gp">C:\&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-serial-number">
<h4>Configure Serial Number<a class="headerlink" href="#configure-serial-number" title="Permalink to this headline">¶</a></h4>
<p>It may be necessary to set or unset the selected debug probe. Use the following
steps to do this.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 39%" />
<col style="width: 61%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><ol class="arabic simple">
<li><p>Open the target configuration file.</p></li>
</ol>
</td>
<td><img alt="../_images/ccs_targetconfig_file.png" src="../_images/ccs_targetconfig_file.png" />
</td>
</tr>
<tr class="row-even"><td><ol class="arabic simple" start="2">
<li><p>Open the Advanced pane.</p></li>
</ol>
</td>
<td></td>
</tr>
<tr class="row-odd"><td><ol class="arabic simple" start="3">
<li><p>Choose the top-level debugger entry.</p></li>
</ol>
</td>
<td><img alt="../_images/ccs_targetconfig_probe.png" src="../_images/ccs_targetconfig_probe.png" />
</td>
</tr>
<tr class="row-even"><td><ol class="arabic simple" start="4">
<li><p>Enter the serial number.</p></li>
</ol>
</td>
<td><img alt="../_images/ccs_targetconfig_serial.png" src="../_images/ccs_targetconfig_serial.png" />
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="connecting-to-the-xds-debugger">
<h4>Connecting to the XDS Debugger<a class="headerlink" href="#connecting-to-the-xds-debugger" title="Permalink to this headline">¶</a></h4>
<p>If only one debugger is attached, the IDE uses it automatically when you click
the <img alt="img_icon_debug_ccs" src="../_images/icon_debug_ccs.png" /> button in CCS or <img alt="img_icon_debug_iar" src="../_images/icon_debug_iar.png" /> in IAR.</p>
<p>If <strong>multiple debuggers</strong> are connected, you must choose the individual
debugger to use. The following steps detail how to select a debugger in CCS
and IAR.</p>
</div>
</div>
<div class="section" id="configuring-debugger-in-iar">
<h3>Configuring Debugger in IAR<a class="headerlink" href="#configuring-debugger-in-iar" title="Permalink to this headline">¶</a></h3>
<p>If only one debugger is attached, IAR uses it automatically when you click the
<img alt="img_icon_debug_iar" src="../_images/icon_debug_iar.png" /> button.</p>
<p>If more than one debug probe is connected, use the following steps to have IAR
always prompt to select the connection.</p>
<ol class="arabic simple">
<li><p>Open the project options (<code class="docutils literal notranslate"><span class="pre">Project</span></code> → <code class="docutils literal notranslate"><span class="pre">Options</span></code>)</p></li>
<li><p>Go to the Debugger entry.</p></li>
<li><p>Go to Extra options.</p></li>
<li><p>Add the following command line option: <code class="docutils literal notranslate"><span class="pre">--drv_communication=USB:#select</span></code></p></li>
</ol>
</div>
</div>
<div class="section" id="breakpoints">
<h2>Breakpoints<a class="headerlink" href="#breakpoints" title="Permalink to this headline">¶</a></h2>
<p>Comparators in the Flash Patch and Breakpoint Unit (FPB) of the CC13xx or CC26xx LaunchPad are used
to break on an instruction fetch. This can be used to patch a function as it is
fetched from instruction memory. Or these comparators can be used to supply a
Breakpoint (BKPT) instruction to the CPU. These instructions halt the processors
operation, waiting for the debug probe.</p>
<div class="section" id="considerations">
<h3>Considerations<a class="headerlink" href="#considerations" title="Permalink to this headline">¶</a></h3>
<p>While breakpoints are a useful tool for debugging code online, they have the
possibility of altering the execution flow of a piece of code.</p>
<div class="section" id="breakpoints-and-timing">
<h4>Breakpoints and Timing<a class="headerlink" href="#breakpoints-and-timing" title="Permalink to this headline">¶</a></h4>
<p>Synchronous RF protocols are timing sensitive. Breakpoints can easily halt the
execution long enough to lose network timing and break the link.</p>
<p>To still be able to debug, place breakpoints as close as possible to where the
relevant debug information can be read or step through the relevant code
segment to debug.</p>
<p>After you hit a breakpoint and read out the necessary debug information, it is
recommended that you reset the device and re-establish the connection.</p>
</div>
<div class="section" id="breakpoints-and-optimization">
<h4>Breakpoints and Optimization<a class="headerlink" href="#breakpoints-and-optimization" title="Permalink to this headline">¶</a></h4>
<p>When compiler optimizations are enabled, toggling a breakpoint on a line of C
code may not result in the expected behavior. Some examples include the
following.</p>
<p>Code is removed or not compiled in</p>
<blockquote>
<div><p>Toggling a breakpoint in the IDE results in a breakpoint somewhere other
than the intended line. Some IDEs disable breakpoints on nonexistent code.</p>
</div></blockquote>
<p>Code block is part of a common subexpression</p>
<blockquote>
<div><p>A breakpoint might be trigged from a function or piece of code near the
marked line. This might have been due to the compiler reusing sections.</p>
</div></blockquote>
<p>An if clause is represented by a conditional branch in assembly</p>
<blockquote>
<div><p>A breakpoint inside an if clause always breaks on the conditional
statement, even when the condition is not true.</p>
</div></blockquote>
<p>TI recommends selecting an optimization level as low as possible
when debugging. See <a class="reference internal" href="#sect-debug-optim"><span class="std std-ref">Optimizations</span></a> for information on modifying
optimization levels.</p>
</div>
</div>
<div class="section" id="breakpoints-in-ccs">
<h3>Breakpoints in CCS<a class="headerlink" href="#breakpoints-in-ccs" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CCS reserves one hardware breakpoint for instruction stepping.</p>
</div>
<p>To toggle a breakpoint, do any of the following.</p>
<ul class="simple">
<li><p>Double-click the area to the left of the line number.</p></li>
<li><p>Press <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> + <code class="docutils literal notranslate"><span class="pre">Shift</span></code> + <code class="docutils literal notranslate"><span class="pre">B</span></code>.</p></li>
<li><p>Right-click on the line.</p></li>
</ul>
<p>A breakpoint set on line 207 looks like the following.</p>
<div class="figure align-center" id="id8">
<img alt="../_images/ccs_breakpoint_ex.png" src="../_images/ccs_breakpoint_ex.png" />
<p class="caption"><span class="caption-number">Figure 38. </span><span class="caption-text">Breakpoint on line 207. Debugger halted at start of main().</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p>For an overview of the active and inactive breakpoints, click on <code class="docutils literal notranslate"><span class="pre">View</span></code>
→ <code class="docutils literal notranslate"><span class="pre">Breakpoints</span></code>.</p>
<div class="figure align-center" id="id9">
<img alt="../_images/ccs_breakpoint_list.png" src="../_images/ccs_breakpoint_list.png" />
<p class="caption"><span class="caption-number">Figure 39. </span><span class="caption-text">List of breakpoints. Right-click to edit options, or de-select to deactivate.</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>To set a conditional break, do as follows.</p>
<ol class="arabic simple">
<li><p>Right-click the breakpoint in the overview.</p></li>
<li><p>Choose Properties.</p></li>
</ol>
<p>When debugging, Skip Count and Condition can help skip a number of breaks or
only break if a variable is a certain value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Conditional breaks require a debugger response and may halt the processor
long enough to break an active RF connection, or otherwise disrupt timing on
the debug target.</p>
</div>
</div>
<div class="section" id="breakpoints-in-iar">
<h3>Breakpoints in IAR<a class="headerlink" href="#breakpoints-in-iar" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>IAR reserves one comparator for instruction stepping.</p>
</div>
<p>To toggle a breakpoint, do any of the following.</p>
<ul class="simple">
<li><p>Single-click the area to the left of the line number.</p></li>
<li><p>Go to the line and press <code class="docutils literal notranslate"><span class="pre">F9</span></code> to toggle breakpoint</p></li>
<li><p>Right-click on the line and select Toggle Breakpoint (Code).</p></li>
</ul>
<p>A breakpoint looks like this:</p>
<div class="figure align-center" id="id10">
<img alt="../_images/iar_breakpoint_ex.png" src="../_images/iar_breakpoint_ex.png" />
<p class="caption"><span class="caption-number">Figure 40. </span><span class="caption-text">Breakpoint on <code class="docutils literal notranslate"><span class="pre">PIN_init()</span></code>. Debugger halted at start of main().</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<p>For an overview of the active and inactive breakpoints, click
<code class="docutils literal notranslate"><span class="pre">View</span></code> → <code class="docutils literal notranslate"><span class="pre">Breakpoints</span></code>.</p>
<div class="figure align-center" id="id11">
<img alt="../_images/iar_breakpoint_list.png" src="../_images/iar_breakpoint_list.png" />
<p class="caption"><span class="caption-number">Figure 41. </span><span class="caption-text">List of breakpoints. Right-click to edit options, or de-select to deactivate.</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<p>To set a conditional break, do as follows.</p>
<ol class="arabic simple">
<li><p>Right-click the breakpoint in the overview.</p></li>
<li><p>Choose Edit….</p></li>
</ol>
<p>When debugging, Skip Count and Condition can help skip a number of
breaks or only break if a variable is a certain value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Conditional breaks require a debugger response and may halt the processor
long enough to break an active RF connection, or otherwise disrupt timing
on the debug target.</p>
</div>
</div>
</div>
<div class="section" id="watching-variables-and-registers">
<h2>Watching Variables and Registers<a class="headerlink" href="#watching-variables-and-registers" title="Permalink to this headline">¶</a></h2>
<p>Debuggers offer several ways of viewing the state of a halted program. Global
variables are statically placed during link-time and can end up anywhere in the
RAM or Flash of the chip. These variables can be viewed when then target is
halted by the debugger through the Watch and Expression windows.</p>
<p>Unless removed due to optimizations, global variables are always available in
these views. Local variables or variables that are only valid inside a limited
scope are only viewable in that scope. Such variables can also be viewed with
the Watch or Expression views, and may also be automatically displayed when
breaking or stepping through code.</p>
<div class="section" id="id3">
<h3>Considerations<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Local variables are often placed in CPU registers and not on the
stack. These variables also have a limited lifetime even within the
scope in which they are valid. Depending on the optimization
performed, a variable placed in a register may not have a cohesive view of the current state of the variable. Some possible solutions are:</p>
<ul class="simple">
<li><p>Move the variable to global scope, so it remains accessible in RAM.</p></li>
<li><p>Make the variable volatile, so the compiler doesn’t place the value in a
register.</p></li>
<li><p>Make a shadow copy of the variable that is global and volatile.</p></li>
</ul>
</div>
<div class="section" id="variables-in-ccs">
<h3>Variables in CCS<a class="headerlink" href="#variables-in-ccs" title="Permalink to this headline">¶</a></h3>
<p>You can view Global Variables by doing either of the following.</p>
<ul class="simple">
<li><p>Select <code class="docutils literal notranslate"><span class="pre">View</span></code> → <code class="docutils literal notranslate"><span class="pre">Expressions</span></code>.</p></li>
<li><p>Select a variable name in code.</p></li>
<li><p>Right-click and select Add Watch Expression.</p></li>
</ul>
<div class="figure align-center" id="id12">
<img alt="../_images/ccs_watch.png" src="../_images/ccs_watch.png" />
<p class="caption"><span class="caption-number">Figure 42. </span><span class="caption-text">Variable watch window. Note that you can cast values, get address and
sizeof, etc.</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>Select <code class="docutils literal notranslate"><span class="pre">View</span></code> → <code class="docutils literal notranslate"><span class="pre">Variables</span></code> to <code class="docutils literal notranslate"><span class="pre">auto-variables</span></code> that are present
at the current location when stepping through code.</p></li>
</ul>
<div class="figure align-center" id="id13">
<img alt="../_images/ccs_locals.png" src="../_images/ccs_locals.png" />
<p class="caption"><span class="caption-number">Figure 43. </span><span class="caption-text">Local variables. This screenshot is taken during execution of an
application function.</span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="variables-in-iar">
<h3>Variables in IAR<a class="headerlink" href="#variables-in-iar" title="Permalink to this headline">¶</a></h3>
<p>To view Global Variables, do either of the following.</p>
<ul class="simple">
<li><p>Right-click on the variable.</p>
<ul>
<li><p>Select Add to Watch: varName.</p></li>
</ul>
</li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">View</span></code> → <code class="docutils literal notranslate"><span class="pre">Watch</span></code></p>
<ul>
<li><p>Enter the name of the variable.</p></li>
</ul>
</li>
</ul>
<div class="figure align-center" id="id14">
<img alt="../_images/iar_watch.png" src="../_images/iar_watch.png" />
<p class="caption"><span class="caption-number">Figure 44. </span><span class="caption-text">Variable watch window. Note that you can cast values, get address and
sizeof, etc.</span><a class="headerlink" href="#id14" title="Permalink to this image">¶</a></p>
</div>
<p>View –&gt; Locals show the local variables in IAR.</p>
<div class="figure align-center" id="id15">
<img alt="../_images/iar_locals.png" src="../_images/iar_locals.png" />
<p class="caption"><span class="caption-number">Figure 45. </span><span class="caption-text">Local variables. This screenshot is taken during execution of the Simple
Peripheral init function.</span><a class="headerlink" href="#id15" title="Permalink to this image">¶</a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>IAR may remove the variable during optimization and inline the usage of the
value. If so, add the <code class="docutils literal notranslate"><span class="pre">__root</span></code> directive in front.</p>
</div>
</div>
</div>
<div class="section" id="memory-watchpoints">
<h2>Memory Watchpoints<a class="headerlink" href="#memory-watchpoints" title="Permalink to this headline">¶</a></h2>
<p>As mentioned in <a class="reference internal" href="#sec-debug-interface"><span class="std std-ref">Debug Interfaces</span></a>, the Data Watchpoint and Trace Unit
(DWT module) contains four memory watchpoints that allow breakpoints on memory
access. The hardware match functionality looks only at the address. If intended
for use on a variable, the variable must be statically allocated.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a data watchpoint with value match is used, two of the four watchpoints
are used.</p>
</div>
<div class="section" id="watchpoints-in-ccs">
<h3>Watchpoints in CCS<a class="headerlink" href="#watchpoints-in-ccs" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Right-click on a global variable.</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Breakpoint</span></code> → <code class="docutils literal notranslate"><span class="pre">Hardware</span> <span class="pre">Watchpoint</span></code>.</p></li>
<li><p>Go to the list of breakpoints (<code class="docutils literal notranslate"><span class="pre">View</span></code> → <code class="docutils literal notranslate"><span class="pre">Breakpoints</span></code>).</p></li>
<li><p>Right-click and edit the Breakpoint Properties to configure the watchpoint.</p></li>
</ol>
<div class="figure align-center" id="id16">
<img alt="../_images/ccs_watchpoint_add.png" src="../_images/ccs_watchpoint_add.png" />
<p class="caption"><span class="caption-number">Figure 46. </span><span class="caption-text">Adding a watchpoint on a variable.</span><a class="headerlink" href="#id16" title="Permalink to this image">¶</a></p>
</div>
<p>This example configuration ensures that if 0x42 is written to the memory
location for Characteristic 1 in the Bluetooth Low Energy simple_peripheral
example project the device halts execution.</p>
<div class="figure align-center" id="id17">
<img alt="../_images/ccs_watchpoint_configure.png" src="../_images/ccs_watchpoint_configure.png" />
<p class="caption"><span class="caption-number">Figure 47. </span><span class="caption-text">Configuring a hardware watchpoint to break on 8-bit write with value 0x42.</span><a class="headerlink" href="#id17" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="watchpoints-in-iar">
<h3>Watchpoints in IAR<a class="headerlink" href="#watchpoints-in-iar" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>Right-click a variable (global).</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Set</span> <span class="pre">Data</span> <span class="pre">Breakpoint</span> <span class="pre">for</span> <span class="pre">'myVar'</span></code> to add it to the active breakpoints.</p></li>
<li><p>Go to the list of breakpoints (View –&gt; Breakpoints)</p></li>
<li><p>Choose <code class="docutils literal notranslate"><span class="pre">Edit...</span></code> to set up whether the watchpoint should match on read,
write, or any access.</p></li>
</ol>
<div class="figure align-center" id="id18">
<img alt="../_images/iar_watchpoint_configure.png" src="../_images/iar_watchpoint_configure.png" />
<p class="caption"><span class="caption-number">Figure 48. </span><span class="caption-text">Configuring a hardware watchpoint to break on 8-bit write with value 0x42.</span><a class="headerlink" href="#id18" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="ti-rtos-object-viewer">
<span id="sec-rov"></span><h2>TI-RTOS Object Viewer<a class="headerlink" href="#ti-rtos-object-viewer" title="Permalink to this headline">¶</a></h2>
<p>Debuggers may include the RTOS Object Viewer (ROV) plug-in that provides
insight into the current state of TI-RTOS, including task states, stacks, and
so forth.</p>
<p>This section discusses some ROV views useful for debugging and profiling. More
details can be found in the TI-RTOS User’s Guide, including documentation on
how to add log events to application code.</p>
<div class="section" id="scanning-the-bios-for-errors">
<h3>Scanning the BIOS for Errors<a class="headerlink" href="#scanning-the-bios-for-errors" title="Permalink to this headline">¶</a></h3>
<p>The BIOS <code class="docutils literal notranslate"><span class="pre">Scan</span> <span class="pre">for</span> <span class="pre">errors</span></code> view goes through the available ROV modules and
reports on errors. This functionality can be a good point to start if anything
has gone wrong. This scan only shows errors related to TI-RTOS modules and only
the errors it can catch.</p>
<div class="figure align-center" id="id19">
<img alt="../_images/rov_bios_scan.png" src="../_images/rov_bios_scan.png" />
<p class="caption"><span class="caption-number">Figure 49. </span><span class="caption-text">Scan for errors. Here a Task Stack has been overrun.</span><a class="headerlink" href="#id19" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="viewing-the-state-of-each-task">
<h3>Viewing the State of Each Task<a class="headerlink" href="#viewing-the-state-of-each-task" title="Permalink to this headline">¶</a></h3>
<p>The Task <code class="docutils literal notranslate"><span class="pre">Detailed</span></code> view is useful for seeing the state of each task and its
related runtime stack usage. This example shows the state the first time the
user-thread is called. <a class="reference internal" href="#fig-rov-task-detailed"><span class="std std-numref">Figure 50.</span></a> shows the Bluetooth low
energy stack task, represented by its ICall proxy, the Idle task, the
simple_peripheral task and the GAPRole task.</p>
<div class="figure align-center" id="id20">
<span id="fig-rov-task-detailed"></span><img alt="../_images/rov_task_detailed.png" src="../_images/rov_task_detailed.png" />
<p class="caption"><span class="caption-number">Figure 50. </span><span class="caption-text">Detailed view of the Tasks. Notice the address of the overrun task matches
the instance id from Scan for errors.</span><a class="headerlink" href="#id20" title="Permalink to this image">¶</a></p>
</div>
<p>The following list explains the column in <a class="reference internal" href="#fig-rov-task-detailed"><span class="std std-numref">Figure 50.</span></a></p>
<dl class="simple">
<dt>address</dt><dd><p>This column shows the memory location of the <code class="docutils literal notranslate"><span class="pre">Task_Struct</span></code> instance for
each task.</p>
</dd>
<dt>priority</dt><dd><p>This column shows the TI-RTOS priority for the task.</p>
</dd>
<dt>mode</dt><dd><p>This column shows the current state of the task.</p>
</dd>
<dt>fxn</dt><dd><p>This column shows the name of the entry function of the task.</p>
</dd>
<dt>arg0, arg1</dt><dd><p>These columns show arbitrary values that can be given to entry function of
the task. In the image, the ICall_taskEntry is given 0xb001, which is the
flash location of the entry function of the RF stack image and 0x20003a30
(the location of bleUserCfg_t user0Cfg, defined in main()).</p>
</dd>
<dt>stackPeak</dt><dd><p>This column shows the maximum run-time stack memory used based on watermark
in RAM, where the stacks are prefilled with 0xBE and there is a sentinel
word at the end of the run-time stack.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Function calls may push the stack pointer out of the run-time stack, but
not actually write to the entire area. A stack peak near stackSize but not
exceeding it may indicate stack overflow.</p>
</div>
<dl class="simple">
<dt>stackSize</dt><dd><p>This column shows the size of the runtime stack, configured when
instantiating a task.</p>
</dd>
<dt>stackBase</dt><dd><p>This column shows the logical top of the runtime stack of the task (usage
starts at stackBase + stackSize and grows down to this address).</p>
</dd>
</dl>
</div>
<div class="section" id="viewing-the-system-stack">
<h3>Viewing the System Stack<a class="headerlink" href="#viewing-the-system-stack" title="Permalink to this headline">¶</a></h3>
<p>The Hwi <code class="docutils literal notranslate"><span class="pre">Module</span></code> view allows profiling of the system stack used during boot
or for main(), Hwi execution, and Swi execution.</p>
<div class="figure align-center" id="id21">
<img alt="../_images/rov_hwi_module.png" src="../_images/rov_hwi_module.png" />
<p class="caption"><span class="caption-number">Figure 51. </span><span class="caption-text">Viewing the System Stack in the Hwi view of ROV</span><a class="headerlink" href="#id21" title="Permalink to this image">¶</a></p>
</div>
<p>The hwiStackPeak, hwiStackSize, and hwiStackBase can be used to check for
system stack overflow.</p>
</div>
<div class="section" id="rov-in-ccs">
<h3>ROV in CCS<a class="headerlink" href="#rov-in-ccs" title="Permalink to this headline">¶</a></h3>
<p>To access the ROV while in a debug session in CCS:</p>
<ul class="simple">
<li><p>Click the Tools menu.</p></li>
<li><p>Click RTOS Object View (ROV).</p></li>
</ul>
</div>
<div class="section" id="rov-in-iar">
<h3>ROV in IAR<a class="headerlink" href="#rov-in-iar" title="Permalink to this headline">¶</a></h3>
<p>To access the ROV while in a debug session in IAR</p>
<ul class="simple">
<li><p>Use the TI-RTOS menu on the menu bar.</p></li>
<li><p>Select a subview.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When using autosized heap, the ROV may display errors when
accessing modules such as Task and Heap for ROV.
In order to use ROV with an autosized heap you can apply
the following patch to the <code class="docutils literal notranslate"><span class="pre">function</span> <span class="pre">init()</span></code> in
<code class="docutils literal notranslate"><span class="pre">\kernel\tirtos\packages\ti\sysbios\heaps\package.xs</span></code>.
The lines highlited below should be added.</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w">  </span><span class="n">function</span><span class="w"> </span><span class="nf">init</span><span class="p">()</span><span class="w"></span>
<span class="linenos"> 2</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 3</span><span class="w">    </span><span class="cm">/* Add HeapMem&#39;s primaryHeap addresses range to ROV&#39;s memory sections */</span><span class="w"></span>
<span class="linenos"> 4</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xdc</span><span class="p">.</span><span class="n">om</span><span class="p">.</span><span class="n">$name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;rov&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 5</span><span class="w">            </span><span class="c1">// original code omitted</span>
<span class="linenos"> 6</span><span class="w">            </span><span class="c1">// .....</span>
<span class="linenos"> 7</span><span class="w">            </span><span class="c1">// .....</span>
<span class="linenos"> 8</span>
<span class="hll"><span class="linenos"> 9</span><span class="w">            </span><span class="cm">/* Retrieve the MemoryImage java object. */</span><span class="w"></span>
</span><span class="hll"><span class="linenos">10</span><span class="w">            </span><span class="n">var</span><span class="w"> </span><span class="n">Model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xdc</span><span class="p">.</span><span class="n">module</span><span class="p">(</span><span class="s">&quot;xdc.rov.Model&quot;</span><span class="p">);</span><span class="w"></span>
</span><span class="hll"><span class="linenos">11</span><span class="w">            </span><span class="n">var</span><span class="w"> </span><span class="n">memReader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Model</span><span class="p">.</span><span class="n">getMemoryImageInst</span><span class="p">();</span><span class="w"></span>
</span><span class="hll"><span class="linenos">12</span>
</span><span class="hll"><span class="linenos">13</span><span class="w">            </span><span class="cm">/* retrieve the sections list and add a new section */</span><span class="w"></span>
</span><span class="hll"><span class="linenos">14</span><span class="w">            </span><span class="n">var</span><span class="w"> </span><span class="n">sections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">memReader</span><span class="p">.</span><span class="n">getSections</span><span class="p">();</span><span class="w"></span>
</span><span class="hll"><span class="linenos">15</span><span class="w">            </span><span class="n">sections</span><span class="p">.</span><span class="n">addSection</span><span class="p">(</span><span class="mh">0x20000000</span><span class="p">,</span><span class="w"> </span><span class="mh">0x20005000</span><span class="p">);</span><span class="w"></span>
</span><span class="linenos">16</span><span class="w">     </span><span class="p">}</span><span class="w"></span>
<span class="linenos">17</span><span class="w">   </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="using-the-memory-browser">
<h2>Using the Memory Browser<a class="headerlink" href="#using-the-memory-browser" title="Permalink to this headline">¶</a></h2>
<p>Debuggers are able to show a representation of the memory on the CC13xx or CC26xx.  In
<a class="reference internal" href="glossary-cc13xx_cc26xx.html#term-CCS"><span class="xref std std-term">CCS</span></a>, you can index by address or by symbol name. As an example, consider the stack
that was overrun in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-rov-task-detailed</span></code>:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 49%" />
<col style="width: 51%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Simple Peripheral Task’s stack. Note <code class="docutils literal notranslate"><span class="pre">BE</span></code> watermark</p></td>
<td><p>GAPRole Task’s stack. Note it’s completely filled.</p></td>
</tr>
<tr class="row-even"><td><div class="figure align-default">
<img alt="../_images/mem_browser_sbp_stack.png" src="../_images/mem_browser_sbp_stack.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="../_images/mem_browser_gaprole_stack.png" src="../_images/mem_browser_gaprole_stack.png" />
</div>
</td>
</tr>
</tbody>
</table>
<p>The solution in this case would be to increase the stack size for the failing
task and see what the stack peak really is. The <code class="docutils literal notranslate"><span class="pre">stackPeak</span></code> reported is
relying on how many watermark bytes are overwritten, so it can’t know how much
the overrun amounts to.</p>
<p>Because stacks are utilized from higher addresses towards lower addressed
(upwards in the picture), stacks that overrun will tend to overwrite data at
locations immediately before the stack.</p>
</div>
<div class="section" id="connect-the-debugger-to-a-running-target">
<h2>Connect the debugger to a running target<a class="headerlink" href="#connect-the-debugger-to-a-running-target" title="Permalink to this headline">¶</a></h2>
<p>Connecting the debugger to a target can help when you want to see the
status of your target after  it has been running for several hours, or even
days; or if you cannot reproduce a crash with the debugger attached. Once
the debugger connected to the target, all the usual functionalities
(break points, step-by-step, variable view, ROV, memory view…) are available.</p>
<p>This step-by-step guide will help you to configure CCS in order to connect to a
running target</p>
<ol class="arabic">
<li><p>Modify the GEL file</p>
<blockquote>
<div><p>In a very simplistic view, the GEL files describe the way the device’s
debugger has to act (more details can be found in the CCS’s help).
By default, the GEL files ask the device to reset when the debugger is
started up. Fortunately we can modify this:</p>
<ol class="loweralpha">
<li><p>Identify the GEL file to modify</p>
<blockquote>
<div><ul class="simple">
<li><p>Start a debug session as always</p></li>
<li><p>(If needed), display the debug view</p></li>
<li><p>Right-click on the program being, “Open GEL files View”.</p></li>
<li><p>In the GEL files list, open the corresponding GEL file by
double-clicking it. Chose cc26x2.gel for CC26x2 and CC13x2 devices.
Chose cc26x0.gel for CC26x0 and CC13x0 devices.</p></li>
</ul>
<div class="figure align-center" id="id22">
<span id="locate-gel-file"></span><img alt="../_images/locate_gel_file.png" src="../_images/locate_gel_file.png" />
<p class="caption"><span class="caption-number">Figure 52. </span><span class="caption-text">Locate the GEL file to modify.</span><a class="headerlink" href="#id22" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#locate-gel-file"><span class="std std-numref">Figure 52.</span></a> shows how to find the GEL file to modify.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Another possibility consists in looking directly in
<code class="docutils literal notranslate"><span class="pre">&lt;CCS</span> <span class="pre">directory&gt;\ccs_base\emulation\gel</span></code> for the GEL file.</p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The modifications done in a GEL file affect all the devices using
the same GEL files. In other words, it affects all the CC26X2 and
CC13X2 if you modified cc26x2.gel, and all the CC26x0 and CC13x0
if you modified cc26x0.gel.
By default, two different CCS versions do <em>not</em> use the same
GEL files.</p>
</div>
</div></blockquote>
</li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">StartUp()</span></code> function, comment out the code executing the reset.
If needed, an explicit comment will help you to identify the code to
comment out.</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="startup">
<span id="gel-startup"></span><div class="code-block-caption"><span class="caption-number">Listing 20. </span><span class="caption-text">The StartUp() function after modification.</span><a class="headerlink" href="#startup" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">StartUp</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">major</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">minor</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">patch</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 2</span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 3</span><span class="w">    </span><span class="cm">/* Initialize memory map */</span><span class="w"></span>
<span class="linenos"> 4</span><span class="w">    </span><span class="n">memorymap_init</span><span class="p">();</span><span class="w"></span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="w">    </span><span class="cm">/* Debugger specific handling */</span><span class="w"></span>
<span class="linenos"> 7</span><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">GEL_MatchesConnection</span><span class="p">(</span><span class="s">&quot;.*TIXDS.*&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 8</span><span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 9</span><span class="w">        </span><span class="n">GEL_LoadGel</span><span class="p">(</span><span class="s">&quot;$(GEL_file_dir)/cc26xx_connect_util.gel&quot;</span><span class="p">);</span><span class="w"></span>
<span class="linenos">10</span><span class="w">        </span><span class="n">GEL_LoadGel</span><span class="p">(</span><span class="s">&quot;$(GEL_file_dir)/cc26x2_xds.gel&quot;</span><span class="p">);</span><span class="w"></span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="w">        </span><span class="n">DefineResets</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="w">        </span><span class="c1">// Issue Board Reset to ensure device is in a known state</span>
<span class="linenos">15</span><span class="w">        </span><span class="c1">// Note: If you want to attach to a running target without resetting the</span>
<span class="linenos">16</span><span class="w">        </span><span class="c1">//       device, you must comment out the following 4 lines:</span>
<span class="hll"><span class="linenos">17</span><span class="w">    </span><span class="c1">//  if(!GEL_IsConnected())</span>
</span><span class="hll"><span class="linenos">18</span><span class="w">    </span><span class="c1">//  {</span>
</span><span class="hll"><span class="linenos">19</span><span class="w">    </span><span class="c1">//      GEL_AdvancedReset(&quot;Board Reset&quot;);</span>
</span><span class="hll"><span class="linenos">20</span><span class="w">    </span><span class="c1">//  }</span>
</span><span class="linenos">21</span><span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="linenos">22</span><span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="n">GEL_MatchesConnection</span><span class="p">(</span><span class="s">&quot;.*JLink.*&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">23</span><span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="linenos">24</span><span class="w">        </span><span class="n">GEL_LoadGel</span><span class="p">(</span><span class="s">&quot;$(GEL_file_dir)/cc26xx_jlink.gel&quot;</span><span class="p">);</span><span class="w"></span>
<span class="linenos">25</span><span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="linenos">26</span><span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="linenos">27</span><span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="linenos">28</span><span class="w">        </span><span class="n">GEL_TextOut</span><span class="p">(</span><span class="s">&quot;Error: Unknown debugger.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="linenos">29</span><span class="w">        </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="linenos">30</span><span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="linenos">31</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div></blockquote>
</li>
<li><p>Save your modification and close the file. Stop your debugging session</p></li>
</ol>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The modification of the debug configurations only affects one project.</p>
</div>
</div></blockquote>
</li>
<li><p>Modify the Debug Configuration of your project</p>
<blockquote>
<div><p>Once you have clicked CCS’s debug button (the green bug), CCS is doing a
lot of actions for you. For example, CCS loads the program and stops the
execution of the code on the target. In our case, we don’t want CCS to
load the program (as we already have a running program…). In addition,
we don’t necessarily want to stop the execution of the code on the
target. Fortunately, the way CCS is running a debug session is highly
configurable. So let’s adapt those configurations to our needs.</p>
<ol class="loweralpha">
<li><p>On the right of the Debug button, there is an arrow.
Click this arrow and select <em>Debug Configurations…</em>.</p></li>
<li><p>Select your project</p></li>
<li><p>Prevent CCS from loading the program: in the <em>Program</em> tab, chose the
proper <em>Loading options</em> (<em>Load symbols only</em>)</p>
<blockquote>
<div><div class="figure align-center" id="id23">
<img alt="../_images/debug_configuration_1.png" src="../_images/debug_configuration_1.png" />
<p class="caption"><span class="caption-number">Figure 53. </span><span class="caption-text">Open the Debug configurations and modify the loading options.</span><a class="headerlink" href="#id23" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
</li>
<li><p>Prevent CCS from stopping the target: in the <em>Target</em> tab, deselect the
option <em>Halt the target on a connect</em></p></li>
</ol>
<blockquote>
<div><div class="figure align-center" id="id24">
<img alt="../_images/debug_configuration_2.png" src="../_images/debug_configuration_2.png" />
<p class="caption"><span class="caption-number">Figure 54. </span><span class="caption-text">In the Debug configurations, modify the Connection options.</span><a class="headerlink" href="#id24" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
</div></blockquote>
</li>
<li><p>[Optional] Prevent CCS from building the program before load</p>
<blockquote>
<div><p>As no program will be loaded, it is a bit useless to ask CCS to build an
image when you start a debug session. As result, you can disable this
option by using the small arrow at the right of the Flash button. Click
on <em>Build Project Before Load</em> in order to disable the option.</p>
<div class="figure align-center" id="id25">
<img alt="../_images/build_project_before_load.png" src="../_images/build_project_before_load.png" />
<p class="caption"><span class="caption-number">Figure 55. </span><span class="caption-text">Disable “Build Project Before Load” option.</span><a class="headerlink" href="#id25" title="Permalink to this image">¶</a></p>
</div>
<p>Now, the debug button does not anymore load code on the device.
So, how can you load a new image on the device? The easiest way is to use
the Flash button and select the image to flash. Don’t forget to rebuild
your image manually (as we have disabled the option before). Another
solution consists in undoing all the configuration changes we did before.
A third solution consists in using a different version of CCS.</p>
</div></blockquote>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>You are all set now! Let the code running and, when needed, connect
to the running target by using the Debug button as you usually do.</strong></p>
</div>
</div>
<div class="section" id="optimizations">
<span id="sect-debug-optim"></span><h2>Optimizations<a class="headerlink" href="#optimizations" title="Permalink to this headline">¶</a></h2>
<p>Compiler optimizations are great for saving space or speeding up execution.
However, these optimizations can be very difficult to debug around. There are
multiple levels at which optimization can be turned on or off.</p>
<p>Project-wide optimization settings are the most general. Sometimes, given the
constraints of the device, it is impossible to lower the size optimization
level. File-wide optimization settings can be used like project-wide
optimizations to turn on or off certain settings. The most granular control is
using compiler directives to control optimization at a function level.</p>
<div class="section" id="optimizations-in-ccs">
<h3>Optimizations in CCS<a class="headerlink" href="#optimizations-in-ccs" title="Permalink to this headline">¶</a></h3>
<div class="section" id="project-wide-optimizations">
<h4>Project-Wide Optimizations<a class="headerlink" href="#project-wide-optimizations" title="Permalink to this headline">¶</a></h4>
<p>Open the project optimization settings by going to <code class="docutils literal notranslate"><span class="pre">Project</span> <span class="pre">Properties</span></code>
→ <code class="docutils literal notranslate"><span class="pre">CCS</span> <span class="pre">Build</span></code> → <code class="docutils literal notranslate"><span class="pre">ARM</span> <span class="pre">Compiler</span></code> → <code class="docutils literal notranslate"><span class="pre">Optimization</span></code></p>
<div class="figure align-center" id="id26">
<img alt="../_images/ccs_optim_level_project.png" src="../_images/ccs_optim_level_project.png" />
<p class="caption"><span class="caption-number">Figure 56. </span><span class="caption-text">Project-level optimization setting in CCS</span><a class="headerlink" href="#id26" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="single-file-optimizations">
<h4>Single-File Optimizations<a class="headerlink" href="#single-file-optimizations" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Do single-file optimizations with care because this also overrides the
project-wide preprocessor symbols.</p>
</div>
<ol class="arabic simple">
<li><p>Right-click on the file in the Workspace pane.</p></li>
<li><p>Choose Properties.</p></li>
<li><p>Change the optimization level of the file using the same menu in the CCS
project-wide optimization menu.</p></li>
</ol>
</div>
<div class="section" id="single-function-optimizations">
<h4>Single-Function Optimizations<a class="headerlink" href="#single-function-optimizations" title="Permalink to this headline">¶</a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Care must be taken when using pragmas, since they are very specific to the toolchain and may render non-reusable code.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<dl class="simple">
<dt>The TI ARM Clang compiler does not support single-function optimizations. Use Single File optimizations instead.</dt><dd><p>For additional details, check section 3 of the <a class="reference external" href="https://software-dl.ti.com/codegen/docs/tiarmclang/rel1_0_0_sts/tiarmclang_ug/tiarmclang-portfolio/index.html">TI ARM Clang User’s Guide</a>.</p>
</dd>
</dl>
</div>
<div class="literal-block-wrapper docutils container" id="id27">
<div class="code-block-caption"><span class="caption-number">Listing 21. </span><span class="caption-text">Function-level optimization setting in gcc</span><a class="headerlink" href="#id27" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="cp">#pragma GCC push_options</span>
</span><span class="hll"><span class="cp">#pragma GCC optimize (&quot;O0&quot;)</span>
</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">myFunction</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">yourFunction</span><span class="p">(</span><span class="n">other_number</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="hll"><span class="cp">#pragma GCC pop_options</span>
</span></pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="optimizations-in-iar">
<h3>Optimizations in IAR<a class="headerlink" href="#optimizations-in-iar" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id4">
<h4>Project-Wide Optimizations<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Project <code class="docutils literal notranslate"><span class="pre">Options</span></code> → <code class="docutils literal notranslate"><span class="pre">C/C++</span> <span class="pre">Compiler</span></code> → <code class="docutils literal notranslate"><span class="pre">Optimizations</span></code></p>
<div class="figure align-center" id="id28">
<img alt="../_images/iar_optim_level_project.png" src="../_images/iar_optim_level_project.png" />
<p class="caption"><span class="caption-number">Figure 57. </span><span class="caption-text">Project-level optimization setting in IAR</span><a class="headerlink" href="#id28" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="id5">
<h4>Single-File Optimizations<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Right-click on the file in the Workspace pane.</p></li>
<li><p>Choose Options.</p></li>
<li><p>Check Override inherited Settings.</p></li>
<li><p>Choose the optimization level.</p></li>
</ol>
</div>
<div class="section" id="id6">
<h4>Single-Function Optimizations<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Pragmas are very specific to the toolchain, and may lead to non-reusable
code. Be careful where you use these.</p>
</div>
<p>Use #pragma optimize=none before the function definition to deoptimize the
entire function, that is, as follows.</p>
<div class="literal-block-wrapper docutils container" id="id29">
<div class="code-block-caption"><span class="caption-number">Listing 22. </span><span class="caption-text">Function-level optimization setting in IAR</span><a class="headerlink" href="#id29" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="cp">#pragma optimize=none</span>
</span><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">myFunction</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">yourFunction</span><span class="p">(</span><span class="n">other_number</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="deciphering-cpu-exceptions">
<h2>Deciphering CPU Exceptions<a class="headerlink" href="#deciphering-cpu-exceptions" title="Permalink to this headline">¶</a></h2>
<p>Several possible exception causes exist. If an exception is caught, an
exception handler function can be called. Depending on the project settings,
this handler may be a default handler in ROM, which is just an infinite loop or
a custom function called from this default handler instead of a loop.</p>
<p>When an exception occurs, the exception may be caught and halted in debug mode
immediately, depending on the debugger. If the execution halted manually later
through the Break debugger, it is then stopped within the exception handler
loop.</p>
<div class="section" id="exception-cause">
<h3>Exception Cause<a class="headerlink" href="#exception-cause" title="Permalink to this headline">¶</a></h3>
<p>With the default setup using TI-RTOS, the exception cause can be found in the
System Control Space register group (<code class="docutils literal notranslate"><span class="pre">CPU_SCS</span></code>) in the register <code class="docutils literal notranslate"><span class="pre">CFSR</span></code>
(Configurable Fault Status Register). The <a class="reference external" href="http://infocenter.arm.com/help/topic/com.arm.doc.dui0553a/DUI0553A_cortex_m4_dgug.pdf">Arm Cortex User Guide</a> describes
this register. Most exception causes fall into the following three categories.</p>
<ul class="simple">
<li><p>Stack overflow or corruption leads to arbitrary code execution.</p>
<ul>
<li><p>Almost any exception is possible.</p></li>
</ul>
</li>
<li><p>A NULL pointer has been dereferenced and written to.</p>
<ul>
<li><p>Typically (IM)PRECISERR exceptions</p></li>
</ul>
</li>
<li><p>A peripheral module (like UART, Timer, and so forth) is accessed
without being powered.</p>
<ul>
<li><p>Typically (IM)PRECISERR exceptions</p></li>
</ul>
</li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">CFSR</span></code> register is available in <code class="docutils literal notranslate"><span class="pre">View</span></code> → <code class="docutils literal notranslate"><span class="pre">Registers</span></code>.</p>
<p>When an access violation occurs, the exception type is IMPRECISERR because
writes to flash and peripheral memory regions are mostly buffered writes.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">CFSR:BFARVALID</span></code> flag is set when the exception occurs (typical for
PRECISERR), the <code class="docutils literal notranslate"><span class="pre">BFAR</span></code> register in <code class="docutils literal notranslate"><span class="pre">CPU_SCS</span></code> can be read out to find which
memory address caused the exception.</p>
<p>If the exception is IMPRECISERR, PRECISERR can be forced by manually disabling
buffered writes. Set <code class="docutils literal notranslate"><span class="pre">CPU_SCS:ACTRL:DISDEFWBUF</span></code> to 1, by either manually
setting the bit in the register view in the debugger or by including
<code class="docutils literal notranslate"><span class="pre">&lt;hw_cpu_scs.h&gt;</span></code> from Driverlib and calling the following.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ti/devices/cc26x0r2/inc/hw_cpu_scs.h&gt;</span><span class="cp"></span>
<span class="c1">//..</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Disable write-buffering. Note that this negatively affect performance.</span>
<span class="w">    </span><span class="n">HWREG</span><span class="p">(</span><span class="n">CPU_SCS_BASE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">CPU_SCS_O_ACTLR</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CPU_SCS_ACTLR_DISDEFWBUF</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="c1">// ..</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="using-ti-rtos-and-rov-to-parse-exceptions">
<h3>Using TI-RTOS and ROV to Parse Exceptions<a class="headerlink" href="#using-ti-rtos-and-rov-to-parse-exceptions" title="Permalink to this headline">¶</a></h3>
<p>To enable exception decoding in the RTOS Object View (ROV) without using too
much memory, use the Minimal exception handler in TI-RTOS. The default choice
in the Proprietary RF projects is to use no exception handler.</p>
<p>To set this up, open the project’s SysConfig file (.syscfg) and navigate to
<code class="docutils literal notranslate"><span class="pre">TI-RTOS</span></code> → <code class="docutils literal notranslate"><span class="pre">HAL</span></code> → <code class="docutils literal notranslate"><span class="pre">Hwi</span></code> and select the
<code class="docutils literal notranslate"><span class="pre">Enable</span> <span class="pre">Exception</span> <span class="pre">Decoding</span> <span class="pre">at</span> <span class="pre">runtime</span></code> option.</p>
<p>SysConfig sets the default exception handler to <code class="docutils literal notranslate"><span class="pre">Hwi_excHandlerMax</span></code>, which
uses the Error module to pass up errors to a customized function. To
customize this, navigate to <code class="docutils literal notranslate"><span class="pre">TI-RTOS</span></code> → <code class="docutils literal notranslate"><span class="pre">RUNTIME</span></code> →
<code class="docutils literal notranslate"><span class="pre">Error</span> <span class="pre">Handling</span></code> and enter in an
<code class="docutils literal notranslate"><span class="pre">Optional</span> <span class="pre">function</span> <span class="pre">to</span> <span class="pre">call</span> <span class="pre">when</span> <span class="pre">an</span> <span class="pre">error</span> <span class="pre">is</span> <span class="pre">raised</span></code>.</p>
<p>When an exception occurs, the device should end up in that infinite loop.
Inspect the <code class="docutils literal notranslate"><span class="pre">ROV</span></code> → <code class="docutils literal notranslate"><span class="pre">Hwi</span></code> → <code class="docutils literal notranslate"><span class="pre">Exception</span> <span class="pre">information</span></code>.</p>
<div class="figure align-center" id="id30">
<img alt="../_images/rov_hwi_exception.png" src="../_images/rov_hwi_exception.png" />
<p class="caption"><span class="caption-number">Figure 58. </span><span class="caption-text">Decoded exception, intentional write to address 0x0013 which is illegal.
Note that writebuffering has been disabled to get a precise error location,
and that m3Hwi.enableException has been set to false to get the decoding.</span><a class="headerlink" href="#id30" title="Permalink to this image">¶</a></p>
</div>
<p>In this case, a bus fault was forced in the function writeToAddress by
dereferencing address 0x0013 and trying to write to it:</p>
<div class="literal-block-wrapper docutils container" id="id31">
<div class="code-block-caption"><span class="caption-number">Listing 23. </span><span class="caption-text">Write to an address in the FLASH memory region.</span><a class="headerlink" href="#id31" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">writeToAddress</span><span class="p">(</span><span class="kt">uintptr_t</span><span class="w"> </span><span class="o">*</span><span class="n">addr</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">val</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">val</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// ..</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">taskFxn</span><span class="p">(...)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// ..</span>
<span class="w">    </span><span class="n">writeToAddress</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="mi">19</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">);</span><span class="w"> </span><span class="c1">// Randomly chosen values</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<p>The write instruction was placed on line 79 of <code class="docutils literal notranslate"><span class="pre">application.c</span></code>, as indicated.  To
get a precise location, the write buffer was disabled as described earlier.</p>
<p>It can be instructive to look at the disassembly view for the locations
specified by PC (program counter) and LR (link register). PC is the presumed
exception location, and LR is normally the location the failing function should
have returned to. As an example, the PC at this exception:</p>
<div class="figure align-center" id="id32">
<img alt="../_images/exception_pc_of_write.png" src="../_images/exception_pc_of_write.png" />
<p class="caption"><span class="caption-number">Figure 59. </span><span class="caption-text">Here the <code class="docutils literal notranslate"><span class="pre">pc</span></code> from the decoded exception was looked up in the disassembly
view.</span><a class="headerlink" href="#id32" title="Permalink to this image">¶</a></p>
</div>
<p>Some forensics is required here. We have from the Hwi decoding in ROV (and from
the exception context in the exception hook) that the program counter was
<code class="docutils literal notranslate"><span class="pre">0x708e</span></code> when the exception occurred.</p>
<p>At that location there is a store instruction <code class="docutils literal notranslate"><span class="pre">str</span> <span class="pre">r0,</span> <span class="pre">[r1]</span></code> meaning, store
in R0 the value of what the memory address in R1 points to. The business with
<code class="docutils literal notranslate"><span class="pre">SP</span></code> in the figure above is related to optimization being turned off, so all
local variables are stored on the stack, even though in this case R0 and R1
could have been used directly from the caller.</p>
<p>Now we know that the exception occurred because someone called
<code class="docutils literal notranslate"><span class="pre">writeToAddress</span></code> with an invalid address.</p>
<p>Thanks to the exception decoder we can easily find the call site by looking at
the call stack, but if the call stack isn’t helpful, we can look at <code class="docutils literal notranslate"><span class="pre">lr</span></code>,
which is seen in the exception decoder to be <code class="docutils literal notranslate"><span class="pre">0x198f</span></code></p>
<div class="figure align-center" id="id33">
<img alt="../_images/exception_lr_of_write.png" src="../_images/exception_lr_of_write.png" />
<p class="caption"><span class="caption-number">Figure 60. </span><span class="caption-text">Call site as specified in <code class="docutils literal notranslate"><span class="pre">lr</span></code>. Note that lr is the instruction after the
call to <code class="docutils literal notranslate"><span class="pre">writeToAddress</span></code> because execution would have resumed here.</span><a class="headerlink" href="#id33" title="Permalink to this image">¶</a></p>
</div>
<p>We can see here that R0 and R1 are initialized with constants. This means that
some programmer has intentionally called the write function with an address
that causes a busfault.</p>
<p>Most often the reason for a bus-fault is that a pointer is not initialized and
a function like <code class="docutils literal notranslate"><span class="pre">writeToAddress</span></code> gets the pointer, assumes it’s valid and
dereferences the pointer and writes to the invalid address.</p>
</div>
</div>
<div class="section" id="debugging-rf-output">
<h2>Debugging RF Output<a class="headerlink" href="#debugging-rf-output" title="Permalink to this headline">¶</a></h2>
<p>As mentioned in the <a class="reference external" href="http://www.ti.com/lit/pdf/swcu185">CC13x2 CC26x2 SimpleLink Wireless MCU Technical Reference Manual</a>, the RF output can be mapped to pins on the
LaunchPad for RF signal debugging. These pins are intended to be used when
connecting an RF range extender. However, they can also help in instances
where it is unclear if the device is transmitting or receiving in the right
window.</p>
<p>A full overview of the RF Core signals is given in <a class="reference internal" href="../rf-core/signal-routing.html#rf-signal-routing"><span class="std std-ref">Routing RF Core Signals to Physical Pins</span></a>. The
most useful signals for debugging are the LNA enable and Tx start signals. For
debugging the RF driver, the synthesizer calibration signal may also be useful.</p>
<p>To enable RF output debugging, you will need to map the RF Core LNA enable and
PA enable output or Tx start signals to a GPIO. See <a class="reference internal" href="#debugging-enable-rf-observables"><span class="std std-numref">Listing 24.</span></a>
for an example of using DIO6 to output the LNA enable signal (logic high
corresponds to an Rx) and DIO7 to output the Tx start (logic high corresponds
to a Tx). These pins correspond to the Red (DIO6) and Green (DIO7) CC13xx or CC26xx LaunchPad LEDs and
if the jumpers are connected, these LEDs will flicker to indicate RF activity. By
connecting a logic analyzer to these pins, the RF activity over time can be recorded.
If these pins are unavailable in your project, you can select any available DIO.</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id34">
<span id="debugging-enable-rf-observables"></span><div class="code-block-caption"><span class="caption-number">Listing 24. </span><span class="caption-text">Enable RF Observables</span><a class="headerlink" href="#id34" title="Permalink to this code">¶</a></div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cm">/*******************************************************************************</span>
<span class="cm"> * INCLUDES</span>
<span class="cm">*/</span><span class="w"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;driverlib/ioc.h&gt;</span><span class="cp"></span>

<span class="c1">// ...</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>

<span class="w">    </span><span class="cm">/*</span>
<span class="cm">     * Add the following after Board_initGeneral();</span>
<span class="cm">     * Be sure IOIDs used below are not used by any entries in PIN or</span>
<span class="cm">     * GPIO tables from the board files</span>
<span class="cm">     */</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Map LNA enable pin RFC_GPO0 to DIO6</span>
<span class="w">    </span><span class="n">IOCPortConfigureSet</span><span class="p">(</span><span class="n">IOID_6</span><span class="p">,</span><span class="w"> </span><span class="n">IOC_PORT_RFC_GPO0</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="n">IOC_IOMODE_NORMAL</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Map Tx start pin RFC_GPO3 to DIO7</span>
<span class="w">    </span><span class="n">IOCPortConfigureSet</span><span class="p">(</span><span class="n">IOID_7</span><span class="p">,</span><span class="w"> </span><span class="n">IOC_PORT_RFC_GPO3</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="n">IOC_IOMODE_NORMAL</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// ...</span>

<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div></blockquote>
<p>If coexistence is enabled, the RFC_GPO3 is occupied by the REQUEST signal.
To avoid conflicts, please use PA_EN RFC_GPO0.</p>
<p>For more details, see the “External Signaling” chapter of the <a class="reference external" href="http://www.ti.com/lit/pdf/swcu185">CC13x2 CC26x2 SimpleLink Wireless MCU Technical Reference Manual</a>.</p>
</div>
<div class="section" id="debugging-guide-for-serial-interfaces">
<h2>Debugging guide for serial interfaces<a class="headerlink" href="#debugging-guide-for-serial-interfaces" title="Permalink to this headline">¶</a></h2>
<p>The aim of this chapter is to give some pointers on what to check if some issues
are seen when using the UART, SPI, or I2C interfaces.</p>
<p>Note: TI only supports how to use the serial interface modules and the TI
supplied drivers for these interfaces. TI are not able to help on the usage of a
non-TI device connected to I2C, SPI or UART.</p>
<div class="section" id="i2c">
<h3>I2C<a class="headerlink" href="#i2c" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The I2C interface needs an external pull-up resistor. On the LauchPad these
are 3.3 kOhm.</p></li>
<li><p>Measure the waveform on the I2C interface with an oscilloscope to verify the
SCL and  SDA levels</p></li>
<li><p>Monitor the interface with a logic analyzer. Check that data on the bus is the
same as the wanted data.</p></li>
<li><p>Check the interface by reading out the device ID of the sensor.</p></li>
<li><p>Check the slave address. The I2C module uses a 7-bit address. The last 8th bit
is the data direction bit. This last bit is appended automatically by the
driver/HW. The Slave address given to the driver has therefore to be 7-bit.</p></li>
<li><p>Ensure that the readCount and writeCount is according to the register size
used. If the result register in the sensor is 16-bit, the readCount has to be
set to 2.</p></li>
</ul>
</div>
<div class="section" id="spi">
<h3>SPI<a class="headerlink" href="#spi" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Monitor the interface with a logic analyzer. Compare the waveform with the
waveform given in the datasheet for the device you are communicating with.</p></li>
<li><p>Check that the CSn is set correctly.</p></li>
<li><p>Check that the frame format is set correctly. Check if the device you are
communicating with uses SPO = 1 or 0 and SPH = 1 or 0.</p></li>
</ul>
</div>
<div class="section" id="uart">
<h3>UART<a class="headerlink" href="#uart" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Make sure to connect the TX pin of one device to the RX pin of the other
device, and vice versa.  If flow control is enabled, then the same applies
towards the CTS and RTS pins.</p></li>
<li><p>Verify all communication settings between devices, including baud rate,
data length, stop/parity bits and flow control.</p></li>
<li><p>Evaluate the interface with a logic analyzer or oscilloscope, using an
analyzer tool if possible to convert the waveforms into their numerical
counterpart.</p></li>
</ul>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../proprietary-rf/time-synchronization.html" class="btn btn-neutral float-left" title="Time synchronization over the air" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="memory-index.html" class="btn btn-neutral float-right" title="Memory overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2023, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>