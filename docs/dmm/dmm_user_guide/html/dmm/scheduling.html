<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RF Command Scheduling &mdash; 
SimpleLink™ CC13XX/CC26XX SDK
DMM User&#39;s Guide
 5.10.01 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="System Performance and Limitations" href="performance.html" />
    <link rel="prev" title="Application States and Scheduling Policies" href="states-and-policies.html" />
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug dmm scheduling";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script>

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../dmm-guide/index-cc13xx_cc26xx.html" class="icon icon-home"> 
SimpleLink™ CC13XX/CC26XX SDK
DMM User's Guide

          </a>
              <div class="version">
                5.10.01
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/quickstart-intro-cc13xx_cc26xx.html">Introduction to the SimpleLink CC13xx/CC26xx SDK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart-guide/dmm-quick-start.html">Dynamic Multi-protocol Manager Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/index-platform.html">SimpleLink Wireless MCU CC13xx and CC26xx Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dmm-guide/tirtos-index.html">TI-RTOS7 (RTOS Kernel) Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../dmm-guide/dmm-index-cc13xx_cc26xx.html">Dynamic Multi-protocol Manager (DMM)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architectural Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="states-and-policies.html">Application States and Scheduling Policies</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">RF Command Scheduling</a></li>
<li class="toctree-l2"><a class="reference internal" href="performance.html">System Performance and Limitations</a></li>
<li class="toctree-l2"><a class="reference internal" href="example-applications.html">Example Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cc13xx_cc26xx/custom-hardware-cc13xx_cc26xx.html">Custom Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dmm-guide/oad-secure-index.html">Over-the-Air Download (OAD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dmm-guide/debugging-index.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dmm-guide/memory-index.html">Memory overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dmm-guide/sysconfig-index-cc13xx_cc26xx.html">System Configuration Tool (SysConfig)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../energy-trace/energy-trace.html">EnergyTrace User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dmm-guide/index-migration-cc13xx_cc26xx.html">Migration Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dmm-guide/api-reference.html">API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dmm-guide/reference.html">Terms and Definitions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../dmm-guide/index-cc13xx_cc26xx.html">
SimpleLink™ CC13XX/CC26XX SDK
DMM User's Guide
</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../dmm-guide/index-cc13xx_cc26xx.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../dmm-guide/dmm-index-cc13xx_cc26xx.html">Dynamic Multi-protocol Manager (DMM)</a> &raquo;</li>
      <li>RF Command Scheduling</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="rf-command-scheduling">
<span id="sec-dmm-scheduling"></span><h1>RF Command Scheduling<a class="headerlink" href="#rf-command-scheduling" title="Permalink to this headline">¶</a></h1>
<p>RF command scheduling affects only those commands that are submitted through
<a class="reference external" href="../../../rflib/html/group__rf__driver.html#ga5e7f25943b5f3942bf4c09cb87f9aa76">RF_scheduleCmd()</a>. In the case of <a class="reference external" href="../../../rflib/html/group__rf__driver.html#ga2b0ee444fcb74917df94eefea804ecbb">RF_postCmd()</a>, the DMM
redefines this to point to the <a class="reference external" href="../../../rflib/html/group__rf__driver.html#ga5e7f25943b5f3942bf4c09cb87f9aa76">RF_scheduleCmd()</a> API using default
parameters. The actual scheduling behavior is defined by the
<a class="reference internal" href="states-and-policies.html#sec-dmm-policy"><span class="std std-ref">policy</span></a> table entry for the current stack state
combination. When an application updates its state via the
<a class="reference external" href="../../../../dmm/doxygen/dmm/html/dmm__policy_8h.html#a3b80c97cb962dad0928eb42f6bf44c1b">DMMPolicy_updateStackState</a> API, the DMM policy manager will
evaluate and decide if the system state need to change. If the system state
changes, the policy manager will update the DMM scheduler with the new policy.</p>
<p>When a stack wants to schedule an RF command, the DMM scheduler will process
the command based on the scheduling parameters and the active DMM policy:</p>
<dl class="field-list simple">
<dt class="field-odd">Scheduling parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p>stack activity info</p></li>
<li><p>start time and trigger policy</p></li>
<li><p>end time and trigger <em>(optional)</em></p></li>
<li><p>duration <em>(optional)</em></p></li>
<li><p>delay policy</p></li>
</ul>
</dd>
<dt class="field-even">Active DMM policy</dt>
<dd class="field-even"><ul class="simple">
<li><p>priority weight for applicable stack activities</p></li>
</ul>
</dd>
</dl>
<p>The resulting priority for each stack is then calculated as follows:</p>
<div class="math">
<p><img src="../_images/math/47d18def5bf48667dac071cbe9f9157e65317201.svg" alt="\text{Final priority} =
\begin{cases}
    \text{Global priority} + \text{Weight},&amp; \text{if scheduled stack activity is applicable in the active policy}\\
    \text{Global priority},&amp; \text{otherwise}

\end{cases}"/></p>
</div><p>When <a class="reference external" href="../../../rflib/html/group__rf__driver.html#ga5e7f25943b5f3942bf4c09cb87f9aa76">RF_scheduleCmd()</a> or <a class="reference external" href="../../../rflib/html/group__rf__driver.html#ga2b0ee444fcb74917df94eefea804ecbb">RF_postCmd()</a> is called the RF
driver calls a scheduling hook into DMM. The DMM scheduler tries to schedule
the command into the RF queue based on the start time, disregarding the actual
end time of the command. If there is a conflict with another command at the
scheduled start time, a conflict resolution hook is invoked to rule on the
conflict based on the current policy.</p>
<p>In cases where the submitted command is using the <code class="docutils literal notranslate"><span class="pre">TRIG_NOW</span></code> start trigger,
the command will always be inserted in front of the queue, behind any already
submitted <code class="docutils literal notranslate"><span class="pre">TRIG_NOW</span></code> commands, assuming it takes priority. If the command
for any reason cannot be scheduled, for example in case of a conflict with a
higher priority stack, it is rejected.</p>
<p>A scheduling conflict occurs when a command from stack A is running and stack
B is scheduling a command at the same time. To resolve the conflict the delay
policy of the scheduled command is checked first. Regardless of the final
priority, if the scheduled command is delayable it will be delayed until
either the running command completes or the delay runs out. If the delay
policy is not delayable, then the priority is checked. The running command is
preempted if it has a lower priority. If the scheduled command is removed from
the RF queue if it has a lower priority. Assuming the command is not IEEE or
Proprietary RX command, an RF callback with the
<a class="reference external" href="../../../rflib/html/group__rf__driver__cc13x2__cc26x2.html#ga267ffc8a08c3ce6ffa82b704dba641be">RF_EventCmdPreempted</a> event is posted to the stack.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current scheduler implementation is baseline that has limitations. The
DMM scheduler will evolve in the coming releases to cover these
limitations along with improvements.</p>
</div>
<p>The flowchart below shows the complete DMM scheduling flow starting from
interception of a RF command.</p>
<div class="figure align-center" id="id2">
<p class="plantuml">
<img src="../_images/plantuml-87cd9eeb8f86204750c8eff7d1dce27dac559bbf.png" alt="&#64;startuml

:Command is scheduled;

:Invoke scheduling hook;

:Update RF command parameters\naccording to current DMM state;

if (A command is running?) then (yes)
    if (Is there a conflict in time?) then (yes)

        :Invoke conflict resolution hook;

        if (Running command has higher priority?) then (yes)
            if (Is the new command time critical) then (no)

                :Schedule command at\nthe end of the queue;
                stop

            else (yes)

                :Reject command;
                stop

            endif
        else (no)

            :Abort the running command;
            :Insert into queue based on start time;
            stop

        endif
    else (no)
    endif
else (no)
endif

if (Is the new command &quot;TRIG_NOW&quot;?) then (no)
    :Insert into queue based on start time;
    stop
else (yes)
    :Insert command in front of queue\nbased on priority, behind other &quot;TRIG NOW&quot;\ncommands of same or higher priority;
    stop
endif

&#64;enduml"/>
</p>
<p class="caption"><span class="caption-number">Figure 29. </span><span class="caption-text">Scheduling flow for a newly posted command.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="states-and-policies.html" class="btn btn-neutral float-left" title="Application States and Scheduling Policies" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="performance.html" class="btn btn-neutral float-right" title="System Performance and Limitations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2022, Texas Instruments.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>